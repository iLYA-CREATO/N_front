function lb(e,r){for(var t=0;t<r.length;t++){const n=r[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const o=Object.getOwnPropertyDescriptor(n,s);o&&Object.defineProperty(e,s,o.get?o:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function Kg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Jf={exports:{}},ko={},Qf={exports:{}},Nt={};var Km;function ob(){if(Km)return Nt;Km=1;var e=Symbol.for("react.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),p=Symbol.iterator;function y(z){return z===null||typeof z!="object"?null:(z=p&&z[p]||z["@@iterator"],typeof z=="function"?z:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,v={};function w(z,T,Q){this.props=z,this.context=T,this.refs=v,this.updater=Q||k}w.prototype.isReactComponent={},w.prototype.setState=function(z,T){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,T,"setState")},w.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function S(){}S.prototype=w.prototype;function I(z,T,Q){this.props=z,this.context=T,this.refs=v,this.updater=Q||k}var N=I.prototype=new S;N.constructor=I,b(N,w.prototype),N.isPureReactComponent=!0;var P=Array.isArray,W=Object.prototype.hasOwnProperty,X={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function Z(z,T,Q){var Y,J={},K=null,fe=null;if(T!=null)for(Y in T.ref!==void 0&&(fe=T.ref),T.key!==void 0&&(K=""+T.key),T)W.call(T,Y)&&!M.hasOwnProperty(Y)&&(J[Y]=T[Y]);var we=arguments.length-2;if(we===1)J.children=Q;else if(1<we){for(var ye=Array(we),je=0;je<we;je++)ye[je]=arguments[je+2];J.children=ye}if(z&&z.defaultProps)for(Y in we=z.defaultProps,we)J[Y]===void 0&&(J[Y]=we[Y]);return{$$typeof:e,type:z,key:K,ref:fe,props:J,_owner:X.current}}function H(z,T){return{$$typeof:e,type:z.type,key:T,ref:z.ref,props:z.props,_owner:z._owner}}function ce(z){return typeof z=="object"&&z!==null&&z.$$typeof===e}function le(z){var T={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(Q){return T[Q]})}var re=/\/+/g;function te(z,T){return typeof z=="object"&&z!==null&&z.key!=null?le(""+z.key):T.toString(36)}function ve(z,T,Q,Y,J){var K=typeof z;(K==="undefined"||K==="boolean")&&(z=null);var fe=!1;if(z===null)fe=!0;else switch(K){case"string":case"number":fe=!0;break;case"object":switch(z.$$typeof){case e:case r:fe=!0}}if(fe)return fe=z,J=J(fe),z=Y===""?"."+te(fe,0):Y,P(J)?(Q="",z!=null&&(Q=z.replace(re,"$&/")+"/"),ve(J,T,Q,"",function(je){return je})):J!=null&&(ce(J)&&(J=H(J,Q+(!J.key||fe&&fe.key===J.key?"":(""+J.key).replace(re,"$&/")+"/")+z)),T.push(J)),1;if(fe=0,Y=Y===""?".":Y+":",P(z))for(var we=0;we<z.length;we++){K=z[we];var ye=Y+te(K,we);fe+=ve(K,T,Q,ye,J)}else if(ye=y(z),typeof ye=="function")for(z=ye.call(z),we=0;!(K=z.next()).done;)K=K.value,ye=Y+te(K,we++),fe+=ve(K,T,Q,ye,J);else if(K==="object")throw T=String(z),Error("Objects are not valid as a React child (found: "+(T==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":T)+"). If you meant to render a collection of children, use an array instead.");return fe}function Se(z,T,Q){if(z==null)return z;var Y=[],J=0;return ve(z,Y,"","",function(K){return T.call(Q,K,J++)}),Y}function Ce(z){if(z._status===-1){var T=z._result;T=T(),T.then(function(Q){(z._status===0||z._status===-1)&&(z._status=1,z._result=Q)},function(Q){(z._status===0||z._status===-1)&&(z._status=2,z._result=Q)}),z._status===-1&&(z._status=0,z._result=T)}if(z._status===1)return z._result.default;throw z._result}var ue={current:null},ne={transition:null},A={ReactCurrentDispatcher:ue,ReactCurrentBatchConfig:ne,ReactCurrentOwner:X};function me(){throw Error("act(...) is not supported in production builds of React.")}return Nt.Children={map:Se,forEach:function(z,T,Q){Se(z,function(){T.apply(this,arguments)},Q)},count:function(z){var T=0;return Se(z,function(){T++}),T},toArray:function(z){return Se(z,function(T){return T})||[]},only:function(z){if(!ce(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},Nt.Component=w,Nt.Fragment=t,Nt.Profiler=s,Nt.PureComponent=I,Nt.StrictMode=n,Nt.Suspense=d,Nt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=A,Nt.act=me,Nt.cloneElement=function(z,T,Q){if(z==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+z+".");var Y=b({},z.props),J=z.key,K=z.ref,fe=z._owner;if(T!=null){if(T.ref!==void 0&&(K=T.ref,fe=X.current),T.key!==void 0&&(J=""+T.key),z.type&&z.type.defaultProps)var we=z.type.defaultProps;for(ye in T)W.call(T,ye)&&!M.hasOwnProperty(ye)&&(Y[ye]=T[ye]===void 0&&we!==void 0?we[ye]:T[ye])}var ye=arguments.length-2;if(ye===1)Y.children=Q;else if(1<ye){we=Array(ye);for(var je=0;je<ye;je++)we[je]=arguments[je+2];Y.children=we}return{$$typeof:e,type:z.type,key:J,ref:K,props:Y,_owner:fe}},Nt.createContext=function(z){return z={$$typeof:c,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},z.Provider={$$typeof:o,_context:z},z.Consumer=z},Nt.createElement=Z,Nt.createFactory=function(z){var T=Z.bind(null,z);return T.type=z,T},Nt.createRef=function(){return{current:null}},Nt.forwardRef=function(z){return{$$typeof:u,render:z}},Nt.isValidElement=ce,Nt.lazy=function(z){return{$$typeof:m,_payload:{_status:-1,_result:z},_init:Ce}},Nt.memo=function(z,T){return{$$typeof:h,type:z,compare:T===void 0?null:T}},Nt.startTransition=function(z){var T=ne.transition;ne.transition={};try{z()}finally{ne.transition=T}},Nt.unstable_act=me,Nt.useCallback=function(z,T){return ue.current.useCallback(z,T)},Nt.useContext=function(z){return ue.current.useContext(z)},Nt.useDebugValue=function(){},Nt.useDeferredValue=function(z){return ue.current.useDeferredValue(z)},Nt.useEffect=function(z,T){return ue.current.useEffect(z,T)},Nt.useId=function(){return ue.current.useId()},Nt.useImperativeHandle=function(z,T,Q){return ue.current.useImperativeHandle(z,T,Q)},Nt.useInsertionEffect=function(z,T){return ue.current.useInsertionEffect(z,T)},Nt.useLayoutEffect=function(z,T){return ue.current.useLayoutEffect(z,T)},Nt.useMemo=function(z,T){return ue.current.useMemo(z,T)},Nt.useReducer=function(z,T,Q){return ue.current.useReducer(z,T,Q)},Nt.useRef=function(z){return ue.current.useRef(z)},Nt.useState=function(z){return ue.current.useState(z)},Nt.useSyncExternalStore=function(z,T,Q){return ue.current.useSyncExternalStore(z,T,Q)},Nt.useTransition=function(){return ue.current.useTransition()},Nt.version="18.3.1",Nt}var Ym;function Hd(){return Ym||(Ym=1,Qf.exports=ob()),Qf.exports}var Jm;function cb(){if(Jm)return ko;Jm=1;var e=Hd(),r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(u,d,h){var m,p={},y=null,k=null;h!==void 0&&(y=""+h),d.key!==void 0&&(y=""+d.key),d.ref!==void 0&&(k=d.ref);for(m in d)n.call(d,m)&&!o.hasOwnProperty(m)&&(p[m]=d[m]);if(u&&u.defaultProps)for(m in d=u.defaultProps,d)p[m]===void 0&&(p[m]=d[m]);return{$$typeof:r,type:u,key:y,ref:k,props:p,_owner:s.current}}return ko.Fragment=t,ko.jsx=c,ko.jsxs=c,ko}var Qm;function ub(){return Qm||(Qm=1,Jf.exports=cb()),Jf.exports}var i=ub(),j=Hd();const Yg=Kg(j),fb=lb({__proto__:null,default:Yg},[j]);var y0={},Zf={exports:{}},Dn={},ed={exports:{}},td={};var Zm;function db(){return Zm||(Zm=1,(function(e){function r(ne,A){var me=ne.length;ne.push(A);e:for(;0<me;){var z=me-1>>>1,T=ne[z];if(0<s(T,A))ne[z]=A,ne[me]=T,me=z;else break e}}function t(ne){return ne.length===0?null:ne[0]}function n(ne){if(ne.length===0)return null;var A=ne[0],me=ne.pop();if(me!==A){ne[0]=me;e:for(var z=0,T=ne.length,Q=T>>>1;z<Q;){var Y=2*(z+1)-1,J=ne[Y],K=Y+1,fe=ne[K];if(0>s(J,me))K<T&&0>s(fe,J)?(ne[z]=fe,ne[K]=me,z=K):(ne[z]=J,ne[Y]=me,z=Y);else if(K<T&&0>s(fe,me))ne[z]=fe,ne[K]=me,z=K;else break e}}return A}function s(ne,A){var me=ne.sortIndex-A.sortIndex;return me!==0?me:ne.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var d=[],h=[],m=1,p=null,y=3,k=!1,b=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(ne){for(var A=t(h);A!==null;){if(A.callback===null)n(h);else if(A.startTime<=ne)n(h),A.sortIndex=A.expirationTime,r(d,A);else break;A=t(h)}}function P(ne){if(v=!1,N(ne),!b)if(t(d)!==null)b=!0,Ce(W);else{var A=t(h);A!==null&&ue(P,A.startTime-ne)}}function W(ne,A){b=!1,v&&(v=!1,S(Z),Z=-1),k=!0;var me=y;try{for(N(A),p=t(d);p!==null&&(!(p.expirationTime>A)||ne&&!le());){var z=p.callback;if(typeof z=="function"){p.callback=null,y=p.priorityLevel;var T=z(p.expirationTime<=A);A=e.unstable_now(),typeof T=="function"?p.callback=T:p===t(d)&&n(d),N(A)}else n(d);p=t(d)}if(p!==null)var Q=!0;else{var Y=t(h);Y!==null&&ue(P,Y.startTime-A),Q=!1}return Q}finally{p=null,y=me,k=!1}}var X=!1,M=null,Z=-1,H=5,ce=-1;function le(){return!(e.unstable_now()-ce<H)}function re(){if(M!==null){var ne=e.unstable_now();ce=ne;var A=!0;try{A=M(!0,ne)}finally{A?te():(X=!1,M=null)}}else X=!1}var te;if(typeof I=="function")te=function(){I(re)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,Se=ve.port2;ve.port1.onmessage=re,te=function(){Se.postMessage(null)}}else te=function(){w(re,0)};function Ce(ne){M=ne,X||(X=!0,te())}function ue(ne,A){Z=w(function(){ne(e.unstable_now())},A)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ne){ne.callback=null},e.unstable_continueExecution=function(){b||k||(b=!0,Ce(W))},e.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<ne?Math.floor(1e3/ne):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return t(d)},e.unstable_next=function(ne){switch(y){case 1:case 2:case 3:var A=3;break;default:A=y}var me=y;y=A;try{return ne()}finally{y=me}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ne,A){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var me=y;y=ne;try{return A()}finally{y=me}},e.unstable_scheduleCallback=function(ne,A,me){var z=e.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?z+me:z):me=z,ne){case 1:var T=-1;break;case 2:T=250;break;case 5:T=1073741823;break;case 4:T=1e4;break;default:T=5e3}return T=me+T,ne={id:m++,callback:A,priorityLevel:ne,startTime:me,expirationTime:T,sortIndex:-1},me>z?(ne.sortIndex=me,r(h,ne),t(d)===null&&ne===t(h)&&(v?(S(Z),Z=-1):v=!0,ue(P,me-z))):(ne.sortIndex=T,r(d,ne),b||k||(b=!0,Ce(W))),ne},e.unstable_shouldYield=le,e.unstable_wrapCallback=function(ne){var A=y;return function(){var me=y;y=A;try{return ne.apply(this,arguments)}finally{y=me}}}})(td)),td}var ep;function hb(){return ep||(ep=1,ed.exports=db()),ed.exports}var tp;function xb(){if(tp)return Dn;tp=1;var e=Hd(),r=hb();function t(a){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+a,f=1;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function o(a,l){c(a,l),c(a+"Capture",l)}function c(a,l){for(s[a]=l,a=0;a<l.length;a++)n.add(l[a])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},p={};function y(a){return d.call(p,a)?!0:d.call(m,a)?!1:h.test(a)?p[a]=!0:(m[a]=!0,!1)}function k(a,l,f,x){if(f!==null&&f.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return x?!1:f!==null?!f.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function b(a,l,f,x){if(l===null||typeof l>"u"||k(a,l,f,x))return!0;if(x)return!1;if(f!==null)switch(f.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function v(a,l,f,x,g,_,F){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=x,this.attributeNamespace=g,this.mustUseProperty=f,this.propertyName=a,this.type=l,this.sanitizeURL=_,this.removeEmptyString=F}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){w[a]=new v(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var l=a[0];w[l]=new v(l,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){w[a]=new v(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){w[a]=new v(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){w[a]=new v(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){w[a]=new v(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){w[a]=new v(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){w[a]=new v(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){w[a]=new v(a,5,!1,a.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function I(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var l=a.replace(S,I);w[l]=new v(l,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var l=a.replace(S,I);w[l]=new v(l,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var l=a.replace(S,I);w[l]=new v(l,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){w[a]=new v(a,1,!1,a.toLowerCase(),null,!1,!1)}),w.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){w[a]=new v(a,1,!1,a.toLowerCase(),null,!0,!0)});function N(a,l,f,x){var g=w.hasOwnProperty(l)?w[l]:null;(g!==null?g.type!==0:x||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(b(l,f,g,x)&&(f=null),x||g===null?y(l)&&(f===null?a.removeAttribute(l):a.setAttribute(l,""+f)):g.mustUseProperty?a[g.propertyName]=f===null?g.type===3?!1:"":f:(l=g.attributeName,x=g.attributeNamespace,f===null?a.removeAttribute(l):(g=g.type,f=g===3||g===4&&f===!0?"":""+f,x?a.setAttributeNS(x,l,f):a.setAttribute(l,f))))}var P=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,W=Symbol.for("react.element"),X=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),Z=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),ce=Symbol.for("react.provider"),le=Symbol.for("react.context"),re=Symbol.for("react.forward_ref"),te=Symbol.for("react.suspense"),ve=Symbol.for("react.suspense_list"),Se=Symbol.for("react.memo"),Ce=Symbol.for("react.lazy"),ue=Symbol.for("react.offscreen"),ne=Symbol.iterator;function A(a){return a===null||typeof a!="object"?null:(a=ne&&a[ne]||a["@@iterator"],typeof a=="function"?a:null)}var me=Object.assign,z;function T(a){if(z===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);z=l&&l[1]||""}return`
`+z+a}var Q=!1;function Y(a,l){if(!a||Q)return"";Q=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(ge){var x=ge}Reflect.construct(a,[],l)}else{try{l.call()}catch(ge){x=ge}a.call(l.prototype)}else{try{throw Error()}catch(ge){x=ge}a()}}catch(ge){if(ge&&x&&typeof ge.stack=="string"){for(var g=ge.stack.split(`
`),_=x.stack.split(`
`),F=g.length-1,ee=_.length-1;1<=F&&0<=ee&&g[F]!==_[ee];)ee--;for(;1<=F&&0<=ee;F--,ee--)if(g[F]!==_[ee]){if(F!==1||ee!==1)do if(F--,ee--,0>ee||g[F]!==_[ee]){var se=`
`+g[F].replace(" at new "," at ");return a.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",a.displayName)),se}while(1<=F&&0<=ee);break}}}finally{Q=!1,Error.prepareStackTrace=f}return(a=a?a.displayName||a.name:"")?T(a):""}function J(a){switch(a.tag){case 5:return T(a.type);case 16:return T("Lazy");case 13:return T("Suspense");case 19:return T("SuspenseList");case 0:case 2:case 15:return a=Y(a.type,!1),a;case 11:return a=Y(a.type.render,!1),a;case 1:return a=Y(a.type,!0),a;default:return""}}function K(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case M:return"Fragment";case X:return"Portal";case H:return"Profiler";case Z:return"StrictMode";case te:return"Suspense";case ve:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case le:return(a.displayName||"Context")+".Consumer";case ce:return(a._context.displayName||"Context")+".Provider";case re:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case Se:return l=a.displayName||null,l!==null?l:K(a.type)||"Memo";case Ce:l=a._payload,a=a._init;try{return K(a(l))}catch{}}return null}function fe(a){var l=a.type;switch(a.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=l.render,a=a.displayName||a.name||"",l.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return K(l);case 8:return l===Z?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function we(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function ye(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function je(a){var l=ye(a)?"checked":"value",f=Object.getOwnPropertyDescriptor(a.constructor.prototype,l),x=""+a[l];if(!a.hasOwnProperty(l)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var g=f.get,_=f.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return g.call(this)},set:function(F){x=""+F,_.call(this,F)}}),Object.defineProperty(a,l,{enumerable:f.enumerable}),{getValue:function(){return x},setValue:function(F){x=""+F},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function Xe(a){a._valueTracker||(a._valueTracker=je(a))}function D(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var f=l.getValue(),x="";return a&&(x=ye(a)?a.checked?"true":"false":a.value),a=x,a!==f?(l.setValue(a),!0):!1}function Pe(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function rt(a,l){var f=l.checked;return me({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??a._wrapperState.initialChecked})}function xt(a,l){var f=l.defaultValue==null?"":l.defaultValue,x=l.checked!=null?l.checked:l.defaultChecked;f=we(l.value!=null?l.value:f),a._wrapperState={initialChecked:x,initialValue:f,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function nt(a,l){l=l.checked,l!=null&&N(a,"checked",l,!1)}function Le(a,l){nt(a,l);var f=we(l.value),x=l.type;if(f!=null)x==="number"?(f===0&&a.value===""||a.value!=f)&&(a.value=""+f):a.value!==""+f&&(a.value=""+f);else if(x==="submit"||x==="reset"){a.removeAttribute("value");return}l.hasOwnProperty("value")?Rt(a,l.type,f):l.hasOwnProperty("defaultValue")&&Rt(a,l.type,we(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(a.defaultChecked=!!l.defaultChecked)}function jt(a,l,f){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var x=l.type;if(!(x!=="submit"&&x!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+a._wrapperState.initialValue,f||l===a.value||(a.value=l),a.defaultValue=l}f=a.name,f!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,f!==""&&(a.name=f)}function Rt(a,l,f){(l!=="number"||Pe(a.ownerDocument)!==a)&&(f==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+f&&(a.defaultValue=""+f))}var Bt=Array.isArray;function bt(a,l,f,x){if(a=a.options,l){l={};for(var g=0;g<f.length;g++)l["$"+f[g]]=!0;for(f=0;f<a.length;f++)g=l.hasOwnProperty("$"+a[f].value),a[f].selected!==g&&(a[f].selected=g),g&&x&&(a[f].defaultSelected=!0)}else{for(f=""+we(f),l=null,g=0;g<a.length;g++){if(a[g].value===f){a[g].selected=!0,x&&(a[g].defaultSelected=!0);return}l!==null||a[g].disabled||(l=a[g])}l!==null&&(l.selected=!0)}}function fr(a,l){if(l.dangerouslySetInnerHTML!=null)throw Error(t(91));return me({},l,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function kt(a,l){var f=l.value;if(f==null){if(f=l.children,l=l.defaultValue,f!=null){if(l!=null)throw Error(t(92));if(Bt(f)){if(1<f.length)throw Error(t(93));f=f[0]}l=f}l==null&&(l=""),f=l}a._wrapperState={initialValue:we(f)}}function Pt(a,l){var f=we(l.value),x=we(l.defaultValue);f!=null&&(f=""+f,f!==a.value&&(a.value=f),l.defaultValue==null&&a.defaultValue!==f&&(a.defaultValue=f)),x!=null&&(a.defaultValue=""+x)}function Ut(a){var l=a.textContent;l===a._wrapperState.initialValue&&l!==""&&l!==null&&(a.value=l)}function Mt(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Gt(a,l){return a==null||a==="http://www.w3.org/1999/xhtml"?Mt(l):a==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Tt,tr=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,f,x,g){MSApp.execUnsafeLocalFunction(function(){return a(l,f,x,g)})}:a})(function(a,l){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=l;else{for(Tt=Tt||document.createElement("div"),Tt.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=Tt.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;l.firstChild;)a.appendChild(l.firstChild)}});function Ze(a,l){if(l){var f=a.firstChild;if(f&&f===a.lastChild&&f.nodeType===3){f.nodeValue=l;return}}a.textContent=l}var qe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vt=["Webkit","ms","Moz","O"];Object.keys(qe).forEach(function(a){vt.forEach(function(l){l=l+a.charAt(0).toUpperCase()+a.substring(1),qe[l]=qe[a]})});function ht(a,l,f){return l==null||typeof l=="boolean"||l===""?"":f||typeof l!="number"||l===0||qe.hasOwnProperty(a)&&qe[a]?(""+l).trim():l+"px"}function qt(a,l){a=a.style;for(var f in l)if(l.hasOwnProperty(f)){var x=f.indexOf("--")===0,g=ht(f,l[f],x);f==="float"&&(f="cssFloat"),x?a.setProperty(f,g):a[f]=g}}var rr=me({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ar(a,l){if(l){if(rr[a]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(t(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(t(61))}if(l.style!=null&&typeof l.style!="object")throw Error(t(62))}}function Lt(a,l){if(a.indexOf("-")===-1)return typeof l.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sr=null;function Or(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Nr=null,Br=null,Ur=null;function dr(a){if(a=lo(a)){if(typeof Nr!="function")throw Error(t(280));var l=a.stateNode;l&&(l=Ic(l),Nr(a.stateNode,a.type,l))}}function zr(a){Br?Ur?Ur.push(a):Ur=[a]:Br=a}function Yr(){if(Br){var a=Br,l=Ur;if(Ur=Br=null,dr(a),l)for(a=0;a<l.length;a++)dr(l[a])}}function En(a,l){return a(l)}function Bn(){}var $r=!1;function Sr(a,l,f){if($r)return a(l,f);$r=!0;try{return En(a,l,f)}finally{$r=!1,(Br!==null||Ur!==null)&&(Bn(),Yr())}}function Dr(a,l){var f=a.stateNode;if(f===null)return null;var x=Ic(f);if(x===null)return null;f=x[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(a=a.type,x=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!x;break e;default:a=!1}if(a)return null;if(f&&typeof f!="function")throw Error(t(231,l,typeof f));return f}var Jr=!1;if(u)try{var Er={};Object.defineProperty(Er,"passive",{get:function(){Jr=!0}}),window.addEventListener("test",Er,Er),window.removeEventListener("test",Er,Er)}catch{Jr=!1}function ps(a,l,f,x,g,_,F,ee,se){var ge=Array.prototype.slice.call(arguments,3);try{l.apply(f,ge)}catch(Re){this.onError(Re)}}var Ir=!1,jn=null,O=!1,V=null,L={onError:function(a){Ir=!0,jn=a}};function U(a,l,f,x,g,_,F,ee,se){Ir=!1,jn=null,ps.apply(L,arguments)}function q(a,l,f,x,g,_,F,ee,se){if(U.apply(this,arguments),Ir){if(Ir){var ge=jn;Ir=!1,jn=null}else throw Error(t(198));O||(O=!0,V=ge)}}function G(a){var l=a,f=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(f=l.return),a=l.return;while(a)}return l.tag===3?f:null}function he(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function Ne(a){if(G(a)!==a)throw Error(t(188))}function ae(a){var l=a.alternate;if(!l){if(l=G(a),l===null)throw Error(t(188));return l!==a?null:a}for(var f=a,x=l;;){var g=f.return;if(g===null)break;var _=g.alternate;if(_===null){if(x=g.return,x!==null){f=x;continue}break}if(g.child===_.child){for(_=g.child;_;){if(_===f)return Ne(g),a;if(_===x)return Ne(g),l;_=_.sibling}throw Error(t(188))}if(f.return!==x.return)f=g,x=_;else{for(var F=!1,ee=g.child;ee;){if(ee===f){F=!0,f=g,x=_;break}if(ee===x){F=!0,x=g,f=_;break}ee=ee.sibling}if(!F){for(ee=_.child;ee;){if(ee===f){F=!0,f=_,x=g;break}if(ee===x){F=!0,x=_,f=g;break}ee=ee.sibling}if(!F)throw Error(t(189))}}if(f.alternate!==x)throw Error(t(190))}if(f.tag!==3)throw Error(t(188));return f.stateNode.current===f?a:l}function xe(a){return a=ae(a),a!==null?R(a):null}function R(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var l=R(a);if(l!==null)return l;a=a.sibling}return null}var E=r.unstable_scheduleCallback,ie=r.unstable_cancelCallback,Te=r.unstable_shouldYield,Fe=r.unstable_requestPaint,Ae=r.unstable_now,et=r.unstable_getCurrentPriorityLevel,Et=r.unstable_ImmediatePriority,Ct=r.unstable_UserBlockingPriority,Vt=r.unstable_NormalPriority,Un=r.unstable_LowPriority,zn=r.unstable_IdlePriority,gn=null,hr=null;function ya(a){if(hr&&typeof hr.onCommitFiberRoot=="function")try{hr.onCommitFiberRoot(gn,a,void 0,(a.current.flags&128)===128)}catch{}}var Kt=Math.clz32?Math.clz32:Ui,Bi=Math.log,Ll=Math.LN2;function Ui(a){return a>>>=0,a===0?32:31-(Bi(a)/Ll|0)|0}var vn=64,Ys=4194304;function Qn(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function gs(a,l){var f=a.pendingLanes;if(f===0)return 0;var x=0,g=a.suspendedLanes,_=a.pingedLanes,F=f&268435455;if(F!==0){var ee=F&~g;ee!==0?x=Qn(ee):(_&=F,_!==0&&(x=Qn(_)))}else F=f&~g,F!==0?x=Qn(F):_!==0&&(x=Qn(_));if(x===0)return 0;if(l!==0&&l!==x&&(l&g)===0&&(g=x&-x,_=l&-l,g>=_||g===16&&(_&4194240)!==0))return l;if((x&4)!==0&&(x|=f&16),l=a.entangledLanes,l!==0)for(a=a.entanglements,l&=x;0<l;)f=31-Kt(l),g=1<<f,x|=a[f],l&=~g;return x}function Bl(a,l){switch(a){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Js(a,l){for(var f=a.suspendedLanes,x=a.pingedLanes,g=a.expirationTimes,_=a.pendingLanes;0<_;){var F=31-Kt(_),ee=1<<F,se=g[F];se===-1?((ee&f)===0||(ee&x)!==0)&&(g[F]=Bl(ee,l)):se<=l&&(a.expiredLanes|=ee),_&=~ee}}function ba(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Qa(){var a=vn;return vn<<=1,(vn&4194240)===0&&(vn=64),a}function wa(a){for(var l=[],f=0;31>f;f++)l.push(a);return l}function $n(a,l,f){a.pendingLanes|=l,l!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,l=31-Kt(l),a[l]=f}function C(a,l){var f=a.pendingLanes&~l;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=l,a.mutableReadLanes&=l,a.entangledLanes&=l,l=a.entanglements;var x=a.eventTimes;for(a=a.expirationTimes;0<f;){var g=31-Kt(f),_=1<<g;l[g]=0,x[g]=-1,a[g]=-1,f&=~_}}function _e(a,l){var f=a.entangledLanes|=l;for(a=a.entanglements;f;){var x=31-Kt(f),g=1<<x;g&l|a[x]&l&&(a[x]|=l),f&=~g}}var ke=0;function Ve(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var wt,vs,yn,We,pc,gc=!1,Ul=[],Qs=null,Zs=null,Zn=null,Is=new Map,ea=new Map,Rs=[],mu="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vc(a,l){switch(a){case"focusin":case"focusout":Qs=null;break;case"dragenter":case"dragleave":Zs=null;break;case"mouseover":case"mouseout":Zn=null;break;case"pointerover":case"pointerout":Is.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":ea.delete(l.pointerId)}}function ta(a,l,f,x,g,_){return a===null||a.nativeEvent!==_?(a={blockedOn:l,domEventName:f,eventSystemFlags:x,nativeEvent:_,targetContainers:[g]},l!==null&&(l=lo(l),l!==null&&vs(l)),a):(a.eventSystemFlags|=x,l=a.targetContainers,g!==null&&l.indexOf(g)===-1&&l.push(g),a)}function yc(a,l,f,x,g){switch(l){case"focusin":return Qs=ta(Qs,a,l,f,x,g),!0;case"dragenter":return Zs=ta(Zs,a,l,f,x,g),!0;case"mouseover":return Zn=ta(Zn,a,l,f,x,g),!0;case"pointerover":var _=g.pointerId;return Is.set(_,ta(Is.get(_)||null,a,l,f,x,g)),!0;case"gotpointercapture":return _=g.pointerId,ea.set(_,ta(ea.get(_)||null,a,l,f,x,g)),!0}return!1}function Hn(a){var l=ai(a.target);if(l!==null){var f=G(l);if(f!==null){if(l=f.tag,l===13){if(l=he(f),l!==null){a.blockedOn=l,pc(a.priority,function(){yn(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){a.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Za(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var f=Hl(a.domEventName,a.eventSystemFlags,l[0],a.nativeEvent);if(f===null){f=a.nativeEvent;var x=new f.constructor(f.type,f);sr=x,f.target.dispatchEvent(x),sr=null}else return l=lo(f),l!==null&&vs(l),a.blockedOn=f,!1;l.shift()}return!0}function bc(a,l,f){Za(a)&&f.delete(l)}function zl(){gc=!1,Qs!==null&&Za(Qs)&&(Qs=null),Zs!==null&&Za(Zs)&&(Zs=null),Zn!==null&&Za(Zn)&&(Zn=null),Is.forEach(bc),ea.forEach(bc)}function ei(a,l){a.blockedOn===l&&(a.blockedOn=null,gc||(gc=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,zl)))}function ti(a){function l(g){return ei(g,a)}if(0<Ul.length){ei(Ul[0],a);for(var f=1;f<Ul.length;f++){var x=Ul[f];x.blockedOn===a&&(x.blockedOn=null)}}for(Qs!==null&&ei(Qs,a),Zs!==null&&ei(Zs,a),Zn!==null&&ei(Zn,a),Is.forEach(l),ea.forEach(l),f=0;f<Rs.length;f++)x=Rs[f],x.blockedOn===a&&(x.blockedOn=null);for(;0<Rs.length&&(f=Rs[0],f.blockedOn===null);)Hn(f),f.blockedOn===null&&Rs.shift()}var ys=P.ReactCurrentBatchConfig,_a=!0;function pu(a,l,f,x){var g=ke,_=ys.transition;ys.transition=null;try{ke=1,$l(a,l,f,x)}finally{ke=g,ys.transition=_}}function gu(a,l,f,x){var g=ke,_=ys.transition;ys.transition=null;try{ke=4,$l(a,l,f,x)}finally{ke=g,ys.transition=_}}function $l(a,l,f,x){if(_a){var g=Hl(a,l,f,x);if(g===null)Uu(a,l,x,zi,f),vc(a,x);else if(yc(g,a,l,f,x))x.stopPropagation();else if(vc(a,x),l&4&&-1<mu.indexOf(a)){for(;g!==null;){var _=lo(g);if(_!==null&&wt(_),_=Hl(a,l,f,x),_===null&&Uu(a,l,x,zi,f),_===g)break;g=_}g!==null&&x.stopPropagation()}else Uu(a,l,x,null,f)}}var zi=null;function Hl(a,l,f,x){if(zi=null,a=Or(x),a=ai(a),a!==null)if(l=G(a),l===null)a=null;else if(f=l.tag,f===13){if(a=he(l),a!==null)return a;a=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null);return zi=a,null}function wc(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(et()){case Et:return 1;case Ct:return 4;case Vt:case Un:return 16;case zn:return 536870912;default:return 16}default:return 16}}var bs=null,Wl=null,$i=null;function Vl(){if($i)return $i;var a,l=Wl,f=l.length,x,g="value"in bs?bs.value:bs.textContent,_=g.length;for(a=0;a<f&&l[a]===g[a];a++);var F=f-a;for(x=1;x<=F&&l[f-x]===g[_-x];x++);return $i=g.slice(a,1<x?1-x:void 0)}function Hi(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function Wi(){return!0}function _c(){return!1}function bn(a){function l(f,x,g,_,F){this._reactName=f,this._targetInst=g,this.type=x,this.nativeEvent=_,this.target=F,this.currentTarget=null;for(var ee in a)a.hasOwnProperty(ee)&&(f=a[ee],this[ee]=f?f(_):_[ee]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?Wi:_c,this.isPropagationStopped=_c,this}return me(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Wi)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Wi)},persist:function(){},isPersistent:Wi}),l}var ka={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ql=bn(ka),ri=me({},ka,{view:0,detail:0}),kc=bn(ri),Xl,Gl,ni,si=me({},ri,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jl,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==ni&&(ni&&a.type==="mousemove"?(Xl=a.screenX-ni.screenX,Gl=a.screenY-ni.screenY):Gl=Xl=0,ni=a),Xl)},movementY:function(a){return"movementY"in a?a.movementY:Gl}}),Nc=bn(si),vu=me({},si,{dataTransfer:0}),yu=bn(vu),bu=me({},ri,{relatedTarget:0}),Kl=bn(bu),wu=me({},ka,{animationName:0,elapsedTime:0,pseudoElement:0}),_u=bn(wu),ku=me({},ka,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Nu=bn(ku),Su=me({},ka,{data:0}),Sc=bn(Su),Ec={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Eu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ju={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yl(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=ju[a])?!!l[a]:!1}function Jl(){return Yl}var Cu=me({},ri,{key:function(a){if(a.key){var l=Ec[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=Hi(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Eu[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jl,charCode:function(a){return a.type==="keypress"?Hi(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Hi(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Tu=bn(Cu),B=me({},si,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Oe=bn(B),Ue=me({},ri,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jl}),it=bn(Ue),mt=me({},ka,{propertyName:0,elapsedTime:0,pseudoElement:0}),ar=bn(mt),dt=me({},si,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),vr=bn(dt),Ps=[9,13,27,32],Fu=u&&"CompositionEvent"in window,Ql=null;u&&"documentMode"in document&&(Ql=document.documentMode);var n2=u&&"TextEvent"in window&&!Ql,zh=u&&(!Fu||Ql&&8<Ql&&11>=Ql),$h=" ",Hh=!1;function Wh(a,l){switch(a){case"keyup":return Ps.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vh(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Vi=!1;function s2(a,l){switch(a){case"compositionend":return Vh(l);case"keypress":return l.which!==32?null:(Hh=!0,$h);case"textInput":return a=l.data,a===$h&&Hh?null:a;default:return null}}function a2(a,l){if(Vi)return a==="compositionend"||!Fu&&Wh(a,l)?(a=Vl(),$i=Wl=bs=null,Vi=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return zh&&l.locale!=="ko"?null:l.data;default:return null}}var i2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qh(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!i2[a.type]:l==="textarea"}function Xh(a,l,f,x){zr(x),l=Ac(l,"onChange"),0<l.length&&(f=new ql("onChange","change",null,f,x),a.push({event:f,listeners:l}))}var Zl=null,eo=null;function l2(a){fx(a,0)}function jc(a){var l=Yi(a);if(D(l))return a}function o2(a,l){if(a==="change")return l}var Gh=!1;if(u){var Au;if(u){var Ou="oninput"in document;if(!Ou){var Kh=document.createElement("div");Kh.setAttribute("oninput","return;"),Ou=typeof Kh.oninput=="function"}Au=Ou}else Au=!1;Gh=Au&&(!document.documentMode||9<document.documentMode)}function Yh(){Zl&&(Zl.detachEvent("onpropertychange",Jh),eo=Zl=null)}function Jh(a){if(a.propertyName==="value"&&jc(eo)){var l=[];Xh(l,eo,a,Or(a)),Sr(l2,l)}}function c2(a,l,f){a==="focusin"?(Yh(),Zl=l,eo=f,Zl.attachEvent("onpropertychange",Jh)):a==="focusout"&&Yh()}function u2(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return jc(eo)}function f2(a,l){if(a==="click")return jc(l)}function d2(a,l){if(a==="input"||a==="change")return jc(l)}function h2(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var ws=typeof Object.is=="function"?Object.is:h2;function to(a,l){if(ws(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var f=Object.keys(a),x=Object.keys(l);if(f.length!==x.length)return!1;for(x=0;x<f.length;x++){var g=f[x];if(!d.call(l,g)||!ws(a[g],l[g]))return!1}return!0}function Qh(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Zh(a,l){var f=Qh(a);a=0;for(var x;f;){if(f.nodeType===3){if(x=a+f.textContent.length,a<=l&&x>=l)return{node:f,offset:l-a};a=x}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=Qh(f)}}function ex(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?ex(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function tx(){for(var a=window,l=Pe();l instanceof a.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)a=l.contentWindow;else break;l=Pe(a.document)}return l}function Du(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}function x2(a){var l=tx(),f=a.focusedElem,x=a.selectionRange;if(l!==f&&f&&f.ownerDocument&&ex(f.ownerDocument.documentElement,f)){if(x!==null&&Du(f)){if(l=x.start,a=x.end,a===void 0&&(a=l),"selectionStart"in f)f.selectionStart=l,f.selectionEnd=Math.min(a,f.value.length);else if(a=(l=f.ownerDocument||document)&&l.defaultView||window,a.getSelection){a=a.getSelection();var g=f.textContent.length,_=Math.min(x.start,g);x=x.end===void 0?_:Math.min(x.end,g),!a.extend&&_>x&&(g=x,x=_,_=g),g=Zh(f,_);var F=Zh(f,x);g&&F&&(a.rangeCount!==1||a.anchorNode!==g.node||a.anchorOffset!==g.offset||a.focusNode!==F.node||a.focusOffset!==F.offset)&&(l=l.createRange(),l.setStart(g.node,g.offset),a.removeAllRanges(),_>x?(a.addRange(l),a.extend(F.node,F.offset)):(l.setEnd(F.node,F.offset),a.addRange(l)))}}for(l=[],a=f;a=a.parentNode;)a.nodeType===1&&l.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<l.length;f++)a=l[f],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var m2=u&&"documentMode"in document&&11>=document.documentMode,qi=null,Iu=null,ro=null,Ru=!1;function rx(a,l,f){var x=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Ru||qi==null||qi!==Pe(x)||(x=qi,"selectionStart"in x&&Du(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),ro&&to(ro,x)||(ro=x,x=Ac(Iu,"onSelect"),0<x.length&&(l=new ql("onSelect","select",null,l,f),a.push({event:l,listeners:x}),l.target=qi)))}function Cc(a,l){var f={};return f[a.toLowerCase()]=l.toLowerCase(),f["Webkit"+a]="webkit"+l,f["Moz"+a]="moz"+l,f}var Xi={animationend:Cc("Animation","AnimationEnd"),animationiteration:Cc("Animation","AnimationIteration"),animationstart:Cc("Animation","AnimationStart"),transitionend:Cc("Transition","TransitionEnd")},Pu={},nx={};u&&(nx=document.createElement("div").style,"AnimationEvent"in window||(delete Xi.animationend.animation,delete Xi.animationiteration.animation,delete Xi.animationstart.animation),"TransitionEvent"in window||delete Xi.transitionend.transition);function Tc(a){if(Pu[a])return Pu[a];if(!Xi[a])return a;var l=Xi[a],f;for(f in l)if(l.hasOwnProperty(f)&&f in nx)return Pu[a]=l[f];return a}var sx=Tc("animationend"),ax=Tc("animationiteration"),ix=Tc("animationstart"),lx=Tc("transitionend"),ox=new Map,cx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Na(a,l){ox.set(a,l),o(l,[a])}for(var Mu=0;Mu<cx.length;Mu++){var Lu=cx[Mu],p2=Lu.toLowerCase(),g2=Lu[0].toUpperCase()+Lu.slice(1);Na(p2,"on"+g2)}Na(sx,"onAnimationEnd"),Na(ax,"onAnimationIteration"),Na(ix,"onAnimationStart"),Na("dblclick","onDoubleClick"),Na("focusin","onFocus"),Na("focusout","onBlur"),Na(lx,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var no="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),v2=new Set("cancel close invalid load scroll toggle".split(" ").concat(no));function ux(a,l,f){var x=a.type||"unknown-event";a.currentTarget=f,q(x,l,void 0,a),a.currentTarget=null}function fx(a,l){l=(l&4)!==0;for(var f=0;f<a.length;f++){var x=a[f],g=x.event;x=x.listeners;e:{var _=void 0;if(l)for(var F=x.length-1;0<=F;F--){var ee=x[F],se=ee.instance,ge=ee.currentTarget;if(ee=ee.listener,se!==_&&g.isPropagationStopped())break e;ux(g,ee,ge),_=se}else for(F=0;F<x.length;F++){if(ee=x[F],se=ee.instance,ge=ee.currentTarget,ee=ee.listener,se!==_&&g.isPropagationStopped())break e;ux(g,ee,ge),_=se}}}if(O)throw a=V,O=!1,V=null,a}function Yt(a,l){var f=l[qu];f===void 0&&(f=l[qu]=new Set);var x=a+"__bubble";f.has(x)||(dx(l,a,2,!1),f.add(x))}function Bu(a,l,f){var x=0;l&&(x|=4),dx(f,a,x,l)}var Fc="_reactListening"+Math.random().toString(36).slice(2);function so(a){if(!a[Fc]){a[Fc]=!0,n.forEach(function(f){f!=="selectionchange"&&(v2.has(f)||Bu(f,!1,a),Bu(f,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[Fc]||(l[Fc]=!0,Bu("selectionchange",!1,l))}}function dx(a,l,f,x){switch(wc(l)){case 1:var g=pu;break;case 4:g=gu;break;default:g=$l}f=g.bind(null,l,f,a),g=void 0,!Jr||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(g=!0),x?g!==void 0?a.addEventListener(l,f,{capture:!0,passive:g}):a.addEventListener(l,f,!0):g!==void 0?a.addEventListener(l,f,{passive:g}):a.addEventListener(l,f,!1)}function Uu(a,l,f,x,g){var _=x;if((l&1)===0&&(l&2)===0&&x!==null)e:for(;;){if(x===null)return;var F=x.tag;if(F===3||F===4){var ee=x.stateNode.containerInfo;if(ee===g||ee.nodeType===8&&ee.parentNode===g)break;if(F===4)for(F=x.return;F!==null;){var se=F.tag;if((se===3||se===4)&&(se=F.stateNode.containerInfo,se===g||se.nodeType===8&&se.parentNode===g))return;F=F.return}for(;ee!==null;){if(F=ai(ee),F===null)return;if(se=F.tag,se===5||se===6){x=_=F;continue e}ee=ee.parentNode}}x=x.return}Sr(function(){var ge=_,Re=Or(f),Me=[];e:{var Ie=ox.get(a);if(Ie!==void 0){var Ge=ql,Ye=a;switch(a){case"keypress":if(Hi(f)===0)break e;case"keydown":case"keyup":Ge=Tu;break;case"focusin":Ye="focus",Ge=Kl;break;case"focusout":Ye="blur",Ge=Kl;break;case"beforeblur":case"afterblur":Ge=Kl;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ge=Nc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ge=yu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ge=it;break;case sx:case ax:case ix:Ge=_u;break;case lx:Ge=ar;break;case"scroll":Ge=kc;break;case"wheel":Ge=vr;break;case"copy":case"cut":case"paste":Ge=Nu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ge=Oe}var Je=(l&4)!==0,yr=!Je&&a==="scroll",de=Je?Ie!==null?Ie+"Capture":null:Ie;Je=[];for(var oe=ge,pe;oe!==null;){pe=oe;var ze=pe.stateNode;if(pe.tag===5&&ze!==null&&(pe=ze,de!==null&&(ze=Dr(oe,de),ze!=null&&Je.push(ao(oe,ze,pe)))),yr)break;oe=oe.return}0<Je.length&&(Ie=new Ge(Ie,Ye,null,f,Re),Me.push({event:Ie,listeners:Je}))}}if((l&7)===0){e:{if(Ie=a==="mouseover"||a==="pointerover",Ge=a==="mouseout"||a==="pointerout",Ie&&f!==sr&&(Ye=f.relatedTarget||f.fromElement)&&(ai(Ye)||Ye[ra]))break e;if((Ge||Ie)&&(Ie=Re.window===Re?Re:(Ie=Re.ownerDocument)?Ie.defaultView||Ie.parentWindow:window,Ge?(Ye=f.relatedTarget||f.toElement,Ge=ge,Ye=Ye?ai(Ye):null,Ye!==null&&(yr=G(Ye),Ye!==yr||Ye.tag!==5&&Ye.tag!==6)&&(Ye=null)):(Ge=null,Ye=ge),Ge!==Ye)){if(Je=Nc,ze="onMouseLeave",de="onMouseEnter",oe="mouse",(a==="pointerout"||a==="pointerover")&&(Je=Oe,ze="onPointerLeave",de="onPointerEnter",oe="pointer"),yr=Ge==null?Ie:Yi(Ge),pe=Ye==null?Ie:Yi(Ye),Ie=new Je(ze,oe+"leave",Ge,f,Re),Ie.target=yr,Ie.relatedTarget=pe,ze=null,ai(Re)===ge&&(Je=new Je(de,oe+"enter",Ye,f,Re),Je.target=pe,Je.relatedTarget=yr,ze=Je),yr=ze,Ge&&Ye)t:{for(Je=Ge,de=Ye,oe=0,pe=Je;pe;pe=Gi(pe))oe++;for(pe=0,ze=de;ze;ze=Gi(ze))pe++;for(;0<oe-pe;)Je=Gi(Je),oe--;for(;0<pe-oe;)de=Gi(de),pe--;for(;oe--;){if(Je===de||de!==null&&Je===de.alternate)break t;Je=Gi(Je),de=Gi(de)}Je=null}else Je=null;Ge!==null&&hx(Me,Ie,Ge,Je,!1),Ye!==null&&yr!==null&&hx(Me,yr,Ye,Je,!0)}}e:{if(Ie=ge?Yi(ge):window,Ge=Ie.nodeName&&Ie.nodeName.toLowerCase(),Ge==="select"||Ge==="input"&&Ie.type==="file")var Qe=o2;else if(qh(Ie))if(Gh)Qe=d2;else{Qe=u2;var st=c2}else(Ge=Ie.nodeName)&&Ge.toLowerCase()==="input"&&(Ie.type==="checkbox"||Ie.type==="radio")&&(Qe=f2);if(Qe&&(Qe=Qe(a,ge))){Xh(Me,Qe,f,Re);break e}st&&st(a,Ie,ge),a==="focusout"&&(st=Ie._wrapperState)&&st.controlled&&Ie.type==="number"&&Rt(Ie,"number",Ie.value)}switch(st=ge?Yi(ge):window,a){case"focusin":(qh(st)||st.contentEditable==="true")&&(qi=st,Iu=ge,ro=null);break;case"focusout":ro=Iu=qi=null;break;case"mousedown":Ru=!0;break;case"contextmenu":case"mouseup":case"dragend":Ru=!1,rx(Me,f,Re);break;case"selectionchange":if(m2)break;case"keydown":case"keyup":rx(Me,f,Re)}var at;if(Fu)e:{switch(a){case"compositionstart":var ut="onCompositionStart";break e;case"compositionend":ut="onCompositionEnd";break e;case"compositionupdate":ut="onCompositionUpdate";break e}ut=void 0}else Vi?Wh(a,f)&&(ut="onCompositionEnd"):a==="keydown"&&f.keyCode===229&&(ut="onCompositionStart");ut&&(zh&&f.locale!=="ko"&&(Vi||ut!=="onCompositionStart"?ut==="onCompositionEnd"&&Vi&&(at=Vl()):(bs=Re,Wl="value"in bs?bs.value:bs.textContent,Vi=!0)),st=Ac(ge,ut),0<st.length&&(ut=new Sc(ut,a,null,f,Re),Me.push({event:ut,listeners:st}),at?ut.data=at:(at=Vh(f),at!==null&&(ut.data=at)))),(at=n2?s2(a,f):a2(a,f))&&(ge=Ac(ge,"onBeforeInput"),0<ge.length&&(Re=new Sc("onBeforeInput","beforeinput",null,f,Re),Me.push({event:Re,listeners:ge}),Re.data=at))}fx(Me,l)})}function ao(a,l,f){return{instance:a,listener:l,currentTarget:f}}function Ac(a,l){for(var f=l+"Capture",x=[];a!==null;){var g=a,_=g.stateNode;g.tag===5&&_!==null&&(g=_,_=Dr(a,f),_!=null&&x.unshift(ao(a,_,g)),_=Dr(a,l),_!=null&&x.push(ao(a,_,g))),a=a.return}return x}function Gi(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function hx(a,l,f,x,g){for(var _=l._reactName,F=[];f!==null&&f!==x;){var ee=f,se=ee.alternate,ge=ee.stateNode;if(se!==null&&se===x)break;ee.tag===5&&ge!==null&&(ee=ge,g?(se=Dr(f,_),se!=null&&F.unshift(ao(f,se,ee))):g||(se=Dr(f,_),se!=null&&F.push(ao(f,se,ee)))),f=f.return}F.length!==0&&a.push({event:l,listeners:F})}var y2=/\r\n?/g,b2=/\u0000|\uFFFD/g;function xx(a){return(typeof a=="string"?a:""+a).replace(y2,`
`).replace(b2,"")}function Oc(a,l,f){if(l=xx(l),xx(a)!==l&&f)throw Error(t(425))}function Dc(){}var zu=null,$u=null;function Hu(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Wu=typeof setTimeout=="function"?setTimeout:void 0,w2=typeof clearTimeout=="function"?clearTimeout:void 0,mx=typeof Promise=="function"?Promise:void 0,_2=typeof queueMicrotask=="function"?queueMicrotask:typeof mx<"u"?function(a){return mx.resolve(null).then(a).catch(k2)}:Wu;function k2(a){setTimeout(function(){throw a})}function Vu(a,l){var f=l,x=0;do{var g=f.nextSibling;if(a.removeChild(f),g&&g.nodeType===8)if(f=g.data,f==="/$"){if(x===0){a.removeChild(g),ti(l);return}x--}else f!=="$"&&f!=="$?"&&f!=="$!"||x++;f=g}while(f);ti(l)}function Sa(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return a}function px(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var f=a.data;if(f==="$"||f==="$!"||f==="$?"){if(l===0)return a;l--}else f==="/$"&&l++}a=a.previousSibling}return null}var Ki=Math.random().toString(36).slice(2),Ms="__reactFiber$"+Ki,io="__reactProps$"+Ki,ra="__reactContainer$"+Ki,qu="__reactEvents$"+Ki,N2="__reactListeners$"+Ki,S2="__reactHandles$"+Ki;function ai(a){var l=a[Ms];if(l)return l;for(var f=a.parentNode;f;){if(l=f[ra]||f[Ms]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(a=px(a);a!==null;){if(f=a[Ms])return f;a=px(a)}return l}a=f,f=a.parentNode}return null}function lo(a){return a=a[Ms]||a[ra],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function Yi(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function Ic(a){return a[io]||null}var Xu=[],Ji=-1;function Ea(a){return{current:a}}function Jt(a){0>Ji||(a.current=Xu[Ji],Xu[Ji]=null,Ji--)}function Xt(a,l){Ji++,Xu[Ji]=a.current,a.current=l}var ja={},nn=Ea(ja),Cn=Ea(!1),ii=ja;function Qi(a,l){var f=a.type.contextTypes;if(!f)return ja;var x=a.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===l)return x.__reactInternalMemoizedMaskedChildContext;var g={},_;for(_ in f)g[_]=l[_];return x&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=l,a.__reactInternalMemoizedMaskedChildContext=g),g}function Tn(a){return a=a.childContextTypes,a!=null}function Rc(){Jt(Cn),Jt(nn)}function gx(a,l,f){if(nn.current!==ja)throw Error(t(168));Xt(nn,l),Xt(Cn,f)}function vx(a,l,f){var x=a.stateNode;if(l=l.childContextTypes,typeof x.getChildContext!="function")return f;x=x.getChildContext();for(var g in x)if(!(g in l))throw Error(t(108,fe(a)||"Unknown",g));return me({},f,x)}function Pc(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||ja,ii=nn.current,Xt(nn,a),Xt(Cn,Cn.current),!0}function yx(a,l,f){var x=a.stateNode;if(!x)throw Error(t(169));f?(a=vx(a,l,ii),x.__reactInternalMemoizedMergedChildContext=a,Jt(Cn),Jt(nn),Xt(nn,a)):Jt(Cn),Xt(Cn,f)}var na=null,Mc=!1,Gu=!1;function bx(a){na===null?na=[a]:na.push(a)}function E2(a){Mc=!0,bx(a)}function Ca(){if(!Gu&&na!==null){Gu=!0;var a=0,l=ke;try{var f=na;for(ke=1;a<f.length;a++){var x=f[a];do x=x(!0);while(x!==null)}na=null,Mc=!1}catch(g){throw na!==null&&(na=na.slice(a+1)),E(Et,Ca),g}finally{ke=l,Gu=!1}}return null}var Zi=[],el=0,Lc=null,Bc=0,es=[],ts=0,li=null,sa=1,aa="";function oi(a,l){Zi[el++]=Bc,Zi[el++]=Lc,Lc=a,Bc=l}function wx(a,l,f){es[ts++]=sa,es[ts++]=aa,es[ts++]=li,li=a;var x=sa;a=aa;var g=32-Kt(x)-1;x&=~(1<<g),f+=1;var _=32-Kt(l)+g;if(30<_){var F=g-g%5;_=(x&(1<<F)-1).toString(32),x>>=F,g-=F,sa=1<<32-Kt(l)+g|f<<g|x,aa=_+a}else sa=1<<_|f<<g|x,aa=a}function Ku(a){a.return!==null&&(oi(a,1),wx(a,1,0))}function Yu(a){for(;a===Lc;)Lc=Zi[--el],Zi[el]=null,Bc=Zi[--el],Zi[el]=null;for(;a===li;)li=es[--ts],es[ts]=null,aa=es[--ts],es[ts]=null,sa=es[--ts],es[ts]=null}var Wn=null,Vn=null,nr=!1,_s=null;function _x(a,l){var f=as(5,null,null,0);f.elementType="DELETED",f.stateNode=l,f.return=a,l=a.deletions,l===null?(a.deletions=[f],a.flags|=16):l.push(f)}function kx(a,l){switch(a.tag){case 5:var f=a.type;return l=l.nodeType!==1||f.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(a.stateNode=l,Wn=a,Vn=Sa(l.firstChild),!0):!1;case 6:return l=a.pendingProps===""||l.nodeType!==3?null:l,l!==null?(a.stateNode=l,Wn=a,Vn=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(f=li!==null?{id:sa,overflow:aa}:null,a.memoizedState={dehydrated:l,treeContext:f,retryLane:1073741824},f=as(18,null,null,0),f.stateNode=l,f.return=a,a.child=f,Wn=a,Vn=null,!0):!1;default:return!1}}function Ju(a){return(a.mode&1)!==0&&(a.flags&128)===0}function Qu(a){if(nr){var l=Vn;if(l){var f=l;if(!kx(a,l)){if(Ju(a))throw Error(t(418));l=Sa(f.nextSibling);var x=Wn;l&&kx(a,l)?_x(x,f):(a.flags=a.flags&-4097|2,nr=!1,Wn=a)}}else{if(Ju(a))throw Error(t(418));a.flags=a.flags&-4097|2,nr=!1,Wn=a}}}function Nx(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Wn=a}function Uc(a){if(a!==Wn)return!1;if(!nr)return Nx(a),nr=!0,!1;var l;if((l=a.tag!==3)&&!(l=a.tag!==5)&&(l=a.type,l=l!=="head"&&l!=="body"&&!Hu(a.type,a.memoizedProps)),l&&(l=Vn)){if(Ju(a))throw Sx(),Error(t(418));for(;l;)_x(a,l),l=Sa(l.nextSibling)}if(Nx(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,l=0;a;){if(a.nodeType===8){var f=a.data;if(f==="/$"){if(l===0){Vn=Sa(a.nextSibling);break e}l--}else f!=="$"&&f!=="$!"&&f!=="$?"||l++}a=a.nextSibling}Vn=null}}else Vn=Wn?Sa(a.stateNode.nextSibling):null;return!0}function Sx(){for(var a=Vn;a;)a=Sa(a.nextSibling)}function tl(){Vn=Wn=null,nr=!1}function Zu(a){_s===null?_s=[a]:_s.push(a)}var j2=P.ReactCurrentBatchConfig;function oo(a,l,f){if(a=f.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(t(309));var x=f.stateNode}if(!x)throw Error(t(147,a));var g=x,_=""+a;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===_?l.ref:(l=function(F){var ee=g.refs;F===null?delete ee[_]:ee[_]=F},l._stringRef=_,l)}if(typeof a!="string")throw Error(t(284));if(!f._owner)throw Error(t(290,a))}return a}function zc(a,l){throw a=Object.prototype.toString.call(l),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a))}function Ex(a){var l=a._init;return l(a._payload)}function jx(a){function l(de,oe){if(a){var pe=de.deletions;pe===null?(de.deletions=[oe],de.flags|=16):pe.push(oe)}}function f(de,oe){if(!a)return null;for(;oe!==null;)l(de,oe),oe=oe.sibling;return null}function x(de,oe){for(de=new Map;oe!==null;)oe.key!==null?de.set(oe.key,oe):de.set(oe.index,oe),oe=oe.sibling;return de}function g(de,oe){return de=Pa(de,oe),de.index=0,de.sibling=null,de}function _(de,oe,pe){return de.index=pe,a?(pe=de.alternate,pe!==null?(pe=pe.index,pe<oe?(de.flags|=2,oe):pe):(de.flags|=2,oe)):(de.flags|=1048576,oe)}function F(de){return a&&de.alternate===null&&(de.flags|=2),de}function ee(de,oe,pe,ze){return oe===null||oe.tag!==6?(oe=Vf(pe,de.mode,ze),oe.return=de,oe):(oe=g(oe,pe),oe.return=de,oe)}function se(de,oe,pe,ze){var Qe=pe.type;return Qe===M?Re(de,oe,pe.props.children,ze,pe.key):oe!==null&&(oe.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===Ce&&Ex(Qe)===oe.type)?(ze=g(oe,pe.props),ze.ref=oo(de,oe,pe),ze.return=de,ze):(ze=f0(pe.type,pe.key,pe.props,null,de.mode,ze),ze.ref=oo(de,oe,pe),ze.return=de,ze)}function ge(de,oe,pe,ze){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==pe.containerInfo||oe.stateNode.implementation!==pe.implementation?(oe=qf(pe,de.mode,ze),oe.return=de,oe):(oe=g(oe,pe.children||[]),oe.return=de,oe)}function Re(de,oe,pe,ze,Qe){return oe===null||oe.tag!==7?(oe=pi(pe,de.mode,ze,Qe),oe.return=de,oe):(oe=g(oe,pe),oe.return=de,oe)}function Me(de,oe,pe){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=Vf(""+oe,de.mode,pe),oe.return=de,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case W:return pe=f0(oe.type,oe.key,oe.props,null,de.mode,pe),pe.ref=oo(de,null,oe),pe.return=de,pe;case X:return oe=qf(oe,de.mode,pe),oe.return=de,oe;case Ce:var ze=oe._init;return Me(de,ze(oe._payload),pe)}if(Bt(oe)||A(oe))return oe=pi(oe,de.mode,pe,null),oe.return=de,oe;zc(de,oe)}return null}function Ie(de,oe,pe,ze){var Qe=oe!==null?oe.key:null;if(typeof pe=="string"&&pe!==""||typeof pe=="number")return Qe!==null?null:ee(de,oe,""+pe,ze);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case W:return pe.key===Qe?se(de,oe,pe,ze):null;case X:return pe.key===Qe?ge(de,oe,pe,ze):null;case Ce:return Qe=pe._init,Ie(de,oe,Qe(pe._payload),ze)}if(Bt(pe)||A(pe))return Qe!==null?null:Re(de,oe,pe,ze,null);zc(de,pe)}return null}function Ge(de,oe,pe,ze,Qe){if(typeof ze=="string"&&ze!==""||typeof ze=="number")return de=de.get(pe)||null,ee(oe,de,""+ze,Qe);if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case W:return de=de.get(ze.key===null?pe:ze.key)||null,se(oe,de,ze,Qe);case X:return de=de.get(ze.key===null?pe:ze.key)||null,ge(oe,de,ze,Qe);case Ce:var st=ze._init;return Ge(de,oe,pe,st(ze._payload),Qe)}if(Bt(ze)||A(ze))return de=de.get(pe)||null,Re(oe,de,ze,Qe,null);zc(oe,ze)}return null}function Ye(de,oe,pe,ze){for(var Qe=null,st=null,at=oe,ut=oe=0,Vr=null;at!==null&&ut<pe.length;ut++){at.index>ut?(Vr=at,at=null):Vr=at.sibling;var Dt=Ie(de,at,pe[ut],ze);if(Dt===null){at===null&&(at=Vr);break}a&&at&&Dt.alternate===null&&l(de,at),oe=_(Dt,oe,ut),st===null?Qe=Dt:st.sibling=Dt,st=Dt,at=Vr}if(ut===pe.length)return f(de,at),nr&&oi(de,ut),Qe;if(at===null){for(;ut<pe.length;ut++)at=Me(de,pe[ut],ze),at!==null&&(oe=_(at,oe,ut),st===null?Qe=at:st.sibling=at,st=at);return nr&&oi(de,ut),Qe}for(at=x(de,at);ut<pe.length;ut++)Vr=Ge(at,de,ut,pe[ut],ze),Vr!==null&&(a&&Vr.alternate!==null&&at.delete(Vr.key===null?ut:Vr.key),oe=_(Vr,oe,ut),st===null?Qe=Vr:st.sibling=Vr,st=Vr);return a&&at.forEach(function(Ma){return l(de,Ma)}),nr&&oi(de,ut),Qe}function Je(de,oe,pe,ze){var Qe=A(pe);if(typeof Qe!="function")throw Error(t(150));if(pe=Qe.call(pe),pe==null)throw Error(t(151));for(var st=Qe=null,at=oe,ut=oe=0,Vr=null,Dt=pe.next();at!==null&&!Dt.done;ut++,Dt=pe.next()){at.index>ut?(Vr=at,at=null):Vr=at.sibling;var Ma=Ie(de,at,Dt.value,ze);if(Ma===null){at===null&&(at=Vr);break}a&&at&&Ma.alternate===null&&l(de,at),oe=_(Ma,oe,ut),st===null?Qe=Ma:st.sibling=Ma,st=Ma,at=Vr}if(Dt.done)return f(de,at),nr&&oi(de,ut),Qe;if(at===null){for(;!Dt.done;ut++,Dt=pe.next())Dt=Me(de,Dt.value,ze),Dt!==null&&(oe=_(Dt,oe,ut),st===null?Qe=Dt:st.sibling=Dt,st=Dt);return nr&&oi(de,ut),Qe}for(at=x(de,at);!Dt.done;ut++,Dt=pe.next())Dt=Ge(at,de,ut,Dt.value,ze),Dt!==null&&(a&&Dt.alternate!==null&&at.delete(Dt.key===null?ut:Dt.key),oe=_(Dt,oe,ut),st===null?Qe=Dt:st.sibling=Dt,st=Dt);return a&&at.forEach(function(ib){return l(de,ib)}),nr&&oi(de,ut),Qe}function yr(de,oe,pe,ze){if(typeof pe=="object"&&pe!==null&&pe.type===M&&pe.key===null&&(pe=pe.props.children),typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case W:e:{for(var Qe=pe.key,st=oe;st!==null;){if(st.key===Qe){if(Qe=pe.type,Qe===M){if(st.tag===7){f(de,st.sibling),oe=g(st,pe.props.children),oe.return=de,de=oe;break e}}else if(st.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===Ce&&Ex(Qe)===st.type){f(de,st.sibling),oe=g(st,pe.props),oe.ref=oo(de,st,pe),oe.return=de,de=oe;break e}f(de,st);break}else l(de,st);st=st.sibling}pe.type===M?(oe=pi(pe.props.children,de.mode,ze,pe.key),oe.return=de,de=oe):(ze=f0(pe.type,pe.key,pe.props,null,de.mode,ze),ze.ref=oo(de,oe,pe),ze.return=de,de=ze)}return F(de);case X:e:{for(st=pe.key;oe!==null;){if(oe.key===st)if(oe.tag===4&&oe.stateNode.containerInfo===pe.containerInfo&&oe.stateNode.implementation===pe.implementation){f(de,oe.sibling),oe=g(oe,pe.children||[]),oe.return=de,de=oe;break e}else{f(de,oe);break}else l(de,oe);oe=oe.sibling}oe=qf(pe,de.mode,ze),oe.return=de,de=oe}return F(de);case Ce:return st=pe._init,yr(de,oe,st(pe._payload),ze)}if(Bt(pe))return Ye(de,oe,pe,ze);if(A(pe))return Je(de,oe,pe,ze);zc(de,pe)}return typeof pe=="string"&&pe!==""||typeof pe=="number"?(pe=""+pe,oe!==null&&oe.tag===6?(f(de,oe.sibling),oe=g(oe,pe),oe.return=de,de=oe):(f(de,oe),oe=Vf(pe,de.mode,ze),oe.return=de,de=oe),F(de)):f(de,oe)}return yr}var rl=jx(!0),Cx=jx(!1),$c=Ea(null),Hc=null,nl=null,ef=null;function tf(){ef=nl=Hc=null}function rf(a){var l=$c.current;Jt($c),a._currentValue=l}function nf(a,l,f){for(;a!==null;){var x=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,x!==null&&(x.childLanes|=l)):x!==null&&(x.childLanes&l)!==l&&(x.childLanes|=l),a===f)break;a=a.return}}function sl(a,l){Hc=a,ef=nl=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&l)!==0&&(Fn=!0),a.firstContext=null)}function rs(a){var l=a._currentValue;if(ef!==a)if(a={context:a,memoizedValue:l,next:null},nl===null){if(Hc===null)throw Error(t(308));nl=a,Hc.dependencies={lanes:0,firstContext:a}}else nl=nl.next=a;return l}var ci=null;function sf(a){ci===null?ci=[a]:ci.push(a)}function Tx(a,l,f,x){var g=l.interleaved;return g===null?(f.next=f,sf(l)):(f.next=g.next,g.next=f),l.interleaved=f,ia(a,x)}function ia(a,l){a.lanes|=l;var f=a.alternate;for(f!==null&&(f.lanes|=l),f=a,a=a.return;a!==null;)a.childLanes|=l,f=a.alternate,f!==null&&(f.childLanes|=l),f=a,a=a.return;return f.tag===3?f.stateNode:null}var Ta=!1;function af(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fx(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function la(a,l){return{eventTime:a,lane:l,tag:0,payload:null,callback:null,next:null}}function Fa(a,l,f){var x=a.updateQueue;if(x===null)return null;if(x=x.shared,(Ft&2)!==0){var g=x.pending;return g===null?l.next=l:(l.next=g.next,g.next=l),x.pending=l,ia(a,f)}return g=x.interleaved,g===null?(l.next=l,sf(x)):(l.next=g.next,g.next=l),x.interleaved=l,ia(a,f)}function Wc(a,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194240)!==0)){var x=l.lanes;x&=a.pendingLanes,f|=x,l.lanes=f,_e(a,f)}}function Ax(a,l){var f=a.updateQueue,x=a.alternate;if(x!==null&&(x=x.updateQueue,f===x)){var g=null,_=null;if(f=f.firstBaseUpdate,f!==null){do{var F={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};_===null?g=_=F:_=_.next=F,f=f.next}while(f!==null);_===null?g=_=l:_=_.next=l}else g=_=l;f={baseState:x.baseState,firstBaseUpdate:g,lastBaseUpdate:_,shared:x.shared,effects:x.effects},a.updateQueue=f;return}a=f.lastBaseUpdate,a===null?f.firstBaseUpdate=l:a.next=l,f.lastBaseUpdate=l}function Vc(a,l,f,x){var g=a.updateQueue;Ta=!1;var _=g.firstBaseUpdate,F=g.lastBaseUpdate,ee=g.shared.pending;if(ee!==null){g.shared.pending=null;var se=ee,ge=se.next;se.next=null,F===null?_=ge:F.next=ge,F=se;var Re=a.alternate;Re!==null&&(Re=Re.updateQueue,ee=Re.lastBaseUpdate,ee!==F&&(ee===null?Re.firstBaseUpdate=ge:ee.next=ge,Re.lastBaseUpdate=se))}if(_!==null){var Me=g.baseState;F=0,Re=ge=se=null,ee=_;do{var Ie=ee.lane,Ge=ee.eventTime;if((x&Ie)===Ie){Re!==null&&(Re=Re.next={eventTime:Ge,lane:0,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null});e:{var Ye=a,Je=ee;switch(Ie=l,Ge=f,Je.tag){case 1:if(Ye=Je.payload,typeof Ye=="function"){Me=Ye.call(Ge,Me,Ie);break e}Me=Ye;break e;case 3:Ye.flags=Ye.flags&-65537|128;case 0:if(Ye=Je.payload,Ie=typeof Ye=="function"?Ye.call(Ge,Me,Ie):Ye,Ie==null)break e;Me=me({},Me,Ie);break e;case 2:Ta=!0}}ee.callback!==null&&ee.lane!==0&&(a.flags|=64,Ie=g.effects,Ie===null?g.effects=[ee]:Ie.push(ee))}else Ge={eventTime:Ge,lane:Ie,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null},Re===null?(ge=Re=Ge,se=Me):Re=Re.next=Ge,F|=Ie;if(ee=ee.next,ee===null){if(ee=g.shared.pending,ee===null)break;Ie=ee,ee=Ie.next,Ie.next=null,g.lastBaseUpdate=Ie,g.shared.pending=null}}while(!0);if(Re===null&&(se=Me),g.baseState=se,g.firstBaseUpdate=ge,g.lastBaseUpdate=Re,l=g.shared.interleaved,l!==null){g=l;do F|=g.lane,g=g.next;while(g!==l)}else _===null&&(g.shared.lanes=0);di|=F,a.lanes=F,a.memoizedState=Me}}function Ox(a,l,f){if(a=l.effects,l.effects=null,a!==null)for(l=0;l<a.length;l++){var x=a[l],g=x.callback;if(g!==null){if(x.callback=null,x=f,typeof g!="function")throw Error(t(191,g));g.call(x)}}}var co={},Ls=Ea(co),uo=Ea(co),fo=Ea(co);function ui(a){if(a===co)throw Error(t(174));return a}function lf(a,l){switch(Xt(fo,l),Xt(uo,a),Xt(Ls,co),a=l.nodeType,a){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:Gt(null,"");break;default:a=a===8?l.parentNode:l,l=a.namespaceURI||null,a=a.tagName,l=Gt(l,a)}Jt(Ls),Xt(Ls,l)}function al(){Jt(Ls),Jt(uo),Jt(fo)}function Dx(a){ui(fo.current);var l=ui(Ls.current),f=Gt(l,a.type);l!==f&&(Xt(uo,a),Xt(Ls,f))}function of(a){uo.current===a&&(Jt(Ls),Jt(uo))}var ir=Ea(0);function qc(a){for(var l=a;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var cf=[];function uf(){for(var a=0;a<cf.length;a++)cf[a]._workInProgressVersionPrimary=null;cf.length=0}var Xc=P.ReactCurrentDispatcher,ff=P.ReactCurrentBatchConfig,fi=0,lr=null,Rr=null,Hr=null,Gc=!1,ho=!1,xo=0,C2=0;function sn(){throw Error(t(321))}function df(a,l){if(l===null)return!1;for(var f=0;f<l.length&&f<a.length;f++)if(!ws(a[f],l[f]))return!1;return!0}function hf(a,l,f,x,g,_){if(fi=_,lr=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Xc.current=a===null||a.memoizedState===null?O2:D2,a=f(x,g),ho){_=0;do{if(ho=!1,xo=0,25<=_)throw Error(t(301));_+=1,Hr=Rr=null,l.updateQueue=null,Xc.current=I2,a=f(x,g)}while(ho)}if(Xc.current=Jc,l=Rr!==null&&Rr.next!==null,fi=0,Hr=Rr=lr=null,Gc=!1,l)throw Error(t(300));return a}function xf(){var a=xo!==0;return xo=0,a}function Bs(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hr===null?lr.memoizedState=Hr=a:Hr=Hr.next=a,Hr}function ns(){if(Rr===null){var a=lr.alternate;a=a!==null?a.memoizedState:null}else a=Rr.next;var l=Hr===null?lr.memoizedState:Hr.next;if(l!==null)Hr=l,Rr=a;else{if(a===null)throw Error(t(310));Rr=a,a={memoizedState:Rr.memoizedState,baseState:Rr.baseState,baseQueue:Rr.baseQueue,queue:Rr.queue,next:null},Hr===null?lr.memoizedState=Hr=a:Hr=Hr.next=a}return Hr}function mo(a,l){return typeof l=="function"?l(a):l}function mf(a){var l=ns(),f=l.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=a;var x=Rr,g=x.baseQueue,_=f.pending;if(_!==null){if(g!==null){var F=g.next;g.next=_.next,_.next=F}x.baseQueue=g=_,f.pending=null}if(g!==null){_=g.next,x=x.baseState;var ee=F=null,se=null,ge=_;do{var Re=ge.lane;if((fi&Re)===Re)se!==null&&(se=se.next={lane:0,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null}),x=ge.hasEagerState?ge.eagerState:a(x,ge.action);else{var Me={lane:Re,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null};se===null?(ee=se=Me,F=x):se=se.next=Me,lr.lanes|=Re,di|=Re}ge=ge.next}while(ge!==null&&ge!==_);se===null?F=x:se.next=ee,ws(x,l.memoizedState)||(Fn=!0),l.memoizedState=x,l.baseState=F,l.baseQueue=se,f.lastRenderedState=x}if(a=f.interleaved,a!==null){g=a;do _=g.lane,lr.lanes|=_,di|=_,g=g.next;while(g!==a)}else g===null&&(f.lanes=0);return[l.memoizedState,f.dispatch]}function pf(a){var l=ns(),f=l.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=a;var x=f.dispatch,g=f.pending,_=l.memoizedState;if(g!==null){f.pending=null;var F=g=g.next;do _=a(_,F.action),F=F.next;while(F!==g);ws(_,l.memoizedState)||(Fn=!0),l.memoizedState=_,l.baseQueue===null&&(l.baseState=_),f.lastRenderedState=_}return[_,x]}function Ix(){}function Rx(a,l){var f=lr,x=ns(),g=l(),_=!ws(x.memoizedState,g);if(_&&(x.memoizedState=g,Fn=!0),x=x.queue,gf(Lx.bind(null,f,x,a),[a]),x.getSnapshot!==l||_||Hr!==null&&Hr.memoizedState.tag&1){if(f.flags|=2048,po(9,Mx.bind(null,f,x,g,l),void 0,null),Wr===null)throw Error(t(349));(fi&30)!==0||Px(f,l,g)}return g}function Px(a,l,f){a.flags|=16384,a={getSnapshot:l,value:f},l=lr.updateQueue,l===null?(l={lastEffect:null,stores:null},lr.updateQueue=l,l.stores=[a]):(f=l.stores,f===null?l.stores=[a]:f.push(a))}function Mx(a,l,f,x){l.value=f,l.getSnapshot=x,Bx(l)&&Ux(a)}function Lx(a,l,f){return f(function(){Bx(l)&&Ux(a)})}function Bx(a){var l=a.getSnapshot;a=a.value;try{var f=l();return!ws(a,f)}catch{return!0}}function Ux(a){var l=ia(a,1);l!==null&&Es(l,a,1,-1)}function zx(a){var l=Bs();return typeof a=="function"&&(a=a()),l.memoizedState=l.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mo,lastRenderedState:a},l.queue=a,a=a.dispatch=A2.bind(null,lr,a),[l.memoizedState,a]}function po(a,l,f,x){return a={tag:a,create:l,destroy:f,deps:x,next:null},l=lr.updateQueue,l===null?(l={lastEffect:null,stores:null},lr.updateQueue=l,l.lastEffect=a.next=a):(f=l.lastEffect,f===null?l.lastEffect=a.next=a:(x=f.next,f.next=a,a.next=x,l.lastEffect=a)),a}function $x(){return ns().memoizedState}function Kc(a,l,f,x){var g=Bs();lr.flags|=a,g.memoizedState=po(1|l,f,void 0,x===void 0?null:x)}function Yc(a,l,f,x){var g=ns();x=x===void 0?null:x;var _=void 0;if(Rr!==null){var F=Rr.memoizedState;if(_=F.destroy,x!==null&&df(x,F.deps)){g.memoizedState=po(l,f,_,x);return}}lr.flags|=a,g.memoizedState=po(1|l,f,_,x)}function Hx(a,l){return Kc(8390656,8,a,l)}function gf(a,l){return Yc(2048,8,a,l)}function Wx(a,l){return Yc(4,2,a,l)}function Vx(a,l){return Yc(4,4,a,l)}function qx(a,l){if(typeof l=="function")return a=a(),l(a),function(){l(null)};if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function Xx(a,l,f){return f=f!=null?f.concat([a]):null,Yc(4,4,qx.bind(null,l,a),f)}function vf(){}function Gx(a,l){var f=ns();l=l===void 0?null:l;var x=f.memoizedState;return x!==null&&l!==null&&df(l,x[1])?x[0]:(f.memoizedState=[a,l],a)}function Kx(a,l){var f=ns();l=l===void 0?null:l;var x=f.memoizedState;return x!==null&&l!==null&&df(l,x[1])?x[0]:(a=a(),f.memoizedState=[a,l],a)}function Yx(a,l,f){return(fi&21)===0?(a.baseState&&(a.baseState=!1,Fn=!0),a.memoizedState=f):(ws(f,l)||(f=Qa(),lr.lanes|=f,di|=f,a.baseState=!0),l)}function T2(a,l){var f=ke;ke=f!==0&&4>f?f:4,a(!0);var x=ff.transition;ff.transition={};try{a(!1),l()}finally{ke=f,ff.transition=x}}function Jx(){return ns().memoizedState}function F2(a,l,f){var x=Ia(a);if(f={lane:x,action:f,hasEagerState:!1,eagerState:null,next:null},Qx(a))Zx(l,f);else if(f=Tx(a,l,f,x),f!==null){var g=_n();Es(f,a,x,g),em(f,l,x)}}function A2(a,l,f){var x=Ia(a),g={lane:x,action:f,hasEagerState:!1,eagerState:null,next:null};if(Qx(a))Zx(l,g);else{var _=a.alternate;if(a.lanes===0&&(_===null||_.lanes===0)&&(_=l.lastRenderedReducer,_!==null))try{var F=l.lastRenderedState,ee=_(F,f);if(g.hasEagerState=!0,g.eagerState=ee,ws(ee,F)){var se=l.interleaved;se===null?(g.next=g,sf(l)):(g.next=se.next,se.next=g),l.interleaved=g;return}}catch{}f=Tx(a,l,g,x),f!==null&&(g=_n(),Es(f,a,x,g),em(f,l,x))}}function Qx(a){var l=a.alternate;return a===lr||l!==null&&l===lr}function Zx(a,l){ho=Gc=!0;var f=a.pending;f===null?l.next=l:(l.next=f.next,f.next=l),a.pending=l}function em(a,l,f){if((f&4194240)!==0){var x=l.lanes;x&=a.pendingLanes,f|=x,l.lanes=f,_e(a,f)}}var Jc={readContext:rs,useCallback:sn,useContext:sn,useEffect:sn,useImperativeHandle:sn,useInsertionEffect:sn,useLayoutEffect:sn,useMemo:sn,useReducer:sn,useRef:sn,useState:sn,useDebugValue:sn,useDeferredValue:sn,useTransition:sn,useMutableSource:sn,useSyncExternalStore:sn,useId:sn,unstable_isNewReconciler:!1},O2={readContext:rs,useCallback:function(a,l){return Bs().memoizedState=[a,l===void 0?null:l],a},useContext:rs,useEffect:Hx,useImperativeHandle:function(a,l,f){return f=f!=null?f.concat([a]):null,Kc(4194308,4,qx.bind(null,l,a),f)},useLayoutEffect:function(a,l){return Kc(4194308,4,a,l)},useInsertionEffect:function(a,l){return Kc(4,2,a,l)},useMemo:function(a,l){var f=Bs();return l=l===void 0?null:l,a=a(),f.memoizedState=[a,l],a},useReducer:function(a,l,f){var x=Bs();return l=f!==void 0?f(l):l,x.memoizedState=x.baseState=l,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:l},x.queue=a,a=a.dispatch=F2.bind(null,lr,a),[x.memoizedState,a]},useRef:function(a){var l=Bs();return a={current:a},l.memoizedState=a},useState:zx,useDebugValue:vf,useDeferredValue:function(a){return Bs().memoizedState=a},useTransition:function(){var a=zx(!1),l=a[0];return a=T2.bind(null,a[1]),Bs().memoizedState=a,[l,a]},useMutableSource:function(){},useSyncExternalStore:function(a,l,f){var x=lr,g=Bs();if(nr){if(f===void 0)throw Error(t(407));f=f()}else{if(f=l(),Wr===null)throw Error(t(349));(fi&30)!==0||Px(x,l,f)}g.memoizedState=f;var _={value:f,getSnapshot:l};return g.queue=_,Hx(Lx.bind(null,x,_,a),[a]),x.flags|=2048,po(9,Mx.bind(null,x,_,f,l),void 0,null),f},useId:function(){var a=Bs(),l=Wr.identifierPrefix;if(nr){var f=aa,x=sa;f=(x&~(1<<32-Kt(x)-1)).toString(32)+f,l=":"+l+"R"+f,f=xo++,0<f&&(l+="H"+f.toString(32)),l+=":"}else f=C2++,l=":"+l+"r"+f.toString(32)+":";return a.memoizedState=l},unstable_isNewReconciler:!1},D2={readContext:rs,useCallback:Gx,useContext:rs,useEffect:gf,useImperativeHandle:Xx,useInsertionEffect:Wx,useLayoutEffect:Vx,useMemo:Kx,useReducer:mf,useRef:$x,useState:function(){return mf(mo)},useDebugValue:vf,useDeferredValue:function(a){var l=ns();return Yx(l,Rr.memoizedState,a)},useTransition:function(){var a=mf(mo)[0],l=ns().memoizedState;return[a,l]},useMutableSource:Ix,useSyncExternalStore:Rx,useId:Jx,unstable_isNewReconciler:!1},I2={readContext:rs,useCallback:Gx,useContext:rs,useEffect:gf,useImperativeHandle:Xx,useInsertionEffect:Wx,useLayoutEffect:Vx,useMemo:Kx,useReducer:pf,useRef:$x,useState:function(){return pf(mo)},useDebugValue:vf,useDeferredValue:function(a){var l=ns();return Rr===null?l.memoizedState=a:Yx(l,Rr.memoizedState,a)},useTransition:function(){var a=pf(mo)[0],l=ns().memoizedState;return[a,l]},useMutableSource:Ix,useSyncExternalStore:Rx,useId:Jx,unstable_isNewReconciler:!1};function ks(a,l){if(a&&a.defaultProps){l=me({},l),a=a.defaultProps;for(var f in a)l[f]===void 0&&(l[f]=a[f]);return l}return l}function yf(a,l,f,x){l=a.memoizedState,f=f(x,l),f=f==null?l:me({},l,f),a.memoizedState=f,a.lanes===0&&(a.updateQueue.baseState=f)}var Qc={isMounted:function(a){return(a=a._reactInternals)?G(a)===a:!1},enqueueSetState:function(a,l,f){a=a._reactInternals;var x=_n(),g=Ia(a),_=la(x,g);_.payload=l,f!=null&&(_.callback=f),l=Fa(a,_,g),l!==null&&(Es(l,a,g,x),Wc(l,a,g))},enqueueReplaceState:function(a,l,f){a=a._reactInternals;var x=_n(),g=Ia(a),_=la(x,g);_.tag=1,_.payload=l,f!=null&&(_.callback=f),l=Fa(a,_,g),l!==null&&(Es(l,a,g,x),Wc(l,a,g))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var f=_n(),x=Ia(a),g=la(f,x);g.tag=2,l!=null&&(g.callback=l),l=Fa(a,g,x),l!==null&&(Es(l,a,x,f),Wc(l,a,x))}};function tm(a,l,f,x,g,_,F){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(x,_,F):l.prototype&&l.prototype.isPureReactComponent?!to(f,x)||!to(g,_):!0}function rm(a,l,f){var x=!1,g=ja,_=l.contextType;return typeof _=="object"&&_!==null?_=rs(_):(g=Tn(l)?ii:nn.current,x=l.contextTypes,_=(x=x!=null)?Qi(a,g):ja),l=new l(f,_),a.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Qc,a.stateNode=l,l._reactInternals=a,x&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=g,a.__reactInternalMemoizedMaskedChildContext=_),l}function nm(a,l,f,x){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,x),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,x),l.state!==a&&Qc.enqueueReplaceState(l,l.state,null)}function bf(a,l,f,x){var g=a.stateNode;g.props=f,g.state=a.memoizedState,g.refs={},af(a);var _=l.contextType;typeof _=="object"&&_!==null?g.context=rs(_):(_=Tn(l)?ii:nn.current,g.context=Qi(a,_)),g.state=a.memoizedState,_=l.getDerivedStateFromProps,typeof _=="function"&&(yf(a,l,_,f),g.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(l=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),l!==g.state&&Qc.enqueueReplaceState(g,g.state,null),Vc(a,f,g,x),g.state=a.memoizedState),typeof g.componentDidMount=="function"&&(a.flags|=4194308)}function il(a,l){try{var f="",x=l;do f+=J(x),x=x.return;while(x);var g=f}catch(_){g=`
Error generating stack: `+_.message+`
`+_.stack}return{value:a,source:l,stack:g,digest:null}}function wf(a,l,f){return{value:a,source:null,stack:f??null,digest:l??null}}function _f(a,l){try{console.error(l.value)}catch(f){setTimeout(function(){throw f})}}var R2=typeof WeakMap=="function"?WeakMap:Map;function sm(a,l,f){f=la(-1,f),f.tag=3,f.payload={element:null};var x=l.value;return f.callback=function(){a0||(a0=!0,Mf=x),_f(a,l)},f}function am(a,l,f){f=la(-1,f),f.tag=3;var x=a.type.getDerivedStateFromError;if(typeof x=="function"){var g=l.value;f.payload=function(){return x(g)},f.callback=function(){_f(a,l)}}var _=a.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(f.callback=function(){_f(a,l),typeof x!="function"&&(Oa===null?Oa=new Set([this]):Oa.add(this));var F=l.stack;this.componentDidCatch(l.value,{componentStack:F!==null?F:""})}),f}function im(a,l,f){var x=a.pingCache;if(x===null){x=a.pingCache=new R2;var g=new Set;x.set(l,g)}else g=x.get(l),g===void 0&&(g=new Set,x.set(l,g));g.has(f)||(g.add(f),a=K2.bind(null,a,l,f),l.then(a,a))}function lm(a){do{var l;if((l=a.tag===13)&&(l=a.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return a;a=a.return}while(a!==null);return null}function om(a,l,f,x,g){return(a.mode&1)===0?(a===l?a.flags|=65536:(a.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(l=la(-1,1),l.tag=2,Fa(f,l,1))),f.lanes|=1),a):(a.flags|=65536,a.lanes=g,a)}var P2=P.ReactCurrentOwner,Fn=!1;function wn(a,l,f,x){l.child=a===null?Cx(l,null,f,x):rl(l,a.child,f,x)}function cm(a,l,f,x,g){f=f.render;var _=l.ref;return sl(l,g),x=hf(a,l,f,x,_,g),f=xf(),a!==null&&!Fn?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~g,oa(a,l,g)):(nr&&f&&Ku(l),l.flags|=1,wn(a,l,x,g),l.child)}function um(a,l,f,x,g){if(a===null){var _=f.type;return typeof _=="function"&&!Wf(_)&&_.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(l.tag=15,l.type=_,fm(a,l,_,x,g)):(a=f0(f.type,null,x,l,l.mode,g),a.ref=l.ref,a.return=l,l.child=a)}if(_=a.child,(a.lanes&g)===0){var F=_.memoizedProps;if(f=f.compare,f=f!==null?f:to,f(F,x)&&a.ref===l.ref)return oa(a,l,g)}return l.flags|=1,a=Pa(_,x),a.ref=l.ref,a.return=l,l.child=a}function fm(a,l,f,x,g){if(a!==null){var _=a.memoizedProps;if(to(_,x)&&a.ref===l.ref)if(Fn=!1,l.pendingProps=x=_,(a.lanes&g)!==0)(a.flags&131072)!==0&&(Fn=!0);else return l.lanes=a.lanes,oa(a,l,g)}return kf(a,l,f,x,g)}function dm(a,l,f){var x=l.pendingProps,g=x.children,_=a!==null?a.memoizedState:null;if(x.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xt(ol,qn),qn|=f;else{if((f&1073741824)===0)return a=_!==null?_.baseLanes|f:f,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:a,cachePool:null,transitions:null},l.updateQueue=null,Xt(ol,qn),qn|=a,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=_!==null?_.baseLanes:f,Xt(ol,qn),qn|=x}else _!==null?(x=_.baseLanes|f,l.memoizedState=null):x=f,Xt(ol,qn),qn|=x;return wn(a,l,g,f),l.child}function hm(a,l){var f=l.ref;(a===null&&f!==null||a!==null&&a.ref!==f)&&(l.flags|=512,l.flags|=2097152)}function kf(a,l,f,x,g){var _=Tn(f)?ii:nn.current;return _=Qi(l,_),sl(l,g),f=hf(a,l,f,x,_,g),x=xf(),a!==null&&!Fn?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~g,oa(a,l,g)):(nr&&x&&Ku(l),l.flags|=1,wn(a,l,f,g),l.child)}function xm(a,l,f,x,g){if(Tn(f)){var _=!0;Pc(l)}else _=!1;if(sl(l,g),l.stateNode===null)e0(a,l),rm(l,f,x),bf(l,f,x,g),x=!0;else if(a===null){var F=l.stateNode,ee=l.memoizedProps;F.props=ee;var se=F.context,ge=f.contextType;typeof ge=="object"&&ge!==null?ge=rs(ge):(ge=Tn(f)?ii:nn.current,ge=Qi(l,ge));var Re=f.getDerivedStateFromProps,Me=typeof Re=="function"||typeof F.getSnapshotBeforeUpdate=="function";Me||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(ee!==x||se!==ge)&&nm(l,F,x,ge),Ta=!1;var Ie=l.memoizedState;F.state=Ie,Vc(l,x,F,g),se=l.memoizedState,ee!==x||Ie!==se||Cn.current||Ta?(typeof Re=="function"&&(yf(l,f,Re,x),se=l.memoizedState),(ee=Ta||tm(l,f,ee,x,Ie,se,ge))?(Me||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount()),typeof F.componentDidMount=="function"&&(l.flags|=4194308)):(typeof F.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=x,l.memoizedState=se),F.props=x,F.state=se,F.context=ge,x=ee):(typeof F.componentDidMount=="function"&&(l.flags|=4194308),x=!1)}else{F=l.stateNode,Fx(a,l),ee=l.memoizedProps,ge=l.type===l.elementType?ee:ks(l.type,ee),F.props=ge,Me=l.pendingProps,Ie=F.context,se=f.contextType,typeof se=="object"&&se!==null?se=rs(se):(se=Tn(f)?ii:nn.current,se=Qi(l,se));var Ge=f.getDerivedStateFromProps;(Re=typeof Ge=="function"||typeof F.getSnapshotBeforeUpdate=="function")||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(ee!==Me||Ie!==se)&&nm(l,F,x,se),Ta=!1,Ie=l.memoizedState,F.state=Ie,Vc(l,x,F,g);var Ye=l.memoizedState;ee!==Me||Ie!==Ye||Cn.current||Ta?(typeof Ge=="function"&&(yf(l,f,Ge,x),Ye=l.memoizedState),(ge=Ta||tm(l,f,ge,x,Ie,Ye,se)||!1)?(Re||typeof F.UNSAFE_componentWillUpdate!="function"&&typeof F.componentWillUpdate!="function"||(typeof F.componentWillUpdate=="function"&&F.componentWillUpdate(x,Ye,se),typeof F.UNSAFE_componentWillUpdate=="function"&&F.UNSAFE_componentWillUpdate(x,Ye,se)),typeof F.componentDidUpdate=="function"&&(l.flags|=4),typeof F.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof F.componentDidUpdate!="function"||ee===a.memoizedProps&&Ie===a.memoizedState||(l.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||ee===a.memoizedProps&&Ie===a.memoizedState||(l.flags|=1024),l.memoizedProps=x,l.memoizedState=Ye),F.props=x,F.state=Ye,F.context=se,x=ge):(typeof F.componentDidUpdate!="function"||ee===a.memoizedProps&&Ie===a.memoizedState||(l.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||ee===a.memoizedProps&&Ie===a.memoizedState||(l.flags|=1024),x=!1)}return Nf(a,l,f,x,_,g)}function Nf(a,l,f,x,g,_){hm(a,l);var F=(l.flags&128)!==0;if(!x&&!F)return g&&yx(l,f,!1),oa(a,l,_);x=l.stateNode,P2.current=l;var ee=F&&typeof f.getDerivedStateFromError!="function"?null:x.render();return l.flags|=1,a!==null&&F?(l.child=rl(l,a.child,null,_),l.child=rl(l,null,ee,_)):wn(a,l,ee,_),l.memoizedState=x.state,g&&yx(l,f,!0),l.child}function mm(a){var l=a.stateNode;l.pendingContext?gx(a,l.pendingContext,l.pendingContext!==l.context):l.context&&gx(a,l.context,!1),lf(a,l.containerInfo)}function pm(a,l,f,x,g){return tl(),Zu(g),l.flags|=256,wn(a,l,f,x),l.child}var Sf={dehydrated:null,treeContext:null,retryLane:0};function Ef(a){return{baseLanes:a,cachePool:null,transitions:null}}function gm(a,l,f){var x=l.pendingProps,g=ir.current,_=!1,F=(l.flags&128)!==0,ee;if((ee=F)||(ee=a!==null&&a.memoizedState===null?!1:(g&2)!==0),ee?(_=!0,l.flags&=-129):(a===null||a.memoizedState!==null)&&(g|=1),Xt(ir,g&1),a===null)return Qu(l),a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((l.mode&1)===0?l.lanes=1:a.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(F=x.children,a=x.fallback,_?(x=l.mode,_=l.child,F={mode:"hidden",children:F},(x&1)===0&&_!==null?(_.childLanes=0,_.pendingProps=F):_=d0(F,x,0,null),a=pi(a,x,f,null),_.return=l,a.return=l,_.sibling=a,l.child=_,l.child.memoizedState=Ef(f),l.memoizedState=Sf,a):jf(l,F));if(g=a.memoizedState,g!==null&&(ee=g.dehydrated,ee!==null))return M2(a,l,F,x,ee,g,f);if(_){_=x.fallback,F=l.mode,g=a.child,ee=g.sibling;var se={mode:"hidden",children:x.children};return(F&1)===0&&l.child!==g?(x=l.child,x.childLanes=0,x.pendingProps=se,l.deletions=null):(x=Pa(g,se),x.subtreeFlags=g.subtreeFlags&14680064),ee!==null?_=Pa(ee,_):(_=pi(_,F,f,null),_.flags|=2),_.return=l,x.return=l,x.sibling=_,l.child=x,x=_,_=l.child,F=a.child.memoizedState,F=F===null?Ef(f):{baseLanes:F.baseLanes|f,cachePool:null,transitions:F.transitions},_.memoizedState=F,_.childLanes=a.childLanes&~f,l.memoizedState=Sf,x}return _=a.child,a=_.sibling,x=Pa(_,{mode:"visible",children:x.children}),(l.mode&1)===0&&(x.lanes=f),x.return=l,x.sibling=null,a!==null&&(f=l.deletions,f===null?(l.deletions=[a],l.flags|=16):f.push(a)),l.child=x,l.memoizedState=null,x}function jf(a,l){return l=d0({mode:"visible",children:l},a.mode,0,null),l.return=a,a.child=l}function Zc(a,l,f,x){return x!==null&&Zu(x),rl(l,a.child,null,f),a=jf(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function M2(a,l,f,x,g,_,F){if(f)return l.flags&256?(l.flags&=-257,x=wf(Error(t(422))),Zc(a,l,F,x)):l.memoizedState!==null?(l.child=a.child,l.flags|=128,null):(_=x.fallback,g=l.mode,x=d0({mode:"visible",children:x.children},g,0,null),_=pi(_,g,F,null),_.flags|=2,x.return=l,_.return=l,x.sibling=_,l.child=x,(l.mode&1)!==0&&rl(l,a.child,null,F),l.child.memoizedState=Ef(F),l.memoizedState=Sf,_);if((l.mode&1)===0)return Zc(a,l,F,null);if(g.data==="$!"){if(x=g.nextSibling&&g.nextSibling.dataset,x)var ee=x.dgst;return x=ee,_=Error(t(419)),x=wf(_,x,void 0),Zc(a,l,F,x)}if(ee=(F&a.childLanes)!==0,Fn||ee){if(x=Wr,x!==null){switch(F&-F){case 4:g=2;break;case 16:g=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:g=32;break;case 536870912:g=268435456;break;default:g=0}g=(g&(x.suspendedLanes|F))!==0?0:g,g!==0&&g!==_.retryLane&&(_.retryLane=g,ia(a,g),Es(x,a,g,-1))}return Hf(),x=wf(Error(t(421))),Zc(a,l,F,x)}return g.data==="$?"?(l.flags|=128,l.child=a.child,l=Y2.bind(null,a),g._reactRetry=l,null):(a=_.treeContext,Vn=Sa(g.nextSibling),Wn=l,nr=!0,_s=null,a!==null&&(es[ts++]=sa,es[ts++]=aa,es[ts++]=li,sa=a.id,aa=a.overflow,li=l),l=jf(l,x.children),l.flags|=4096,l)}function vm(a,l,f){a.lanes|=l;var x=a.alternate;x!==null&&(x.lanes|=l),nf(a.return,l,f)}function Cf(a,l,f,x,g){var _=a.memoizedState;_===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:x,tail:f,tailMode:g}:(_.isBackwards=l,_.rendering=null,_.renderingStartTime=0,_.last=x,_.tail=f,_.tailMode=g)}function ym(a,l,f){var x=l.pendingProps,g=x.revealOrder,_=x.tail;if(wn(a,l,x.children,f),x=ir.current,(x&2)!==0)x=x&1|2,l.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&vm(a,f,l);else if(a.tag===19)vm(a,f,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}x&=1}if(Xt(ir,x),(l.mode&1)===0)l.memoizedState=null;else switch(g){case"forwards":for(f=l.child,g=null;f!==null;)a=f.alternate,a!==null&&qc(a)===null&&(g=f),f=f.sibling;f=g,f===null?(g=l.child,l.child=null):(g=f.sibling,f.sibling=null),Cf(l,!1,g,f,_);break;case"backwards":for(f=null,g=l.child,l.child=null;g!==null;){if(a=g.alternate,a!==null&&qc(a)===null){l.child=g;break}a=g.sibling,g.sibling=f,f=g,g=a}Cf(l,!0,f,null,_);break;case"together":Cf(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function e0(a,l){(l.mode&1)===0&&a!==null&&(a.alternate=null,l.alternate=null,l.flags|=2)}function oa(a,l,f){if(a!==null&&(l.dependencies=a.dependencies),di|=l.lanes,(f&l.childLanes)===0)return null;if(a!==null&&l.child!==a.child)throw Error(t(153));if(l.child!==null){for(a=l.child,f=Pa(a,a.pendingProps),l.child=f,f.return=l;a.sibling!==null;)a=a.sibling,f=f.sibling=Pa(a,a.pendingProps),f.return=l;f.sibling=null}return l.child}function L2(a,l,f){switch(l.tag){case 3:mm(l),tl();break;case 5:Dx(l);break;case 1:Tn(l.type)&&Pc(l);break;case 4:lf(l,l.stateNode.containerInfo);break;case 10:var x=l.type._context,g=l.memoizedProps.value;Xt($c,x._currentValue),x._currentValue=g;break;case 13:if(x=l.memoizedState,x!==null)return x.dehydrated!==null?(Xt(ir,ir.current&1),l.flags|=128,null):(f&l.child.childLanes)!==0?gm(a,l,f):(Xt(ir,ir.current&1),a=oa(a,l,f),a!==null?a.sibling:null);Xt(ir,ir.current&1);break;case 19:if(x=(f&l.childLanes)!==0,(a.flags&128)!==0){if(x)return ym(a,l,f);l.flags|=128}if(g=l.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Xt(ir,ir.current),x)break;return null;case 22:case 23:return l.lanes=0,dm(a,l,f)}return oa(a,l,f)}var bm,Tf,wm,_m;bm=function(a,l){for(var f=l.child;f!==null;){if(f.tag===5||f.tag===6)a.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===l)break;for(;f.sibling===null;){if(f.return===null||f.return===l)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},Tf=function(){},wm=function(a,l,f,x){var g=a.memoizedProps;if(g!==x){a=l.stateNode,ui(Ls.current);var _=null;switch(f){case"input":g=rt(a,g),x=rt(a,x),_=[];break;case"select":g=me({},g,{value:void 0}),x=me({},x,{value:void 0}),_=[];break;case"textarea":g=fr(a,g),x=fr(a,x),_=[];break;default:typeof g.onClick!="function"&&typeof x.onClick=="function"&&(a.onclick=Dc)}Ar(f,x);var F;f=null;for(ge in g)if(!x.hasOwnProperty(ge)&&g.hasOwnProperty(ge)&&g[ge]!=null)if(ge==="style"){var ee=g[ge];for(F in ee)ee.hasOwnProperty(F)&&(f||(f={}),f[F]="")}else ge!=="dangerouslySetInnerHTML"&&ge!=="children"&&ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&ge!=="autoFocus"&&(s.hasOwnProperty(ge)?_||(_=[]):(_=_||[]).push(ge,null));for(ge in x){var se=x[ge];if(ee=g?.[ge],x.hasOwnProperty(ge)&&se!==ee&&(se!=null||ee!=null))if(ge==="style")if(ee){for(F in ee)!ee.hasOwnProperty(F)||se&&se.hasOwnProperty(F)||(f||(f={}),f[F]="");for(F in se)se.hasOwnProperty(F)&&ee[F]!==se[F]&&(f||(f={}),f[F]=se[F])}else f||(_||(_=[]),_.push(ge,f)),f=se;else ge==="dangerouslySetInnerHTML"?(se=se?se.__html:void 0,ee=ee?ee.__html:void 0,se!=null&&ee!==se&&(_=_||[]).push(ge,se)):ge==="children"?typeof se!="string"&&typeof se!="number"||(_=_||[]).push(ge,""+se):ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&(s.hasOwnProperty(ge)?(se!=null&&ge==="onScroll"&&Yt("scroll",a),_||ee===se||(_=[])):(_=_||[]).push(ge,se))}f&&(_=_||[]).push("style",f);var ge=_;(l.updateQueue=ge)&&(l.flags|=4)}},_m=function(a,l,f,x){f!==x&&(l.flags|=4)};function go(a,l){if(!nr)switch(a.tailMode){case"hidden":l=a.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?a.tail=null:f.sibling=null;break;case"collapsed":f=a.tail;for(var x=null;f!==null;)f.alternate!==null&&(x=f),f=f.sibling;x===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:x.sibling=null}}function an(a){var l=a.alternate!==null&&a.alternate.child===a.child,f=0,x=0;if(l)for(var g=a.child;g!==null;)f|=g.lanes|g.childLanes,x|=g.subtreeFlags&14680064,x|=g.flags&14680064,g.return=a,g=g.sibling;else for(g=a.child;g!==null;)f|=g.lanes|g.childLanes,x|=g.subtreeFlags,x|=g.flags,g.return=a,g=g.sibling;return a.subtreeFlags|=x,a.childLanes=f,l}function B2(a,l,f){var x=l.pendingProps;switch(Yu(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return an(l),null;case 1:return Tn(l.type)&&Rc(),an(l),null;case 3:return x=l.stateNode,al(),Jt(Cn),Jt(nn),uf(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(a===null||a.child===null)&&(Uc(l)?l.flags|=4:a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,_s!==null&&(Uf(_s),_s=null))),Tf(a,l),an(l),null;case 5:of(l);var g=ui(fo.current);if(f=l.type,a!==null&&l.stateNode!=null)wm(a,l,f,x,g),a.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!x){if(l.stateNode===null)throw Error(t(166));return an(l),null}if(a=ui(Ls.current),Uc(l)){x=l.stateNode,f=l.type;var _=l.memoizedProps;switch(x[Ms]=l,x[io]=_,a=(l.mode&1)!==0,f){case"dialog":Yt("cancel",x),Yt("close",x);break;case"iframe":case"object":case"embed":Yt("load",x);break;case"video":case"audio":for(g=0;g<no.length;g++)Yt(no[g],x);break;case"source":Yt("error",x);break;case"img":case"image":case"link":Yt("error",x),Yt("load",x);break;case"details":Yt("toggle",x);break;case"input":xt(x,_),Yt("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!_.multiple},Yt("invalid",x);break;case"textarea":kt(x,_),Yt("invalid",x)}Ar(f,_),g=null;for(var F in _)if(_.hasOwnProperty(F)){var ee=_[F];F==="children"?typeof ee=="string"?x.textContent!==ee&&(_.suppressHydrationWarning!==!0&&Oc(x.textContent,ee,a),g=["children",ee]):typeof ee=="number"&&x.textContent!==""+ee&&(_.suppressHydrationWarning!==!0&&Oc(x.textContent,ee,a),g=["children",""+ee]):s.hasOwnProperty(F)&&ee!=null&&F==="onScroll"&&Yt("scroll",x)}switch(f){case"input":Xe(x),jt(x,_,!0);break;case"textarea":Xe(x),Ut(x);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(x.onclick=Dc)}x=g,l.updateQueue=x,x!==null&&(l.flags|=4)}else{F=g.nodeType===9?g:g.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Mt(f)),a==="http://www.w3.org/1999/xhtml"?f==="script"?(a=F.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof x.is=="string"?a=F.createElement(f,{is:x.is}):(a=F.createElement(f),f==="select"&&(F=a,x.multiple?F.multiple=!0:x.size&&(F.size=x.size))):a=F.createElementNS(a,f),a[Ms]=l,a[io]=x,bm(a,l,!1,!1),l.stateNode=a;e:{switch(F=Lt(f,x),f){case"dialog":Yt("cancel",a),Yt("close",a),g=x;break;case"iframe":case"object":case"embed":Yt("load",a),g=x;break;case"video":case"audio":for(g=0;g<no.length;g++)Yt(no[g],a);g=x;break;case"source":Yt("error",a),g=x;break;case"img":case"image":case"link":Yt("error",a),Yt("load",a),g=x;break;case"details":Yt("toggle",a),g=x;break;case"input":xt(a,x),g=rt(a,x),Yt("invalid",a);break;case"option":g=x;break;case"select":a._wrapperState={wasMultiple:!!x.multiple},g=me({},x,{value:void 0}),Yt("invalid",a);break;case"textarea":kt(a,x),g=fr(a,x),Yt("invalid",a);break;default:g=x}Ar(f,g),ee=g;for(_ in ee)if(ee.hasOwnProperty(_)){var se=ee[_];_==="style"?qt(a,se):_==="dangerouslySetInnerHTML"?(se=se?se.__html:void 0,se!=null&&tr(a,se)):_==="children"?typeof se=="string"?(f!=="textarea"||se!=="")&&Ze(a,se):typeof se=="number"&&Ze(a,""+se):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(s.hasOwnProperty(_)?se!=null&&_==="onScroll"&&Yt("scroll",a):se!=null&&N(a,_,se,F))}switch(f){case"input":Xe(a),jt(a,x,!1);break;case"textarea":Xe(a),Ut(a);break;case"option":x.value!=null&&a.setAttribute("value",""+we(x.value));break;case"select":a.multiple=!!x.multiple,_=x.value,_!=null?bt(a,!!x.multiple,_,!1):x.defaultValue!=null&&bt(a,!!x.multiple,x.defaultValue,!0);break;default:typeof g.onClick=="function"&&(a.onclick=Dc)}switch(f){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return an(l),null;case 6:if(a&&l.stateNode!=null)_m(a,l,a.memoizedProps,x);else{if(typeof x!="string"&&l.stateNode===null)throw Error(t(166));if(f=ui(fo.current),ui(Ls.current),Uc(l)){if(x=l.stateNode,f=l.memoizedProps,x[Ms]=l,(_=x.nodeValue!==f)&&(a=Wn,a!==null))switch(a.tag){case 3:Oc(x.nodeValue,f,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Oc(x.nodeValue,f,(a.mode&1)!==0)}_&&(l.flags|=4)}else x=(f.nodeType===9?f:f.ownerDocument).createTextNode(x),x[Ms]=l,l.stateNode=x}return an(l),null;case 13:if(Jt(ir),x=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(nr&&Vn!==null&&(l.mode&1)!==0&&(l.flags&128)===0)Sx(),tl(),l.flags|=98560,_=!1;else if(_=Uc(l),x!==null&&x.dehydrated!==null){if(a===null){if(!_)throw Error(t(318));if(_=l.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(t(317));_[Ms]=l}else tl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;an(l),_=!1}else _s!==null&&(Uf(_s),_s=null),_=!0;if(!_)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=f,l):(x=x!==null,x!==(a!==null&&a.memoizedState!==null)&&x&&(l.child.flags|=8192,(l.mode&1)!==0&&(a===null||(ir.current&1)!==0?Pr===0&&(Pr=3):Hf())),l.updateQueue!==null&&(l.flags|=4),an(l),null);case 4:return al(),Tf(a,l),a===null&&so(l.stateNode.containerInfo),an(l),null;case 10:return rf(l.type._context),an(l),null;case 17:return Tn(l.type)&&Rc(),an(l),null;case 19:if(Jt(ir),_=l.memoizedState,_===null)return an(l),null;if(x=(l.flags&128)!==0,F=_.rendering,F===null)if(x)go(_,!1);else{if(Pr!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(F=qc(a),F!==null){for(l.flags|=128,go(_,!1),x=F.updateQueue,x!==null&&(l.updateQueue=x,l.flags|=4),l.subtreeFlags=0,x=f,f=l.child;f!==null;)_=f,a=x,_.flags&=14680066,F=_.alternate,F===null?(_.childLanes=0,_.lanes=a,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=F.childLanes,_.lanes=F.lanes,_.child=F.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=F.memoizedProps,_.memoizedState=F.memoizedState,_.updateQueue=F.updateQueue,_.type=F.type,a=F.dependencies,_.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),f=f.sibling;return Xt(ir,ir.current&1|2),l.child}a=a.sibling}_.tail!==null&&Ae()>cl&&(l.flags|=128,x=!0,go(_,!1),l.lanes=4194304)}else{if(!x)if(a=qc(F),a!==null){if(l.flags|=128,x=!0,f=a.updateQueue,f!==null&&(l.updateQueue=f,l.flags|=4),go(_,!0),_.tail===null&&_.tailMode==="hidden"&&!F.alternate&&!nr)return an(l),null}else 2*Ae()-_.renderingStartTime>cl&&f!==1073741824&&(l.flags|=128,x=!0,go(_,!1),l.lanes=4194304);_.isBackwards?(F.sibling=l.child,l.child=F):(f=_.last,f!==null?f.sibling=F:l.child=F,_.last=F)}return _.tail!==null?(l=_.tail,_.rendering=l,_.tail=l.sibling,_.renderingStartTime=Ae(),l.sibling=null,f=ir.current,Xt(ir,x?f&1|2:f&1),l):(an(l),null);case 22:case 23:return $f(),x=l.memoizedState!==null,a!==null&&a.memoizedState!==null!==x&&(l.flags|=8192),x&&(l.mode&1)!==0?(qn&1073741824)!==0&&(an(l),l.subtreeFlags&6&&(l.flags|=8192)):an(l),null;case 24:return null;case 25:return null}throw Error(t(156,l.tag))}function U2(a,l){switch(Yu(l),l.tag){case 1:return Tn(l.type)&&Rc(),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return al(),Jt(Cn),Jt(nn),uf(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 5:return of(l),null;case 13:if(Jt(ir),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(t(340));tl()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return Jt(ir),null;case 4:return al(),null;case 10:return rf(l.type._context),null;case 22:case 23:return $f(),null;case 24:return null;default:return null}}var t0=!1,ln=!1,z2=typeof WeakSet=="function"?WeakSet:Set,Ke=null;function ll(a,l){var f=a.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(x){xr(a,l,x)}else f.current=null}function Ff(a,l,f){try{f()}catch(x){xr(a,l,x)}}var km=!1;function $2(a,l){if(zu=_a,a=tx(),Du(a)){if("selectionStart"in a)var f={start:a.selectionStart,end:a.selectionEnd};else e:{f=(f=a.ownerDocument)&&f.defaultView||window;var x=f.getSelection&&f.getSelection();if(x&&x.rangeCount!==0){f=x.anchorNode;var g=x.anchorOffset,_=x.focusNode;x=x.focusOffset;try{f.nodeType,_.nodeType}catch{f=null;break e}var F=0,ee=-1,se=-1,ge=0,Re=0,Me=a,Ie=null;t:for(;;){for(var Ge;Me!==f||g!==0&&Me.nodeType!==3||(ee=F+g),Me!==_||x!==0&&Me.nodeType!==3||(se=F+x),Me.nodeType===3&&(F+=Me.nodeValue.length),(Ge=Me.firstChild)!==null;)Ie=Me,Me=Ge;for(;;){if(Me===a)break t;if(Ie===f&&++ge===g&&(ee=F),Ie===_&&++Re===x&&(se=F),(Ge=Me.nextSibling)!==null)break;Me=Ie,Ie=Me.parentNode}Me=Ge}f=ee===-1||se===-1?null:{start:ee,end:se}}else f=null}f=f||{start:0,end:0}}else f=null;for($u={focusedElem:a,selectionRange:f},_a=!1,Ke=l;Ke!==null;)if(l=Ke,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,Ke=a;else for(;Ke!==null;){l=Ke;try{var Ye=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(Ye!==null){var Je=Ye.memoizedProps,yr=Ye.memoizedState,de=l.stateNode,oe=de.getSnapshotBeforeUpdate(l.elementType===l.type?Je:ks(l.type,Je),yr);de.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var pe=l.stateNode.containerInfo;pe.nodeType===1?pe.textContent="":pe.nodeType===9&&pe.documentElement&&pe.removeChild(pe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ze){xr(l,l.return,ze)}if(a=l.sibling,a!==null){a.return=l.return,Ke=a;break}Ke=l.return}return Ye=km,km=!1,Ye}function vo(a,l,f){var x=l.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var g=x=x.next;do{if((g.tag&a)===a){var _=g.destroy;g.destroy=void 0,_!==void 0&&Ff(l,f,_)}g=g.next}while(g!==x)}}function r0(a,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var f=l=l.next;do{if((f.tag&a)===a){var x=f.create;f.destroy=x()}f=f.next}while(f!==l)}}function Af(a){var l=a.ref;if(l!==null){var f=a.stateNode;a.tag,a=f,typeof l=="function"?l(a):l.current=a}}function Nm(a){var l=a.alternate;l!==null&&(a.alternate=null,Nm(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&(delete l[Ms],delete l[io],delete l[qu],delete l[N2],delete l[S2])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function Sm(a){return a.tag===5||a.tag===3||a.tag===4}function Em(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||Sm(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Of(a,l,f){var x=a.tag;if(x===5||x===6)a=a.stateNode,l?f.nodeType===8?f.parentNode.insertBefore(a,l):f.insertBefore(a,l):(f.nodeType===8?(l=f.parentNode,l.insertBefore(a,f)):(l=f,l.appendChild(a)),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=Dc));else if(x!==4&&(a=a.child,a!==null))for(Of(a,l,f),a=a.sibling;a!==null;)Of(a,l,f),a=a.sibling}function Df(a,l,f){var x=a.tag;if(x===5||x===6)a=a.stateNode,l?f.insertBefore(a,l):f.appendChild(a);else if(x!==4&&(a=a.child,a!==null))for(Df(a,l,f),a=a.sibling;a!==null;)Df(a,l,f),a=a.sibling}var Qr=null,Ns=!1;function Aa(a,l,f){for(f=f.child;f!==null;)jm(a,l,f),f=f.sibling}function jm(a,l,f){if(hr&&typeof hr.onCommitFiberUnmount=="function")try{hr.onCommitFiberUnmount(gn,f)}catch{}switch(f.tag){case 5:ln||ll(f,l);case 6:var x=Qr,g=Ns;Qr=null,Aa(a,l,f),Qr=x,Ns=g,Qr!==null&&(Ns?(a=Qr,f=f.stateNode,a.nodeType===8?a.parentNode.removeChild(f):a.removeChild(f)):Qr.removeChild(f.stateNode));break;case 18:Qr!==null&&(Ns?(a=Qr,f=f.stateNode,a.nodeType===8?Vu(a.parentNode,f):a.nodeType===1&&Vu(a,f),ti(a)):Vu(Qr,f.stateNode));break;case 4:x=Qr,g=Ns,Qr=f.stateNode.containerInfo,Ns=!0,Aa(a,l,f),Qr=x,Ns=g;break;case 0:case 11:case 14:case 15:if(!ln&&(x=f.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){g=x=x.next;do{var _=g,F=_.destroy;_=_.tag,F!==void 0&&((_&2)!==0||(_&4)!==0)&&Ff(f,l,F),g=g.next}while(g!==x)}Aa(a,l,f);break;case 1:if(!ln&&(ll(f,l),x=f.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=f.memoizedProps,x.state=f.memoizedState,x.componentWillUnmount()}catch(ee){xr(f,l,ee)}Aa(a,l,f);break;case 21:Aa(a,l,f);break;case 22:f.mode&1?(ln=(x=ln)||f.memoizedState!==null,Aa(a,l,f),ln=x):Aa(a,l,f);break;default:Aa(a,l,f)}}function Cm(a){var l=a.updateQueue;if(l!==null){a.updateQueue=null;var f=a.stateNode;f===null&&(f=a.stateNode=new z2),l.forEach(function(x){var g=J2.bind(null,a,x);f.has(x)||(f.add(x),x.then(g,g))})}}function Ss(a,l){var f=l.deletions;if(f!==null)for(var x=0;x<f.length;x++){var g=f[x];try{var _=a,F=l,ee=F;e:for(;ee!==null;){switch(ee.tag){case 5:Qr=ee.stateNode,Ns=!1;break e;case 3:Qr=ee.stateNode.containerInfo,Ns=!0;break e;case 4:Qr=ee.stateNode.containerInfo,Ns=!0;break e}ee=ee.return}if(Qr===null)throw Error(t(160));jm(_,F,g),Qr=null,Ns=!1;var se=g.alternate;se!==null&&(se.return=null),g.return=null}catch(ge){xr(g,l,ge)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)Tm(l,a),l=l.sibling}function Tm(a,l){var f=a.alternate,x=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(Ss(l,a),Us(a),x&4){try{vo(3,a,a.return),r0(3,a)}catch(Je){xr(a,a.return,Je)}try{vo(5,a,a.return)}catch(Je){xr(a,a.return,Je)}}break;case 1:Ss(l,a),Us(a),x&512&&f!==null&&ll(f,f.return);break;case 5:if(Ss(l,a),Us(a),x&512&&f!==null&&ll(f,f.return),a.flags&32){var g=a.stateNode;try{Ze(g,"")}catch(Je){xr(a,a.return,Je)}}if(x&4&&(g=a.stateNode,g!=null)){var _=a.memoizedProps,F=f!==null?f.memoizedProps:_,ee=a.type,se=a.updateQueue;if(a.updateQueue=null,se!==null)try{ee==="input"&&_.type==="radio"&&_.name!=null&&nt(g,_),Lt(ee,F);var ge=Lt(ee,_);for(F=0;F<se.length;F+=2){var Re=se[F],Me=se[F+1];Re==="style"?qt(g,Me):Re==="dangerouslySetInnerHTML"?tr(g,Me):Re==="children"?Ze(g,Me):N(g,Re,Me,ge)}switch(ee){case"input":Le(g,_);break;case"textarea":Pt(g,_);break;case"select":var Ie=g._wrapperState.wasMultiple;g._wrapperState.wasMultiple=!!_.multiple;var Ge=_.value;Ge!=null?bt(g,!!_.multiple,Ge,!1):Ie!==!!_.multiple&&(_.defaultValue!=null?bt(g,!!_.multiple,_.defaultValue,!0):bt(g,!!_.multiple,_.multiple?[]:"",!1))}g[io]=_}catch(Je){xr(a,a.return,Je)}}break;case 6:if(Ss(l,a),Us(a),x&4){if(a.stateNode===null)throw Error(t(162));g=a.stateNode,_=a.memoizedProps;try{g.nodeValue=_}catch(Je){xr(a,a.return,Je)}}break;case 3:if(Ss(l,a),Us(a),x&4&&f!==null&&f.memoizedState.isDehydrated)try{ti(l.containerInfo)}catch(Je){xr(a,a.return,Je)}break;case 4:Ss(l,a),Us(a);break;case 13:Ss(l,a),Us(a),g=a.child,g.flags&8192&&(_=g.memoizedState!==null,g.stateNode.isHidden=_,!_||g.alternate!==null&&g.alternate.memoizedState!==null||(Pf=Ae())),x&4&&Cm(a);break;case 22:if(Re=f!==null&&f.memoizedState!==null,a.mode&1?(ln=(ge=ln)||Re,Ss(l,a),ln=ge):Ss(l,a),Us(a),x&8192){if(ge=a.memoizedState!==null,(a.stateNode.isHidden=ge)&&!Re&&(a.mode&1)!==0)for(Ke=a,Re=a.child;Re!==null;){for(Me=Ke=Re;Ke!==null;){switch(Ie=Ke,Ge=Ie.child,Ie.tag){case 0:case 11:case 14:case 15:vo(4,Ie,Ie.return);break;case 1:ll(Ie,Ie.return);var Ye=Ie.stateNode;if(typeof Ye.componentWillUnmount=="function"){x=Ie,f=Ie.return;try{l=x,Ye.props=l.memoizedProps,Ye.state=l.memoizedState,Ye.componentWillUnmount()}catch(Je){xr(x,f,Je)}}break;case 5:ll(Ie,Ie.return);break;case 22:if(Ie.memoizedState!==null){Om(Me);continue}}Ge!==null?(Ge.return=Ie,Ke=Ge):Om(Me)}Re=Re.sibling}e:for(Re=null,Me=a;;){if(Me.tag===5){if(Re===null){Re=Me;try{g=Me.stateNode,ge?(_=g.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(ee=Me.stateNode,se=Me.memoizedProps.style,F=se!=null&&se.hasOwnProperty("display")?se.display:null,ee.style.display=ht("display",F))}catch(Je){xr(a,a.return,Je)}}}else if(Me.tag===6){if(Re===null)try{Me.stateNode.nodeValue=ge?"":Me.memoizedProps}catch(Je){xr(a,a.return,Je)}}else if((Me.tag!==22&&Me.tag!==23||Me.memoizedState===null||Me===a)&&Me.child!==null){Me.child.return=Me,Me=Me.child;continue}if(Me===a)break e;for(;Me.sibling===null;){if(Me.return===null||Me.return===a)break e;Re===Me&&(Re=null),Me=Me.return}Re===Me&&(Re=null),Me.sibling.return=Me.return,Me=Me.sibling}}break;case 19:Ss(l,a),Us(a),x&4&&Cm(a);break;case 21:break;default:Ss(l,a),Us(a)}}function Us(a){var l=a.flags;if(l&2){try{e:{for(var f=a.return;f!==null;){if(Sm(f)){var x=f;break e}f=f.return}throw Error(t(160))}switch(x.tag){case 5:var g=x.stateNode;x.flags&32&&(Ze(g,""),x.flags&=-33);var _=Em(a);Df(a,_,g);break;case 3:case 4:var F=x.stateNode.containerInfo,ee=Em(a);Of(a,ee,F);break;default:throw Error(t(161))}}catch(se){xr(a,a.return,se)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function H2(a,l,f){Ke=a,Fm(a)}function Fm(a,l,f){for(var x=(a.mode&1)!==0;Ke!==null;){var g=Ke,_=g.child;if(g.tag===22&&x){var F=g.memoizedState!==null||t0;if(!F){var ee=g.alternate,se=ee!==null&&ee.memoizedState!==null||ln;ee=t0;var ge=ln;if(t0=F,(ln=se)&&!ge)for(Ke=g;Ke!==null;)F=Ke,se=F.child,F.tag===22&&F.memoizedState!==null?Dm(g):se!==null?(se.return=F,Ke=se):Dm(g);for(;_!==null;)Ke=_,Fm(_),_=_.sibling;Ke=g,t0=ee,ln=ge}Am(a)}else(g.subtreeFlags&8772)!==0&&_!==null?(_.return=g,Ke=_):Am(a)}}function Am(a){for(;Ke!==null;){var l=Ke;if((l.flags&8772)!==0){var f=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:ln||r0(5,l);break;case 1:var x=l.stateNode;if(l.flags&4&&!ln)if(f===null)x.componentDidMount();else{var g=l.elementType===l.type?f.memoizedProps:ks(l.type,f.memoizedProps);x.componentDidUpdate(g,f.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var _=l.updateQueue;_!==null&&Ox(l,_,x);break;case 3:var F=l.updateQueue;if(F!==null){if(f=null,l.child!==null)switch(l.child.tag){case 5:f=l.child.stateNode;break;case 1:f=l.child.stateNode}Ox(l,F,f)}break;case 5:var ee=l.stateNode;if(f===null&&l.flags&4){f=ee;var se=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":se.autoFocus&&f.focus();break;case"img":se.src&&(f.src=se.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var ge=l.alternate;if(ge!==null){var Re=ge.memoizedState;if(Re!==null){var Me=Re.dehydrated;Me!==null&&ti(Me)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}ln||l.flags&512&&Af(l)}catch(Ie){xr(l,l.return,Ie)}}if(l===a){Ke=null;break}if(f=l.sibling,f!==null){f.return=l.return,Ke=f;break}Ke=l.return}}function Om(a){for(;Ke!==null;){var l=Ke;if(l===a){Ke=null;break}var f=l.sibling;if(f!==null){f.return=l.return,Ke=f;break}Ke=l.return}}function Dm(a){for(;Ke!==null;){var l=Ke;try{switch(l.tag){case 0:case 11:case 15:var f=l.return;try{r0(4,l)}catch(se){xr(l,f,se)}break;case 1:var x=l.stateNode;if(typeof x.componentDidMount=="function"){var g=l.return;try{x.componentDidMount()}catch(se){xr(l,g,se)}}var _=l.return;try{Af(l)}catch(se){xr(l,_,se)}break;case 5:var F=l.return;try{Af(l)}catch(se){xr(l,F,se)}}}catch(se){xr(l,l.return,se)}if(l===a){Ke=null;break}var ee=l.sibling;if(ee!==null){ee.return=l.return,Ke=ee;break}Ke=l.return}}var W2=Math.ceil,n0=P.ReactCurrentDispatcher,If=P.ReactCurrentOwner,ss=P.ReactCurrentBatchConfig,Ft=0,Wr=null,jr=null,Zr=0,qn=0,ol=Ea(0),Pr=0,yo=null,di=0,s0=0,Rf=0,bo=null,An=null,Pf=0,cl=1/0,ca=null,a0=!1,Mf=null,Oa=null,i0=!1,Da=null,l0=0,wo=0,Lf=null,o0=-1,c0=0;function _n(){return(Ft&6)!==0?Ae():o0!==-1?o0:o0=Ae()}function Ia(a){return(a.mode&1)===0?1:(Ft&2)!==0&&Zr!==0?Zr&-Zr:j2.transition!==null?(c0===0&&(c0=Qa()),c0):(a=ke,a!==0||(a=window.event,a=a===void 0?16:wc(a.type)),a)}function Es(a,l,f,x){if(50<wo)throw wo=0,Lf=null,Error(t(185));$n(a,f,x),((Ft&2)===0||a!==Wr)&&(a===Wr&&((Ft&2)===0&&(s0|=f),Pr===4&&Ra(a,Zr)),On(a,x),f===1&&Ft===0&&(l.mode&1)===0&&(cl=Ae()+500,Mc&&Ca()))}function On(a,l){var f=a.callbackNode;Js(a,l);var x=gs(a,a===Wr?Zr:0);if(x===0)f!==null&&ie(f),a.callbackNode=null,a.callbackPriority=0;else if(l=x&-x,a.callbackPriority!==l){if(f!=null&&ie(f),l===1)a.tag===0?E2(Rm.bind(null,a)):bx(Rm.bind(null,a)),_2(function(){(Ft&6)===0&&Ca()}),f=null;else{switch(Ve(x)){case 1:f=Et;break;case 4:f=Ct;break;case 16:f=Vt;break;case 536870912:f=zn;break;default:f=Vt}f=Hm(f,Im.bind(null,a))}a.callbackPriority=l,a.callbackNode=f}}function Im(a,l){if(o0=-1,c0=0,(Ft&6)!==0)throw Error(t(327));var f=a.callbackNode;if(ul()&&a.callbackNode!==f)return null;var x=gs(a,a===Wr?Zr:0);if(x===0)return null;if((x&30)!==0||(x&a.expiredLanes)!==0||l)l=u0(a,x);else{l=x;var g=Ft;Ft|=2;var _=Mm();(Wr!==a||Zr!==l)&&(ca=null,cl=Ae()+500,xi(a,l));do try{X2();break}catch(ee){Pm(a,ee)}while(!0);tf(),n0.current=_,Ft=g,jr!==null?l=0:(Wr=null,Zr=0,l=Pr)}if(l!==0){if(l===2&&(g=ba(a),g!==0&&(x=g,l=Bf(a,g))),l===1)throw f=yo,xi(a,0),Ra(a,x),On(a,Ae()),f;if(l===6)Ra(a,x);else{if(g=a.current.alternate,(x&30)===0&&!V2(g)&&(l=u0(a,x),l===2&&(_=ba(a),_!==0&&(x=_,l=Bf(a,_))),l===1))throw f=yo,xi(a,0),Ra(a,x),On(a,Ae()),f;switch(a.finishedWork=g,a.finishedLanes=x,l){case 0:case 1:throw Error(t(345));case 2:mi(a,An,ca);break;case 3:if(Ra(a,x),(x&130023424)===x&&(l=Pf+500-Ae(),10<l)){if(gs(a,0)!==0)break;if(g=a.suspendedLanes,(g&x)!==x){_n(),a.pingedLanes|=a.suspendedLanes&g;break}a.timeoutHandle=Wu(mi.bind(null,a,An,ca),l);break}mi(a,An,ca);break;case 4:if(Ra(a,x),(x&4194240)===x)break;for(l=a.eventTimes,g=-1;0<x;){var F=31-Kt(x);_=1<<F,F=l[F],F>g&&(g=F),x&=~_}if(x=g,x=Ae()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*W2(x/1960))-x,10<x){a.timeoutHandle=Wu(mi.bind(null,a,An,ca),x);break}mi(a,An,ca);break;case 5:mi(a,An,ca);break;default:throw Error(t(329))}}}return On(a,Ae()),a.callbackNode===f?Im.bind(null,a):null}function Bf(a,l){var f=bo;return a.current.memoizedState.isDehydrated&&(xi(a,l).flags|=256),a=u0(a,l),a!==2&&(l=An,An=f,l!==null&&Uf(l)),a}function Uf(a){An===null?An=a:An.push.apply(An,a)}function V2(a){for(var l=a;;){if(l.flags&16384){var f=l.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var x=0;x<f.length;x++){var g=f[x],_=g.getSnapshot;g=g.value;try{if(!ws(_(),g))return!1}catch{return!1}}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Ra(a,l){for(l&=~Rf,l&=~s0,a.suspendedLanes|=l,a.pingedLanes&=~l,a=a.expirationTimes;0<l;){var f=31-Kt(l),x=1<<f;a[f]=-1,l&=~x}}function Rm(a){if((Ft&6)!==0)throw Error(t(327));ul();var l=gs(a,0);if((l&1)===0)return On(a,Ae()),null;var f=u0(a,l);if(a.tag!==0&&f===2){var x=ba(a);x!==0&&(l=x,f=Bf(a,x))}if(f===1)throw f=yo,xi(a,0),Ra(a,l),On(a,Ae()),f;if(f===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=l,mi(a,An,ca),On(a,Ae()),null}function zf(a,l){var f=Ft;Ft|=1;try{return a(l)}finally{Ft=f,Ft===0&&(cl=Ae()+500,Mc&&Ca())}}function hi(a){Da!==null&&Da.tag===0&&(Ft&6)===0&&ul();var l=Ft;Ft|=1;var f=ss.transition,x=ke;try{if(ss.transition=null,ke=1,a)return a()}finally{ke=x,ss.transition=f,Ft=l,(Ft&6)===0&&Ca()}}function $f(){qn=ol.current,Jt(ol)}function xi(a,l){a.finishedWork=null,a.finishedLanes=0;var f=a.timeoutHandle;if(f!==-1&&(a.timeoutHandle=-1,w2(f)),jr!==null)for(f=jr.return;f!==null;){var x=f;switch(Yu(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&Rc();break;case 3:al(),Jt(Cn),Jt(nn),uf();break;case 5:of(x);break;case 4:al();break;case 13:Jt(ir);break;case 19:Jt(ir);break;case 10:rf(x.type._context);break;case 22:case 23:$f()}f=f.return}if(Wr=a,jr=a=Pa(a.current,null),Zr=qn=l,Pr=0,yo=null,Rf=s0=di=0,An=bo=null,ci!==null){for(l=0;l<ci.length;l++)if(f=ci[l],x=f.interleaved,x!==null){f.interleaved=null;var g=x.next,_=f.pending;if(_!==null){var F=_.next;_.next=g,x.next=F}f.pending=x}ci=null}return a}function Pm(a,l){do{var f=jr;try{if(tf(),Xc.current=Jc,Gc){for(var x=lr.memoizedState;x!==null;){var g=x.queue;g!==null&&(g.pending=null),x=x.next}Gc=!1}if(fi=0,Hr=Rr=lr=null,ho=!1,xo=0,If.current=null,f===null||f.return===null){Pr=1,yo=l,jr=null;break}e:{var _=a,F=f.return,ee=f,se=l;if(l=Zr,ee.flags|=32768,se!==null&&typeof se=="object"&&typeof se.then=="function"){var ge=se,Re=ee,Me=Re.tag;if((Re.mode&1)===0&&(Me===0||Me===11||Me===15)){var Ie=Re.alternate;Ie?(Re.updateQueue=Ie.updateQueue,Re.memoizedState=Ie.memoizedState,Re.lanes=Ie.lanes):(Re.updateQueue=null,Re.memoizedState=null)}var Ge=lm(F);if(Ge!==null){Ge.flags&=-257,om(Ge,F,ee,_,l),Ge.mode&1&&im(_,ge,l),l=Ge,se=ge;var Ye=l.updateQueue;if(Ye===null){var Je=new Set;Je.add(se),l.updateQueue=Je}else Ye.add(se);break e}else{if((l&1)===0){im(_,ge,l),Hf();break e}se=Error(t(426))}}else if(nr&&ee.mode&1){var yr=lm(F);if(yr!==null){(yr.flags&65536)===0&&(yr.flags|=256),om(yr,F,ee,_,l),Zu(il(se,ee));break e}}_=se=il(se,ee),Pr!==4&&(Pr=2),bo===null?bo=[_]:bo.push(_),_=F;do{switch(_.tag){case 3:_.flags|=65536,l&=-l,_.lanes|=l;var de=sm(_,se,l);Ax(_,de);break e;case 1:ee=se;var oe=_.type,pe=_.stateNode;if((_.flags&128)===0&&(typeof oe.getDerivedStateFromError=="function"||pe!==null&&typeof pe.componentDidCatch=="function"&&(Oa===null||!Oa.has(pe)))){_.flags|=65536,l&=-l,_.lanes|=l;var ze=am(_,ee,l);Ax(_,ze);break e}}_=_.return}while(_!==null)}Bm(f)}catch(Qe){l=Qe,jr===f&&f!==null&&(jr=f=f.return);continue}break}while(!0)}function Mm(){var a=n0.current;return n0.current=Jc,a===null?Jc:a}function Hf(){(Pr===0||Pr===3||Pr===2)&&(Pr=4),Wr===null||(di&268435455)===0&&(s0&268435455)===0||Ra(Wr,Zr)}function u0(a,l){var f=Ft;Ft|=2;var x=Mm();(Wr!==a||Zr!==l)&&(ca=null,xi(a,l));do try{q2();break}catch(g){Pm(a,g)}while(!0);if(tf(),Ft=f,n0.current=x,jr!==null)throw Error(t(261));return Wr=null,Zr=0,Pr}function q2(){for(;jr!==null;)Lm(jr)}function X2(){for(;jr!==null&&!Te();)Lm(jr)}function Lm(a){var l=$m(a.alternate,a,qn);a.memoizedProps=a.pendingProps,l===null?Bm(a):jr=l,If.current=null}function Bm(a){var l=a;do{var f=l.alternate;if(a=l.return,(l.flags&32768)===0){if(f=B2(f,l,qn),f!==null){jr=f;return}}else{if(f=U2(f,l),f!==null){f.flags&=32767,jr=f;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Pr=6,jr=null;return}}if(l=l.sibling,l!==null){jr=l;return}jr=l=a}while(l!==null);Pr===0&&(Pr=5)}function mi(a,l,f){var x=ke,g=ss.transition;try{ss.transition=null,ke=1,G2(a,l,f,x)}finally{ss.transition=g,ke=x}return null}function G2(a,l,f,x){do ul();while(Da!==null);if((Ft&6)!==0)throw Error(t(327));f=a.finishedWork;var g=a.finishedLanes;if(f===null)return null;if(a.finishedWork=null,a.finishedLanes=0,f===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var _=f.lanes|f.childLanes;if(C(a,_),a===Wr&&(jr=Wr=null,Zr=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||i0||(i0=!0,Hm(Vt,function(){return ul(),null})),_=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||_){_=ss.transition,ss.transition=null;var F=ke;ke=1;var ee=Ft;Ft|=4,If.current=null,$2(a,f),Tm(f,a),x2($u),_a=!!zu,$u=zu=null,a.current=f,H2(f),Fe(),Ft=ee,ke=F,ss.transition=_}else a.current=f;if(i0&&(i0=!1,Da=a,l0=g),_=a.pendingLanes,_===0&&(Oa=null),ya(f.stateNode),On(a,Ae()),l!==null)for(x=a.onRecoverableError,f=0;f<l.length;f++)g=l[f],x(g.value,{componentStack:g.stack,digest:g.digest});if(a0)throw a0=!1,a=Mf,Mf=null,a;return(l0&1)!==0&&a.tag!==0&&ul(),_=a.pendingLanes,(_&1)!==0?a===Lf?wo++:(wo=0,Lf=a):wo=0,Ca(),null}function ul(){if(Da!==null){var a=Ve(l0),l=ss.transition,f=ke;try{if(ss.transition=null,ke=16>a?16:a,Da===null)var x=!1;else{if(a=Da,Da=null,l0=0,(Ft&6)!==0)throw Error(t(331));var g=Ft;for(Ft|=4,Ke=a.current;Ke!==null;){var _=Ke,F=_.child;if((Ke.flags&16)!==0){var ee=_.deletions;if(ee!==null){for(var se=0;se<ee.length;se++){var ge=ee[se];for(Ke=ge;Ke!==null;){var Re=Ke;switch(Re.tag){case 0:case 11:case 15:vo(8,Re,_)}var Me=Re.child;if(Me!==null)Me.return=Re,Ke=Me;else for(;Ke!==null;){Re=Ke;var Ie=Re.sibling,Ge=Re.return;if(Nm(Re),Re===ge){Ke=null;break}if(Ie!==null){Ie.return=Ge,Ke=Ie;break}Ke=Ge}}}var Ye=_.alternate;if(Ye!==null){var Je=Ye.child;if(Je!==null){Ye.child=null;do{var yr=Je.sibling;Je.sibling=null,Je=yr}while(Je!==null)}}Ke=_}}if((_.subtreeFlags&2064)!==0&&F!==null)F.return=_,Ke=F;else e:for(;Ke!==null;){if(_=Ke,(_.flags&2048)!==0)switch(_.tag){case 0:case 11:case 15:vo(9,_,_.return)}var de=_.sibling;if(de!==null){de.return=_.return,Ke=de;break e}Ke=_.return}}var oe=a.current;for(Ke=oe;Ke!==null;){F=Ke;var pe=F.child;if((F.subtreeFlags&2064)!==0&&pe!==null)pe.return=F,Ke=pe;else e:for(F=oe;Ke!==null;){if(ee=Ke,(ee.flags&2048)!==0)try{switch(ee.tag){case 0:case 11:case 15:r0(9,ee)}}catch(Qe){xr(ee,ee.return,Qe)}if(ee===F){Ke=null;break e}var ze=ee.sibling;if(ze!==null){ze.return=ee.return,Ke=ze;break e}Ke=ee.return}}if(Ft=g,Ca(),hr&&typeof hr.onPostCommitFiberRoot=="function")try{hr.onPostCommitFiberRoot(gn,a)}catch{}x=!0}return x}finally{ke=f,ss.transition=l}}return!1}function Um(a,l,f){l=il(f,l),l=sm(a,l,1),a=Fa(a,l,1),l=_n(),a!==null&&($n(a,1,l),On(a,l))}function xr(a,l,f){if(a.tag===3)Um(a,a,f);else for(;l!==null;){if(l.tag===3){Um(l,a,f);break}else if(l.tag===1){var x=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Oa===null||!Oa.has(x))){a=il(f,a),a=am(l,a,1),l=Fa(l,a,1),a=_n(),l!==null&&($n(l,1,a),On(l,a));break}}l=l.return}}function K2(a,l,f){var x=a.pingCache;x!==null&&x.delete(l),l=_n(),a.pingedLanes|=a.suspendedLanes&f,Wr===a&&(Zr&f)===f&&(Pr===4||Pr===3&&(Zr&130023424)===Zr&&500>Ae()-Pf?xi(a,0):Rf|=f),On(a,l)}function zm(a,l){l===0&&((a.mode&1)===0?l=1:(l=Ys,Ys<<=1,(Ys&130023424)===0&&(Ys=4194304)));var f=_n();a=ia(a,l),a!==null&&($n(a,l,f),On(a,f))}function Y2(a){var l=a.memoizedState,f=0;l!==null&&(f=l.retryLane),zm(a,f)}function J2(a,l){var f=0;switch(a.tag){case 13:var x=a.stateNode,g=a.memoizedState;g!==null&&(f=g.retryLane);break;case 19:x=a.stateNode;break;default:throw Error(t(314))}x!==null&&x.delete(l),zm(a,f)}var $m;$m=function(a,l,f){if(a!==null)if(a.memoizedProps!==l.pendingProps||Cn.current)Fn=!0;else{if((a.lanes&f)===0&&(l.flags&128)===0)return Fn=!1,L2(a,l,f);Fn=(a.flags&131072)!==0}else Fn=!1,nr&&(l.flags&1048576)!==0&&wx(l,Bc,l.index);switch(l.lanes=0,l.tag){case 2:var x=l.type;e0(a,l),a=l.pendingProps;var g=Qi(l,nn.current);sl(l,f),g=hf(null,l,x,a,g,f);var _=xf();return l.flags|=1,typeof g=="object"&&g!==null&&typeof g.render=="function"&&g.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,Tn(x)?(_=!0,Pc(l)):_=!1,l.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,af(l),g.updater=Qc,l.stateNode=g,g._reactInternals=l,bf(l,x,a,f),l=Nf(null,l,x,!0,_,f)):(l.tag=0,nr&&_&&Ku(l),wn(null,l,g,f),l=l.child),l;case 16:x=l.elementType;e:{switch(e0(a,l),a=l.pendingProps,g=x._init,x=g(x._payload),l.type=x,g=l.tag=Z2(x),a=ks(x,a),g){case 0:l=kf(null,l,x,a,f);break e;case 1:l=xm(null,l,x,a,f);break e;case 11:l=cm(null,l,x,a,f);break e;case 14:l=um(null,l,x,ks(x.type,a),f);break e}throw Error(t(306,x,""))}return l;case 0:return x=l.type,g=l.pendingProps,g=l.elementType===x?g:ks(x,g),kf(a,l,x,g,f);case 1:return x=l.type,g=l.pendingProps,g=l.elementType===x?g:ks(x,g),xm(a,l,x,g,f);case 3:e:{if(mm(l),a===null)throw Error(t(387));x=l.pendingProps,_=l.memoizedState,g=_.element,Fx(a,l),Vc(l,x,null,f);var F=l.memoizedState;if(x=F.element,_.isDehydrated)if(_={element:x,isDehydrated:!1,cache:F.cache,pendingSuspenseBoundaries:F.pendingSuspenseBoundaries,transitions:F.transitions},l.updateQueue.baseState=_,l.memoizedState=_,l.flags&256){g=il(Error(t(423)),l),l=pm(a,l,x,f,g);break e}else if(x!==g){g=il(Error(t(424)),l),l=pm(a,l,x,f,g);break e}else for(Vn=Sa(l.stateNode.containerInfo.firstChild),Wn=l,nr=!0,_s=null,f=Cx(l,null,x,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(tl(),x===g){l=oa(a,l,f);break e}wn(a,l,x,f)}l=l.child}return l;case 5:return Dx(l),a===null&&Qu(l),x=l.type,g=l.pendingProps,_=a!==null?a.memoizedProps:null,F=g.children,Hu(x,g)?F=null:_!==null&&Hu(x,_)&&(l.flags|=32),hm(a,l),wn(a,l,F,f),l.child;case 6:return a===null&&Qu(l),null;case 13:return gm(a,l,f);case 4:return lf(l,l.stateNode.containerInfo),x=l.pendingProps,a===null?l.child=rl(l,null,x,f):wn(a,l,x,f),l.child;case 11:return x=l.type,g=l.pendingProps,g=l.elementType===x?g:ks(x,g),cm(a,l,x,g,f);case 7:return wn(a,l,l.pendingProps,f),l.child;case 8:return wn(a,l,l.pendingProps.children,f),l.child;case 12:return wn(a,l,l.pendingProps.children,f),l.child;case 10:e:{if(x=l.type._context,g=l.pendingProps,_=l.memoizedProps,F=g.value,Xt($c,x._currentValue),x._currentValue=F,_!==null)if(ws(_.value,F)){if(_.children===g.children&&!Cn.current){l=oa(a,l,f);break e}}else for(_=l.child,_!==null&&(_.return=l);_!==null;){var ee=_.dependencies;if(ee!==null){F=_.child;for(var se=ee.firstContext;se!==null;){if(se.context===x){if(_.tag===1){se=la(-1,f&-f),se.tag=2;var ge=_.updateQueue;if(ge!==null){ge=ge.shared;var Re=ge.pending;Re===null?se.next=se:(se.next=Re.next,Re.next=se),ge.pending=se}}_.lanes|=f,se=_.alternate,se!==null&&(se.lanes|=f),nf(_.return,f,l),ee.lanes|=f;break}se=se.next}}else if(_.tag===10)F=_.type===l.type?null:_.child;else if(_.tag===18){if(F=_.return,F===null)throw Error(t(341));F.lanes|=f,ee=F.alternate,ee!==null&&(ee.lanes|=f),nf(F,f,l),F=_.sibling}else F=_.child;if(F!==null)F.return=_;else for(F=_;F!==null;){if(F===l){F=null;break}if(_=F.sibling,_!==null){_.return=F.return,F=_;break}F=F.return}_=F}wn(a,l,g.children,f),l=l.child}return l;case 9:return g=l.type,x=l.pendingProps.children,sl(l,f),g=rs(g),x=x(g),l.flags|=1,wn(a,l,x,f),l.child;case 14:return x=l.type,g=ks(x,l.pendingProps),g=ks(x.type,g),um(a,l,x,g,f);case 15:return fm(a,l,l.type,l.pendingProps,f);case 17:return x=l.type,g=l.pendingProps,g=l.elementType===x?g:ks(x,g),e0(a,l),l.tag=1,Tn(x)?(a=!0,Pc(l)):a=!1,sl(l,f),rm(l,x,g),bf(l,x,g,f),Nf(null,l,x,!0,a,f);case 19:return ym(a,l,f);case 22:return dm(a,l,f)}throw Error(t(156,l.tag))};function Hm(a,l){return E(a,l)}function Q2(a,l,f,x){this.tag=a,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function as(a,l,f,x){return new Q2(a,l,f,x)}function Wf(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Z2(a){if(typeof a=="function")return Wf(a)?1:0;if(a!=null){if(a=a.$$typeof,a===re)return 11;if(a===Se)return 14}return 2}function Pa(a,l){var f=a.alternate;return f===null?(f=as(a.tag,l,a.key,a.mode),f.elementType=a.elementType,f.type=a.type,f.stateNode=a.stateNode,f.alternate=a,a.alternate=f):(f.pendingProps=l,f.type=a.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=a.flags&14680064,f.childLanes=a.childLanes,f.lanes=a.lanes,f.child=a.child,f.memoizedProps=a.memoizedProps,f.memoizedState=a.memoizedState,f.updateQueue=a.updateQueue,l=a.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=a.sibling,f.index=a.index,f.ref=a.ref,f}function f0(a,l,f,x,g,_){var F=2;if(x=a,typeof a=="function")Wf(a)&&(F=1);else if(typeof a=="string")F=5;else e:switch(a){case M:return pi(f.children,g,_,l);case Z:F=8,g|=8;break;case H:return a=as(12,f,l,g|2),a.elementType=H,a.lanes=_,a;case te:return a=as(13,f,l,g),a.elementType=te,a.lanes=_,a;case ve:return a=as(19,f,l,g),a.elementType=ve,a.lanes=_,a;case ue:return d0(f,g,_,l);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case ce:F=10;break e;case le:F=9;break e;case re:F=11;break e;case Se:F=14;break e;case Ce:F=16,x=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return l=as(F,f,l,g),l.elementType=a,l.type=x,l.lanes=_,l}function pi(a,l,f,x){return a=as(7,a,x,l),a.lanes=f,a}function d0(a,l,f,x){return a=as(22,a,x,l),a.elementType=ue,a.lanes=f,a.stateNode={isHidden:!1},a}function Vf(a,l,f){return a=as(6,a,null,l),a.lanes=f,a}function qf(a,l,f){return l=as(4,a.children!==null?a.children:[],a.key,l),l.lanes=f,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}function eb(a,l,f,x,g){this.tag=l,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wa(0),this.expirationTimes=wa(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wa(0),this.identifierPrefix=x,this.onRecoverableError=g,this.mutableSourceEagerHydrationData=null}function Xf(a,l,f,x,g,_,F,ee,se){return a=new eb(a,l,f,ee,se),l===1?(l=1,_===!0&&(l|=8)):l=0,_=as(3,null,null,l),a.current=_,_.stateNode=a,_.memoizedState={element:x,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},af(_),a}function tb(a,l,f){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:X,key:x==null?null:""+x,children:a,containerInfo:l,implementation:f}}function Wm(a){if(!a)return ja;a=a._reactInternals;e:{if(G(a)!==a||a.tag!==1)throw Error(t(170));var l=a;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(Tn(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(t(171))}if(a.tag===1){var f=a.type;if(Tn(f))return vx(a,f,l)}return l}function Vm(a,l,f,x,g,_,F,ee,se){return a=Xf(f,x,!0,a,g,_,F,ee,se),a.context=Wm(null),f=a.current,x=_n(),g=Ia(f),_=la(x,g),_.callback=l??null,Fa(f,_,g),a.current.lanes=g,$n(a,g,x),On(a,x),a}function h0(a,l,f,x){var g=l.current,_=_n(),F=Ia(g);return f=Wm(f),l.context===null?l.context=f:l.pendingContext=f,l=la(_,F),l.payload={element:a},x=x===void 0?null:x,x!==null&&(l.callback=x),a=Fa(g,l,F),a!==null&&(Es(a,g,F,_),Wc(a,g,F)),F}function x0(a){return a=a.current,a.child?(a.child.tag===5,a.child.stateNode):null}function qm(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var f=a.retryLane;a.retryLane=f!==0&&f<l?f:l}}function Gf(a,l){qm(a,l),(a=a.alternate)&&qm(a,l)}function rb(){return null}var Xm=typeof reportError=="function"?reportError:function(a){console.error(a)};function Kf(a){this._internalRoot=a}m0.prototype.render=Kf.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(t(409));h0(a,l,null,null)},m0.prototype.unmount=Kf.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;hi(function(){h0(null,a,null,null)}),l[ra]=null}};function m0(a){this._internalRoot=a}m0.prototype.unstable_scheduleHydration=function(a){if(a){var l=We();a={blockedOn:null,target:a,priority:l};for(var f=0;f<Rs.length&&l!==0&&l<Rs[f].priority;f++);Rs.splice(f,0,a),f===0&&Hn(a)}};function Yf(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function p0(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function Gm(){}function nb(a,l,f,x,g){if(g){if(typeof x=="function"){var _=x;x=function(){var ge=x0(F);_.call(ge)}}var F=Vm(l,x,a,0,null,!1,!1,"",Gm);return a._reactRootContainer=F,a[ra]=F.current,so(a.nodeType===8?a.parentNode:a),hi(),F}for(;g=a.lastChild;)a.removeChild(g);if(typeof x=="function"){var ee=x;x=function(){var ge=x0(se);ee.call(ge)}}var se=Xf(a,0,!1,null,null,!1,!1,"",Gm);return a._reactRootContainer=se,a[ra]=se.current,so(a.nodeType===8?a.parentNode:a),hi(function(){h0(l,se,f,x)}),se}function g0(a,l,f,x,g){var _=f._reactRootContainer;if(_){var F=_;if(typeof g=="function"){var ee=g;g=function(){var se=x0(F);ee.call(se)}}h0(l,F,a,g)}else F=nb(f,l,a,g,x);return x0(F)}wt=function(a){switch(a.tag){case 3:var l=a.stateNode;if(l.current.memoizedState.isDehydrated){var f=Qn(l.pendingLanes);f!==0&&(_e(l,f|1),On(l,Ae()),(Ft&6)===0&&(cl=Ae()+500,Ca()))}break;case 13:hi(function(){var x=ia(a,1);if(x!==null){var g=_n();Es(x,a,1,g)}}),Gf(a,1)}},vs=function(a){if(a.tag===13){var l=ia(a,134217728);if(l!==null){var f=_n();Es(l,a,134217728,f)}Gf(a,134217728)}},yn=function(a){if(a.tag===13){var l=Ia(a),f=ia(a,l);if(f!==null){var x=_n();Es(f,a,l,x)}Gf(a,l)}},We=function(){return ke},pc=function(a,l){var f=ke;try{return ke=a,l()}finally{ke=f}},Nr=function(a,l,f){switch(l){case"input":if(Le(a,f),l=f.name,f.type==="radio"&&l!=null){for(f=a;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<f.length;l++){var x=f[l];if(x!==a&&x.form===a.form){var g=Ic(x);if(!g)throw Error(t(90));D(x),Le(x,g)}}}break;case"textarea":Pt(a,f);break;case"select":l=f.value,l!=null&&bt(a,!!f.multiple,l,!1)}},En=zf,Bn=hi;var sb={usingClientEntryPoint:!1,Events:[lo,Yi,Ic,zr,Yr,zf]},_o={findFiberByHostInstance:ai,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ab={bundleType:_o.bundleType,version:_o.version,rendererPackageName:_o.rendererPackageName,rendererConfig:_o.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:P.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=xe(a),a===null?null:a.stateNode},findFiberByHostInstance:_o.findFiberByHostInstance||rb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var v0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!v0.isDisabled&&v0.supportsFiber)try{gn=v0.inject(ab),hr=v0}catch{}}return Dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sb,Dn.createPortal=function(a,l){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yf(l))throw Error(t(200));return tb(a,l,null,f)},Dn.createRoot=function(a,l){if(!Yf(a))throw Error(t(299));var f=!1,x="",g=Xm;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(x=l.identifierPrefix),l.onRecoverableError!==void 0&&(g=l.onRecoverableError)),l=Xf(a,1,!1,null,null,f,!1,x,g),a[ra]=l.current,so(a.nodeType===8?a.parentNode:a),new Kf(l)},Dn.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=xe(l),a=a===null?null:a.stateNode,a},Dn.flushSync=function(a){return hi(a)},Dn.hydrate=function(a,l,f){if(!p0(l))throw Error(t(200));return g0(null,a,l,!0,f)},Dn.hydrateRoot=function(a,l,f){if(!Yf(a))throw Error(t(405));var x=f!=null&&f.hydratedSources||null,g=!1,_="",F=Xm;if(f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(_=f.identifierPrefix),f.onRecoverableError!==void 0&&(F=f.onRecoverableError)),l=Vm(l,null,a,1,f??null,g,!1,_,F),a[ra]=l.current,so(a),x)for(a=0;a<x.length;a++)f=x[a],g=f._getVersion,g=g(f._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[f,g]:l.mutableSourceEagerHydrationData.push(f,g);return new m0(l)},Dn.render=function(a,l,f){if(!p0(l))throw Error(t(200));return g0(null,a,l,!1,f)},Dn.unmountComponentAtNode=function(a){if(!p0(a))throw Error(t(40));return a._reactRootContainer?(hi(function(){g0(null,null,a,!1,function(){a._reactRootContainer=null,a[ra]=null})}),!0):!1},Dn.unstable_batchedUpdates=zf,Dn.unstable_renderSubtreeIntoContainer=function(a,l,f,x){if(!p0(f))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return g0(a,l,f,!1,x)},Dn.version="18.3.1-next-f1338f8080-20240426",Dn}var rp;function Jg(){if(rp)return Zf.exports;rp=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),Zf.exports=xb(),Zf.exports}var np;function mb(){if(np)return y0;np=1;var e=Jg();return y0.createRoot=e.createRoot,y0.hydrateRoot=e.hydrateRoot,y0}var pb=mb();const gb=Kg(pb);Jg();function Bo(){return Bo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Bo.apply(this,arguments)}var Ba;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ba||(Ba={}));const sp="popstate";function vb(e){e===void 0&&(e={});function r(n,s){let{pathname:o,search:c,hash:u}=n.location;return kd("",{pathname:o,search:c,hash:u},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(n,s){return typeof s=="string"?s:R0(s)}return bb(r,t,null,e)}function ur(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function Wd(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function yb(){return Math.random().toString(36).substr(2,8)}function ap(e,r){return{usr:e.state,key:e.key,idx:r}}function kd(e,r,t,n){return t===void 0&&(t=null),Bo({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof r=="string"?Fl(r):r,{state:t,key:r&&r.key||n||yb()})}function R0(e){let{pathname:r="/",search:t="",hash:n=""}=e;return t&&t!=="?"&&(r+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(r+=n.charAt(0)==="#"?n:"#"+n),r}function Fl(e){let r={};if(e){let t=e.indexOf("#");t>=0&&(r.hash=e.substr(t),e=e.substr(0,t));let n=e.indexOf("?");n>=0&&(r.search=e.substr(n),e=e.substr(0,n)),e&&(r.pathname=e)}return r}function bb(e,r,t,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:o=!1}=n,c=s.history,u=Ba.Pop,d=null,h=m();h==null&&(h=0,c.replaceState(Bo({},c.state,{idx:h}),""));function m(){return(c.state||{idx:null}).idx}function p(){u=Ba.Pop;let w=m(),S=w==null?null:w-h;h=w,d&&d({action:u,location:v.location,delta:S})}function y(w,S){u=Ba.Push;let I=kd(v.location,w,S);h=m()+1;let N=ap(I,h),P=v.createHref(I);try{c.pushState(N,"",P)}catch(W){if(W instanceof DOMException&&W.name==="DataCloneError")throw W;s.location.assign(P)}o&&d&&d({action:u,location:v.location,delta:1})}function k(w,S){u=Ba.Replace;let I=kd(v.location,w,S);h=m();let N=ap(I,h),P=v.createHref(I);c.replaceState(N,"",P),o&&d&&d({action:u,location:v.location,delta:0})}function b(w){let S=s.location.origin!=="null"?s.location.origin:s.location.href,I=typeof w=="string"?w:R0(w);return I=I.replace(/ $/,"%20"),ur(S,"No window.location.(origin|href) available to create URL for href: "+I),new URL(I,S)}let v={get action(){return u},get location(){return e(s,c)},listen(w){if(d)throw new Error("A history only accepts one active listener");return s.addEventListener(sp,p),d=w,()=>{s.removeEventListener(sp,p),d=null}},createHref(w){return r(s,w)},createURL:b,encodeLocation(w){let S=b(w);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:y,replace:k,go(w){return c.go(w)}};return v}var ip;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(ip||(ip={}));function wb(e,r,t){return t===void 0&&(t="/"),_b(e,r,t)}function _b(e,r,t,n){let s=typeof r=="string"?Fl(r):r,o=kl(s.pathname||"/",t);if(o==null)return null;let c=Qg(e);kb(c);let u=null;for(let d=0;u==null&&d<c.length;++d){let h=Ib(o);u=Ob(c[d],h)}return u}function Qg(e,r,t,n){r===void 0&&(r=[]),t===void 0&&(t=[]),n===void 0&&(n="");let s=(o,c,u)=>{let d={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};d.relativePath.startsWith("/")&&(ur(d.relativePath.startsWith(n),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(n.length));let h=$a([n,d.relativePath]),m=t.concat(d);o.children&&o.children.length>0&&(ur(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),Qg(o.children,r,m,h)),!(o.path==null&&!o.index)&&r.push({path:h,score:Fb(h,o.index),routesMeta:m})};return e.forEach((o,c)=>{var u;if(o.path===""||!((u=o.path)!=null&&u.includes("?")))s(o,c);else for(let d of Zg(o.path))s(o,c,d)}),r}function Zg(e){let r=e.split("/");if(r.length===0)return[];let[t,...n]=r,s=t.endsWith("?"),o=t.replace(/\?$/,"");if(n.length===0)return s?[o,""]:[o];let c=Zg(n.join("/")),u=[];return u.push(...c.map(d=>d===""?o:[o,d].join("/"))),s&&u.push(...c),u.map(d=>e.startsWith("/")&&d===""?"/":d)}function kb(e){e.sort((r,t)=>r.score!==t.score?t.score-r.score:Ab(r.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}const Nb=/^:[\w-]+$/,Sb=3,Eb=2,jb=1,Cb=10,Tb=-2,lp=e=>e==="*";function Fb(e,r){let t=e.split("/"),n=t.length;return t.some(lp)&&(n+=Tb),r&&(n+=Eb),t.filter(s=>!lp(s)).reduce((s,o)=>s+(Nb.test(o)?Sb:o===""?jb:Cb),n)}function Ab(e,r){return e.length===r.length&&e.slice(0,-1).every((n,s)=>n===r[s])?e[e.length-1]-r[r.length-1]:0}function Ob(e,r,t){let{routesMeta:n}=e,s={},o="/",c=[];for(let u=0;u<n.length;++u){let d=n[u],h=u===n.length-1,m=o==="/"?r:r.slice(o.length)||"/",p=Nd({path:d.relativePath,caseSensitive:d.caseSensitive,end:h},m),y=d.route;if(!p)return null;Object.assign(s,p.params),c.push({params:s,pathname:$a([o,p.pathname]),pathnameBase:Bb($a([o,p.pathnameBase])),route:y}),p.pathnameBase!=="/"&&(o=$a([o,p.pathnameBase]))}return c}function Nd(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,n]=Db(e.path,e.caseSensitive,e.end),s=r.match(t);if(!s)return null;let o=s[0],c=o.replace(/(.)\/+$/,"$1"),u=s.slice(1);return{params:n.reduce((h,m,p)=>{let{paramName:y,isOptional:k}=m;if(y==="*"){let v=u[p]||"";c=o.slice(0,o.length-v.length).replace(/(.)\/+$/,"$1")}const b=u[p];return k&&!b?h[y]=void 0:h[y]=(b||"").replace(/%2F/g,"/"),h},{}),pathname:o,pathnameBase:c,pattern:e}}function Db(e,r,t){r===void 0&&(r=!1),t===void 0&&(t=!0),Wd(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,d)=>(n.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,r?void 0:"i"),n]}function Ib(e){try{return e.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return Wd(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+r+").")),e}}function kl(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let t=r.endsWith("/")?r.length-1:r.length,n=e.charAt(t);return n&&n!=="/"?null:e.slice(t)||"/"}const Rb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Pb=e=>Rb.test(e);function Mb(e,r){r===void 0&&(r="/");let{pathname:t,search:n="",hash:s=""}=typeof e=="string"?Fl(e):e,o;if(t)if(Pb(t))o=t;else{if(t.includes("//")){let c=t;t=t.replace(/\/\/+/g,"/"),Wd(!1,"Pathnames cannot have embedded double slashes - normalizing "+(c+" -> "+t))}t.startsWith("/")?o=op(t.substring(1),"/"):o=op(t,r)}else o=r;return{pathname:o,search:Ub(n),hash:zb(s)}}function op(e,r){let t=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function rd(e,r,t,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+r+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Lb(e){return e.filter((r,t)=>t===0||r.route.path&&r.route.path.length>0)}function Vd(e,r){let t=Lb(e);return r?t.map((n,s)=>s===t.length-1?n.pathname:n.pathnameBase):t.map(n=>n.pathnameBase)}function qd(e,r,t,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=Fl(e):(s=Bo({},e),ur(!s.pathname||!s.pathname.includes("?"),rd("?","pathname","search",s)),ur(!s.pathname||!s.pathname.includes("#"),rd("#","pathname","hash",s)),ur(!s.search||!s.search.includes("#"),rd("#","search","hash",s)));let o=e===""||s.pathname==="",c=o?"/":s.pathname,u;if(c==null)u=t;else{let p=r.length-1;if(!n&&c.startsWith("..")){let y=c.split("/");for(;y[0]==="..";)y.shift(),p-=1;s.pathname=y.join("/")}u=p>=0?r[p]:"/"}let d=Mb(s,u),h=c&&c!=="/"&&c.endsWith("/"),m=(o||c===".")&&t.endsWith("/");return!d.pathname.endsWith("/")&&(h||m)&&(d.pathname+="/"),d}const $a=e=>e.join("/").replace(/\/\/+/g,"/"),Bb=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Ub=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,zb=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function $b(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const e1=["post","put","patch","delete"];new Set(e1);const Hb=["get",...e1];new Set(Hb);function Uo(){return Uo=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Uo.apply(this,arguments)}const Q0=j.createContext(null),t1=j.createContext(null),ma=j.createContext(null),Z0=j.createContext(null),qs=j.createContext({outlet:null,matches:[],isDataRoute:!1}),r1=j.createContext(null);function Wb(e,r){let{relative:t}=r===void 0?{}:r;Al()||ur(!1);let{basename:n,navigator:s}=j.useContext(ma),{hash:o,pathname:c,search:u}=eu(e,{relative:t}),d=c;return n!=="/"&&(d=c==="/"?n:$a([n,c])),s.createHref({pathname:d,search:u,hash:o})}function Al(){return j.useContext(Z0)!=null}function Xa(){return Al()||ur(!1),j.useContext(Z0).location}function n1(e){j.useContext(ma).static||j.useLayoutEffect(e)}function xs(){let{isDataRoute:e}=j.useContext(qs);return e?aw():Vb()}function Vb(){Al()||ur(!1);let e=j.useContext(Q0),{basename:r,future:t,navigator:n}=j.useContext(ma),{matches:s}=j.useContext(qs),{pathname:o}=Xa(),c=JSON.stringify(Vd(s,t.v7_relativeSplatPath)),u=j.useRef(!1);return n1(()=>{u.current=!0}),j.useCallback(function(h,m){if(m===void 0&&(m={}),!u.current)return;if(typeof h=="number"){n.go(h);return}let p=qd(h,JSON.parse(c),o,m.relative==="path");e==null&&r!=="/"&&(p.pathname=p.pathname==="/"?r:$a([r,p.pathname])),(m.replace?n.replace:n.push)(p,m.state,m)},[r,n,c,o,e])}const s1=j.createContext(null);function qb(){return j.useContext(s1)}function Xb(e){let r=j.useContext(qs).outlet;return r&&j.createElement(s1.Provider,{value:e},r)}function Xd(){let{matches:e}=j.useContext(qs),r=e[e.length-1];return r?r.params:{}}function eu(e,r){let{relative:t}=r===void 0?{}:r,{future:n}=j.useContext(ma),{matches:s}=j.useContext(qs),{pathname:o}=Xa(),c=JSON.stringify(Vd(s,n.v7_relativeSplatPath));return j.useMemo(()=>qd(e,JSON.parse(c),o,t==="path"),[e,c,o,t])}function Gb(e,r){return Kb(e,r)}function Kb(e,r,t,n){Al()||ur(!1);let{navigator:s}=j.useContext(ma),{matches:o}=j.useContext(qs),c=o[o.length-1],u=c?c.params:{};c&&c.pathname;let d=c?c.pathnameBase:"/";c&&c.route;let h=Xa(),m;if(r){var p;let w=typeof r=="string"?Fl(r):r;d==="/"||(p=w.pathname)!=null&&p.startsWith(d)||ur(!1),m=w}else m=h;let y=m.pathname||"/",k=y;if(d!=="/"){let w=d.replace(/^\//,"").split("/");k="/"+y.replace(/^\//,"").split("/").slice(w.length).join("/")}let b=wb(e,{pathname:k}),v=ew(b&&b.map(w=>Object.assign({},w,{params:Object.assign({},u,w.params),pathname:$a([d,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?d:$a([d,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),o,t,n);return r&&v?j.createElement(Z0.Provider,{value:{location:Uo({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Ba.Pop}},v):v}function Yb(){let e=sw(),r=$b(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},r),t?j.createElement("pre",{style:s},t):null,null)}const Jb=j.createElement(Yb,null);class Qb extends j.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,t){return t.location!==r.location||t.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:t.error,location:t.location,revalidation:r.revalidation||t.revalidation}}componentDidCatch(r,t){console.error("React Router caught the following error during render",r,t)}render(){return this.state.error!==void 0?j.createElement(qs.Provider,{value:this.props.routeContext},j.createElement(r1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Zb(e){let{routeContext:r,match:t,children:n}=e,s=j.useContext(Q0);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),j.createElement(qs.Provider,{value:r},n)}function ew(e,r,t,n){var s;if(r===void 0&&(r=[]),t===void 0&&(t=null),n===void 0&&(n=null),e==null){var o;if(!t)return null;if(t.errors)e=t.matches;else if((o=n)!=null&&o.v7_partialHydration&&r.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let c=e,u=(s=t)==null?void 0:s.errors;if(u!=null){let m=c.findIndex(p=>p.route.id&&u?.[p.route.id]!==void 0);m>=0||ur(!1),c=c.slice(0,Math.min(c.length,m+1))}let d=!1,h=-1;if(t&&n&&n.v7_partialHydration)for(let m=0;m<c.length;m++){let p=c[m];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(h=m),p.route.id){let{loaderData:y,errors:k}=t,b=p.route.loader&&y[p.route.id]===void 0&&(!k||k[p.route.id]===void 0);if(p.route.lazy||b){d=!0,h>=0?c=c.slice(0,h+1):c=[c[0]];break}}}return c.reduceRight((m,p,y)=>{let k,b=!1,v=null,w=null;t&&(k=u&&p.route.id?u[p.route.id]:void 0,v=p.route.errorElement||Jb,d&&(h<0&&y===0?(iw("route-fallback"),b=!0,w=null):h===y&&(b=!0,w=p.route.hydrateFallbackElement||null)));let S=r.concat(c.slice(0,y+1)),I=()=>{let N;return k?N=v:b?N=w:p.route.Component?N=j.createElement(p.route.Component,null):p.route.element?N=p.route.element:N=m,j.createElement(Zb,{match:p,routeContext:{outlet:m,matches:S,isDataRoute:t!=null},children:N})};return t&&(p.route.ErrorBoundary||p.route.errorElement||y===0)?j.createElement(Qb,{location:t.location,revalidation:t.revalidation,component:v,error:k,children:I(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):I()},null)}var a1=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(a1||{}),i1=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(i1||{});function tw(e){let r=j.useContext(Q0);return r||ur(!1),r}function rw(e){let r=j.useContext(t1);return r||ur(!1),r}function nw(e){let r=j.useContext(qs);return r||ur(!1),r}function l1(e){let r=nw(),t=r.matches[r.matches.length-1];return t.route.id||ur(!1),t.route.id}function sw(){var e;let r=j.useContext(r1),t=rw(),n=l1();return r!==void 0?r:(e=t.errors)==null?void 0:e[n]}function aw(){let{router:e}=tw(a1.UseNavigateStable),r=l1(i1.UseNavigateStable),t=j.useRef(!1);return n1(()=>{t.current=!0}),j.useCallback(function(s,o){o===void 0&&(o={}),t.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Uo({fromRouteId:r},o)))},[e,r])}const cp={};function iw(e,r,t){cp[e]||(cp[e]=!0)}function lw(e,r){e?.v7_startTransition,e?.v7_relativeSplatPath}function To(e){let{to:r,replace:t,state:n,relative:s}=e;Al()||ur(!1);let{future:o,static:c}=j.useContext(ma),{matches:u}=j.useContext(qs),{pathname:d}=Xa(),h=xs(),m=qd(r,Vd(u,o.v7_relativeSplatPath),d,s==="path"),p=JSON.stringify(m);return j.useEffect(()=>h(JSON.parse(p),{replace:t,state:n,relative:s}),[h,p,s,t,n]),null}function ow(e){return Xb(e.context)}function qr(e){ur(!1)}function cw(e){let{basename:r="/",children:t=null,location:n,navigationType:s=Ba.Pop,navigator:o,static:c=!1,future:u}=e;Al()&&ur(!1);let d=r.replace(/^\/*/,"/"),h=j.useMemo(()=>({basename:d,navigator:o,static:c,future:Uo({v7_relativeSplatPath:!1},u)}),[d,u,o,c]);typeof n=="string"&&(n=Fl(n));let{pathname:m="/",search:p="",hash:y="",state:k=null,key:b="default"}=n,v=j.useMemo(()=>{let w=kl(m,d);return w==null?null:{location:{pathname:w,search:p,hash:y,state:k,key:b},navigationType:s}},[d,m,p,y,k,b,s]);return v==null?null:j.createElement(ma.Provider,{value:h},j.createElement(Z0.Provider,{children:t,value:v}))}function uw(e){let{children:r,location:t}=e;return Gb(Sd(r),t)}new Promise(()=>{});function Sd(e,r){r===void 0&&(r=[]);let t=[];return j.Children.forEach(e,(n,s)=>{if(!j.isValidElement(n))return;let o=[...r,s];if(n.type===j.Fragment){t.push.apply(t,Sd(n.props.children,o));return}n.type!==qr&&ur(!1),!n.props.index||!n.props.children||ur(!1);let c={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(c.children=Sd(n.props.children,o)),t.push(c)}),t}function P0(){return P0=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},P0.apply(this,arguments)}function o1(e,r){if(e==null)return{};var t={},n=Object.keys(e),s,o;for(o=0;o<n.length;o++)s=n[o],!(r.indexOf(s)>=0)&&(t[s]=e[s]);return t}function fw(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function dw(e,r){return e.button===0&&(!r||r==="_self")&&!fw(e)}const hw=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],xw=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],mw="6";try{window.__reactRouterVersion=mw}catch{}const pw=j.createContext({isTransitioning:!1}),gw="startTransition",up=fb[gw];function vw(e){let{basename:r,children:t,future:n,window:s}=e,o=j.useRef();o.current==null&&(o.current=vb({window:s,v5Compat:!0}));let c=o.current,[u,d]=j.useState({action:c.action,location:c.location}),{v7_startTransition:h}=n||{},m=j.useCallback(p=>{h&&up?up(()=>d(p)):d(p)},[d,h]);return j.useLayoutEffect(()=>c.listen(m),[c,m]),j.useEffect(()=>lw(n),[n]),j.createElement(cw,{basename:r,children:t,location:u.location,navigationType:u.action,navigator:c,future:n})}const yw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",bw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ww=j.forwardRef(function(r,t){let{onClick:n,relative:s,reloadDocument:o,replace:c,state:u,target:d,to:h,preventScrollReset:m,viewTransition:p}=r,y=o1(r,hw),{basename:k}=j.useContext(ma),b,v=!1;if(typeof h=="string"&&bw.test(h)&&(b=h,yw))try{let N=new URL(window.location.href),P=h.startsWith("//")?new URL(N.protocol+h):new URL(h),W=kl(P.pathname,k);P.origin===N.origin&&W!=null?h=W+P.search+P.hash:v=!0}catch{}let w=Wb(h,{relative:s}),S=kw(h,{replace:c,state:u,target:d,preventScrollReset:m,relative:s,viewTransition:p});function I(N){n&&n(N),N.defaultPrevented||S(N)}return j.createElement("a",P0({},y,{href:b||w,onClick:v||o?n:I,ref:t,target:d}))}),fl=j.forwardRef(function(r,t){let{"aria-current":n="page",caseSensitive:s=!1,className:o="",end:c=!1,style:u,to:d,viewTransition:h,children:m}=r,p=o1(r,xw),y=eu(d,{relative:p.relative}),k=Xa(),b=j.useContext(t1),{navigator:v,basename:w}=j.useContext(ma),S=b!=null&&Nw(y)&&h===!0,I=v.encodeLocation?v.encodeLocation(y).pathname:y.pathname,N=k.pathname,P=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;s||(N=N.toLowerCase(),P=P?P.toLowerCase():null,I=I.toLowerCase()),P&&w&&(P=kl(P,w)||P);const W=I!=="/"&&I.endsWith("/")?I.length-1:I.length;let X=N===I||!c&&N.startsWith(I)&&N.charAt(W)==="/",M=P!=null&&(P===I||!c&&P.startsWith(I)&&P.charAt(I.length)==="/"),Z={isActive:X,isPending:M,isTransitioning:S},H=X?n:void 0,ce;typeof o=="function"?ce=o(Z):ce=[o,X?"active":null,M?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let le=typeof u=="function"?u(Z):u;return j.createElement(ww,P0({},p,{"aria-current":H,className:ce,ref:t,style:le,to:d,viewTransition:h}),typeof m=="function"?m(Z):m)});var Ed;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ed||(Ed={}));var fp;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(fp||(fp={}));function _w(e){let r=j.useContext(Q0);return r||ur(!1),r}function kw(e,r){let{target:t,replace:n,state:s,preventScrollReset:o,relative:c,viewTransition:u}=r===void 0?{}:r,d=xs(),h=Xa(),m=eu(e,{relative:c});return j.useCallback(p=>{if(dw(p,t)){p.preventDefault();let y=n!==void 0?n:R0(h)===R0(m);d(e,{replace:y,state:s,preventScrollReset:o,relative:c,viewTransition:u})}},[h,d,m,n,s,t,e,o,c,u])}function Nw(e,r){r===void 0&&(r={});let t=j.useContext(pw);t==null&&ur(!1);let{basename:n}=_w(Ed.useViewTransitionState),s=eu(e,{relative:r.relative});if(!t.isTransitioning)return!1;let o=kl(t.currentLocation.pathname,n)||t.currentLocation.pathname,c=kl(t.nextLocation.pathname,n)||t.nextLocation.pathname;return Nd(s.pathname,c)!=null||Nd(s.pathname,o)!=null}function c1(e,r){return function(){return e.apply(r,arguments)}}const{toString:Sw}=Object.prototype,{getPrototypeOf:Gd}=Object,{iterator:tu,toStringTag:u1}=Symbol,ru=(e=>r=>{const t=Sw.call(r);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Ds=e=>(e=e.toLowerCase(),r=>ru(r)===e),nu=e=>r=>typeof r===e,{isArray:Ol}=Array,Nl=nu("undefined");function rc(e){return e!==null&&!Nl(e)&&e.constructor!==null&&!Nl(e.constructor)&&Rn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const f1=Ds("ArrayBuffer");function Ew(e){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(e):r=e&&e.buffer&&f1(e.buffer),r}const jw=nu("string"),Rn=nu("function"),d1=nu("number"),nc=e=>e!==null&&typeof e=="object",Cw=e=>e===!0||e===!1,O0=e=>{if(ru(e)!=="object")return!1;const r=Gd(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(u1 in e)&&!(tu in e)},Tw=e=>{if(!nc(e)||rc(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Fw=Ds("Date"),Aw=Ds("File"),Ow=Ds("Blob"),Dw=Ds("FileList"),Iw=e=>nc(e)&&Rn(e.pipe),Rw=e=>{let r;return e&&(typeof FormData=="function"&&e instanceof FormData||Rn(e.append)&&((r=ru(e))==="formdata"||r==="object"&&Rn(e.toString)&&e.toString()==="[object FormData]"))},Pw=Ds("URLSearchParams"),[Mw,Lw,Bw,Uw]=["ReadableStream","Request","Response","Headers"].map(Ds),zw=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function sc(e,r,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let n,s;if(typeof e!="object"&&(e=[e]),Ol(e))for(n=0,s=e.length;n<s;n++)r.call(null,e[n],n,e);else{if(rc(e))return;const o=t?Object.getOwnPropertyNames(e):Object.keys(e),c=o.length;let u;for(n=0;n<c;n++)u=o[n],r.call(null,e[u],u,e)}}function h1(e,r){if(rc(e))return null;r=r.toLowerCase();const t=Object.keys(e);let n=t.length,s;for(;n-- >0;)if(s=t[n],r===s.toLowerCase())return s;return null}const vi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,x1=e=>!Nl(e)&&e!==vi;function jd(){const{caseless:e,skipUndefined:r}=x1(this)&&this||{},t={},n=(s,o)=>{const c=e&&h1(t,o)||o;O0(t[c])&&O0(s)?t[c]=jd(t[c],s):O0(s)?t[c]=jd({},s):Ol(s)?t[c]=s.slice():(!r||!Nl(s))&&(t[c]=s)};for(let s=0,o=arguments.length;s<o;s++)arguments[s]&&sc(arguments[s],n);return t}const $w=(e,r,t,{allOwnKeys:n}={})=>(sc(r,(s,o)=>{t&&Rn(s)?e[o]=c1(s,t):e[o]=s},{allOwnKeys:n}),e),Hw=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Ww=(e,r,t,n)=>{e.prototype=Object.create(r.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:r.prototype}),t&&Object.assign(e.prototype,t)},Vw=(e,r,t,n)=>{let s,o,c;const u={};if(r=r||{},e==null)return r;do{for(s=Object.getOwnPropertyNames(e),o=s.length;o-- >0;)c=s[o],(!n||n(c,e,r))&&!u[c]&&(r[c]=e[c],u[c]=!0);e=t!==!1&&Gd(e)}while(e&&(!t||t(e,r))&&e!==Object.prototype);return r},qw=(e,r,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=r.length;const n=e.indexOf(r,t);return n!==-1&&n===t},Xw=e=>{if(!e)return null;if(Ol(e))return e;let r=e.length;if(!d1(r))return null;const t=new Array(r);for(;r-- >0;)t[r]=e[r];return t},Gw=(e=>r=>e&&r instanceof e)(typeof Uint8Array<"u"&&Gd(Uint8Array)),Kw=(e,r)=>{const n=(e&&e[tu]).call(e);let s;for(;(s=n.next())&&!s.done;){const o=s.value;r.call(e,o[0],o[1])}},Yw=(e,r)=>{let t;const n=[];for(;(t=e.exec(r))!==null;)n.push(t);return n},Jw=Ds("HTMLFormElement"),Qw=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,s){return n.toUpperCase()+s}),dp=(({hasOwnProperty:e})=>(r,t)=>e.call(r,t))(Object.prototype),Zw=Ds("RegExp"),m1=(e,r)=>{const t=Object.getOwnPropertyDescriptors(e),n={};sc(t,(s,o)=>{let c;(c=r(s,o,e))!==!1&&(n[o]=c||s)}),Object.defineProperties(e,n)},e_=e=>{m1(e,(r,t)=>{if(Rn(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const n=e[t];if(Rn(n)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},t_=(e,r)=>{const t={},n=s=>{s.forEach(o=>{t[o]=!0})};return Ol(e)?n(e):n(String(e).split(r)),t},r_=()=>{},n_=(e,r)=>e!=null&&Number.isFinite(e=+e)?e:r;function s_(e){return!!(e&&Rn(e.append)&&e[u1]==="FormData"&&e[tu])}const a_=e=>{const r=new Array(10),t=(n,s)=>{if(nc(n)){if(r.indexOf(n)>=0)return;if(rc(n))return n;if(!("toJSON"in n)){r[s]=n;const o=Ol(n)?[]:{};return sc(n,(c,u)=>{const d=t(c,s+1);!Nl(d)&&(o[u]=d)}),r[s]=void 0,o}}return n};return t(e,0)},i_=Ds("AsyncFunction"),l_=e=>e&&(nc(e)||Rn(e))&&Rn(e.then)&&Rn(e.catch),p1=((e,r)=>e?setImmediate:r?((t,n)=>(vi.addEventListener("message",({source:s,data:o})=>{s===vi&&o===t&&n.length&&n.shift()()},!1),s=>{n.push(s),vi.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Rn(vi.postMessage)),o_=typeof queueMicrotask<"u"?queueMicrotask.bind(vi):typeof process<"u"&&process.nextTick||p1,c_=e=>e!=null&&Rn(e[tu]),be={isArray:Ol,isArrayBuffer:f1,isBuffer:rc,isFormData:Rw,isArrayBufferView:Ew,isString:jw,isNumber:d1,isBoolean:Cw,isObject:nc,isPlainObject:O0,isEmptyObject:Tw,isReadableStream:Mw,isRequest:Lw,isResponse:Bw,isHeaders:Uw,isUndefined:Nl,isDate:Fw,isFile:Aw,isBlob:Ow,isRegExp:Zw,isFunction:Rn,isStream:Iw,isURLSearchParams:Pw,isTypedArray:Gw,isFileList:Dw,forEach:sc,merge:jd,extend:$w,trim:zw,stripBOM:Hw,inherits:Ww,toFlatObject:Vw,kindOf:ru,kindOfTest:Ds,endsWith:qw,toArray:Xw,forEachEntry:Kw,matchAll:Yw,isHTMLForm:Jw,hasOwnProperty:dp,hasOwnProp:dp,reduceDescriptors:m1,freezeMethods:e_,toObjectSet:t_,toCamelCase:Qw,noop:r_,toFiniteNumber:n_,findKey:h1,global:vi,isContextDefined:x1,isSpecCompliantForm:s_,toJSONObject:a_,isAsyncFn:i_,isThenable:l_,setImmediate:p1,asap:o_,isIterable:c_};function pt(e,r,t,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",r&&(this.code=r),t&&(this.config=t),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}be.inherits(pt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:be.toJSONObject(this.config),code:this.code,status:this.status}}});const g1=pt.prototype,v1={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{v1[e]={value:e}});Object.defineProperties(pt,v1);Object.defineProperty(g1,"isAxiosError",{value:!0});pt.from=(e,r,t,n,s,o)=>{const c=Object.create(g1);be.toFlatObject(e,c,function(m){return m!==Error.prototype},h=>h!=="isAxiosError");const u=e&&e.message?e.message:"Error",d=r==null&&e?e.code:r;return pt.call(c,u,d,t,n,s),e&&c.cause==null&&Object.defineProperty(c,"cause",{value:e,configurable:!0}),c.name=e&&e.name||"Error",o&&Object.assign(c,o),c};const u_=null;function Cd(e){return be.isPlainObject(e)||be.isArray(e)}function y1(e){return be.endsWith(e,"[]")?e.slice(0,-2):e}function hp(e,r,t){return e?e.concat(r).map(function(s,o){return s=y1(s),!t&&o?"["+s+"]":s}).join(t?".":""):r}function f_(e){return be.isArray(e)&&!e.some(Cd)}const d_=be.toFlatObject(be,{},null,function(r){return/^is[A-Z]/.test(r)});function su(e,r,t){if(!be.isObject(e))throw new TypeError("target must be an object");r=r||new FormData,t=be.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,w){return!be.isUndefined(w[v])});const n=t.metaTokens,s=t.visitor||m,o=t.dots,c=t.indexes,d=(t.Blob||typeof Blob<"u"&&Blob)&&be.isSpecCompliantForm(r);if(!be.isFunction(s))throw new TypeError("visitor must be a function");function h(b){if(b===null)return"";if(be.isDate(b))return b.toISOString();if(be.isBoolean(b))return b.toString();if(!d&&be.isBlob(b))throw new pt("Blob is not supported. Use a Buffer instead.");return be.isArrayBuffer(b)||be.isTypedArray(b)?d&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function m(b,v,w){let S=b;if(b&&!w&&typeof b=="object"){if(be.endsWith(v,"{}"))v=n?v:v.slice(0,-2),b=JSON.stringify(b);else if(be.isArray(b)&&f_(b)||(be.isFileList(b)||be.endsWith(v,"[]"))&&(S=be.toArray(b)))return v=y1(v),S.forEach(function(N,P){!(be.isUndefined(N)||N===null)&&r.append(c===!0?hp([v],P,o):c===null?v:v+"[]",h(N))}),!1}return Cd(b)?!0:(r.append(hp(w,v,o),h(b)),!1)}const p=[],y=Object.assign(d_,{defaultVisitor:m,convertValue:h,isVisitable:Cd});function k(b,v){if(!be.isUndefined(b)){if(p.indexOf(b)!==-1)throw Error("Circular reference detected in "+v.join("."));p.push(b),be.forEach(b,function(S,I){(!(be.isUndefined(S)||S===null)&&s.call(r,S,be.isString(I)?I.trim():I,v,y))===!0&&k(S,v?v.concat(I):[I])}),p.pop()}}if(!be.isObject(e))throw new TypeError("data must be an object");return k(e),r}function xp(e){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return r[n]})}function Kd(e,r){this._pairs=[],e&&su(e,this,r)}const b1=Kd.prototype;b1.append=function(r,t){this._pairs.push([r,t])};b1.toString=function(r){const t=r?function(n){return r.call(this,n,xp)}:xp;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function h_(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function w1(e,r,t){if(!r)return e;const n=t&&t.encode||h_;be.isFunction(t)&&(t={serialize:t});const s=t&&t.serialize;let o;if(s?o=s(r,t):o=be.isURLSearchParams(r)?r.toString():new Kd(r,t).toString(n),o){const c=e.indexOf("#");c!==-1&&(e=e.slice(0,c)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class mp{constructor(){this.handlers=[]}use(r,t,n){return this.handlers.push({fulfilled:r,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){be.forEach(this.handlers,function(n){n!==null&&r(n)})}}const _1={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},x_=typeof URLSearchParams<"u"?URLSearchParams:Kd,m_=typeof FormData<"u"?FormData:null,p_=typeof Blob<"u"?Blob:null,g_={isBrowser:!0,classes:{URLSearchParams:x_,FormData:m_,Blob:p_},protocols:["http","https","file","blob","url","data"]},Yd=typeof window<"u"&&typeof document<"u",Td=typeof navigator=="object"&&navigator||void 0,v_=Yd&&(!Td||["ReactNative","NativeScript","NS"].indexOf(Td.product)<0),y_=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",b_=Yd&&window.location.href||"http://localhost",w_=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Yd,hasStandardBrowserEnv:v_,hasStandardBrowserWebWorkerEnv:y_,navigator:Td,origin:b_},Symbol.toStringTag,{value:"Module"})),dn={...w_,...g_};function __(e,r){return su(e,new dn.classes.URLSearchParams,{visitor:function(t,n,s,o){return dn.isNode&&be.isBuffer(t)?(this.append(n,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...r})}function k_(e){return be.matchAll(/\w+|\[(\w*)]/g,e).map(r=>r[0]==="[]"?"":r[1]||r[0])}function N_(e){const r={},t=Object.keys(e);let n;const s=t.length;let o;for(n=0;n<s;n++)o=t[n],r[o]=e[o];return r}function k1(e){function r(t,n,s,o){let c=t[o++];if(c==="__proto__")return!0;const u=Number.isFinite(+c),d=o>=t.length;return c=!c&&be.isArray(s)?s.length:c,d?(be.hasOwnProp(s,c)?s[c]=[s[c],n]:s[c]=n,!u):((!s[c]||!be.isObject(s[c]))&&(s[c]=[]),r(t,n,s[c],o)&&be.isArray(s[c])&&(s[c]=N_(s[c])),!u)}if(be.isFormData(e)&&be.isFunction(e.entries)){const t={};return be.forEachEntry(e,(n,s)=>{r(k_(n),s,t,0)}),t}return null}function S_(e,r,t){if(be.isString(e))try{return(r||JSON.parse)(e),be.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(t||JSON.stringify)(e)}const ac={transitional:_1,adapter:["xhr","http","fetch"],transformRequest:[function(r,t){const n=t.getContentType()||"",s=n.indexOf("application/json")>-1,o=be.isObject(r);if(o&&be.isHTMLForm(r)&&(r=new FormData(r)),be.isFormData(r))return s?JSON.stringify(k1(r)):r;if(be.isArrayBuffer(r)||be.isBuffer(r)||be.isStream(r)||be.isFile(r)||be.isBlob(r)||be.isReadableStream(r))return r;if(be.isArrayBufferView(r))return r.buffer;if(be.isURLSearchParams(r))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let u;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return __(r,this.formSerializer).toString();if((u=be.isFileList(r))||n.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return su(u?{"files[]":r}:r,d&&new d,this.formSerializer)}}return o||s?(t.setContentType("application/json",!1),S_(r)):r}],transformResponse:[function(r){const t=this.transitional||ac.transitional,n=t&&t.forcedJSONParsing,s=this.responseType==="json";if(be.isResponse(r)||be.isReadableStream(r))return r;if(r&&be.isString(r)&&(n&&!this.responseType||s)){const c=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(r,this.parseReviver)}catch(u){if(c)throw u.name==="SyntaxError"?pt.from(u,pt.ERR_BAD_RESPONSE,this,null,this.response):u}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:dn.classes.FormData,Blob:dn.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};be.forEach(["delete","get","head","post","put","patch"],e=>{ac.headers[e]={}});const E_=be.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),j_=e=>{const r={};let t,n,s;return e&&e.split(`
`).forEach(function(c){s=c.indexOf(":"),t=c.substring(0,s).trim().toLowerCase(),n=c.substring(s+1).trim(),!(!t||r[t]&&E_[t])&&(t==="set-cookie"?r[t]?r[t].push(n):r[t]=[n]:r[t]=r[t]?r[t]+", "+n:n)}),r},pp=Symbol("internals");function No(e){return e&&String(e).trim().toLowerCase()}function D0(e){return e===!1||e==null?e:be.isArray(e)?e.map(D0):String(e)}function C_(e){const r=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=t.exec(e);)r[n[1]]=n[2];return r}const T_=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function nd(e,r,t,n,s){if(be.isFunction(n))return n.call(this,r,t);if(s&&(r=t),!!be.isString(r)){if(be.isString(n))return r.indexOf(n)!==-1;if(be.isRegExp(n))return n.test(r)}}function F_(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,t,n)=>t.toUpperCase()+n)}function A_(e,r){const t=be.toCamelCase(" "+r);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+t,{value:function(s,o,c){return this[n].call(this,r,s,o,c)},configurable:!0})})}let Pn=class{constructor(r){r&&this.set(r)}set(r,t,n){const s=this;function o(u,d,h){const m=No(d);if(!m)throw new Error("header name must be a non-empty string");const p=be.findKey(s,m);(!p||s[p]===void 0||h===!0||h===void 0&&s[p]!==!1)&&(s[p||d]=D0(u))}const c=(u,d)=>be.forEach(u,(h,m)=>o(h,m,d));if(be.isPlainObject(r)||r instanceof this.constructor)c(r,t);else if(be.isString(r)&&(r=r.trim())&&!T_(r))c(j_(r),t);else if(be.isObject(r)&&be.isIterable(r)){let u={},d,h;for(const m of r){if(!be.isArray(m))throw TypeError("Object iterator must return a key-value pair");u[h=m[0]]=(d=u[h])?be.isArray(d)?[...d,m[1]]:[d,m[1]]:m[1]}c(u,t)}else r!=null&&o(t,r,n);return this}get(r,t){if(r=No(r),r){const n=be.findKey(this,r);if(n){const s=this[n];if(!t)return s;if(t===!0)return C_(s);if(be.isFunction(t))return t.call(this,s,n);if(be.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,t){if(r=No(r),r){const n=be.findKey(this,r);return!!(n&&this[n]!==void 0&&(!t||nd(this,this[n],n,t)))}return!1}delete(r,t){const n=this;let s=!1;function o(c){if(c=No(c),c){const u=be.findKey(n,c);u&&(!t||nd(n,n[u],u,t))&&(delete n[u],s=!0)}}return be.isArray(r)?r.forEach(o):o(r),s}clear(r){const t=Object.keys(this);let n=t.length,s=!1;for(;n--;){const o=t[n];(!r||nd(this,this[o],o,r,!0))&&(delete this[o],s=!0)}return s}normalize(r){const t=this,n={};return be.forEach(this,(s,o)=>{const c=be.findKey(n,o);if(c){t[c]=D0(s),delete t[o];return}const u=r?F_(o):String(o).trim();u!==o&&delete t[o],t[u]=D0(s),n[u]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const t=Object.create(null);return be.forEach(this,(n,s)=>{n!=null&&n!==!1&&(t[s]=r&&be.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,t])=>r+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...t){const n=new this(r);return t.forEach(s=>n.set(s)),n}static accessor(r){const n=(this[pp]=this[pp]={accessors:{}}).accessors,s=this.prototype;function o(c){const u=No(c);n[u]||(A_(s,c),n[u]=!0)}return be.isArray(r)?r.forEach(o):o(r),this}};Pn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);be.reduceDescriptors(Pn.prototype,({value:e},r)=>{let t=r[0].toUpperCase()+r.slice(1);return{get:()=>e,set(n){this[t]=n}}});be.freezeMethods(Pn);function sd(e,r){const t=this||ac,n=r||t,s=Pn.from(n.headers);let o=n.data;return be.forEach(e,function(u){o=u.call(t,o,s.normalize(),r?r.status:void 0)}),s.normalize(),o}function N1(e){return!!(e&&e.__CANCEL__)}function Dl(e,r,t){pt.call(this,e??"canceled",pt.ERR_CANCELED,r,t),this.name="CanceledError"}be.inherits(Dl,pt,{__CANCEL__:!0});function S1(e,r,t){const n=t.config.validateStatus;!t.status||!n||n(t.status)?e(t):r(new pt("Request failed with status code "+t.status,[pt.ERR_BAD_REQUEST,pt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function O_(e){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return r&&r[1]||""}function D_(e,r){e=e||10;const t=new Array(e),n=new Array(e);let s=0,o=0,c;return r=r!==void 0?r:1e3,function(d){const h=Date.now(),m=n[o];c||(c=h),t[s]=d,n[s]=h;let p=o,y=0;for(;p!==s;)y+=t[p++],p=p%e;if(s=(s+1)%e,s===o&&(o=(o+1)%e),h-c<r)return;const k=m&&h-m;return k?Math.round(y*1e3/k):void 0}}function I_(e,r){let t=0,n=1e3/r,s,o;const c=(h,m=Date.now())=>{t=m,s=null,o&&(clearTimeout(o),o=null),e(...h)};return[(...h)=>{const m=Date.now(),p=m-t;p>=n?c(h,m):(s=h,o||(o=setTimeout(()=>{o=null,c(s)},n-p)))},()=>s&&c(s)]}const M0=(e,r,t=3)=>{let n=0;const s=D_(50,250);return I_(o=>{const c=o.loaded,u=o.lengthComputable?o.total:void 0,d=c-n,h=s(d),m=c<=u;n=c;const p={loaded:c,total:u,progress:u?c/u:void 0,bytes:d,rate:h||void 0,estimated:h&&u&&m?(u-c)/h:void 0,event:o,lengthComputable:u!=null,[r?"download":"upload"]:!0};e(p)},t)},gp=(e,r)=>{const t=e!=null;return[n=>r[0]({lengthComputable:t,total:e,loaded:n}),r[1]]},vp=e=>(...r)=>be.asap(()=>e(...r)),R_=dn.hasStandardBrowserEnv?((e,r)=>t=>(t=new URL(t,dn.origin),e.protocol===t.protocol&&e.host===t.host&&(r||e.port===t.port)))(new URL(dn.origin),dn.navigator&&/(msie|trident)/i.test(dn.navigator.userAgent)):()=>!0,P_=dn.hasStandardBrowserEnv?{write(e,r,t,n,s,o,c){if(typeof document>"u")return;const u=[`${e}=${encodeURIComponent(r)}`];be.isNumber(t)&&u.push(`expires=${new Date(t).toUTCString()}`),be.isString(n)&&u.push(`path=${n}`),be.isString(s)&&u.push(`domain=${s}`),o===!0&&u.push("secure"),be.isString(c)&&u.push(`SameSite=${c}`),document.cookie=u.join("; ")},read(e){if(typeof document>"u")return null;const r=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return r?decodeURIComponent(r[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function M_(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function L_(e,r){return r?e.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):e}function E1(e,r,t){let n=!M_(r);return e&&(n||t==!1)?L_(e,r):r}const yp=e=>e instanceof Pn?{...e}:e;function Si(e,r){r=r||{};const t={};function n(h,m,p,y){return be.isPlainObject(h)&&be.isPlainObject(m)?be.merge.call({caseless:y},h,m):be.isPlainObject(m)?be.merge({},m):be.isArray(m)?m.slice():m}function s(h,m,p,y){if(be.isUndefined(m)){if(!be.isUndefined(h))return n(void 0,h,p,y)}else return n(h,m,p,y)}function o(h,m){if(!be.isUndefined(m))return n(void 0,m)}function c(h,m){if(be.isUndefined(m)){if(!be.isUndefined(h))return n(void 0,h)}else return n(void 0,m)}function u(h,m,p){if(p in r)return n(h,m);if(p in e)return n(void 0,h)}const d={url:o,method:o,data:o,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u,headers:(h,m,p)=>s(yp(h),yp(m),p,!0)};return be.forEach(Object.keys({...e,...r}),function(m){const p=d[m]||s,y=p(e[m],r[m],m);be.isUndefined(y)&&p!==u||(t[m]=y)}),t}const j1=e=>{const r=Si({},e);let{data:t,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:o,headers:c,auth:u}=r;if(r.headers=c=Pn.from(c),r.url=w1(E1(r.baseURL,r.url,r.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&c.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),be.isFormData(t)){if(dn.hasStandardBrowserEnv||dn.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if(be.isFunction(t.getHeaders)){const d=t.getHeaders(),h=["content-type","content-length"];Object.entries(d).forEach(([m,p])=>{h.includes(m.toLowerCase())&&c.set(m,p)})}}if(dn.hasStandardBrowserEnv&&(n&&be.isFunction(n)&&(n=n(r)),n||n!==!1&&R_(r.url))){const d=s&&o&&P_.read(o);d&&c.set(s,d)}return r},B_=typeof XMLHttpRequest<"u",U_=B_&&function(e){return new Promise(function(t,n){const s=j1(e);let o=s.data;const c=Pn.from(s.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:h}=s,m,p,y,k,b;function v(){k&&k(),b&&b(),s.cancelToken&&s.cancelToken.unsubscribe(m),s.signal&&s.signal.removeEventListener("abort",m)}let w=new XMLHttpRequest;w.open(s.method.toUpperCase(),s.url,!0),w.timeout=s.timeout;function S(){if(!w)return;const N=Pn.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),W={data:!u||u==="text"||u==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:N,config:e,request:w};S1(function(M){t(M),v()},function(M){n(M),v()},W),w=null}"onloadend"in w?w.onloadend=S:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(S)},w.onabort=function(){w&&(n(new pt("Request aborted",pt.ECONNABORTED,e,w)),w=null)},w.onerror=function(P){const W=P&&P.message?P.message:"Network Error",X=new pt(W,pt.ERR_NETWORK,e,w);X.event=P||null,n(X),w=null},w.ontimeout=function(){let P=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const W=s.transitional||_1;s.timeoutErrorMessage&&(P=s.timeoutErrorMessage),n(new pt(P,W.clarifyTimeoutError?pt.ETIMEDOUT:pt.ECONNABORTED,e,w)),w=null},o===void 0&&c.setContentType(null),"setRequestHeader"in w&&be.forEach(c.toJSON(),function(P,W){w.setRequestHeader(W,P)}),be.isUndefined(s.withCredentials)||(w.withCredentials=!!s.withCredentials),u&&u!=="json"&&(w.responseType=s.responseType),h&&([y,b]=M0(h,!0),w.addEventListener("progress",y)),d&&w.upload&&([p,k]=M0(d),w.upload.addEventListener("progress",p),w.upload.addEventListener("loadend",k)),(s.cancelToken||s.signal)&&(m=N=>{w&&(n(!N||N.type?new Dl(null,e,w):N),w.abort(),w=null)},s.cancelToken&&s.cancelToken.subscribe(m),s.signal&&(s.signal.aborted?m():s.signal.addEventListener("abort",m)));const I=O_(s.url);if(I&&dn.protocols.indexOf(I)===-1){n(new pt("Unsupported protocol "+I+":",pt.ERR_BAD_REQUEST,e));return}w.send(o||null)})},z_=(e,r)=>{const{length:t}=e=e?e.filter(Boolean):[];if(r||t){let n=new AbortController,s;const o=function(h){if(!s){s=!0,u();const m=h instanceof Error?h:this.reason;n.abort(m instanceof pt?m:new Dl(m instanceof Error?m.message:m))}};let c=r&&setTimeout(()=>{c=null,o(new pt(`timeout ${r} of ms exceeded`,pt.ETIMEDOUT))},r);const u=()=>{e&&(c&&clearTimeout(c),c=null,e.forEach(h=>{h.unsubscribe?h.unsubscribe(o):h.removeEventListener("abort",o)}),e=null)};e.forEach(h=>h.addEventListener("abort",o));const{signal:d}=n;return d.unsubscribe=()=>be.asap(u),d}},$_=function*(e,r){let t=e.byteLength;if(t<r){yield e;return}let n=0,s;for(;n<t;)s=n+r,yield e.slice(n,s),n=s},H_=async function*(e,r){for await(const t of W_(e))yield*$_(t,r)},W_=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const r=e.getReader();try{for(;;){const{done:t,value:n}=await r.read();if(t)break;yield n}}finally{await r.cancel()}},bp=(e,r,t,n)=>{const s=H_(e,r);let o=0,c,u=d=>{c||(c=!0,n&&n(d))};return new ReadableStream({async pull(d){try{const{done:h,value:m}=await s.next();if(h){u(),d.close();return}let p=m.byteLength;if(t){let y=o+=p;t(y)}d.enqueue(new Uint8Array(m))}catch(h){throw u(h),h}},cancel(d){return u(d),s.return()}},{highWaterMark:2})},wp=64*1024,{isFunction:b0}=be,V_=(({Request:e,Response:r})=>({Request:e,Response:r}))(be.global),{ReadableStream:_p,TextEncoder:kp}=be.global,Np=(e,...r)=>{try{return!!e(...r)}catch{return!1}},q_=e=>{e=be.merge.call({skipUndefined:!0},V_,e);const{fetch:r,Request:t,Response:n}=e,s=r?b0(r):typeof fetch=="function",o=b0(t),c=b0(n);if(!s)return!1;const u=s&&b0(_p),d=s&&(typeof kp=="function"?(b=>v=>b.encode(v))(new kp):async b=>new Uint8Array(await new t(b).arrayBuffer())),h=o&&u&&Np(()=>{let b=!1;const v=new t(dn.origin,{body:new _p,method:"POST",get duplex(){return b=!0,"half"}}).headers.has("Content-Type");return b&&!v}),m=c&&u&&Np(()=>be.isReadableStream(new n("").body)),p={stream:m&&(b=>b.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(b=>{!p[b]&&(p[b]=(v,w)=>{let S=v&&v[b];if(S)return S.call(v);throw new pt(`Response type '${b}' is not supported`,pt.ERR_NOT_SUPPORT,w)})});const y=async b=>{if(b==null)return 0;if(be.isBlob(b))return b.size;if(be.isSpecCompliantForm(b))return(await new t(dn.origin,{method:"POST",body:b}).arrayBuffer()).byteLength;if(be.isArrayBufferView(b)||be.isArrayBuffer(b))return b.byteLength;if(be.isURLSearchParams(b)&&(b=b+""),be.isString(b))return(await d(b)).byteLength},k=async(b,v)=>{const w=be.toFiniteNumber(b.getContentLength());return w??y(v)};return async b=>{let{url:v,method:w,data:S,signal:I,cancelToken:N,timeout:P,onDownloadProgress:W,onUploadProgress:X,responseType:M,headers:Z,withCredentials:H="same-origin",fetchOptions:ce}=j1(b),le=r||fetch;M=M?(M+"").toLowerCase():"text";let re=z_([I,N&&N.toAbortSignal()],P),te=null;const ve=re&&re.unsubscribe&&(()=>{re.unsubscribe()});let Se;try{if(X&&h&&w!=="get"&&w!=="head"&&(Se=await k(Z,S))!==0){let z=new t(v,{method:"POST",body:S,duplex:"half"}),T;if(be.isFormData(S)&&(T=z.headers.get("content-type"))&&Z.setContentType(T),z.body){const[Q,Y]=gp(Se,M0(vp(X)));S=bp(z.body,wp,Q,Y)}}be.isString(H)||(H=H?"include":"omit");const Ce=o&&"credentials"in t.prototype,ue={...ce,signal:re,method:w.toUpperCase(),headers:Z.normalize().toJSON(),body:S,duplex:"half",credentials:Ce?H:void 0};te=o&&new t(v,ue);let ne=await(o?le(te,ce):le(v,ue));const A=m&&(M==="stream"||M==="response");if(m&&(W||A&&ve)){const z={};["status","statusText","headers"].forEach(J=>{z[J]=ne[J]});const T=be.toFiniteNumber(ne.headers.get("content-length")),[Q,Y]=W&&gp(T,M0(vp(W),!0))||[];ne=new n(bp(ne.body,wp,Q,()=>{Y&&Y(),ve&&ve()}),z)}M=M||"text";let me=await p[be.findKey(p,M)||"text"](ne,b);return!A&&ve&&ve(),await new Promise((z,T)=>{S1(z,T,{data:me,headers:Pn.from(ne.headers),status:ne.status,statusText:ne.statusText,config:b,request:te})})}catch(Ce){throw ve&&ve(),Ce&&Ce.name==="TypeError"&&/Load failed|fetch/i.test(Ce.message)?Object.assign(new pt("Network Error",pt.ERR_NETWORK,b,te),{cause:Ce.cause||Ce}):pt.from(Ce,Ce&&Ce.code,b,te)}}},X_=new Map,C1=e=>{let r=e&&e.env||{};const{fetch:t,Request:n,Response:s}=r,o=[n,s,t];let c=o.length,u=c,d,h,m=X_;for(;u--;)d=o[u],h=m.get(d),h===void 0&&m.set(d,h=u?new Map:q_(r)),m=h;return h};C1();const Jd={http:u_,xhr:U_,fetch:{get:C1}};be.forEach(Jd,(e,r)=>{if(e){try{Object.defineProperty(e,"name",{value:r})}catch{}Object.defineProperty(e,"adapterName",{value:r})}});const Sp=e=>`- ${e}`,G_=e=>be.isFunction(e)||e===null||e===!1;function K_(e,r){e=be.isArray(e)?e:[e];const{length:t}=e;let n,s;const o={};for(let c=0;c<t;c++){n=e[c];let u;if(s=n,!G_(n)&&(s=Jd[(u=String(n)).toLowerCase()],s===void 0))throw new pt(`Unknown adapter '${u}'`);if(s&&(be.isFunction(s)||(s=s.get(r))))break;o[u||"#"+c]=s}if(!s){const c=Object.entries(o).map(([d,h])=>`adapter ${d} `+(h===!1?"is not supported by the environment":"is not available in the build"));let u=t?c.length>1?`since :
`+c.map(Sp).join(`
`):" "+Sp(c[0]):"as no adapter specified";throw new pt("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return s}const T1={getAdapter:K_,adapters:Jd};function ad(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Dl(null,e)}function Ep(e){return ad(e),e.headers=Pn.from(e.headers),e.data=sd.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),T1.getAdapter(e.adapter||ac.adapter,e)(e).then(function(n){return ad(e),n.data=sd.call(e,e.transformResponse,n),n.headers=Pn.from(n.headers),n},function(n){return N1(n)||(ad(e),n&&n.response&&(n.response.data=sd.call(e,e.transformResponse,n.response),n.response.headers=Pn.from(n.response.headers))),Promise.reject(n)})}const F1="1.13.2",au={};["object","boolean","number","function","string","symbol"].forEach((e,r)=>{au[e]=function(n){return typeof n===e||"a"+(r<1?"n ":" ")+e}});const jp={};au.transitional=function(r,t,n){function s(o,c){return"[Axios v"+F1+"] Transitional option '"+o+"'"+c+(n?". "+n:"")}return(o,c,u)=>{if(r===!1)throw new pt(s(c," has been removed"+(t?" in "+t:"")),pt.ERR_DEPRECATED);return t&&!jp[c]&&(jp[c]=!0,console.warn(s(c," has been deprecated since v"+t+" and will be removed in the near future"))),r?r(o,c,u):!0}};au.spelling=function(r){return(t,n)=>(console.warn(`${n} is likely a misspelling of ${r}`),!0)};function Y_(e,r,t){if(typeof e!="object")throw new pt("options must be an object",pt.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let s=n.length;for(;s-- >0;){const o=n[s],c=r[o];if(c){const u=e[o],d=u===void 0||c(u,o,e);if(d!==!0)throw new pt("option "+o+" must be "+d,pt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new pt("Unknown option "+o,pt.ERR_BAD_OPTION)}}const I0={assertOptions:Y_,validators:au},zs=I0.validators;let bi=class{constructor(r){this.defaults=r||{},this.interceptors={request:new mp,response:new mp}}async request(r,t){try{return await this._request(r,t)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const o=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?o&&!String(n.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+o):n.stack=o}catch{}}throw n}}_request(r,t){typeof r=="string"?(t=t||{},t.url=r):t=r||{},t=Si(this.defaults,t);const{transitional:n,paramsSerializer:s,headers:o}=t;n!==void 0&&I0.assertOptions(n,{silentJSONParsing:zs.transitional(zs.boolean),forcedJSONParsing:zs.transitional(zs.boolean),clarifyTimeoutError:zs.transitional(zs.boolean)},!1),s!=null&&(be.isFunction(s)?t.paramsSerializer={serialize:s}:I0.assertOptions(s,{encode:zs.function,serialize:zs.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),I0.assertOptions(t,{baseUrl:zs.spelling("baseURL"),withXsrfToken:zs.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let c=o&&be.merge(o.common,o[t.method]);o&&be.forEach(["delete","get","head","post","put","patch","common"],b=>{delete o[b]}),t.headers=Pn.concat(c,o);const u=[];let d=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(t)===!1||(d=d&&v.synchronous,u.unshift(v.fulfilled,v.rejected))});const h=[];this.interceptors.response.forEach(function(v){h.push(v.fulfilled,v.rejected)});let m,p=0,y;if(!d){const b=[Ep.bind(this),void 0];for(b.unshift(...u),b.push(...h),y=b.length,m=Promise.resolve(t);p<y;)m=m.then(b[p++],b[p++]);return m}y=u.length;let k=t;for(;p<y;){const b=u[p++],v=u[p++];try{k=b(k)}catch(w){v.call(this,w);break}}try{m=Ep.call(this,k)}catch(b){return Promise.reject(b)}for(p=0,y=h.length;p<y;)m=m.then(h[p++],h[p++]);return m}getUri(r){r=Si(this.defaults,r);const t=E1(r.baseURL,r.url,r.allowAbsoluteUrls);return w1(t,r.params,r.paramsSerializer)}};be.forEach(["delete","get","head","options"],function(r){bi.prototype[r]=function(t,n){return this.request(Si(n||{},{method:r,url:t,data:(n||{}).data}))}});be.forEach(["post","put","patch"],function(r){function t(n){return function(o,c,u){return this.request(Si(u||{},{method:r,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:c}))}}bi.prototype[r]=t(),bi.prototype[r+"Form"]=t(!0)});let J_=class A1{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const n=this;this.promise.then(s=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](s);n._listeners=null}),this.promise.then=s=>{let o;const c=new Promise(u=>{n.subscribe(u),o=u}).then(s);return c.cancel=function(){n.unsubscribe(o)},c},r(function(o,c,u){n.reason||(n.reason=new Dl(o,c,u),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const t=this._listeners.indexOf(r);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const r=new AbortController,t=n=>{r.abort(n)};return this.subscribe(t),r.signal.unsubscribe=()=>this.unsubscribe(t),r.signal}static source(){let r;return{token:new A1(function(s){r=s}),cancel:r}}};function Q_(e){return function(t){return e.apply(null,t)}}function Z_(e){return be.isObject(e)&&e.isAxiosError===!0}const Fd={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Fd).forEach(([e,r])=>{Fd[r]=e});function O1(e){const r=new bi(e),t=c1(bi.prototype.request,r);return be.extend(t,bi.prototype,r,{allOwnKeys:!0}),be.extend(t,r,null,{allOwnKeys:!0}),t.create=function(s){return O1(Si(e,s))},t}const _r=O1(ac);_r.Axios=bi;_r.CanceledError=Dl;_r.CancelToken=J_;_r.isCancel=N1;_r.VERSION=F1;_r.toFormData=su;_r.AxiosError=pt;_r.Cancel=_r.CanceledError;_r.all=function(r){return Promise.all(r)};_r.spread=Q_;_r.isAxiosError=Z_;_r.mergeConfig=Si;_r.AxiosHeaders=Pn;_r.formToJSON=e=>k1(be.isHTMLForm(e)?new FormData(e):e);_r.getAdapter=T1.getAdapter;_r.HttpStatusCode=Fd;_r.default=_r;const{Axios:FD,AxiosError:AD,CanceledError:OD,isCancel:DD,CancelToken:ID,VERSION:RD,all:PD,Cancel:MD,isAxiosError:LD,spread:BD,toFormData:UD,AxiosHeaders:zD,HttpStatusCode:$D,formToJSON:HD,getAdapter:WD,mergeConfig:VD}=_r,D1="https://nback-production-54ff.up.railway.app".replace("/api",""),ek=`${D1}/api`,Ad=`${D1}/uploads`,Be=_r.create({baseURL:ek,headers:{"Content-Type":"application/json"}});Be.interceptors.request.use(e=>{const r=localStorage.getItem("token");return r&&(e.headers.Authorization=`Bearer ${r}`),e},e=>Promise.reject(e));Be.interceptors.response.use(e=>e,e=>(e.response&&e.response.status===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)));const tk=e=>Be.post("/auth/login",e),rk=()=>Be.get("/auth/me"),ic=(e="",r="")=>{const t={};return e&&(t.name=e),r&&(t.responsibleId=r),Be.get("/clients",{params:t})},nk=e=>Be.get(`/clients/${e}`),sk=e=>Be.post("/clients",e),ak=(e,r)=>Be.put(`/clients/${e}`,r),ik=e=>Be.post("/clients/bulk-upload",e),lk=e=>Be.post("/client-objects/bulk-upload",e),ok=()=>Be.get("/client-attributes"),ck=()=>Be.get("/client-attributes/enabled"),uk=e=>Be.post("/client-attributes",e),fk=(e,r)=>Be.put(`/client-attributes/${e}`,r),dk=e=>Be.delete(`/client-attributes/${e}`),I1=(e={})=>Be.get("/bids",{params:e}),hk=e=>Be.get(`/bids/${e}`),xk=e=>Be.post("/bids",e),Cp=(e,r)=>Be.put(`/bids/${e}`,r),mk=e=>Be.get(`/bids/${e}/comments`),pk=(e,r)=>Be.post(`/bids/${e}/comments`,r),gk=(e,r,t)=>Be.put(`/bids/${e}/comments/${r}`,t),vk=(e,r)=>Be.delete(`/bids/${e}/comments/${r}`),yk=e=>Be.get(`/bids/${e}/files`),bk=async(e,r)=>{const t=new FormData;for(const n of r)t.append("files",n);return Be.post(`/bids/${e}/files`,t,{headers:{"Content-Type":"multipart/form-data"}})},Tp=(e,r)=>Be.delete(`/bids/${e}/files/${encodeURIComponent(r)}`),R1=()=>Be.get("/bid-types"),wk=e=>Be.post("/bid-types",e),_k=(e,r)=>Be.put(`/bid-types/${e}`,r),kk=e=>Be.delete(`/bid-types/${e}`),Nk=e=>Be.get(`/bid-types/${e}/statuses`),Sk=e=>Be.get(`/bid-types/${e}/transitions`),Qd=()=>Be.get("/equipment"),Ek=e=>Be.post("/equipment",e),jk=(e,r)=>Be.put(`/equipment/${e}`,r),Ck=e=>Be.delete(`/equipment/${e}`),Tk=async(e,r)=>{const t=new FormData;for(const n of r)t.append("images",n);return Be.post(`/equipment/${e}/images`,t,{headers:{"Content-Type":"multipart/form-data"}})},Fk=(e,r)=>Be.delete(`/equipment/${e}/images/${encodeURIComponent(r)}`),Ak=e=>Be.get(`/bid-equipment/bid/${e}`),Ok=()=>Be.get("/bid-equipment/expense-history"),Dk=()=>Be.get("/bid-equipment/return-history"),Ik=e=>Be.post("/bid-equipment",e),Rk=(e,r)=>Be.put(`/bid-equipment/${e}`,r),Pk=(e,r)=>Be.delete(`/bid-equipment/${e}`,{data:{returnReason:r}}),P1=e=>Be.get(`/client-equipment/client/${e}`),M1=e=>Be.post("/client-equipment",e),Mk=e=>Be.delete(`/client-equipment/${e}`),Lk=e=>Be.post("/suppliers",e),Ga=()=>Be.get("/users"),Bk=e=>Be.post("/users",e),Uk=(e,r)=>Be.put(`/users/${e}`,r),zk=e=>Be.delete(`/users/${e}`),L1=()=>Be.get("/roles"),$k=e=>Be.post("/roles",e),Hk=(e,r)=>Be.put(`/roles/${e}`,r),Wk=e=>Be.delete(`/roles/${e}`),lc=(e="")=>{const r={};return e&&(r.clientId=e),Be.get("/client-objects",{params:r})},Vk=e=>Be.get(`/client-objects/${e}`),qk=e=>Be.post("/client-objects",e),Xk=(e,r)=>Be.put(`/client-objects/${e}`,r),Gk=e=>Be.delete(`/client-objects/${e}`),B1=()=>Be.get("/specifications"),Kk=e=>Be.post("/specifications",e),Yk=(e,r)=>Be.put(`/specifications/${e}`,r),Jk=e=>Be.delete(`/specifications/${e}`),Qk=e=>Be.get(`/bids/${e}/specifications`),Zk=(e,r)=>Be.post(`/bids/${e}/specifications`,r),eN=(e,r,t)=>Be.put(`/bids/${e}/specifications/${r}`,t),tN=(e,r)=>Be.delete(`/bids/${e}/specifications/${r}`),rN=e=>Be.get(`/bids/${e}/history`),nN=()=>Be.get("/specification-categories"),U1=()=>Be.get("/specification-categories/tree"),sN=e=>Be.post("/specification-categories",e),aN=(e,r)=>Be.put(`/specification-categories/${e}`,r),iN=e=>Be.delete(`/specification-categories/${e}`),lN=e=>Be.get("/salary/report",{params:e}),oN=()=>Be.post("/backups/create"),cN=()=>Be.get("/backups/list"),uN=e=>Be.get(`/backups/download/${e}`,{responseType:"blob"}),Fp=e=>e instanceof FormData?Be.post("/backups/restore",e,{headers:{"Content-Type":"multipart/form-data"}}):Be.post("/backups/restore",{filename:e}),fN=e=>Be.delete(`/backups/${e}`),dN=(e="all",r="")=>Be.get("/analytics",{params:{period:e,specificDate:r}}),hN=(e="all",r=50)=>Be.get("/notifications",{params:{filter:e,limit:r}}),xN=e=>Be.put(`/notifications/${e}/read`),Ap=e=>Be.post("/notifications/create",e),mN=(e={})=>Be.get("/contracts",{params:e}),pN=e=>Be.get(`/contracts/bid/${e}`),gN=e=>Be.post("/contracts",e),vN=e=>Be.delete(`/contracts/${e}`),Zd=()=>Be.get("/subject-forms"),yN=e=>Be.post("/subject-forms",e),bN=(e,r)=>Be.put(`/subject-forms/${e}`,r),wN=e=>Be.delete(`/subject-forms/${e}`),z1=j.createContext(null),_N=({children:e})=>{const[r,t]=j.useState(null),[n,s]=j.useState(!0);j.useEffect(()=>{localStorage.getItem("token")?rk().then(h=>{const m=h.data.user;localStorage.setItem("user",JSON.stringify(m)),t(m)}).catch(h=>{if(console.error("Failed to fetch user info:",h),h.response&&h.response.status===404)localStorage.removeItem("token"),localStorage.removeItem("user"),t(null);else{const m=localStorage.getItem("user");m&&t(JSON.parse(m))}}).finally(()=>{s(!1)}):s(!1)},[]);const u={user:r,login:(d,h)=>{localStorage.setItem("token",h),localStorage.setItem("user",JSON.stringify(d)),t(d)},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t(null)},isAuthenticated:!!r};return n?i.jsx("div",{className:"min-h-screen flex items-center justify-center",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):i.jsx(z1.Provider,{value:u,children:e})},Oi=()=>{const e=j.useContext(z1);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},kN=({children:e})=>{const{isAuthenticated:r}=Oi();return r?e:i.jsx(To,{to:"/login",replace:!0})},Xs=()=>{const{user:e}=Oi(),r=j.useCallback(o=>e?.role===""?!0:e?.permissions?.[o]===!0,[e?.permissions,e?.role]),t=j.useCallback(o=>o.some(c=>r(c)),[r]),n=j.useCallback(o=>o.every(c=>r(c)),[r]),s=j.useCallback(o=>r({warehouse:"tab_warehouse",salary:"tab_salary"}[o]),[r]);return{hasPermission:r,hasAnyPermission:t,hasAllPermissions:n,canAccessTab:s,permissions:e?.permissions||{},isAdmin:e?.role===""}},Op=({children:e,permissions:r,requireAll:t=!1,fallback:n="/dashboard/clients"})=>{const{hasPermission:s,hasAllPermissions:o,hasAnyPermission:c}=Xs();if(!r)return e;let u=!1;return Array.isArray(r)?u=t?o(r):c(r):u=s(r),u?e:i.jsx(To,{to:n,replace:!0})},NN=()=>{const e=xs(),{login:r}=Oi(),[t,n]=j.useState({username:"",password:""}),[s,o]=j.useState(""),[c,u]=j.useState(!1),d=async h=>{h.preventDefault(),o(""),u(!0);try{const m=await tk(t);r(m.data.user,m.data.token),e("/dashboard/bids")}catch(m){o(m.response?.data?.message||"  ")}finally{u(!1)}};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-cyan-100 via-blue-200 to-blue-400 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 w-full max-w-md",children:[i.jsx("h1",{className:"text-3xl font-bold text-blue-600 mb-6 text-center",style:{textShadow:"2px 2px 4px rgba(0,0,0,0.3)"},children:"Navi Desk"}),i.jsxs("form",{onSubmit:d,className:"space-y-6",children:[s&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:s}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:" "}),i.jsx("input",{type:"text",value:t.username,onChange:h=>n({...t,username:h.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"  ",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:""}),i.jsx("input",{type:"password",value:t.password,onChange:h=>n({...t,password:h.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:" ",required:!0})]}),i.jsx("button",{type:"submit",disabled:c,className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-lg transition duration-200 disabled:opacity-50",children:c?"...":""})]})]})})};const $1=(...e)=>e.filter((r,t,n)=>!!r&&r.trim()!==""&&n.indexOf(r)===t).join(" ").trim();const SN=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const EN=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(r,t,n)=>n?n.toUpperCase():t.toLowerCase());const Dp=e=>{const r=EN(e);return r.charAt(0).toUpperCase()+r.slice(1)};var jN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const CN=e=>{for(const r in e)if(r.startsWith("aria-")||r==="role"||r==="title")return!0;return!1};const TN=j.forwardRef(({color:e="currentColor",size:r=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:o,iconNode:c,...u},d)=>j.createElement("svg",{ref:d,...jN,width:r,height:r,stroke:e,strokeWidth:n?Number(t)*24/Number(r):t,className:$1("lucide",s),...!o&&!CN(u)&&{"aria-hidden":"true"},...u},[...c.map(([h,m])=>j.createElement(h,m)),...Array.isArray(o)?o:[o]]));const ft=(e,r)=>{const t=j.forwardRef(({className:n,...s},o)=>j.createElement(TN,{ref:o,iconNode:r,className:$1(`lucide-${SN(Dp(e))}`,`lucide-${e}`,n),...s}));return t.displayName=Dp(e),t};const FN=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Ip=ft("bell",FN);const AN=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],ON=ft("bold",AN);const DN=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],IN=ft("building",DN);const RN=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],PN=ft("calendar",RN);const MN=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],LN=ft("chart-no-axes-column",MN);const BN=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],vl=ft("chevron-down",BN);const UN=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],zN=ft("chevron-left",UN);const $N=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],HN=ft("chevron-right",$N);const WN=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],id=ft("chevron-up",WN);const VN=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],qN=ft("circle-check-big",VN);const XN=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],H1=ft("clipboard-list",XN);const GN=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],KN=ft("clock",GN);const YN=[["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["circle",{cx:"12",cy:"12",r:"8",key:"46899m"}]],Rp=ft("cog",YN);const JN=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],QN=ft("dollar-sign",JN);const ZN=[["path",{d:"M11 20H2",key:"nlcfvz"}],["path",{d:"M11 4.562v16.157a1 1 0 0 0 1.242.97L19 20V5.562a2 2 0 0 0-1.515-1.94l-4-1A2 2 0 0 0 11 4.561z",key:"au4z13"}],["path",{d:"M11 4H8a2 2 0 0 0-2 2v14",key:"74r1mk"}],["path",{d:"M14 12h.01",key:"1jfl7z"}],["path",{d:"M22 20h-3",key:"vhrsz"}]],e4=ft("door-open",ZN);const t4=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Pp=ft("download",t4);const r4=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Sl=ft("file-text",r4);const n4=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],Mp=ft("file",n4);const s4=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],a4=ft("folder",s4);const i4=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],l4=ft("italic",i4);const o4=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],c4=ft("list-ordered",o4);const u4=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],f4=ft("list",u4);const d4=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Lp=ft("log-out",d4);const h4=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],x4=ft("menu",h4);const m4=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],W1=ft("package",m4);const p4=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],g4=ft("redo",p4);const v4=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],y4=ft("refresh-cw",v4);const b4=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],w4=ft("rotate-ccw",b4);const _4=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],k4=ft("rotate-cw",_4);const N4=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ld=ft("settings",N4);const S4=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],E4=ft("shield",S4);const j4=[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]],C4=ft("strikethrough",j4);const T4=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],F4=ft("tag",T4);const A4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],O4=ft("target",A4);const D4=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 19H5",key:"vjpgq2"}]],I4=ft("text-align-center",D4);const R4=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 19H7",key:"4cu937"}]],P4=ft("text-align-end",R4);const M4=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],L4=ft("text-align-start",M4);const B4=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],zo=ft("trash-2",B4);const U4=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],dl=ft("trending-up",U4);const z4=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],$4=ft("underline",z4);const H4=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],W4=ft("undo",H4);const V4=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],q4=ft("upload",V4);const X4=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Bp=ft("user",X4);const G4=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],V1=ft("users",G4);const K4=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],El=ft("x",K4);const Y4=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],J4=ft("zoom-in",Y4);const Q4=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Z4=ft("zoom-out",Q4);function eS({isOpen:e,message:r,errorDetails:t,onClose:n}){const s=j.useRef(null),[o,c]=j.useState({rotateX:0,rotateY:0}),[u,d]=j.useState(!1),h=j.useRef({rotateX:0,rotateY:0}),m=j.useRef(null),p=25,y=.08,k=w=>Math.max(-p,Math.min(p,w)),b=(w,S,I)=>w+(S-w)*I;j.useEffect(()=>{if(!e)return;const w=I=>{const N=s.current;if(!N)return;const P=N.getBoundingClientRect(),W=P.left+P.width/2,X=P.top+P.height/2,M=(I.clientX-W)/(P.width/2),Z=(I.clientY-X)/(P.height/2),H=k(M*p),ce=k(Z*p);h.current={rotateX:-ce,rotateY:H}},S=()=>{c(I=>({rotateX:b(I.rotateX,h.current.rotateX,y),rotateY:b(I.rotateY,h.current.rotateY,y)})),m.current=requestAnimationFrame(S)};return m.current=requestAnimationFrame(S),window.addEventListener("mousemove",w),()=>{window.removeEventListener("mousemove",w),m.current&&cancelAnimationFrame(m.current)}},[e]);const v=j.useCallback(()=>{const w=`: ${r}

:
${t||"  "}

:
${Fo.join(`
`)}`;navigator.clipboard.writeText(w).then(()=>{d(!0),setTimeout(()=>d(!1),2e3)}).catch(S=>{console.error(" :",S)})},[r,t]);return e?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-[9998] bg-black/60 backdrop-blur-sm pointer-events-auto"}),i.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center pointer-events-none",children:i.jsxs("div",{ref:s,className:"bg-gradient-to-br from-red-900 via-red-800 to-red-950 rounded-2xl shadow-2xl border-4 border-red-500 p-8 max-w-lg w-full mx-4 pointer-events-auto",style:{transform:`perspective(1000px) rotateX(${o.rotateX}deg) rotateY(${o.rotateY}deg)`,transformOrigin:"center center",transition:"transform 0.1s ease-out"},children:[i.jsxs("div",{className:"text-center mb-6",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-red-600 rounded-full mb-4 shadow-lg",children:i.jsx("svg",{className:"w-12 h-12 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),i.jsx("h2",{className:"text-4xl font-bold text-red-500 mb-2 tracking-wider animate-pulse",children:""}),i.jsx("div",{className:"h-1 bg-red-500 rounded-full w-24 mx-auto"})]}),i.jsxs("div",{className:"bg-red-950/50 rounded-xl p-4 mb-6 border border-red-700/50",children:[i.jsx("p",{className:"text-red-200 text-lg text-center leading-relaxed",children:r}),t&&i.jsx("p",{className:"text-red-300/70 text-sm text-center mt-3 font-mono",children:t})]}),Fo.length>0&&i.jsx("div",{className:"mb-6",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"cursor-pointer text-red-300 hover:text-red-200 text-sm flex items-center gap-2 transition-colors",children:[i.jsx("svg",{className:"w-4 h-4 transition-transform group-open:rotate-90",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),"  "]}),i.jsx("div",{className:"mt-2 bg-black/40 rounded-lg p-3 max-h-48 overflow-auto",children:i.jsx("pre",{className:"text-red-400 text-xs font-mono whitespace-pre-wrap break-all",children:Fo.join(`
`)})})]})}),i.jsxs("div",{className:"flex gap-3 justify-center",children:[i.jsxs("button",{onClick:v,className:"px-6 py-3 bg-red-700 hover:bg-red-600 text-white font-semibold rounded-xl transition-all duration-200 flex items-center gap-2 shadow-lg hover:shadow-red-600/30 transform hover:-translate-y-0.5",children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})}),u?"!":" "]}),i.jsxs("button",{onClick:n,className:"px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white font-semibold rounded-xl transition-all duration-200 flex items-center gap-2 shadow-lg hover:shadow-gray-600/30 transform hover:-translate-y-0.5",children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),""]})]})]})})]}):null}let Fo=[];const tS=console.error,rS=console.warn;console.error=(...e)=>{const r=e.map(t=>t instanceof Error?t.message:typeof t=="object"?JSON.stringify(t,null,2):String(t)).join(`
`);Fo.push(`[ERROR] ${new Date().toISOString()} - ${r}`),tS.apply(console,e)};console.warn=(...e)=>{const r=e.map(t=>t instanceof Error?t.message:typeof t=="object"?JSON.stringify(t,null,2):String(t)).join(`
`);Fo.push(`[WARN] ${new Date().toISOString()} - ${r}`),rS.apply(console,e)};const q1=j.createContext(null);function nS({children:e}){const[r,t]=j.useState(null),[n,s]=j.useState(!1),o=j.useCallback((u,d="")=>{t({message:u,details:d}),s(!0)},[]),c=j.useCallback(()=>{s(!1),t(null)},[]);return i.jsxs(q1.Provider,{value:{showError:o,closeError:c,isOpen:n,error:r},children:[e,i.jsx(eS,{isOpen:n,message:r?.message||"",errorDetails:r?.details||"",onClose:c})]})}function X1(){const e=j.useContext(q1);if(!e)throw new Error("useError must be used within an ErrorProvider");return e}const sS=()=>{const{user:e,logout:r}=Oi(),{canAccessTab:t,hasPermission:n}=Xs(),{showError:s}=X1(),o=Xa(),c=o.pathname==="/dashboard/settings",[u,d]=j.useState("user"),[h,m]=j.useState(!1),[p,y]=j.useState(!1),[k,b]=j.useState(!1),[v,w]=j.useState("all"),[S,I]=j.useState([]),[N,P]=j.useState(0),[W,X]=j.useState(!1),M=[{id:"user",permission:"settings_user_button",label:""},{id:"roles",permission:"settings_role_button",label:""},{id:"subject-forms",permission:"settings_subject_forms_button",label:" . "},{id:"client-attributes",permission:"settings_client_attributes_button",label:" "},{id:"specification-categories",permission:"settings_spec_category_button",label:" "},{id:"specifications",permission:"settings_spec_button",label:""},{id:"bid-types",permission:"settings_bid_type_button",label:" "},{id:"administration",permission:"settings_administration_button",label:""}],Z=[{id:"bids",path:"/dashboard/bids",label:"",icon:H1,permission:null},{id:"clients",path:"/dashboard/clients",label:"",icon:V1,permission:null},{id:"contracts",path:"/dashboard/contracts",label:"",icon:Sl,permission:null},{id:"objects",path:"/dashboard/objects",label:"",icon:IN,permission:null},{id:"equipment",path:"/dashboard/equipment",label:"",icon:W1,permission:"tab_warehouse"},{id:"salary",path:"/dashboard/salary",label:"/",icon:QN,permission:"tab_salary"},{id:"analytics",path:"/dashboard/analytics",label:"",icon:LN,permission:null}];j.useEffect(()=>{if(c&&u==="user"){const te=M.find(ve=>n(ve.permission));te&&te.id!=="user"&&d(te.id)}},[c,u]),j.useEffect(()=>{y(!1)},[o.pathname]),j.useEffect(()=>{const te=ve=>{k&&!ve.target.closest(".notification-panel")&&!ve.target.closest(".notification-button")&&b(!1)};return document.addEventListener("mousedown",te),()=>document.removeEventListener("mousedown",te)},[k]);const H=async()=>{try{X(!0);const te=await hN(v);te.data.success&&(I(te.data.data),P(te.data.unreadCount))}catch(te){console.error("   :",te)}finally{X(!1)}},ce=j.useMemo(()=>te=>({user:i.jsx(Bp,{size:20},"user-icon"),roles:i.jsx(E4,{size:20},"roles-icon"),"client-attributes":i.jsx(F4,{size:20},"client-attributes-icon"),"specification-categories":i.jsx(a4,{size:20},"specification-categories-icon"),specifications:i.jsx(Sl,{size:20},"specifications-icon"),"bid-types":i.jsx(O4,{size:20},"bid-types-icon"),administration:i.jsx(ld,{size:20},"administration-icon")})[te]||i.jsx(ld,{size:20},"default-settings-icon"),[]),le=()=>{y(!1)},re=c?h?"ml-16":"ml-56":h?"ml-16":"ml-64";return i.jsxs("div",{className:"min-h-screen bg-gray-100",children:[i.jsxs("div",{className:"md:hidden fixed top-0 left-0 right-0 h-16 bg-white border-b border-gray-200 z-20 flex items-center justify-between px-4",children:[i.jsx("button",{onClick:()=>y(!0),className:"p-2 rounded-lg hover:bg-gray-100 mobile-tap",children:i.jsx(x4,{size:24})}),i.jsx("span",{className:"font-semibold text-gray-800",children:"CRM System"}),i.jsxs("button",{onClick:()=>b(!k),className:`relative p-2 rounded-lg mobile-tap ${N>0?"text-orange-500":"text-gray-600"}`,children:[i.jsx(Ip,{size:24}),N>0&&i.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:N})]})]}),i.jsx("div",{className:`mobile-sidebar-overlay ${p?"active":""}`,onClick:le}),i.jsxs("aside",{className:`mobile-sidebar ${p?"active":""}`,children:[i.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[i.jsx("span",{className:"font-semibold text-gray-800",children:""}),i.jsx("button",{onClick:le,className:"p-2 rounded-lg hover:bg-gray-100 mobile-tap",children:i.jsx(El,{size:24})})]}),i.jsx("nav",{className:"p-4",children:i.jsxs("div",{className:"space-y-2",children:[Z.map(te=>{const ve=te.icon;return te.permission&&!t(te.permission.replace("tab_",""))?null:i.jsxs(fl,{to:te.path,className:({isActive:Se})=>`flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition ${Se?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,onClick:le,children:[i.jsx(ve,{size:20}),i.jsx("span",{children:te.label})]},te.id)}),i.jsx("div",{className:"border-t border-gray-200 my-4"}),i.jsxs(fl,{to:"/dashboard/settings",className:({isActive:te})=>`flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition ${te?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,onClick:le,children:[i.jsx(Rp,{size:20}),i.jsx("span",{children:""})]}),i.jsxs("button",{onClick:r,className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition text-red-600 hover:bg-red-50",children:[i.jsx(Lp,{size:20}),i.jsx("span",{children:""})]})]})})]}),i.jsx("aside",{className:"desktop-sidebar hidden md:flex flex-col fixed left-0 top-0 h-screen bg-sky-50 transition-all duration-300 z-10",style:{width:c?h?"4rem":"14rem":h?"4rem":"16rem"},children:c?i.jsxs("div",{className:"p-4",children:[i.jsx("button",{onClick:()=>m(!h),className:`mb-4 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-lg transition font-medium ${h?"flex justify-center items-center w-full p-2":"px-4 py-2 w-full"}`,title:h?" ":" ",children:h?"":" "}),i.jsx("button",{onClick:()=>window.history.back(),className:`mb-4 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition font-medium ${h?"flex justify-center items-center w-full p-2":"px-4 py-2 w-full"}`,title:"",children:h?i.jsx(e4,{size:20}):""}),i.jsx("nav",{className:"space-y-2",children:M.filter(te=>n(te.permission)||e?.role==="").map(te=>i.jsx("button",{onClick:()=>d(te.id),className:`${h?"flex justify-center px-2 py-2":"w-full text-left px-4 py-2"} rounded-lg font-medium transition ${u===te.id?"bg-blue-100 text-blue-700 border-r-4 border-blue-500":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"}`,title:h?te.label:"",children:h?ce(te.id):te.label},te.id))})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:`p-4 border-b border-gray-200 ${h?"flex justify-center":""}`,children:i.jsx("button",{onClick:()=>m(!h),className:`${h?"flex justify-center text-gray-600 hover:text-gray-900 hover:bg-gray-100 p-2 rounded transition-all":"flex items-center px-4 py-2 gap-2 rounded-lg font-medium transition text-gray-600 hover:bg-gray-100 hover:text-gray-900"}`,title:h?"":"",children:h?i.jsx(HN,{size:20}):i.jsxs(i.Fragment,{children:[i.jsx(zN,{size:20})," ",i.jsx("span",{children:""})]})})}),i.jsx("nav",{className:"flex-1 p-4",children:i.jsx("div",{className:"space-y-2",children:Z.map(te=>{const ve=te.icon;return te.permission&&!t(te.permission.replace("tab_",""))?null:i.jsxs(fl,{to:te.path,className:({isActive:Se})=>`${Se?"bg-blue-100 text-blue-700 border-r-4 border-blue-500":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"} ${h?"flex justify-center p-2":"flex items-center px-4 py-2 gap-2"} rounded-lg font-medium transition`,title:h?te.label:"",children:[i.jsx(ve,{size:20}),!h&&i.jsx("span",{children:te.label})]},te.id)})})}),i.jsx("div",{className:"p-4 border-t border-gray-200",children:i.jsxs(fl,{to:"/dashboard/settings",className:({isActive:te})=>`${te?"bg-blue-100 text-blue-700 border-r-4 border-blue-500":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"} ${h?"flex justify-center p-2":"flex items-center px-4 py-2 gap-2"} rounded-lg font-medium transition`,title:h?"":"",children:[i.jsx(Rp,{size:20}),!h&&i.jsx("span",{children:""})]})})]})}),i.jsxs("div",{className:"hidden md:flex fixed top-0 bg-sky-50 justify-end items-center h-16 px-4 gap-4 z-10",style:{left:c?h?"4rem":"14rem":h?"4rem":"16rem",width:`calc(100% - ${c?h?"4rem":"14rem":h?"4rem":"16rem"})`},children:[i.jsxs("div",{className:"flex items-center gap-2 text-gray-700 font-medium mr-4",children:[i.jsx(Bp,{size:20}),i.jsx("span",{className:"hidden lg:inline",children:e?.fullName})]}),i.jsxs("button",{onClick:()=>{b(!k),k||H()},className:`notification_button relative flex items-center justify-center w-10 h-10 rounded-lg transition ${N>0?"bg-orange-500 hover:bg-orange-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"}`,title:"",children:[i.jsx(Ip,{size:20}),N>0&&i.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:N})]}),k&&i.jsxs("div",{className:"notification_panel absolute top-16 right-4 w-80 bg-white border border-gray-300 rounded-lg shadow-lg z-50 max-h-96 overflow-y-auto",children:[i.jsx("div",{className:"p-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h4",{className:"font-medium",children:""}),i.jsxs("select",{value:v,onChange:te=>w(te.target.value),className:"text-sm border border-gray-300 rounded px-2 py-1",children:[i.jsx("option",{value:"all",children:""}),i.jsx("option",{value:"unread",children:""}),i.jsx("option",{value:"bid_created",children:" "}),i.jsx("option",{value:"equipment_added",children:" "}),i.jsx("option",{value:"specification_added",children:" "})]})]})}),i.jsx("div",{className:"divide-y divide-gray-100",children:W?i.jsx("div",{className:"p-8 text-center text-gray-500",children:"..."}):S.length>0?S.map(te=>i.jsx("div",{className:`p-4 hover:bg-gray-50 cursor-pointer transition ${te.isRead?"":"bg-blue-50"}`,onClick:async()=>{te.isRead||(await xN(te.id),I(ve=>ve.map(Se=>Se.id===te.id?{...Se,isRead:!0}:Se)),P(ve=>Math.max(0,ve-1)))},children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${te.type==="overdue"?"bg-red-500":te.type==="bid_created"?"bg-blue-500":te.type==="equipment_added"?"bg-orange-500":te.type==="specification_added"?"bg-green-500":"bg-gray-500"}`}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:`font-medium text-sm ${te.isRead?"text-gray-600":"text-gray-900"}`,children:te.title}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:te.message}),i.jsx("p",{className:"text-xs text-gray-400 mt-2",children:new Date(te.createdAt).toLocaleString()})]})]})},te.id)):i.jsx("div",{className:"p-8 text-center text-gray-500",children:" "})})]}),i.jsxs("button",{onClick:r,className:"hidden lg:flex items-center gap-2 bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded-lg transition",children:[i.jsx(Lp,{size:20})," "]})]}),i.jsx("main",{className:`pt-16 md:pt-16 h-[calc(100vh-4rem)] md:h-[calc(100vh-4rem)] ${re} transition-all duration-300`,children:i.jsx("div",{className:"p-4 md:p-8 h-full overflow-auto",children:i.jsx(ow,{context:{activeSettingsTab:u}},u)})}),i.jsx("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-30 pb-safe",children:i.jsxs("div",{className:"flex justify-around items-center py-2",children:[Z.slice(0,5).map(te=>{const ve=te.icon;return te.permission&&!t(te.permission.replace("tab_",""))?null:i.jsxs(fl,{to:te.path,className:({isActive:Se})=>`flex flex-col items-center px-3 py-2 rounded-lg transition ${Se?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[i.jsx(ve,{size:24}),i.jsx("span",{className:"text-xs mt-1",children:te.label})]},te.id)}),i.jsxs(fl,{to:"/dashboard/settings",className:({isActive:te})=>`flex flex-col items-center px-3 py-2 rounded-lg transition ${te?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[i.jsx(ld,{size:24}),i.jsx("span",{className:"text-xs mt-1",children:""})]})]})})]})},aS=()=>{const e=xs(),{hasPermission:r}=Xs(),[t,n]=j.useState([]),[s,o]=j.useState([]),[c,u]=j.useState([]),[d,h]=j.useState(!1),[m,p]=j.useState({name:"",email:"",phone:"",subjectForm:"",responsibleId:""}),[y,k]=j.useState(localStorage.getItem("clientsSearchQuery")||""),[b,v]=j.useState(localStorage.getItem("clientsResponsibleFilter")||""),[w,S]=j.useState(()=>{const K=localStorage.getItem("clientsVisibleFilters");return K?JSON.parse(K):{responsible:!1}}),[I,N]=j.useState(!1),P=["name","email","phone","subjectForm","responsible","bidsCount","objectsCount"],W=localStorage.getItem("clientsVisibleColumns"),X={name:!0,email:!0,phone:!0,subjectForm:!0,responsible:!0,bidsCount:!0,objectsCount:!0},M=W?{...X,...JSON.parse(W)}:X,Z=localStorage.getItem("clientsColumnOrder");let H=Z?JSON.parse(Z).filter(K=>P.includes(K)):P;P.forEach(K=>{H.includes(K)||H.push(K)});const[ce,le]=j.useState(H),[re,te]=j.useState(M),[ve,Se]=j.useState(!1);j.useEffect(()=>{const K=setTimeout(()=>Ce(y,b),300);return()=>clearTimeout(K)},[y,b]),j.useEffect(()=>{(async()=>{try{const fe=await Ga();o(fe.data)}catch(fe){console.error("Error fetching users:",fe)}})()},[]),j.useEffect(()=>{(async()=>{try{const fe=await Zd();u(fe.data)}catch(fe){console.error("Error fetching subject forms:",fe)}})()},[]),j.useEffect(()=>{localStorage.setItem("clientsVisibleColumns",JSON.stringify(re))},[re]),j.useEffect(()=>{localStorage.setItem("clientsColumnOrder",JSON.stringify(ce))},[ce]),j.useEffect(()=>{const K=fe=>{ve&&!fe.target.closest(".column-settings")&&Se(!1)};return document.addEventListener("mousedown",K),()=>document.removeEventListener("mousedown",K)},[ve]);const Ce=async(K="",fe="")=>{console.log("Fetching clients...");try{const we=await ic(K,fe);console.log("Clients response:",we),n(we.data),console.log("Clients set:",we.data)}catch(we){console.error("Error fetching clients:",we),console.error("Error details:",we.response)}},ue=async K=>{K.preventDefault();try{await sk(m),Ce(),A()}catch(fe){console.error("Error saving client:",fe)}},ne=K=>{e(`/dashboard/clients/${K.id}`)},A=()=>{p({name:"",email:"",phone:"",subjectForm:"",responsibleId:""}),h(!1)},me=K=>{te(fe=>({...fe,[K]:!fe[K]}))},z=K=>{if(K>0){const fe=[...ce];[fe[K],fe[K-1]]=[fe[K-1],fe[K]],le(fe)}},T=K=>{if(K<ce.length-1){const fe=[...ce];[fe[K],fe[K+1]]=[fe[K+1],fe[K]],le(fe)}},Q=K=>{switch(K){case"name":return"";case"email":return"Email";case"phone":return"";case"subjectForm":return" ";case"responsible":return"";case"bidsCount":return"";case"objectsCount":return"";default:return K}},Y=(K,fe)=>{switch(fe){case"name":return K.name;case"email":return K.email;case"phone":return K.phone;case"subjectForm":return K.subjectForm||"-";case"responsible":return K.responsible?K.responsible.fullName||K.responsible.email:" ";case"bidsCount":return K._count?.bids||0;case"objectsCount":return K._count?.clientObjects||0;default:return""}},J=ce.filter(K=>re[K]);return i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:""}),i.jsxs("div",{className:"bg-gray-200 rounded-lg p-4 mb-6",children:[i.jsx("div",{className:"flex justify-end mb-4",children:r("client_create")&&i.jsx("button",{onClick:()=>h(!0),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:"+  "})}),i.jsxs("div",{className:"mb-4 flex gap-4",children:[i.jsx("div",{className:"flex-1",children:i.jsx("input",{type:"text",placeholder:"  ...",value:y,onChange:K=>k(K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),i.jsxs("div",{className:"relative column-settings",children:[i.jsx("button",{onClick:()=>Se(!ve),className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition",children:" "}),ve&&i.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white border border-gray-300 rounded-lg shadow-lg z-10 column-settings",children:i.jsxs("div",{className:"p-4",children:[i.jsx("h4",{className:"font-medium mb-2",children:" "}),ce.map((K,fe)=>i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:re[K],onChange:()=>me(K),className:"mr-2"}),Q(K)]}),re[K]&&i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>z(fe),disabled:fe===0,className:"px-2 py-1 bg-gray-200 hover:bg-gray-300 disabled:opacity-50 text-xs rounded",children:""}),i.jsx("button",{onClick:()=>T(fe),disabled:fe===ce.length-1,className:"px-2 py-1 bg-gray-200 hover:bg-gray-300 disabled:opacity-50 text-xs rounded",children:""})]})]},K))]})})]}),i.jsx("button",{onClick:()=>N(!0),className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition",children:" "})]}),w.responsible&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("select",{value:b,onChange:K=>v(K.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:" "}),s.map(K=>i.jsxs("option",{value:K.id,children:[K.fullName||K.username," "]},K.id))]}),i.jsx("button",{onClick:()=>{S({...w,responsible:!1}),v("")},className:"text-red-500 hover:text-red-700",children:"X "})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto table-container flex-1 min-h-0",children:i.jsxs("table",{className:"divide-y divide-gray-200",style:{minWidth:`${J.length*120}px`},children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsx("tr",{children:J.map(K=>i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 resize-x overflow-auto cursor-pointer hover:bg-gray-100 transition",style:{minWidth:"1px"},children:Q(K)},K))})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(K=>i.jsx("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>ne(K),children:J.map(fe=>i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Y(K,fe)},fe))},K.id))})]})}),I&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:" "}),i.jsx("div",{className:"space-y-2",children:i.jsx("button",{onClick:()=>{S({...w,responsible:!0}),N(!1)},className:"w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition",children:""})}),i.jsx("div",{className:"flex gap-2 pt-4",children:i.jsx("button",{onClick:()=>N(!1),className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})})]})}),d&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"  "}),i.jsxs("form",{onSubmit:ue,className:"space-y-4",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:m.name,onChange:K=>p({...m,name:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{type:"email",value:m.email,onChange:K=>p({...m,email:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"tel",value:m.phone,onChange:K=>p({...m,phone:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsxs("select",{value:m.subjectForm,onChange:K=>p({...m,subjectForm:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"  "}),c.map(K=>i.jsx("option",{value:K.name,children:K.name},K.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsxs("select",{value:m.responsibleId,onChange:K=>p({...m,responsibleId:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:" "}),s.map(K=>i.jsx("option",{value:K.id,children:K.fullName||K.username},K.id))]})]}),i.jsxs("div",{className:"flex gap-2 pt-4",children:[i.jsx("button",{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition",children:""}),i.jsx("button",{type:"button",onClick:A,className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})]})]})]})})]})},iS=()=>i.jsx("div",{children:"Bids"}),lS=()=>{const{id:e}=Xd(),r=xs(),{hasPermission:t}=Xs(),[n,s]=j.useState(null),[o,c]=j.useState([]),[u,d]=j.useState(!0),[h,m]=j.useState(""),[p,y]=j.useState(""),[k,b]=j.useState(!1),[v,w]=j.useState({name:"",email:"",phone:"",subjectForm:"",responsibleId:null,attributes:{}}),[S,I]=j.useState([]),[N,P]=j.useState(!1),[W,X]=j.useState([]),[M,Z]=j.useState([]),[H,ce]=j.useState([]),[le,re]=j.useState([]),[te,ve]=j.useState([]),[Se,Ce]=j.useState([]),[ue,ne]=j.useState(!1),[A,me]=j.useState(""),[z,T]=j.useState(""),Q=["id","tema","status","description"],Y=localStorage.getItem("clientDetailBidsVisibleColumns"),J={id:!0,tema:!0,status:!0,description:!0},K=Y?{...J,...JSON.parse(Y)}:J,fe=localStorage.getItem("clientDetailBidsColumnOrder");let we=fe?JSON.parse(fe).filter(E=>Q.includes(E)):Q;Q.forEach(E=>{we.includes(E)||we.push(E)});const[ye,je]=j.useState(we),[Xe,D]=j.useState(K),[Pe,rt]=j.useState(!1),xt=["equipmentName","productCode","imei","bidId","actions"],nt=localStorage.getItem("clientDetailEquipmentVisibleColumns"),Le={equipmentName:!0,productCode:!0,imei:!0,bidId:!0,actions:!0},jt=nt?{...Le,...JSON.parse(nt)}:Le,Rt=localStorage.getItem("clientDetailEquipmentColumnOrder");let Bt=Rt?JSON.parse(Rt).filter(E=>xt.includes(E)):xt;xt.forEach(E=>{Bt.includes(E)||Bt.push(E)});const[bt,fr]=j.useState(Bt),[kt,Pt]=j.useState(jt),[Ut,Mt]=j.useState(!1),Gt=["brandModel","stateNumber","bids"],Tt=localStorage.getItem("clientDetailObjectsVisibleColumns"),tr={brandModel:!0,stateNumber:!0,bids:!0},Ze=Tt?{...tr,...JSON.parse(Tt)}:tr,qe=localStorage.getItem("clientDetailObjectsColumnOrder");let vt=qe?JSON.parse(qe).filter(E=>Gt.includes(E)):Gt;Gt.forEach(E=>{vt.includes(E)||vt.push(E)});const[ht,qt]=j.useState(vt),[rr,Ar]=j.useState(Ze),[Lt,sr]=j.useState(!1);j.useEffect(()=>{Or(),Nr(),Br(),Ur(),dr(),zr(),Yr()},[e]),j.useEffect(()=>{localStorage.setItem("clientDetailBidsVisibleColumns",JSON.stringify(Xe))},[Xe]),j.useEffect(()=>{localStorage.setItem("clientDetailBidsColumnOrder",JSON.stringify(ye))},[ye]),j.useEffect(()=>{localStorage.setItem("clientDetailEquipmentVisibleColumns",JSON.stringify(kt))},[kt]),j.useEffect(()=>{localStorage.setItem("clientDetailEquipmentColumnOrder",JSON.stringify(bt))},[bt]),j.useEffect(()=>{localStorage.setItem("clientDetailObjectsVisibleColumns",JSON.stringify(rr))},[rr]),j.useEffect(()=>{localStorage.setItem("clientDetailObjectsColumnOrder",JSON.stringify(ht))},[ht]),j.useEffect(()=>{const E=ie=>{Pe&&!ie.target.closest(".bids-column-settings")&&rt(!1),Ut&&!ie.target.closest(".equipment-column-settings")&&Mt(!1),Lt&&!ie.target.closest(".objects-column-settings")&&sr(!1)};return document.addEventListener("mousedown",E),()=>document.removeEventListener("mousedown",E)},[Pe,Ut,Lt]);const Or=async()=>{try{const E=await nk(e);s(E.data)}catch(E){m("  "),console.error("Error fetching client:",E)}finally{d(!1)}},Nr=async()=>{try{const E=await lc(e);c(E.data)}catch(E){console.error("Error fetching client objects:",E)}},Br=async()=>{try{const E=await Ga();I(E.data)}catch(E){console.error("Error fetching users:",E)}},Ur=async()=>{try{const E=await ck();X(E.data)}catch(E){console.error("Error fetching enabled attributes:",E)}},dr=async()=>{try{const E=await P1(e);Z(E.data)}catch(E){console.error("Error fetching client equipment:",E)}},zr=async()=>{try{const E=await Qd();ve(E.data)}catch(E){console.error("Error fetching all equipment:",E)}},Yr=async()=>{try{const E=await Zd();Ce(E.data)}catch(E){console.error("Error fetching subject forms:",E)}},En=async E=>{if(confirm(" ,       ?"))try{await Mk(E),dr()}catch(ie){console.error("Error deleting client equipment:",ie),alert("   .")}},Bn=async()=>{if(A)try{await M1({clientId:parseInt(e),equipmentId:parseInt(A),imei:z.trim()||null}),ne(!1),me(""),T(""),dr()}catch(E){console.error("Error adding client equipment:",E),alert("   .")}},$r=E=>{D(ie=>({...ie,[E]:!ie[E]}))},Sr=E=>{if(E>0){const ie=[...ye];[ie[E],ie[E-1]]=[ie[E-1],ie[E]],je(ie)}},Dr=E=>{if(E<ye.length-1){const ie=[...ye];[ie[E],ie[E+1]]=[ie[E+1],ie[E]],je(ie)}},Jr=E=>{Pt(ie=>({...ie,[E]:!ie[E]}))},Er=E=>{if(E>0){const ie=[...bt];[ie[E],ie[E-1]]=[ie[E-1],ie[E]],fr(ie)}},ps=E=>{if(E<bt.length-1){const ie=[...bt];[ie[E],ie[E+1]]=[ie[E+1],ie[E]],fr(ie)}},Ir=E=>{Ar(ie=>({...ie,[E]:!ie[E]}))},jn=E=>{if(E>0){const ie=[...ht];[ie[E],ie[E-1]]=[ie[E-1],ie[E]],qt(ie)}},O=E=>{if(E<ht.length-1){const ie=[...ht];[ie[E],ie[E+1]]=[ie[E+1],ie[E]],qt(ie)}},V=E=>{switch(E){case"id":return"";case"tema":return"";case"status":return"";case"description":return"";default:return E}},L=E=>{switch(E){case"equipmentName":return"";case"productCode":return" ";case"imei":return"IMEI";case"bidId":return"";case"actions":return"";default:return E}},U=E=>{switch(E){case"brandModel":return"/";case"stateNumber":return". ";case"bids":return"";default:return E}},q=(E,ie)=>{switch(ie){case"id":return` ${E.id}`;case"tema":return E.tema;case"status":{let Te=null;E.bidType?.statuses&&Array.isArray(E.bidType.statuses)&&(Te=E.bidType.statuses.find(Ct=>Ct.name===E.status));const Fe=Te?.color||"#7a7777",Ae=Te?.name||E.status,et=Fe==="#ffffff"||Fe.toLowerCase()==="#fff",Et=et?"#333333":"#ffffff";return i.jsx("span",{className:"px-2 py-1 text-xs rounded-full border",style:{backgroundColor:Fe,color:Et,borderColor:et?"#cccccc":Fe},children:Ae})}case"description":return i.jsx("div",{className:"max-w-xs truncate",children:E.description});default:return""}},G=(E,ie)=>{switch(ie){case"equipmentName":return E.equipment.name;case"productCode":return E.equipment.productCode||"-";case"imei":return E.imei||"-";case"bidId":return E.bid?i.jsx("button",{onClick:()=>r(`/dashboard/bids/${E.bid.id}`),className:"text-blue-500 hover:text-blue-700 underline",children:E.bid.id}):"-";case"actions":return t("client_equipment_delete")?i.jsx("button",{onClick:()=>En(E.id),className:"text-red-500 hover:text-red-700",children:""}):null;default:return""}},he=(E,ie)=>{switch(ie){case"brandModel":return E.brandModel;case"stateNumber":return E.stateNumber;case"bids":return E.bids&&E.bids.length>0?i.jsx("div",{className:"flex flex-wrap gap-1",children:E.bids.map(Te=>i.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded",children:Te.tema},Te.id))}):i.jsx("span",{className:"text-gray-500",children:" "});default:return""}},Ne=()=>{const E={};W.forEach(ie=>{const Te=n.attributeValues?.find(Fe=>Fe.attributeId===ie.id)?.value||"";if(ie.type==="multiselect"&&Te)try{E[ie.id]=JSON.parse(Te)}catch{E[ie.id]=[]}else E[ie.id]=Te}),w({name:n.name||"",email:n.email||"",phone:n.phone||"",subjectForm:n.subjectForm||"",responsibleId:n.responsibleId||null,attributes:E}),b(!0)},ae=()=>{b(!1),w({name:"",email:"",phone:"",subjectForm:"",responsibleId:null,attributes:{}})},xe=async()=>{P(!0);try{const E=await ak(e,v);s(E.data),b(!1)}catch(E){console.error("Error updating client:",E),m("   ")}finally{P(!1)}},R=E=>{const{name:ie,value:Te}=E.target;if(ie.startsWith("attr_")){const Fe=ie.replace("attr_","");w(Ae=>({...Ae,attributes:{...Ae.attributes,[Fe]:Te}}))}else w(Fe=>({...Fe,[ie]:ie==="responsibleId"?Te?parseInt(Te):null:Te}))};return u?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"text-gray-500",children:"..."})}):h||!n?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("p",{className:"text-red-500 mb-4",children:h}),i.jsx("button",{onClick:()=>r("/dashboard/clients"),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:"  "})]}):i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"  "}),i.jsx("div",{className:"flex space-x-2",children:k?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:xe,disabled:N,className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition disabled:opacity-50",children:N?"...":""}),i.jsx("button",{onClick:ae,disabled:N,className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition disabled:opacity-50",children:""})]}):i.jsxs(i.Fragment,{children:[t("client_edit")&&i.jsx("button",{onClick:Ne,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:""}),i.jsx("button",{onClick:()=>r("/dashboard/clients"),className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition",children:""})]})})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),k?i.jsx("input",{type:"text",name:"name",value:v.name,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:N}):i.jsx("p",{className:"text-gray-900 text-lg",children:n.name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),k?i.jsx("input",{type:"email",name:"email",value:v.email,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:N}):i.jsx("p",{className:"text-gray-900 text-lg",children:n.email})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),k?i.jsx("input",{type:"tel",name:"phone",value:v.phone,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:N}):i.jsx("p",{className:"text-gray-900 text-lg",children:n.phone})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),k?i.jsxs("select",{name:"subjectForm",value:v.subjectForm,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:N,children:[i.jsx("option",{value:"",children:"  "}),Se.map(E=>i.jsx("option",{value:E.name,children:E.name},E.id))]}):i.jsx("p",{className:"text-gray-900 text-lg",children:n.subjectForm||"-"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),k?i.jsxs("select",{name:"responsibleId",value:v.responsibleId||"",onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:N,children:[i.jsx("option",{value:"",children:" "}),S.map(E=>i.jsx("option",{value:E.id,children:E.fullName||E.email},E.id))]}):i.jsx("p",{className:"text-gray-900 text-lg",children:n.responsible?n.responsible.fullName||n.responsible.email:" "})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsx("p",{className:"text-gray-900 text-lg",children:n.bids?.length||0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsx("p",{className:"text-gray-900 text-lg",children:o.length})]}),W.map(E=>{const ie=n.attributeValues?.find(Te=>Te.attributeId===E.id)?.value||"";return i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:E.name}),k?E.type==="select"?i.jsxs("select",{name:`attr_${E.id}`,value:v.attributes[E.id]||"",onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:N,children:[i.jsx("option",{value:"",children:" "}),E.options?.map(Te=>i.jsx("option",{value:Te,children:Te},Te))]}):E.type==="multiselect"?i.jsx("div",{className:"space-y-2",children:E.options?.map(Te=>{const Fe=v.attributes[E.id]?JSON.parse(v.attributes[E.id]):[];return i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:Fe.includes(Te),onChange:Ae=>{const et=Ae.target.checked?[...Fe,Te]:Fe.filter(Et=>Et!==Te);R({target:{name:`attr_${E.id}`,value:JSON.stringify(et)}})},className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500",disabled:N}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:Te})]},Te)})}):E.type==="image"?i.jsxs("div",{children:[i.jsx("input",{type:"file",accept:"image/*",onChange:Te=>{const Fe=Te.target.files[0];if(Fe){const Ae=new FileReader;Ae.onload=et=>{R({target:{name:`attr_${E.id}`,value:et.target.result}})},Ae.readAsDataURL(Fe)}},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:N}),v.attributes[E.id]&&i.jsx("img",{src:v.attributes[E.id],alt:"Preview",className:"mt-2 max-w-full h-32 object-cover rounded"})]}):E.type==="boolean"?i.jsx("input",{type:"checkbox",name:`attr_${E.id}`,checked:v.attributes[E.id]==="true",onChange:Te=>R({target:{name:`attr_${E.id}`,value:Te.target.checked?"true":"false"}}),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500",disabled:N}):E.type==="number"?i.jsx("input",{type:"number",name:`attr_${E.id}`,value:v.attributes[E.id]||"",onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:N}):i.jsx("input",{type:"text",name:`attr_${E.id}`,value:v.attributes[E.id]||"",onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:N}):E.type==="multiselect"?i.jsx("p",{className:"text-gray-900 text-lg",children:ie?(()=>{try{const Te=JSON.parse(ie);return Array.isArray(Te)?Te.join(", "):" "}catch{return" "}})():" "}):E.type==="image"?ie?i.jsx("img",{src:ie,alt:E.name,className:"max-w-full h-32 object-cover rounded"}):i.jsx("p",{className:"text-gray-900 text-lg",children:" "}):i.jsx("p",{className:"text-gray-900 text-lg",children:ie||" "})]},E.id)})]})}),i.jsxs("div",{className:"mt-6",children:[i.jsx("div",{className:"flex space-x-1 mb-4",children:["","","","",""].map(E=>{let ie=E,Te=0;return E===""?Te=n.bids?n.bids.length:0:E===""?Te=M.length:E===""?Te=H.length:E===""?Te=o.length:E===""&&(Te=le.length),ie=`${E} (${Te})`,i.jsx("button",{onClick:()=>{E===""&&console.log(" tab clicked"),y(E)},className:`px-4 py-2 rounded-t-lg font-medium transition ${p===E?"bg-white text-blue-600 border-b-2 border-blue-600":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:ie},E)})}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[p===""&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:" "}),i.jsxs("div",{className:"relative bids-column-settings",children:[i.jsx("button",{onClick:()=>rt(!Pe),className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition text-sm",children:" "}),Pe&&i.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white border border-gray-300 rounded-lg shadow-lg z-10",children:i.jsxs("div",{className:"p-4",children:[i.jsx("h4",{className:"font-medium mb-2",children:" "}),ye.map((E,ie)=>i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:Xe[E],onChange:()=>$r(E),className:"mr-2"}),V(E)]}),Xe[E]&&i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>Sr(ie),disabled:ie===0,className:"px-2 py-1 bg-gray-200 hover:bg-gray-300 disabled:opacity-50 text-xs rounded",children:""}),i.jsx("button",{onClick:()=>Dr(ie),disabled:ie===ye.length-1,className:"px-2 py-1 bg-gray-200 hover:bg-gray-300 disabled:opacity-50 text-xs rounded",children:""})]})]},E))]})})]})]}),n.bids&&n.bids.length>0?i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsx("tr",{children:ye.filter(E=>Xe[E]).map(E=>i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:V(E)},E))})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.bids.map(E=>i.jsx("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>r(`/dashboard/bids/${E.id}`),children:ye.filter(ie=>Xe[ie]).map(ie=>i.jsx("td",{className:`px-6 py-4 ${ie==="description"?"":"whitespace-nowrap"}`,children:q(E,ie)},ie))},E.id))})]})}):i.jsx("p",{className:"text-gray-500",children:"   "})]}),p===""&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:" "}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("div",{className:"relative equipment-column-settings",children:[i.jsx("button",{onClick:()=>Mt(!Ut),className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition text-sm",children:" "}),Ut&&i.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white border border-gray-300 rounded-lg shadow-lg z-10",children:i.jsxs("div",{className:"p-4",children:[i.jsx("h4",{className:"font-medium mb-2",children:" "}),bt.map((E,ie)=>i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:kt[E],onChange:()=>Jr(E),className:"mr-2"}),L(E)]}),kt[E]&&i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>Er(ie),disabled:ie===0,className:"px-2 py-1 bg-gray-200 hover:bg-gray-300 disabled:opacity-50 text-xs rounded",children:""}),i.jsx("button",{onClick:()=>ps(ie),disabled:ie===bt.length-1,className:"px-2 py-1 bg-gray-200 hover:bg-gray-300 disabled:opacity-50 text-xs rounded",children:""})]})]},E))]})})]}),t("client_equipment_add")&&i.jsx("button",{onClick:()=>ne(!0),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition text-sm",children:" "})]})]}),M.length>0?i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full bg-white border border-gray-300",children:[i.jsx("thead",{children:i.jsx("tr",{className:"bg-gray-50",children:bt.filter(E=>kt[E]).map(E=>i.jsx("th",{className:"px-4 py-2 border-b text-left text-xs font-medium text-gray-500 uppercase",children:L(E)},E))})}),i.jsx("tbody",{children:M.map(E=>i.jsx("tr",{className:"hover:bg-gray-50",children:bt.filter(ie=>kt[ie]).map(ie=>i.jsx("td",{className:"px-4 py-2 border-b",children:G(E,ie)},ie))},E.id))})]})}):i.jsx("p",{className:"text-gray-500 text-center py-4",children:"  "})]}),p===""&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),i.jsx("p",{className:"text-gray-500",children:" "})]}),p===""&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:" "}),i.jsxs("div",{className:"relative objects-column-settings",children:[i.jsx("button",{onClick:()=>sr(!Lt),className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition text-sm",children:" "}),Lt&&i.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white border border-gray-300 rounded-lg shadow-lg z-10",children:i.jsxs("div",{className:"p-4",children:[i.jsx("h4",{className:"font-medium mb-2",children:" "}),ht.map((E,ie)=>i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:rr[E],onChange:()=>Ir(E),className:"mr-2"}),U(E)]}),rr[E]&&i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>jn(ie),disabled:ie===0,className:"px-2 py-1 bg-gray-200 hover:bg-gray-300 disabled:opacity-50 text-xs rounded",children:""}),i.jsx("button",{onClick:()=>O(ie),disabled:ie===ht.length-1,className:"px-2 py-1 bg-gray-200 hover:bg-gray-300 disabled:opacity-50 text-xs rounded",children:""})]})]},E))]})})]})]}),o&&o.length>0?i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsx("tr",{children:ht.filter(E=>rr[E]).map(E=>i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:U(E)},E))})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(E=>i.jsx("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>r(`/dashboard/client-objects/${E.id}`),children:ht.filter(ie=>rr[ie]).map(ie=>i.jsx("td",{className:"px-6 py-4",children:he(E,ie)},ie))},E.id))})]})}):i.jsx("p",{className:"text-gray-500",children:"   "})]}),p===""&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),i.jsx("p",{className:"text-gray-500",children:" "})]})]})]}),ue&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:" "}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsxs("select",{value:A,onChange:E=>me(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:" "}),te.filter(E=>!M.some(ie=>ie.equipmentId===E.id)).map(E=>i.jsxs("option",{value:E.id,children:[E.name," ",E.productCode?`(${E.productCode})`:""]},E.id))]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IMEI ()"}),i.jsx("input",{type:"text",value:z,onChange:E=>T(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:" IMEI"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:Bn,disabled:!A,className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed",children:""}),i.jsx("button",{onClick:()=>{ne(!1),me(""),T("")},className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})]})]})})]})},oS=({value:e,onChange:r,placeholder:t=" ..."})=>{const n=j.useRef(null),[s,o]=j.useState([]),[c,u]=j.useState(-1),d=()=>{const S=n.current?.innerHTML||"";o(I=>[...I.slice(0,c+1),S]),u(I=>I+1)},h=(S,I=null)=>{n.current?.focus(),document.execCommand(S,!1,I),d(),r(n.current?.innerHTML||"")},m=()=>{if(c>0){const S=c-1;u(S),n.current.innerHTML=s[S],r(s[S])}},p=()=>{if(c<s.length-1){const S=c+1;u(S),n.current.innerHTML=s[S],r(s[S])}},y=()=>{n.current?.focus(),document.execCommand("removeFormat",!1,null),d(),r(n.current?.innerHTML||"")},k=()=>{r(n.current?.innerHTML||"")};j.useEffect(()=>{n.current&&e&&s.length===0&&(n.current.innerHTML=e||"",o([e||""]),u(0))},[]);const b=[{icon:i.jsx(ON,{size:16}),title:"",action:"bold"},{icon:i.jsx(l4,{size:16}),title:"",action:"italic"},{icon:i.jsx($4,{size:16}),title:"",action:"underline"},{icon:i.jsx(C4,{size:16}),title:"",action:"strikeThrough"}],v=[{icon:i.jsx(f4,{size:16}),title:"",action:"insertUnorderedList"},{icon:i.jsx(c4,{size:16}),title:"",action:"insertOrderedList"}],w=[{icon:i.jsx(L4,{size:16}),title:"  ",action:"justifyLeft"},{icon:i.jsx(I4,{size:16}),title:" ",action:"justifyCenter"},{icon:i.jsx(P4,{size:16}),title:"  ",action:"justifyRight"}];return i.jsxs("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:[i.jsxs("div",{className:"flex flex-wrap gap-1 p-2 bg-gray-100 border-b border-gray-300",children:[i.jsxs("div",{className:"flex gap-1 border-r border-gray-300 pr-2 mr-1",children:[i.jsx("button",{type:"button",onClick:m,disabled:c<=0,className:"p-1.5 hover:bg-gray-200 rounded transition disabled:opacity-50",title:"",children:i.jsx(W4,{size:16})}),i.jsx("button",{type:"button",onClick:p,disabled:c>=s.length-1,className:"p-1.5 hover:bg-gray-200 rounded transition disabled:opacity-50",title:"",children:i.jsx(g4,{size:16})}),i.jsx("button",{type:"button",onClick:y,className:"p-1.5 hover:bg-red-100 text-red-600 rounded transition",title:" ",children:i.jsx(w4,{size:16})})]}),i.jsx("div",{className:"flex gap-1 border-r border-gray-300 pr-2 mr-1",children:b.map(S=>i.jsx("button",{type:"button",onClick:()=>h(S.action),className:"p-1.5 hover:bg-gray-200 rounded transition",title:S.title,children:S.icon},S.action))}),i.jsx("div",{className:"flex gap-1 border-r border-gray-300 pr-2 mr-1",children:v.map(S=>i.jsx("button",{type:"button",onClick:()=>h(S.action),className:"p-1.5 hover:bg-gray-200 rounded transition",title:S.title,children:S.icon},S.action))}),i.jsx("div",{className:"flex gap-1",children:w.map(S=>i.jsx("button",{type:"button",onClick:()=>h(S.action),className:"p-1.5 hover:bg-gray-200 rounded transition",title:S.title,children:S.icon},S.action))})]}),i.jsx("div",{ref:n,contentEditable:!0,onInput:k,className:"w-full px-3 py-2 min-h-[100px] max-h-[300px] overflow-y-auto focus:outline-none","data-placeholder":t,suppressContentEditableWarning:!0,style:{minHeight:"100px"}})]})},cS=()=>{const{id:e}=Xd(),r=xs(),{user:t}=Oi(),{hasPermission:n}=Xs(),[s,o]=j.useState(null),[c,u]=j.useState(!0),[d,h]=j.useState(""),[m,p]=j.useState(!1),[y,k]=j.useState("comments"),[b,v]=j.useState([]),[w,S]=j.useState(""),[I,N]=j.useState(null),[P,W]=j.useState(""),[X,M]=j.useState([]),[Z,H]=j.useState(!1),[ce,le]=j.useState(null),[re,te]=j.useState(null),[ve,Se]=j.useState(!1),[Ce,ue]=j.useState([]),[ne,A]=j.useState([]),[me,z]=j.useState([]),[T,Q]=j.useState(new Set),[Y,J]=j.useState(!1),[K,fe]=j.useState([]),[we,ye]=j.useState(""),[je,Xe]=j.useState(""),[D,Pe]=j.useState(!1),[rt,xt]=j.useState(""),[nt,Le]=j.useState(!1),[jt,Rt]=j.useState(""),[Bt,bt]=j.useState(!1),[fr,kt]=j.useState([]),[Pt,Ut]=j.useState([]),[Mt,Gt]=j.useState([]),[Tt,tr]=j.useState([]),[Ze,qe]=j.useState(!1),[vt,ht]=j.useState(null),[qt,rr]=j.useState(!1),[Ar,Lt]=j.useState(null),[sr,Or]=j.useState(""),[Nr,Br]=j.useState([]),[Ur,dr]=j.useState(!1),[zr,Yr]=j.useState(!1),[En,Bn]=j.useState([]),[$r,Sr]=j.useState([]),[Dr,Jr]=j.useState([]),[Er,ps]=j.useState([]),[Ir,jn]=j.useState(null),[O,V]=j.useState([]),[L,U]=j.useState(new Set),[q,G]=j.useState(!1),[he,Ne]=j.useState(!1),[ae,xe]=j.useState(null),[R,E]=j.useState(!1),[ie,Te]=j.useState(null),[Fe,Ae]=j.useState(100),[et,Et]=j.useState(0),[Ct,Vt]=j.useState({x:0,y:0}),[Un,zn]=j.useState(!1),[gn,hr]=j.useState({x:0,y:0}),[ya,Kt]=j.useState({x:0,y:0}),[Bi,Ll]=j.useState(new Set),Ui=j.useRef(null),[vn,Ys]=j.useState([]),[Qn,gs]=j.useState(null),[Bl,Js]=j.useState(!1),[ba,Qa]=j.useState(!1),[wa,$n]=j.useState(!1),[C,_e]=j.useState({bidEquipmentId:null,clientName:"",responsibleName:"",clientObject:"",equipmentName:"",imei:"",quantity:1,contractEndDate:""}),[ke,Ve]=j.useState({clientId:"",title:"",bidTypeId:"",description:"",clientObjectId:"",workAddress:"",contactFullName:"",contactPhone:"",parentId:"",plannedResolutionDate:"",plannedReactionTimeMinutes:"",assignedAt:"",plannedDurationMinutes:"",amount:0}),[wt,vs]=j.useState(!1),[yn,We]=j.useState([]),pc=()=>{Ve({clientId:"",title:"",bidTypeId:"",description:"",clientObjectId:"",workAddress:"",contactFullName:"",contactPhone:"",parentId:"",plannedResolutionDate:"",plannedReactionTimeMinutes:"",assignedAt:"",plannedDurationMinutes:"",amount:0}),Sr([])},[gc,Ul]=j.useState([]),[Qs,Zs]=j.useState(-1);j.useEffect(()=>{Zn(),Is(),ea(),ta(),yc(),Rs(),ti(),mu(),vc(),Hn(),Za(),bc(),ei(),ys(),_a()},[e]),j.useEffect(()=>{s&&(Xl(),Gl())},[s]),j.useEffect(()=>{zl(ke.clientId),Ve(B=>({...B,clientObjectId:""}))},[ke.clientId]),j.useEffect(()=>{const B=()=>{s?.statusMetadata?.deadlines?.deadline&&jn(Cu(s.statusMetadata.deadlines.deadline))};B();const Oe=setInterval(B,6e4);return()=>clearInterval(Oe)},[s]),j.useEffect(()=>{s&&(ye(s.updNumber||""),Xe(s.updDate?new Date(s.updDate).toISOString().split("T")[0]:""),xt(s.contract||""),Rt(s.workAddress||""))},[s]),j.useEffect(()=>{const B=Oe=>{m&&!Oe.target.closest(".status-dropdown-container")&&p(!1)};return document.addEventListener("mousedown",B),()=>{document.removeEventListener("mousedown",B)}},[m]);const Zn=async()=>{try{const B=await hk(e);o(B.data),yc(),console.log("  ID:",e),console.log(" :",{clientId:B.data.clientId,clientName:B.data.clientName,tema:B.data.title,amount:B.data.amount,status:B.data.status,description:B.data.description,clientObjectId:B.data.clientObjectId,updNumber:B.data.updNumber,updDate:B.data.updDate,contract:B.data.contract,bidTypeName:B.data.bidType?B.data.bidType.name:" ",creatorName:B.data.creatorName,createdAt:B.data.createdAt,updatedAt:B.data.updatedAt})}catch(B){h("  "),console.error("Error fetching bid:",B)}finally{u(!1)}},Is=async()=>{try{const B=await mk(e);v(B.data)}catch(B){console.error("Error fetching comments:",B)}},ea=async()=>{try{const B=await Qk(e);M(B.data)}catch(B){console.error("Error fetching bid specifications:",B)}},Rs=async()=>{try{const B=await Ga();ue(B.data)}catch(B){console.error("Error fetching users:",B)}},mu=async()=>{try{const B=await B1();A(B.data)}catch(B){console.error("Error fetching specifications:",B)}},vc=async()=>{try{const B=await U1();z(B.data)}catch(B){console.error("Error fetching specification categories:",B)}},ta=async()=>{try{const B=await Ak(e);Gt(B.data)}catch(B){console.error("Error fetching bid equipment:",B)}},yc=async()=>{try{const B=await Qd();tr(B.data)}catch(B){console.error("Error fetching equipment:",B)}},Hn=async()=>{try{const B=await rN(e);fe(B.data)}catch(B){console.error("Error fetching bid history:",B)}},Za=async()=>{try{const B=await I1(),Ue=(Array.isArray(B.data)?B.data:[]).filter(it=>it.parentId===parseInt(e));Br(Ue)}catch(B){console.error("Error fetching child bids:",B),Br([])}},bc=async()=>{try{const B=await ic();Bn(B.data)}catch(B){console.error("Error fetching clients:",B)}},zl=async B=>{if(!B){Sr([]);return}try{const Oe=await lc(B);Sr(Oe.data)}catch(Oe){console.error("Error fetching client objects:",Oe),Sr([])}},ei=async()=>{try{const B=await R1();Jr(B.data)}catch(B){console.error("Error fetching bid types:",B)}},ti=async()=>{try{const B=await L1();ps(B.data)}catch(B){console.error("Error fetching roles:",B)}},ys=async()=>{try{const Oe=(await yk(e)).data.map(mt=>({...mt,path:`${Ad}/bids/${e}/${decodeURIComponent(mt.name)}`}));V(Oe);const Ue=new Set,it=(mt,ar)=>new Promise(dt=>{if(mt.match(/\.(jpg|jpeg|png|gif|webp|bmp)$/i)){const vr=new Image;vr.onload=()=>dt(!0),vr.onerror=()=>{console.info(`  : ${ar}`),dt(!1)},vr.src=mt}else{const vr=new XMLHttpRequest;vr.open("HEAD",mt,!0),vr.onload=()=>dt(vr.status>=200&&vr.status<400),vr.onerror=()=>{console.info(`  : ${ar}`),dt(!1)},vr.ontimeout=()=>{console.info(`   (): ${ar}`),dt(!1)},vr.timeout=5e3,vr.send()}});for(const mt of Oe)await it(mt.path,mt.originalName||mt.name)||Ue.add(mt.name);U(Ue)}catch(B){console.error("Error fetching bid files:",B)}},_a=async()=>{try{const B=await pN(e);if(B.data&&B.data.data){const Oe=Array.isArray(B.data.data)?B.data.data:[B.data.data];Ys(Oe);const Ue=Mt&&Mt.length>0?Mt[0]:null;_e({clientName:s?.clientName||"",responsibleName:t?.fullName||s?.responsibleName||s?.currentResponsibleName||"",clientObject:s?.clientObject?`${s.clientObject.brandModel} ${s.clientObject.stateNumber||""}`:"",equipmentName:Ue?.equipment?.name||"",imei:Ue?.imei||"",quantity:Ue?.quantity||1,contractEndDate:s?.plannedResolutionDate?new Date(s.plannedResolutionDate).toISOString().split("T")[0]:""})}else{Ys([]);const Oe=Mt&&Mt.length>0?Mt[0]:null;_e({clientName:s?.clientName||"",responsibleName:t?.fullName||s?.responsibleName||s?.currentResponsibleName||"",clientObject:s?.clientObject?`${s.clientObject.brandModel} ${s.clientObject.stateNumber||""}`:"",equipmentName:Oe?.equipment?.name||"",imei:Oe?.imei||"",quantity:Oe?.quantity||1,contractEndDate:s?.plannedResolutionDate?new Date(s.plannedResolutionDate).toISOString().split("T")[0]:""})}}catch(B){console.error("Error fetching contracts:",B)}},pu=async()=>{try{const{contractNumber:B,...Oe}=C;Qn?await updateContract(Qn,Oe):await gN({bidId:parseInt(e),...Oe}),Js(!1),_a()}catch(B){console.error("Error saving contract:",B)}},gu=async B=>{if(B)try{await vN(B),_a(),Js(!1),gs(null)}catch(Oe){console.error("Error deleting contract:",Oe)}},$l=j.useRef(null),zi=async B=>{const Oe=Array.from(B.target.files);if(Oe.length!==0)try{G(!0),await bk(e,Oe),await ys()}catch(Ue){console.error("Error uploading files:",Ue),alert("   : "+(Ue.response?.data?.message||Ue.message))}finally{G(!1)}},Hl=B=>{const Oe={};return B.forEach(Ue=>{const it=new Date(Ue.createdAt),mt=it.toLocaleDateString("ru-RU",{day:"2-digit",month:"long",year:"numeric"}),ar=it.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}),dt=`${mt}_${ar}`;Oe[dt]||(Oe[dt]={dateKey:mt,timeKey:ar,uploaderName:Ue.uploaderName,files:[]}),Oe[dt].files.push(Ue)}),Object.values(Oe).sort((Ue,it)=>{const mt=new Date(Ue.dateKey+" "+Ue.timeKey);return new Date(it.dateKey+" "+it.timeKey)-mt})},wc=B=>{const Oe=new Set(Bi);Oe.has(B)?Oe.delete(B):Oe.add(B),Ll(Oe)},bs=B=>{xe(B),Ne(!0)},Wl=async()=>{if(ae)try{await Tp(e,ae),await ys()}catch(B){console.error("Error deleting file:",B),alert("   ")}finally{Ne(!1),xe(null)}},$i=async()=>{if(!(L.size===0||!window.confirm(`    (${L.size} .)?`)))try{const Oe=Array.from(L).map(Ue=>Tp(e,Ue).catch(it=>{console.error(`Error deleting file ${Ue}:`,it)}));await Promise.all(Oe),await ys(),alert(` : ${L.size}`)}catch(Oe){console.error("Error deleting missing files:",Oe),alert("   ")}},Vl=async B=>{try{const Oe=await fetch(`/api/bids/${e}/files/${encodeURIComponent(B.name)}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(Oe.ok){const Ue=await Oe.blob(),it=window.URL.createObjectURL(Ue),mt=document.createElement("a");mt.href=it,mt.download=B.originalName,document.body.appendChild(mt),mt.click(),document.body.removeChild(mt),window.URL.revokeObjectURL(it)}else throw new Error("Failed to download file")}catch(Oe){console.error("   :",Oe);const Ue=document.createElement("a");Ue.href=`/api/bids/${e}/files/${encodeURIComponent(B.name)}`,Ue.target="_blank",Ue.rel="noopener noreferrer",document.body.appendChild(Ue),Ue.click(),document.body.removeChild(Ue)}},Hi=B=>{Te(B),Ae(100),Et(0),Vt({x:0,y:0}),E(!0),document.body.style.overflow="hidden"},Wi=()=>{E(!1),Te(null),Vt({x:0,y:0}),document.body.style.overflow=""};j.useEffect(()=>{const B=Ui.current;if(!B)return;const Oe=Ue=>{Ue.preventDefault();const it=Ue.deltaY>0?-10:10,mt=Math.min(Math.max(Fe+it,25),300);Ae(mt)};return B.addEventListener("wheel",Oe,{passive:!1}),()=>{B.removeEventListener("wheel",Oe)}},[R,Fe]);const _c=()=>{Ae(B=>Math.min(B+25,300))},bn=()=>{Ae(B=>Math.max(B-25,25))},ka=()=>{Et(B=>(B+90)%360)},ql=B=>{B.button===1&&(B.preventDefault(),zn(!0),hr({x:B.clientX-Ct.x,y:B.clientY-Ct.y}))},ri=B=>{const Oe=B.currentTarget.getBoundingClientRect();Kt({x:B.clientX-Oe.left,y:B.clientY-Oe.top}),Un&&Vt({x:B.clientX-gn.x,y:B.clientY-gn.y})},kc=B=>{B.button===1&&zn(!1)},Xl=async()=>{if(s&&s.bidTypeId)try{const B=await Nk(s.bidTypeId);kt(B.data)}catch(B){console.error("Error fetching bid statuses:",B)}},Gl=async()=>{if(s&&s.bidTypeId)try{const B=await Sk(s.bidTypeId);Ut(B.data)}catch(B){console.error("Error fetching bid status transitions:",B)}},ni=()=>{if(s.bidTypeResponsibleName)return s.bidTypeResponsibleName;if(s.bidTypeStatuses&&s.status){const B=s.bidTypeStatuses.find(Oe=>Oe.name===s.status);if(B&&B.responsibleRoleId){const Oe=Er.find(Ue=>Ue.id===parseInt(B.responsibleRoleId));if(Oe)return`: ${Oe.name}`}}return" "},si=()=>{if(!s||!fr.length||!Pt.length)return[];const B=fr.find(Ue=>Ue.name===s.status);return B?Pt.filter(Ue=>Ue.fromPosition===B.position).map(Ue=>fr.find(it=>it.position===Ue.toPosition)).filter(Boolean):[]},Nc=B=>!s||!s.bidTypeStatuses?null:s.bidTypeStatuses.find(Ue=>Ue.name===B)?.color||null,vu=(B,Oe)=>"#"+B.replace(/^#/,"").replace(/../g,Ue=>("0"+Math.min(255,Math.max(0,parseInt(Ue,16)+Oe)).toString(16)).substr(-2)),yu=async B=>{try{const Ue=!s.bidTypeStatuses?.find(it=>it.name===B)?.responsibleUserId;await Cp(e,{status:B,...Ue&&{currentResponsibleUserId:t?.id}}),Zn(),Hn()}catch(Oe){console.error("Error changing status:",Oe)}},bu=async B=>{if(B.preventDefault(),!!w.trim())try{await pk(e,{content:w}),S(""),Is(),Hn()}catch(Oe){console.error("Error creating comment:",Oe),alert("   . ,    .")}},Kl=B=>{N(B.id),W(B.content)},wu=()=>{N(null),W("")},_u=async()=>{if(P.trim())try{await gk(e,I,{content:P.trim()}),N(null),W(""),Is(),Hn()}catch(B){console.error("Error updating comment:",B),alert("   . ,    .")}},ku=async B=>{if(confirm(" ,     ?"))try{await vk(e,B),Is(),Hn()}catch(Oe){console.error("Error deleting comment:",Oe),alert("   . ,    .")}},Nu=async B=>{if(confirm(" ,     ?"))try{await tN(e,B),ea(),Hn()}catch(Oe){console.error("Error deleting specification:",Oe),alert("   .")}},Su=B=>{Lt(B),Or(""),rr(!0)},Sc=async()=>{if(Ar)try{await Pk(Ar.id,sr),rr(!1),Lt(null),Or(""),ta(),Hn()}catch(B){console.error("Error deleting equipment:",B),alert("   .")}},Ec=async B=>{try{await Cp(e,B),Zn(),Hn()}catch(Oe){console.error("Error updating bid:",Oe),alert("   .")}},Eu=async B=>{try{if(ce)await eN(e,ce.id,B);else{await Zk(e,B);const Oe=ne.find(Ue=>Ue.id.toString()===B.specificationId);await Ap({userId:s.createdBy,title:" ",message:`  ${s.id}   "${Oe?.name||""}"`,type:"specification_added",bidId:s.id})}H(!1),le(null),ea(),Hn()}catch(Oe){console.error("Error saving specification:",Oe),alert("   .")}},ju=async B=>{try{if(vt)await Rk(vt.id,B);else{const Oe=await P1(s.clientId);Oe.data.some(mt=>mt.equipmentId===parseInt(B.equipmentId))||await M1({clientId:s.clientId,equipmentId:B.equipmentId}),await Ik({...B,bidId:e});const it=Oe.data.find(mt=>mt.equipment&&mt.equipment.id.toString()===B.equipmentId);await Ap({userId:s.createdBy,title:" ",message:`  ${s.id}   "${it?.name||""}"`,type:"equipment_added",bidId:s.id})}qe(!1),ht(null),ta(),Hn()}catch(Oe){console.error("Error saving equipment:",Oe),alert("   .")}},Yl=()=>{const B=new Date;return B.setDate(B.getDate()+5),B.toISOString().slice(0,16)},Jl=async B=>{if(B.preventDefault(),!!ke.title.trim())try{await xk({clientId:ke.clientId,title:ke.title,description:ke.description,bidTypeId:ke.bidTypeId?parseInt(ke.bidTypeId):null,amount:ke.amount,workAddress:ke.workAddress,contactFullName:ke.contactFullName,contactPhone:ke.contactPhone,parentId:zr?null:parseInt(e),plannedResolutionDate:ke.plannedResolutionDate,plannedReactionTimeMinutes:ke.plannedReactionTimeMinutes,assignedAt:ke.assignedAt,plannedDurationMinutes:ke.plannedDurationMinutes,clientObjectId:ke.clientObjectId||null,status:""}),dr(!1),Yr(!1),Ve({clientId:"",title:"",bidTypeId:"",description:"",clientObjectId:"",workAddress:"",contactFullName:"",contactPhone:"",parentId:"",plannedResolutionDate:Yl(),plannedReactionTimeMinutes:"",assignedAt:"",plannedDurationMinutes:"",amount:0}),zr||Za()}catch(Oe){console.error("Error creating bid:",Oe),alert("    .")}},Cu=B=>{if(!B)return null;const Oe=new Date,it=new Date(B)-Oe;if(it<=0)return{text:"",color:"text-red-600",bgColor:"bg-red-100"};const mt=Math.floor(it/(1e3*60*60*24)),ar=Math.floor(it%(1e3*60*60*24)/(1e3*60*60)),dt=Math.floor(it%(1e3*60*60)/(1e3*60));return mt>0?{text:`${mt} ${ar} ${dt}`,color:mt>2?"text-green-600":"text-yellow-600",bgColor:mt>2?"bg-green-100":"bg-yellow-100"}:ar>0?{text:`${ar} ${dt}`,color:ar>5?"text-green-600":"text-orange-600",bgColor:ar>5?"bg-green-100":"bg-orange-100"}:{text:`${dt}`,color:"text-red-600",bgColor:"bg-red-100"}};if(c)return i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"text-gray-500",children:"..."})});if(d||!s)return i.jsxs("div",{className:"text-center py-8",children:[i.jsx("p",{className:"text-red-500 mb-4",children:d}),i.jsx("button",{onClick:()=>r("/dashboard/bids"),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:"  "})]});const Tu=s.createdAt?new Date(s.createdAt).toLocaleString("ru-RU",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"";return i.jsxs("div",{className:"flex min-h-screen",children:[i.jsxs("div",{className:"flex-1 p-4",children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("button",{onClick:()=>r("/dashboard/bids"),className:"text-black text-sm px-2 py-1 flex items-center",children:[i.jsx("span",{className:"text-blue-500 mr-1 font-bold",children:""})," "]})}),i.jsx("div",{className:"mb-4",children:i.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["",s.id," ",s.tema]})}),i.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("p",{className:"text-gray-900 text-lg cursor-pointer hover:text-blue-600 transition",onClick:()=>r(`/dashboard/clients/${s.clientId}`),children:s.clientName})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsx("div",{className:"text-gray-900",children:s.clientObject?i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:s.clientObject.brandModel}),i.jsxs("p",{className:"text-sm text-gray-600",children:[". : ",s.clientObject.stateNumber||"N/A"]})]}):i.jsx("p",{className:"text-gray-500",children:" "})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" /"}),i.jsx("p",{className:"text-gray-900 text-lg",children:s.creatorName})]}),s.parent&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsxs("p",{className:"text-gray-900 text-lg cursor-pointer hover:text-blue-600 transition",onClick:()=>r(`/dashboard/bids/${s.parent.id}`),children:["",s.parent.id," ",s.parent.tema]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:",  "}),D?i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("input",{type:"text",value:we,onChange:B=>ye(B.target.value),className:"flex-1 min-w-[200px] max-w-[300px] px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:" "}),i.jsxs("div",{className:"flex flex-wrap gap-1 sm:gap-2 flex-shrink-0",children:[i.jsx("button",{onClick:()=>{Ec({updNumber:we}),Pe(!1)},className:"bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 sm:px-3 sm:py-2 text-sm rounded-lg whitespace-nowrap",children:""}),i.jsx("button",{onClick:()=>{ye(s.updNumber||""),Pe(!1)},className:"bg-gray-500 hover:bg-gray-600 text-white px-2 py-1 sm:px-3 sm:py-2 text-sm rounded-lg whitespace-nowrap",children:""})]})]}):i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("p",{className:"text-gray-900",children:we||" "}),i.jsx("button",{onClick:()=>Pe(!0),className:"text-blue-500 hover:text-blue-700",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  "}),Bt?i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("input",{type:"text",value:jt,onChange:B=>Rt(B.target.value),className:"flex-1 min-w-[200px] max-w-[400px] px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:" ..."}),i.jsxs("div",{className:"flex flex-wrap gap-1 sm:gap-2 flex-shrink-0",children:[i.jsx("button",{onClick:()=>{Ec({workAddress:jt}),bt(!1)},className:"bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 sm:px-3 sm:py-2 text-sm rounded-lg whitespace-nowrap",children:""}),i.jsx("button",{onClick:()=>{Rt(s.workAddress||""),bt(!1)},className:"bg-gray-500 hover:bg-gray-600 text-white px-2 py-1 sm:px-3 sm:py-2 text-sm rounded-lg whitespace-nowrap",children:""})]})]}):i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("p",{className:"text-gray-900",children:jt||" "}),i.jsx("button",{onClick:()=>bt(!0),className:"text-blue-500 hover:text-blue-700",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("p",{className:"text-gray-900",children:s.description||" "})]})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mt-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:""}),n("bid_equipment_add")&&i.jsx("button",{onClick:()=>qe(!0),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition text-sm",children:" "})]}),Mt.length>0?i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full bg-white border border-gray-300",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-50",children:[i.jsx("th",{className:"px-4 py-2 border-b text-left",children:""}),i.jsx("th",{className:"px-4 py-2 border-b text-left",children:"IMEI"}),i.jsx("th",{className:"px-4 py-2 border-b text-left",children:""}),i.jsx("th",{className:"px-4 py-2 border-b text-left",children:""})]})}),i.jsx("tbody",{children:Mt.map(B=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-2 border-b",children:B.equipment.name}),i.jsx("td",{className:"px-4 py-2 border-b",children:B.imei||"-"}),i.jsx("td",{className:"px-4 py-2 border-b",children:B.quantity}),i.jsxs("td",{className:"px-4 py-2 border-b",children:[i.jsx("button",{onClick:()=>{ht(B),qe(!0)},className:"text-blue-500 hover:text-blue-700 mr-2",children:""}),i.jsx("button",{onClick:()=>Su(B),className:"text-red-500 hover:text-red-700",children:""})]})]},B.id))})]})}):i.jsx("p",{className:"text-gray-500 text-center py-4",children:"  "})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mt-6",children:[i.jsx("div",{className:"border-b border-gray-200",children:i.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"comments",label:""},{id:"files",label:""},{id:"nested",label:" "},{id:"spec",label:""},{id:"contracts",label:""},{id:"print",label:" "}].map(B=>i.jsx("button",{onClick:()=>k(B.id),className:`py-2 px-1 border-b-2 font-medium text-sm ${y===B.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:B.label},B.id))})}),i.jsxs("div",{className:"mt-4",children:[y==="comments"&&i.jsxs("div",{children:[i.jsx("div",{className:"mb-4",children:i.jsxs("form",{onSubmit:bu,className:"flex gap-2",children:[i.jsx("input",{type:"text",value:w,onChange:B=>S(B.target.value),placeholder:" ...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),i.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:""})]})}),i.jsx("div",{className:"space-y-4",children:b.length>0?b.map(B=>i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsx("p",{className:"font-medium text-gray-900",children:B.user.fullName}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("p",{className:"text-sm text-gray-500",children:new Date(B.createdAt).toLocaleString("ru-RU",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}),t&&B.userId===t.id&&i.jsxs("div",{className:"flex space-x-1",children:[i.jsx("button",{onClick:()=>Kl(B),className:"text-blue-500 hover:text-blue-700 text-sm",title:"",children:""}),i.jsx("button",{onClick:()=>ku(B.id),className:"text-red-500 hover:text-red-700 text-sm",title:"",children:i.jsx(zo,{size:16})})]})]})]}),I===B.id?i.jsxs("div",{className:"space-y-2",children:[i.jsx("textarea",{value:P,onChange:Oe=>W(Oe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:_u,className:"bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm",children:""}),i.jsx("button",{onClick:wu,className:"bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded text-sm",children:""})]})]}):i.jsx("p",{className:"text-gray-700",children:B.content})]},B.id)):i.jsx("p",{className:"text-gray-500 text-center py-4",children:"  "})})]}),y==="files"&&i.jsxs("div",{children:[i.jsxs("div",{className:"mb-4 flex items-center space-x-4",children:[i.jsxs("label",{className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition cursor-pointer flex items-center gap-2",children:[i.jsx(q4,{size:18}),q?"...":" ",i.jsx("input",{ref:$l,type:"file",multiple:!0,onChange:zi,className:"hidden",accept:"*/*",disabled:q})]}),L.size>0&&i.jsxs("button",{onClick:$i,className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition flex items-center gap-2",children:[i.jsx(zo,{size:18}),"  (",L.size,")"]})]}),(()=>{const B=Ue=>{const it=["jpg","jpeg","png","gif","webp","bmp"],mt=Ue.split(".").pop().toLowerCase();return it.includes(mt)},Oe=Hl(O);return Oe.length>0?i.jsx("div",{className:"space-y-3",children:Oe.map((Ue,it)=>{const mt=Bi.has(`${Ue.dateKey}_${Ue.timeKey}`),ar=Ue.files.every(dt=>L.has(dt.name));return i.jsxs("div",{className:`rounded-lg border overflow-hidden ${ar?"bg-red-50 border-red-300":"bg-gray-50 border-gray-200"}`,children:[i.jsxs("div",{className:`p-3 border-b cursor-pointer flex items-center justify-between ${ar?"bg-red-100 border-red-300":"bg-gray-100 border-gray-200"}`,onClick:()=>wc(`${Ue.dateKey}_${Ue.timeKey}`),children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-sm font-medium text-gray-800",children:Ue.dateKey}),i.jsx("p",{className:"text-xs text-gray-600",children:Ue.timeKey})]}),i.jsxs("div",{className:"border-l border-gray-300 pl-3",children:[i.jsxs("p",{className:"text-sm font-medium text-gray-800",children:[Ue.files.length," ",Ue.files.length===1?"":Ue.files.length<=4?"":""]}),i.jsx("p",{className:"text-xs text-gray-600",children:Ue.uploaderName||" "})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[ar&&i.jsxs("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded",children:[Ue.files.length," "]}),i.jsx("span",{className:`transform transition-transform ${mt?"rotate-180":""}`,children:i.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]}),mt&&i.jsx("div",{className:"p-3 space-y-2",children:Ue.files.map((dt,vr)=>{const Ps=L.has(dt.name);return i.jsx("div",{className:`rounded border overflow-hidden ${Ps?"bg-red-50 border-red-200":"bg-white border-gray-200"}`,children:B(dt.originalName)?i.jsxs("div",{children:[i.jsx("div",{className:`p-2 border-b ${Ps?"bg-red-100 border-red-200":"bg-gray-50 border-gray-200"}`,children:i.jsx("p",{className:"text-sm font-medium text-gray-700 truncate",title:dt.originalName,children:dt.originalName})}),Ps?i.jsx("div",{className:"w-full h-32 bg-red-100 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Mp,{size:32,className:"text-red-400 mx-auto mb-1"}),i.jsx("p",{className:"text-red-600 text-sm font-medium",children:dt.originalName}),i.jsx("p",{className:"text-red-500 text-xs",children:"  "})]})}):i.jsx("img",{src:dt.path,alt:dt.originalName,className:"w-full h-20 object-contain bg-gray-100 cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>Hi(dt)}),i.jsx("div",{className:`p-2 border-t ${Ps?"bg-red-100 border-red-200":"bg-gray-50 border-gray-200"}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("p",{className:"text-xs text-gray-600",children:dt.size?dt.size>1024*1024?(dt.size/(1024*1024)).toFixed(2)+" ":dt.size>1024?(dt.size/1024).toFixed(2)+" ":dt.size+" ":""}),i.jsxs("div",{className:"flex gap-2",children:[!Ps&&i.jsxs("button",{onClick:()=>Vl(dt),className:"bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs flex items-center gap-1",children:[i.jsx(Pp,{size:12}),""]}),i.jsx("button",{onClick:()=>bs(dt.name),className:"bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs",children:""})]})]})})]}):i.jsx("div",{className:`p-2 ${Ps?"bg-red-50":""}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Mp,{size:24,className:Ps?"text-red-400":"text-blue-500"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900 text-sm truncate",title:dt.originalName,children:dt.originalName}),i.jsx("p",{className:"text-xs text-gray-500",children:dt.size?dt.size>1024*1024?`${(dt.size/(1024*1024)).toFixed(2)} `:dt.size>1024?`${(dt.size/1024).toFixed(2)} `:`${dt.size} `:" "})]})]}),i.jsxs("div",{className:"flex gap-2",children:[!Ps&&i.jsxs("button",{onClick:()=>Vl(dt),className:"bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs flex items-center gap-1",children:[i.jsx(Pp,{size:12}),""]}),i.jsx("button",{onClick:()=>bs(dt.name),className:"bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs",children:""})]})]})})},vr)})})]},it)})}):i.jsx("p",{className:"text-gray-500 text-center py-8",children:"  "})})()]}),y==="nested"&&i.jsx("div",{children:Nr.length>0?i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full bg-white border border-gray-300",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-50",children:[i.jsx("th",{className:"px-4 py-2 border-b text-left",children:"ID"}),i.jsx("th",{className:"px-4 py-2 border-b text-left",children:""}),i.jsx("th",{className:"px-4 py-2 border-b text-left",children:""}),i.jsx("th",{className:"px-4 py-2 border-b text-left",children:""}),i.jsx("th",{className:"px-4 py-2 border-b text-left",children:""}),i.jsx("th",{className:"px-4 py-2 border-b text-left",children:""})]})}),i.jsx("tbody",{children:Nr.map(B=>i.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>r(`/dashboard/bids/${B.id}`),children:[i.jsx("td",{className:"px-4 py-2 border-b",children:B.id}),i.jsx("td",{className:"px-4 py-2 border-b",children:" "}),i.jsx("td",{className:"px-4 py-2 border-b",children:B.title}),i.jsx("td",{className:"px-4 py-2 border-b",children:B.status}),i.jsx("td",{className:"px-4 py-2 border-b",children:new Date(B.createdAt).toLocaleDateString("ru-RU")}),i.jsx("td",{className:"px-4 py-2 border-b",children:i.jsx("button",{onClick:Oe=>{Oe.stopPropagation(),r(`/dashboard/bids/${B.id}`)},className:"text-blue-500 hover:text-blue-700",children:""})})]},B.id))})]})}):i.jsx("p",{className:"text-gray-500 text-center py-4",children:"  "})}),y==="spec"&&i.jsxs("div",{children:[i.jsx("div",{className:"mb-4 flex items-center space-x-4",children:i.jsx("button",{onClick:()=>H(!0),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:" "})}),X.length>0?i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full bg-white border border-gray-300",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-50",children:[i.jsx("th",{className:"px-4 py-2 border-b text-left",children:""}),i.jsx("th",{className:"px-4 py-2 border-b text-left",children:""}),i.jsx("th",{className:"px-4 py-2 border-b text-left",children:"%"}),i.jsx("th",{className:"px-4 py-2 border-b text-left",children:""}),i.jsx("th",{className:"px-4 py-2 border-b text-left",children:""}),i.jsx("th",{className:"px-4 py-2 border-b text-left",children:""})]})}),i.jsx("tbody",{children:X.map((B,Oe)=>i.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>{te(B),Se(!0)},children:[i.jsx("td",{className:"px-4 py-2 border-b",children:Oe+1}),i.jsx("td",{className:"px-4 py-2 border-b",children:B.specification.name}),i.jsxs("td",{className:"px-4 py-2 border-b",children:[B.discount||0,"%"]}),i.jsxs("td",{className:"px-4 py-2 border-b",children:[(B.specification.cost*(1-(B.discount||0)/100)).toFixed(2)," ."]}),i.jsx("td",{className:"px-4 py-2 border-b",children:B.executors&&B.executors.length>0?B.executors.map(Ue=>Ue.fullName).join(", "):" "}),i.jsxs("td",{className:"px-4 py-2 border-b",children:[i.jsx("button",{onClick:Ue=>{Ue.stopPropagation(),le(B),H(!0)},className:"text-blue-500 hover:text-blue-700 mr-2",children:""}),i.jsx("button",{onClick:Ue=>{Ue.stopPropagation(),Nu(B.id)},className:"text-red-500 hover:text-red-700",children:""})]})]},B.id))})]})}):i.jsx("p",{className:"text-gray-500 text-center py-4",children:"  "}),X.length>0&&i.jsxs("div",{className:"mt-6",children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:" "}),i.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:(()=>{const B={};X.forEach(Ue=>{const it=Ue.discount||0,mt=Ue.specification.cost*(1-it/100),ar=Ue.executors||[],dt=mt/ar.length;ar.forEach(vr=>{B[vr.id]||(B[vr.id]={user:vr,total:0}),B[vr.id].total+=dt})});const Oe=Object.values(B).sort((Ue,it)=>it.total-Ue.total);return Oe.length>0?i.jsxs("table",{className:"min-w-full bg-white border border-gray-300",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-100",children:[i.jsx("th",{className:"px-4 py-2 border-b text-left",children:""}),i.jsx("th",{className:"px-4 py-2 border-b text-left",children:""})]})}),i.jsx("tbody",{children:Oe.map(({user:Ue,total:it})=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-2 border-b font-medium",children:Ue.fullName}),i.jsxs("td",{className:"px-4 py-2 border-b text-green-600 font-semibold",children:[it.toFixed(2)," ."]})]},Ue.id))})]}):i.jsx("p",{className:"text-gray-500",children:"   "})})()})]})]}),y==="contracts"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),vn&&vn.length>0?i.jsx("div",{className:"space-y-2",children:vn.map(B=>i.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-3 cursor-pointer hover:bg-gray-50 transition",onClick:()=>{_e({bidEquipmentId:B.bidEquipmentId||null,contractNumber:B.contractNumber||"",clientName:B.clientName||s?.clientName||"",responsibleName:B.responsibleName||t?.fullName||s?.currentResponsibleName||"",clientObject:B.clientObject||(s?.clientObject?`${s.clientObject.brandModel} ${s.clientObject.stateNumber||""}`:""),equipmentName:B.equipmentName||"",imei:B.imei||"",quantity:B.quantity||1,contractEndDate:B.contractEndDate?new Date(B.contractEndDate).toISOString().split("T")[0]:""}),gs(B.id),$n(!0),Js(!0)},children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Sl,{size:18,className:"text-green-500"}),i.jsxs("span",{className:"text-green-600 font-medium",children:[" ",B.contractNumber]})]})},B.id))}):i.jsx("p",{className:"text-gray-500 text-sm",children:" "}),(()=>{const B=vn&&vn.length>0?vn.map(it=>it.bidEquipmentId).filter(it=>it!==null):[],Oe=Mt&&Mt.length>0?Mt.filter(it=>!B.includes(it.id)):[],Ue=Oe.length>0;return i.jsxs("button",{onClick:()=>{const it=Oe.length>0?Oe[0]:null;_e({bidEquipmentId:it?.id||null,clientName:s?.clientName||"",responsibleName:t?.fullName||s?.responsibleName||s?.currentResponsibleName||"",clientObject:s?.clientObject?`${s.clientObject.brandModel} ${s.clientObject.stateNumber||""}`:"",equipmentName:it?.equipment?.name||"",imei:it?.imei||"",quantity:it?.quantity||1,contractEndDate:s?.plannedResolutionDate?new Date(s.plannedResolutionDate).toISOString().split("T")[0]:""}),gs(null),$n(!1),Js(!0)},disabled:!Ue,className:`${Ue?"bg-green-500 hover:bg-green-600":"bg-gray-300 cursor-not-allowed"} text-white px-4 py-2 rounded-lg transition text-sm flex items-center gap-2 mt-3 w-full justify-center`,children:[i.jsx(Sl,{size:18}),Ue?" ":"   "]})})()]}),y==="print"&&i.jsx("div",{className:"text-center py-8",children:i.jsx("p",{className:"text-gray-500",children:"   "})})]})]})]}),i.jsxs("div",{className:"w-64 bg-white shadow pb-4 pt-0 ml-4 relative",children:[i.jsxs("div",{className:"mb-4 relative status-dropdown-container",children:[i.jsx("div",{className:"w-full p-2 text-lg text-left text-white cursor-pointer",style:{backgroundColor:Nc(s.status)||"#7a7777"},onClick:()=>p(!m),children:s.status}),m&&i.jsx("div",{className:"absolute top-full left-0 right-0 bg-white/80 border border-gray-300 shadow-lg z-10 mt-1 p-1",children:i.jsxs("div",{className:"py-1 space-y-1",children:[si().map(B=>i.jsx("button",{onClick:()=>{yu(B.name),p(!1)},className:"w-full text-left px-4 py-2 transition-colors text-white",style:{backgroundColor:B.color||"#7a7777"},onMouseEnter:Oe=>Oe.target.style.backgroundColor=B.color?vu(B.color,-10):"#6a6666",onMouseLeave:Oe=>Oe.target.style.backgroundColor=B.color||"#7a7777",children:B.name},B.position)),si().length===0&&i.jsx("div",{className:"px-4 py-2 text-gray-500 text-sm",children:"    "})]})})]}),i.jsxs("div",{className:"p-2",children:[i.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:" "}),i.jsx("p",{className:"text-gray-900",children:s.bidType?s.bidType.name:" "})]}),i.jsxs("div",{className:"p-2",children:[i.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"   "}),i.jsx("p",{className:"text-gray-900",children:Tu})]}),i.jsxs("div",{className:"p-2",children:[i.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:""}),i.jsx("p",{className:"text-gray-900",children:ni()})]}),i.jsx("div",{className:"border-t border-gray-200 my-2"}),Ir&&s.status!==""&&i.jsxs("div",{className:"p-2",children:[i.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:" "}),i.jsxs("div",{className:`px-3 py-2 rounded-lg text-sm font-medium ${Ir.bgColor} ${Ir.color}`,children:[" ",Ir.text]})]}),i.jsxs("div",{className:"p-2",children:[i.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"   (SLA)"}),i.jsx("p",{className:"text-gray-900",children:s.plannedReactionTimeMinutes?`${s.plannedReactionTimeMinutes} .`:s.bidType?.plannedReactionTimeMinutes?`${s.bidType.plannedReactionTimeMinutes} .`:" "})]}),i.jsxs("div",{className:"p-2",children:[i.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"  ()"}),i.jsx("p",{className:"text-gray-900",children:s.plannedDurationMinutes?`${s.plannedDurationMinutes} .`:s.bidType?.plannedDurationMinutes?`${s.bidType.plannedDurationMinutes} .`:" "})]}),i.jsx("div",{className:"p-2",children:i.jsx("button",{onClick:()=>J(!0),className:"w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:""})}),n("bid_create")&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"p-2",children:i.jsx("button",{onClick:()=>{Ve({clientId:s.clientId.toString(),title:"",bidTypeId:s.bidTypeId?s.bidTypeId.toString():"",description:s.description||"",clientObjectId:s.clientObjectId?s.clientObjectId.toString():"",workAddress:s.workAddress||"",contactFullName:s.contactFullName||"",contactPhone:s.contactPhone||"",parentId:e,plannedResolutionDate:Yl(),plannedReactionTimeMinutes:s.plannedReactionTimeMinutes?s.plannedReactionTimeMinutes.toString():"",assignedAt:s.assignedAt?new Date(s.assignedAt).toISOString().slice(0,16):"",plannedDurationMinutes:s.plannedDurationMinutes?s.plannedDurationMinutes.toString():"",amount:s.amount||0}),s.clientId&&zl(s.clientId.toString()),Yr(!1),dr(!0)},className:"w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:" "})}),i.jsx("div",{className:"p-2",children:i.jsx("button",{onClick:()=>{Ve({clientId:s.clientId.toString(),title:s.tema||"",bidTypeId:s.bidTypeId?s.bidTypeId.toString():"",description:s.description||"",clientObjectId:s.clientObjectId?s.clientObjectId.toString():"",workAddress:s.workAddress||"",contactFullName:s.contactFullName||"",contactPhone:s.contactPhone||"",parentId:"",plannedResolutionDate:Yl(),plannedReactionTimeMinutes:s.plannedReactionTimeMinutes?s.plannedReactionTimeMinutes.toString():"",assignedAt:s.assignedAt?new Date(s.assignedAt).toISOString().slice(0,16):"",plannedDurationMinutes:s.plannedDurationMinutes?s.plannedDurationMinutes.toString():"",amount:s.amount||0}),s.clientId&&zl(s.clientId.toString()),Yr(!0),dr(!0)},className:"w-full bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition",children:" "})})]})]}),Z&&i.jsx(uS,{isOpen:Z,onClose:()=>{H(!1),le(null)},onSave:Eu,editingSpec:ce,specCategories:me,specifications:ne,availableUsers:Ce,currentUser:t,expandedCategories:T,setExpandedCategories:Q}),Ze&&i.jsx(fS,{isOpen:Ze,onClose:()=>{qe(!1),ht(null)},onSave:ju,editingEquipment:vt,equipment:Tt}),i.jsx(dS,{isOpen:he,onClose:()=>{Ne(!1),xe(null)},onConfirm:Wl,fileName:O.find(B=>B.name===ae)?.originalName||ae}),i.jsx(hS,{isOpen:qt,onClose:()=>{rr(!1),Lt(null),Or("")},onConfirm:Sc,equipment:Ar,reason:sr,setReason:Or}),i.jsx(mS,{isOpen:Bl,onClose:()=>{Js(!1),gs(null),$n(!1)},onSave:pu,onDelete:gu,showDeleteModal:ba,setShowDeleteModal:Qa,formData:C,setFormData:_e,bid:s,bidEquipment:Mt,user:t,editingContractId:Qn,contracts:vn,contractToDelete:vn?.find(B=>B.id===Qn),contractViewMode:wa,setContractViewMode:$n}),R&&ie&&i.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 overflow-hidden",children:[i.jsxs("div",{className:"absolute top-4 left-4 right-4 flex items-center justify-between text-white z-10",children:[i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("span",{className:"text-sm font-medium",children:ie.originalName})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:bn,className:"p-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",title:"",children:i.jsx(Z4,{size:20})}),i.jsxs("span",{className:"text-sm w-12 text-center",children:[Fe,"%"]}),i.jsx("button",{onClick:_c,className:"p-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",title:"",children:i.jsx(J4,{size:20})}),i.jsx("button",{onClick:ka,className:"p-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors ml-2",title:"",children:i.jsx(k4,{size:20})}),i.jsx("button",{onClick:Wi,className:"p-2 bg-red-600 hover:bg-red-500 rounded-lg transition-colors ml-4",title:"",children:i.jsx(El,{size:20})})]})]}),i.jsx("div",{ref:Ui,className:"w-full h-full flex items-center justify-center p-4",onMouseDown:ql,onMouseMove:ri,onMouseUp:kc,onMouseLeave:kc,style:{cursor:Un?"move":"default"},children:i.jsx("img",{src:ie.path,alt:ie.originalName,style:{transform:`rotate(${et}deg) scale(${Fe/100}) translate(${Ct.x}px, ${Ct.y}px)`,maxWidth:"100%",maxHeight:"100%",objectFit:"contain",transition:Un?"none":"transform 0.3s ease"}})})]}),ve&&re&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:" "}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("p",{className:"text-gray-900",children:re.specification.category.name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("p",{className:"text-gray-900",children:re.specification.name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" ()"}),i.jsxs("p",{className:"text-gray-900",children:[re.specification.cost," ."]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"   ()"}),i.jsxs("p",{className:"text-green-600 font-semibold",children:[Math.round(re.specification.cost*(1-(re.discount||0)/100))," ."]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsxs("p",{className:"text-gray-900",children:[re.discount||0,"%"]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("p",{className:"text-gray-900",children:re.executors&&re.executors.length>0?re.executors.map(B=>B.fullName).join(", "):" "})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsx("p",{className:"text-gray-900",children:new Date(re.createdAt).toLocaleString("ru-RU",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]})]}),i.jsx("div",{className:"flex justify-end space-x-2 mt-6",children:i.jsx("button",{onClick:()=>{Se(!1),te(null)},className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg",children:""})})]})}),Y&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:" "}),K.length>0?i.jsx("div",{className:"space-y-4",children:K.map((B,Oe)=>i.jsx("div",{className:"border-b pb-2",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:B.action}),i.jsxs("p",{className:"text-sm text-gray-600",children:[": ",B.user]})]}),i.jsx("p",{className:"text-sm text-gray-500",children:new Date(B.date).toLocaleString("ru-RU",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]})},Oe))}):i.jsx("p",{className:"text-gray-500 text-center py-4",children:" "}),i.jsx("div",{className:"flex justify-end space-x-2 mt-6",children:i.jsx("button",{onClick:()=>J(!1),className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg",children:""})})]})}),Ur&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-5xl max-h-[95vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:zr?" ":"  "}),i.jsxs("form",{onSubmit:Jl,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsxs("select",{value:ke.clientId,onChange:B=>{Ve({...ke,clientId:B.target.value,clientObjectId:""})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:" "}),En.map(B=>i.jsx("option",{value:B.id,children:B.name},B.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsxs("select",{value:ke.clientObjectId,onChange:B=>Ve({...ke,clientObjectId:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:ke.clientId?"  ()":"  "}),$r.map(B=>i.jsxs("option",{value:B.id,children:[B.brandModel," ",B.stateNumber?`(${B.stateNumber})`:""]},B.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:ke.title,onChange:B=>Ve({...ke,title:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsxs("select",{value:ke.bidTypeId,onChange:B=>Ve({...ke,bidTypeId:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"  "}),Dr.map(B=>i.jsx("option",{value:B.id,children:B.name},B.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx(oS,{value:ke.description||"",onChange:B=>Ve({...ke,description:B}),placeholder:"  ..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  "}),i.jsx("div",{className:"flex gap-2",children:i.jsx("input",{type:"text",value:ke.workAddress,onChange:B=>Ve({...ke,workAddress:B.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"   "})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"   "}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:ke.contactFullName,onChange:B=>Ve({...ke,contactFullName:B.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"  "}),i.jsx("input",{type:"text",value:ke.contactPhone,onChange:B=>Ve({...ke,contactPhone:B.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:" "})]})]}),i.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[i.jsx("button",{type:"button",onClick:()=>{pc(),dr(!1)},className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg",children:""}),i.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg",children:""})]})]})]})})]})},uS=({isOpen:e,onClose:r,onSave:t,editingSpec:n,specCategories:s,specifications:o,availableUsers:c,currentUser:u,expandedCategories:d,setExpandedCategories:h})=>{const[m,p]=j.useState(n?.specificationId||""),[y,k]=j.useState(n?.executorIds||[]),[b,v]=j.useState(""),[w,S]=j.useState(n?.discount||0),I=o.find(Z=>Z.id===parseInt(m)),N=()=>{b&&!y.includes(parseInt(b))&&(k([...y,parseInt(b)]),v(""))},P=Z=>{k(y.filter(H=>H!==Z))},W=()=>{if(!m){alert(" ");return}t({specificationId:m,executorIds:y,discount:parseFloat(w)||0})},X=Z=>{const H=new Set(d);H.has(Z)?H.delete(Z):H.add(Z),h(H)},M=({category:Z,specifications:H,selectedSpecId:ce,setSelectedSpecId:le,expandedCategories:re,toggleCategory:te,level:ve})=>{const Se=H.filter(A=>A.categoryId===Z.id),Ce=Z.children&&Z.children.length>0,ue=Se.length>0,ne=re.has(Z.id);return i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center p-3 bg-gray-50 border-b cursor-pointer hover:bg-gray-100",style:{paddingLeft:`${12+ve*20}px`},onClick:()=>te(Z.id),children:[(Ce||ue)&&i.jsx("span",{className:"mr-2",children:ne?"":""}),!(Ce||ue)&&i.jsx("span",{className:"mr-2 w-4"}),i.jsx("span",{className:"font-medium",children:Z.name}),i.jsxs("span",{className:"ml-auto text-sm text-gray-500",children:["(",Se.length,")"]})]}),ne&&i.jsxs("div",{children:[Se.map(A=>i.jsx("div",{className:`p-2 cursor-pointer hover:bg-blue-50 ${ce===A.id.toString()?"bg-blue-100":""}`,style:{paddingLeft:`${32+ve*20}px`},onClick:()=>le(A.id.toString()),children:i.jsx("span",{children:A.name})},A.id)),Z.children&&Z.children.map(A=>i.jsx(M,{category:A,specifications:H,selectedSpecId:ce,setSelectedSpecId:le,expandedCategories:re,toggleCategory:te,level:ve+1},A.id))]})]})};return e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:n?" ":" "}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "}),i.jsx("div",{className:"border border-gray-300 rounded-lg max-h-60 overflow-y-auto",children:s.map(Z=>i.jsx(M,{category:Z,specifications:o,selectedSpecId:m,setSelectedSpecId:p,expandedCategories:d,toggleCategory:X,level:0},Z.id))})]}),I&&i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("input",{type:"text",value:`${I.cost} .`,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"}),w!==0&&i.jsxs("div",{className:"text-sm text-gray-600",children:["  : ",(I.cost*(1-w/100)).toFixed(2)," ."]})]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" (%)"}),i.jsx("input",{type:"number",value:w,onChange:Z=>S(parseFloat(Z.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0"})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsxs("div",{className:"flex space-x-2 mb-2",children:[i.jsxs("select",{value:b,onChange:Z=>v(Z.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:" "}),c.filter(Z=>!y.includes(Z.id)).map(Z=>i.jsx("option",{value:Z.id,children:Z.fullName},Z.id))]}),i.jsx("button",{onClick:N,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg",disabled:!b,children:""})]}),y.length>0&&i.jsx("div",{className:"space-y-1",children:y.map(Z=>{const H=c.find(ce=>ce.id===Z);return i.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded",children:[i.jsx("span",{children:H?H.fullName:" "}),i.jsx("button",{onClick:()=>P(Z),className:"text-red-500 hover:text-red-700",children:""})]},Z)})})]}),i.jsxs("div",{className:"flex justify-end space-x-2",children:[i.jsx("button",{onClick:r,className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg",children:""}),i.jsx("button",{onClick:W,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg",children:n?"":""})]})]})}):null},fS=({isOpen:e,onClose:r,onSave:t,editingEquipment:n,equipment:s})=>{const[o,c]=j.useState(n?.equipmentId||""),[u,d]=j.useState(n?.imei||""),[h,m]=j.useState(n?.quantity||1);s.find(y=>y.id===parseInt(o));const p=()=>{if(!o){alert(" ");return}t({equipmentId:o,imei:u.trim()||null,quantity:parseInt(h)||1})};return e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:n?" ":" "}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsxs("select",{value:o,onChange:y=>c(y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:" "}),s.map(y=>i.jsx("option",{value:y.id,children:y.name},y.id))]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IMEI ()"}),i.jsx("input",{type:"text",value:u,onChange:y=>d(y.target.value),placeholder:" IMEI",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"number",value:h,onChange:y=>m(y.target.value),min:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{className:"flex justify-end space-x-2",children:[i.jsx("button",{onClick:r,className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg",children:""}),i.jsx("button",{onClick:p,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg",children:n?"":""})]})]})}):null},dS=({isOpen:e,onClose:r,onConfirm:t,fileName:n})=>e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"bg-red-100 p-3 rounded-full",children:i.jsx(zo,{size:24,className:"text-red-600"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" "})]}),i.jsxs("p",{className:"text-gray-600 mb-6",children:[" ,     ",i.jsx("span",{className:"font-medium text-gray-900",children:n}),"?",i.jsx("br",{}),i.jsx("span",{className:"text-sm text-gray-500",children:"   ."})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition",children:""}),i.jsx("button",{onClick:t,className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition",children:""})]})]})}):null,hS=({isOpen:e,onClose:r,onConfirm:t,equipment:n,reason:s,setReason:o})=>!e||!n?null:i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"bg-red-100 p-3 rounded-full",children:i.jsx(zo,{size:24,className:"text-red-600"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" "})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  :"}),i.jsx("p",{className:"text-gray-900 font-medium",children:n.equipment?.name||""}),n.imei&&i.jsxs("p",{className:"text-sm text-gray-600",children:["IMEI: ",n.imei]}),n.quantity>1&&i.jsxs("p",{className:"text-sm text-gray-600",children:[": ",n.quantity]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["  ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{value:s,onChange:c=>o(c.target.value),placeholder:"   ...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,required:!0})]}),i.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"      ."}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition",children:""}),i.jsx("button",{onClick:t,disabled:!s.trim(),className:`px-4 py-2 rounded-lg transition ${s.trim()?"bg-red-500 hover:bg-red-600 text-white":"bg-red-300 text-white cursor-not-allowed"}`,children:""})]})]})}),xS=({isOpen:e,onClose:r,onConfirm:t,contract:n})=>!e||!n?null:i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"bg-red-100 p-3 rounded-full",children:i.jsx(zo,{size:24,className:"text-red-600"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" "})]}),i.jsxs("p",{className:"text-gray-600 mb-6",children:[" ,     ",i.jsx("span",{className:"font-medium text-gray-900",children:n.contractNumber}),"?",i.jsx("br",{}),i.jsx("span",{className:"text-sm text-gray-500",children:"   ."})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition",children:""}),i.jsx("button",{onClick:t,className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition",children:""})]})]})}),mS=({isOpen:e,onClose:r,onSave:t,onDelete:n,showDeleteModal:s,setShowDeleteModal:o,formData:c,setFormData:u,bid:d,bidEquipment:h,user:m,editingContractId:p,contracts:y,contractToDelete:k,contractViewMode:b,setContractViewMode:v})=>{if(!e)return null;const w=b&&p!==null,S=p!==null&&!b,I=d?.clientObject?`${d.clientObject.brandModel} ${d.clientObject.stateNumber||""}`:"",N=m?.fullName||"",P=y&&y.length>0?y.map(H=>H.bidEquipmentId).filter(H=>H!==null):[],W=h&&h.length>0?h.map(H=>({id:H.id,name:H.equipment?.name||" ",imei:H.imei||"",quantity:H.quantity||1,hasContract:P.includes(H.id)})):[],X=S?W:W.filter(H=>!H.hasContract),M=W.find(H=>H.id===c.bidEquipmentId),Z=H=>{const ce=parseInt(H.target.value),le=W.find(re=>re.id===ce);le&&u(re=>({...re,bidEquipmentId:ce,equipmentName:le.name,imei:le.imei,quantity:le.quantity}))};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:i.jsx(Sl,{size:24,className:"text-green-600"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:w?"":S?" ":" "}),w&&i.jsxs("span",{className:"bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-medium",children:["",c.contractNumber]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:c.clientName||d?.clientName||"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-600 cursor-not-allowed"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:N||c.responsibleName||"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-600 cursor-not-allowed"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:c.clientObject||I||"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-600 cursor-not-allowed"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",w?"":i.jsx("span",{className:"text-red-500",children:"*"})]}),w?i.jsx("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-900",children:c.equipmentName||" "}):i.jsxs(i.Fragment,{children:[i.jsxs("select",{value:M?.id||"",onChange:Z,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:S&&!M?.hasContract,children:[i.jsx("option",{value:"",children:" "}),X.map(H=>i.jsxs("option",{value:H.id,disabled:H.hasContract&&!S,children:[H.name," ",H.imei?`(IMEI: ${H.imei})`:""," x",H.quantity,H.hasContract?" ":""]},H.id))]}),X.length===0&&!S&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"    "}),W.length===0&&i.jsx("p",{className:"text-xs text-red-500 mt-1",children:"   "})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IMEI"}),i.jsx("input",{type:"text",value:c.imei,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-600 cursor-not-allowed"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"number",value:c.quantity,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-600 cursor-not-allowed"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),w?i.jsx("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-900",children:c.contractEndDate?new Date(c.contractEndDate).toLocaleDateString("ru-RU"):" "}):i.jsx("input",{type:"date",value:c.contractEndDate,onChange:H=>u(ce=>({...ce,contractEndDate:H.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[w&&n&&i.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition",children:""}),S&&!w&&n&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>o(!0),className:"px-4 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition",children:""}),i.jsx(xS,{isOpen:s,onClose:()=>o(!1),onConfirm:()=>{n(p),o(!1),r()},contract:k})]}),i.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition",children:w?"":""}),!w&&i.jsx("button",{onClick:t,disabled:!c.equipmentName,className:`px-4 py-2 rounded-lg transition ${c.equipmentName?"bg-green-500 hover:bg-green-600 text-white":"bg-green-300 text-white cursor-not-allowed"}`,children:S?"":""})]})]})})},pS=()=>{const{id:e}=Xd(),r=xs(),{hasPermission:t}=Xs(),[n,s]=j.useState(null),[o,c]=j.useState(!0),[u,d]=j.useState(""),[h,m]=j.useState(""),[p,y]=j.useState(!1),[k,b]=j.useState({brandModel:"",stateNumber:"",equipment:"",responsibleId:""}),[v,w]=j.useState([]),[S,I]=j.useState([]),[N,P]=j.useState(!1),[W,X]=j.useState(!1),[M,Z]=j.useState(null);j.useEffect(()=>{H(),ce(),le()},[e]);const H=async()=>{try{const ue=await Vk(e);s(ue.data),b({brandModel:ue.data.brandModel,stateNumber:ue.data.stateNumber,equipment:ue.data.equipment||"",responsibleId:ue.data.responsible?.id?.toString()||""})}catch(ue){d("  "),console.error("Error fetching client object:",ue)}finally{c(!1)}},ce=async()=>{try{const ue=await ic();w(ue.data)}catch(ue){console.error("Error fetching clients:",ue)}},le=async()=>{try{const ue=await Ga();I(ue.data)}catch(ue){console.error("Error fetching users:",ue)}},re=()=>{y(!0)},te=async()=>{try{await Xk(e,k),s({...n,...k}),y(!1)}catch(ue){console.error("Error updating object:",ue)}},ve=()=>{b({brandModel:n.brandModel,stateNumber:n.stateNumber,equipment:n.equipment||"",responsibleId:n.responsible?.id?.toString()||""}),y(!1)},Se=()=>{if(n.bids&&n.bids.length>0){X(!0);return}P(!0)},Ce=async()=>{try{await Gk(e),r("/dashboard/objects")}catch(ue){console.error("Error deleting object:",ue),Z({type:"error",message:"   ."}),setTimeout(()=>Z(null),3e3)}finally{P(!1)}};return o?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"text-gray-500",children:"..."})}):u||!n?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("p",{className:"text-red-500 mb-4",children:u}),i.jsx("button",{onClick:()=>r("/dashboard/clients"),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:"  "})]}):i.jsxs("div",{children:[M&&i.jsx("div",{className:`fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ${M.type==="error"?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:M.message}),W&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full",children:[i.jsx("h3",{className:"text-lg font-bold mb-4",children:"  "}),i.jsx("p",{className:"mb-4",children:"     :"}),i.jsx("ul",{className:"mb-4 space-y-2",children:n.bids.map(ue=>i.jsxs("li",{className:"flex items-center gap-2",children:[i.jsxs("span",{className:"font-medium",children:[" ",ue.id]}),i.jsx("span",{children:ue.tema})]},ue.id))}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{onClick:()=>X(!1),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:""})})]})}),N&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[i.jsx("h3",{className:"text-lg font-bold mb-4",children:" "}),i.jsx("p",{className:"mb-4",children:" ,     ?"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:Ce,className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition",children:""}),i.jsx("button",{onClick:()=>P(!1),className:"bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded-lg transition",children:""})]})]})}),i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"  "}),i.jsxs("div",{className:"flex gap-2",children:[p?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:te,className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition",children:""}),i.jsx("button",{onClick:ve,className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition",children:""})]}):i.jsxs(i.Fragment,{children:[t("client_object_edit")&&i.jsx("button",{onClick:re,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:""}),t("client_object_delete")&&i.jsx("button",{onClick:Se,className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition",children:""})]}),i.jsx("button",{onClick:()=>r(-1),className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition",children:""})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"/"}),p?i.jsx("input",{type:"text",value:k.brandModel,onChange:ue=>b({...k,brandModel:ue.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}):i.jsx("p",{className:"text-gray-900 text-lg",children:n.brandModel})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:". "}),p?i.jsx("input",{type:"text",value:k.stateNumber,onChange:ue=>b({...k,stateNumber:ue.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}):i.jsx("p",{className:"text-gray-900 text-lg",children:n.stateNumber})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("span",{className:"text-blue-600 text-lg cursor-pointer hover:underline",onClick:()=>r(`/dashboard/clients/${n.client.id}`),children:n.client.name})]}),p&&i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("textarea",{value:k.equipment,onChange:ue=>b({...k,equipment:ue.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",placeholder:""})]}),!p&&i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("span",{className:"text-gray-900",children:n.responsible?n.responsible.fullName:" "})]}),p&&i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsxs("select",{value:k.responsibleId,onChange:ue=>b({...k,responsibleId:ue.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:" "}),S.map(ue=>i.jsx("option",{value:ue.id,children:ue.fullName||ue.username},ue.id))]})]})]})}),i.jsxs("div",{className:"mt-6",children:[i.jsx("div",{className:"flex space-x-1 mb-4",children:["",""].map(ue=>i.jsx("button",{onClick:()=>m(ue),className:`px-4 py-2 rounded-t-lg font-medium transition ${h===ue?"bg-white text-blue-600 border-b-2 border-blue-600":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:ue},ue))}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h===""&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:" "}),n.bids&&n.bids.length>0?i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.bids.map(ue=>i.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>r(`/dashboard/bids/${ue.id}`),children:[i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[" ",ue.id]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ue.tema}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${ue.status==="Accepted"?"bg-green-100 text-green-800":ue.status==="Rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:ue.status==="Pending"?" ":ue.status==="Accepted"?"":ue.status==="Rejected"?"":ue.status})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"max-w-xs truncate",children:ue.description})})]},ue.id))})]})}):i.jsx("p",{className:"text-gray-500",children:"  "})]}),h===""&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:""}),i.jsx("p",{className:"text-center text-gray-500",children:"  "})]})]})]})]})},gS=()=>{const e=xs(),{hasPermission:r}=Xs(),{user:t}=Oi(),[n,s]=j.useState([]),[o,c]=j.useState([]),[u,d]=j.useState([]),[h,m]=j.useState(!1),[p,y]=j.useState(""),[k,b]=j.useState({clientId:"",brandModel:"",stateNumber:"",responsibleId:""}),[v,w]=j.useState({client:[],brandModel:[],responsible:[]}),[S,I]=j.useState({client:!1,brandModel:!1,responsible:!1}),[N,P]=j.useState(()=>{const A=localStorage.getItem("objectsVisibleFilters");return A?JSON.parse(A):{client:!1,brandModel:!1,responsible:!1}}),[W,X]=j.useState(!1);j.useEffect(()=>{M(),Z(),H(),m(!1)},[]),j.useEffect(()=>{localStorage.setItem("objectsVisibleFilters",JSON.stringify(N))},[N]),j.useEffect(()=>{const A=me=>{me.target.closest(".filter-dropdown")||I(T=>{const Q={};return Object.keys(T).forEach(Y=>{Q[Y]=!1}),Q})};return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[]);const M=async()=>{try{const A=await lc();s(A.data)}catch(A){console.error("Error fetching objects:",A)}},Z=async()=>{try{const A=await ic();c(A.data)}catch(A){console.error("Error fetching clients:",A)}},H=async()=>{try{const A=await Ga();d(A.data)}catch(A){console.error("Error fetching users:",A)}},ce=async A=>{A.preventDefault();try{const me=await qk(k);e(`/dashboard/client-objects/${me.data.id}`)}catch(me){console.error("Error saving object:",me)}},le=A=>{e(`/dashboard/client-objects/${A.id}`)},re=()=>{const A=t?t.id.toString():"";b({clientId:"",brandModel:"",stateNumber:"",responsibleId:A}),m(!1)},te=(A,me)=>{w(z=>{const T=z[A];return T.includes(me)?{...z,[A]:T.filter(Q=>Q!==me)}:{...z,[A]:[...T,me]}})},ve=A=>{w(me=>({...me,[A]:[]}))},Se=[...new Set(n.map(A=>A.client.name))].sort(),Ce=[...new Set(n.map(A=>A.brandModel))].sort(),ue=[...new Set(n.map(A=>A.responsible?.fullName).filter(Boolean))].sort(),ne=n.filter(A=>{const me=A.id.toString().includes(p)||A.client.name.toLowerCase().includes(p.toLowerCase())||A.brandModel.toLowerCase().includes(p.toLowerCase()),z=v.client.length===0||v.client.includes(A.client.name),T=v.brandModel.length===0||v.brandModel.includes(A.brandModel),Q=v.responsible.length===0||A.responsible&&v.responsible.includes(A.responsible.fullName);return me&&z&&T&&Q});return i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:""}),h&&i.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"  "}),i.jsxs("form",{onSubmit:ce,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsxs("select",{value:k.clientId,onChange:A=>b({...k,clientId:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:" "}),o.map(A=>i.jsx("option",{value:A.id,children:A.name},A.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"/"}),i.jsx("input",{type:"text",value:k.brandModel,onChange:A=>b({...k,brandModel:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:". "}),i.jsx("input",{type:"text",value:k.stateNumber,onChange:A=>b({...k,stateNumber:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsxs("select",{value:k.responsibleId,onChange:A=>b({...k,responsibleId:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:" "}),u.map(A=>i.jsx("option",{value:A.id,children:A.fullName||A.username},A.id))]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"    "})]}),i.jsxs("div",{className:"flex gap-2 pt-4",children:[i.jsx("button",{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition",children:""}),i.jsx("button",{type:"button",onClick:re,className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})]})]})]}),!h&&i.jsxs("div",{children:[i.jsxs("div",{className:"bg-gray-200 rounded-lg p-4 mb-6",children:[i.jsxs("div",{className:"flex justify-end gap-2 mb-4",children:[i.jsx("button",{onClick:()=>X(!0),className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition",children:""}),r("client_object_create")&&i.jsx("button",{onClick:()=>{const A=t?t.id.toString():"";b(me=>({...me,responsibleId:A})),m(!h)},className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:h?"":"+  "})]}),i.jsx("input",{type:"text",placeholder:"   ,   ...",value:p,onChange:A=>y(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 mb-4"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[N.client&&i.jsxs("div",{className:"relative filter-dropdown",children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["",v.client.length>0&&` (${v.client.length})`]}),i.jsxs("button",{onClick:()=>I(A=>({...A,client:!A.client})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-left flex justify-between items-center hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("span",{className:"truncate",children:v.client.length===0?"":`${v.client.length} `}),i.jsx(vl,{size:16,className:`transition-transform ${S.client?"rotate-180":""}`})]}),S.client&&i.jsxs("div",{className:"absolute z-10 mt-1 w-full border border-gray-300 rounded-lg bg-white shadow-lg max-h-48 overflow-y-auto",children:[i.jsx("div",{className:"p-2 border-b bg-gray-50 sticky top-0",children:i.jsxs("label",{className:"flex items-center text-sm cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:v.client.length===0,onChange:()=>ve("client"),className:"mr-2"}),i.jsx("span",{className:"font-medium",children:""})]})}),Se.map(A=>i.jsxs("label",{className:"flex items-center p-2 hover:bg-gray-50 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:v.client.includes(A),onChange:()=>te("client",A),className:"mr-2"}),i.jsx("span",{className:"text-sm truncate",children:A})]},A))]})]}),N.brandModel&&i.jsxs("div",{className:"relative filter-dropdown",children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["/",v.brandModel.length>0&&` (${v.brandModel.length})`]}),i.jsxs("button",{onClick:()=>I(A=>({...A,brandModel:!A.brandModel})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-left flex justify-between items-center hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("span",{className:"truncate",children:v.brandModel.length===0?"":`${v.brandModel.length} `}),i.jsx(vl,{size:16,className:`transition-transform ${S.brandModel?"rotate-180":""}`})]}),S.brandModel&&i.jsxs("div",{className:"absolute z-10 mt-1 w-full border border-gray-300 rounded-lg bg-white shadow-lg max-h-48 overflow-y-auto",children:[i.jsx("div",{className:"p-2 border-b bg-gray-50 sticky top-0",children:i.jsxs("label",{className:"flex items-center text-sm cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:v.brandModel.length===0,onChange:()=>ve("brandModel"),className:"mr-2"}),i.jsx("span",{className:"font-medium",children:""})]})}),Ce.map(A=>i.jsxs("label",{className:"flex items-center p-2 hover:bg-gray-50 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:v.brandModel.includes(A),onChange:()=>te("brandModel",A),className:"mr-2"}),i.jsx("span",{className:"text-sm truncate",children:A})]},A))]})]}),N.responsible&&i.jsxs("div",{className:"relative filter-dropdown",children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["",v.responsible.length>0&&` (${v.responsible.length})`]}),i.jsxs("button",{onClick:()=>I(A=>({...A,responsible:!A.responsible})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-left flex justify-between items-center hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("span",{className:"truncate",children:v.responsible.length===0?"":`${v.responsible.length} `}),i.jsx(vl,{size:16,className:`transition-transform ${S.responsible?"rotate-180":""}`})]}),S.responsible&&i.jsxs("div",{className:"absolute z-10 mt-1 w-full border border-gray-300 rounded-lg bg-white shadow-lg max-h-48 overflow-y-auto",children:[i.jsx("div",{className:"p-2 border-b bg-gray-50 sticky top-0",children:i.jsxs("label",{className:"flex items-center text-sm cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:v.responsible.length===0,onChange:()=>ve("responsible"),className:"mr-2"}),i.jsx("span",{className:"font-medium",children:""})]})}),ue.map(A=>i.jsxs("label",{className:"flex items-center p-2 hover:bg-gray-50 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:v.responsible.includes(A),onChange:()=>te("responsible",A),className:"mr-2"}),i.jsx("span",{className:"text-sm truncate",children:A})]},A))]})]})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto table-container flex-1 min-h-0",children:i.jsxs("table",{className:"divide-y divide-gray-200",style:{minWidth:"480px"},children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[120px]",style:{resize:"horizontal",overflow:"auto"},children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[120px]",style:{resize:"horizontal",overflow:"auto"},children:"/"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[120px]",style:{resize:"horizontal",overflow:"auto"},children:". "}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[120px]",style:{resize:"horizontal",overflow:"auto"},children:""})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ne.map(A=>i.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>le(A),children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:A.client.name}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:A.brandModel}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:A.stateNumber}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:A.responsible?A.responsible.fullName:"-"})]},A.id))})]})})]}),W&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h3",{className:"text-xl font-bold",children:" "}),i.jsx("button",{onClick:()=>X(!1),className:"text-gray-500 hover:text-gray-700",children:i.jsx(El,{size:24})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition",children:[i.jsx("input",{type:"checkbox",checked:N.client,onChange:()=>P({...N,client:!N.client}),className:"w-5 h-5 text-blue-500 rounded focus:ring-blue-500"}),i.jsx("span",{className:"text-gray-700",children:"  "})]}),i.jsxs("label",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition",children:[i.jsx("input",{type:"checkbox",checked:N.brandModel,onChange:()=>P({...N,brandModel:!N.brandModel}),className:"w-5 h-5 text-blue-500 rounded focus:ring-blue-500"}),i.jsx("span",{className:"text-gray-700",children:"  /"})]}),i.jsxs("label",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition",children:[i.jsx("input",{type:"checkbox",checked:N.responsible,onChange:()=>P({...N,responsible:!N.responsible}),className:"w-5 h-5 text-blue-500 rounded focus:ring-blue-500"}),i.jsx("span",{className:"text-gray-700",children:"  "})]})]}),i.jsx("div",{className:"flex gap-2 pt-4",children:i.jsx("button",{onClick:()=>X(!1),className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})})]})})]})};function vS({isOpen:e,title:r="",message:t=" ?",confirmText:n="",cancelText:s="",onConfirm:o,onCancel:c,confirmButtonColor:u="red"}){const[d,h]=j.useState(!1);if(j.useEffect(()=>{e&&h(!0)},[e]),!d)return null;const m=()=>{o(),h(!1)},p=()=>{c(),h(!1)},y={red:"bg-red-500 hover:bg-red-600 focus:ring-red-500",blue:"bg-blue-500 hover:bg-blue-600 focus:ring-blue-500",green:"bg-green-500 hover:bg-green-600 focus:ring-green-500"};return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-[9998] bg-black/50 backdrop-blur-sm",onClick:p}),i.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-6 transform transition-all duration-200",onClick:k=>k.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${u==="red"?"bg-red-100":"bg-blue-100"}`,children:i.jsx("svg",{className:`w-6 h-6 ${u==="red"?"text-red-500":"text-blue-500"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),i.jsx("h3",{className:"text-xl font-bold text-gray-900",children:r})]}),i.jsx("p",{className:"text-gray-600 mb-6",children:t}),i.jsxs("div",{className:"flex gap-3 justify-end",children:[i.jsx("button",{onClick:p,className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-lg transition-colors",children:s}),i.jsx("button",{onClick:m,className:`px-4 py-2 ${y[u]||y.red} text-white font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2`,children:n})]})]})})]})}const yS=()=>{const e=xs(),{hasPermission:r}=Xs(),[t,n]=j.useState([]),[s,o]=j.useState([]),[c,u]=j.useState(""),[d,h]=j.useState(null),[m,p]=j.useState(!1),[y,k]=j.useState(!1),[b,v]=j.useState(null),w=j.useRef(null),S=["id","name","productCode","purchasePrice","sellingPrice"],I=localStorage.getItem("equipmentVisibleColumns"),N={id:!0,name:!0,productCode:!0,sellingPrice:!0,purchasePrice:!0},P=I?{...N,...JSON.parse(I),sellingPrice:!0,purchasePrice:!0,productCode:!0}:N,W=localStorage.getItem("equipmentColumnOrder"),X=W?[...new Set([...JSON.parse(W).filter(R=>S.includes(R)),...S])]:S,[M,Z]=j.useState(X),[H,ce]=j.useState(P),[le,re]=j.useState(!1),[te,ve]=j.useState({name:"",productCode:"",sellingPrice:"",purchasePrice:"",description:""}),[Se,Ce]=j.useState(""),[ue,ne]=j.useState([]),[A,me]=j.useState("nomenclature"),[z,T]=j.useState(null),[Q,Y]=j.useState(!1),[J,K]=j.useState([]),[fe,we]=j.useState(!1),[ye,je]=j.useState(!1),[Xe,D]=j.useState(0),[Pe,rt]=j.useState(!1),xt=j.useRef(0),nt=j.useRef(0),Le=["bidId","bidTema","clientObject","client","equipmentName","imei","quantity"],jt=localStorage.getItem("expenseHistoryVisibleColumns"),Rt={bidId:!0,bidTema:!0,clientObject:!0,client:!0,equipmentName:!0,imei:!0,quantity:!0},Bt=jt?{...Rt,...JSON.parse(jt)}:Rt,bt=localStorage.getItem("expenseHistoryColumnOrder"),fr=bt?[...new Set([...JSON.parse(bt).filter(R=>Le.includes(R)),...Le])]:Le,[kt,Pt]=j.useState(fr),[Ut,Mt]=j.useState(Bt),[Gt,Tt]=j.useState(!1),[tr,Ze]=j.useState(!1),[qe,vt]=j.useState([]);j.useEffect(()=>{ht()},[]),j.useEffect(()=>{A==="expense-history"&&qt()},[A]),j.useEffect(()=>{const R=()=>{A==="expense-history"&&!document.hidden&&qt()};return document.addEventListener("visibilitychange",R),()=>document.removeEventListener("visibilitychange",R)},[A]),j.useEffect(()=>{A==="return-history"&&rr()},[A]),j.useEffect(()=>{const R=()=>{A==="return-history"&&!document.hidden&&rr()};return document.addEventListener("visibilitychange",R),()=>document.removeEventListener("visibilitychange",R)},[A]),j.useEffect(()=>{z&&z.id!=="new"?K(z.images||[]):K([])},[z]),j.useEffect(()=>{localStorage.setItem("equipmentVisibleColumns",JSON.stringify(H))},[H]),j.useEffect(()=>{localStorage.setItem("equipmentColumnOrder",JSON.stringify(M))},[M]),j.useEffect(()=>{localStorage.setItem("expenseHistoryVisibleColumns",JSON.stringify(Ut))},[Ut]),j.useEffect(()=>{localStorage.setItem("expenseHistoryColumnOrder",JSON.stringify(kt))},[kt]),j.useEffect(()=>{const R=E=>{le&&!E.target.closest(".equipment-column-settings")&&re(!1),Gt&&!E.target.closest(".expense-history-column-settings")&&Tt(!1)};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[le,Gt]);const ht=async()=>{try{const R=await Qd();n(R.data)}catch(R){console.error("Error fetching equipment:",R)}},qt=async()=>{try{const R=await Ok();o(R.data)}catch(R){console.error("Error fetching expense history:",R)}},rr=async()=>{try{Ze(!0);const R=await Dk();vt(R.data)}catch(R){console.error("Error fetching return history:",R)}finally{Ze(!1)}},Ar=async R=>{R.preventDefault(),Ce("");try{if(d)await jk(d.id,te);else{const E=await Ek(te);T(E.data)}ht(),Or(),Y(!1)}catch(E){console.error("Error saving equipment:",E),Ce(E.response?.data?.message||"   ")}},Lt=()=>{T(null),Y(!1),K([]),d&&Or()},sr=async R=>{try{await Ck(R.id),ht()}catch(E){console.error("Error deleting equipment:",E),E.response?.data?.message?Ce(E.response.data.message):Ce("   ")}},Or=()=>{ve({name:"",productCode:"",sellingPrice:"",purchasePrice:"",description:""}),h(null),Ce(""),K([])},Nr=async R=>{const E=Array.from(R.target.files);if(E.length!==0){if(!z||z.id==="new"){alert("  ,   ");return}we(!0);try{const ie=await Tk(z.id,E);K(ie.data.images),T(Te=>({...Te,images:ie.data.images}))}catch(ie){console.error("Error uploading images:",ie),alert("   ")}finally{we(!1),w.current&&(w.current.value="")}}},Br=async R=>{if(!(!z||z.id==="new"))try{const E=await Fk(z.id,R);K(E.data.images),T(ie=>({...ie,images:E.data.images}))}catch(E){console.error("Error deleting image:",E),alert("   ")}},Ur=R=>{D(R),je(!0)},dr=()=>{je(!1)},zr=()=>{D(R=>(R+1)%J.length)},Yr=()=>{D(R=>(R-1+J.length)%J.length)},En=R=>{rt(!0),xt.current=R.type.includes("mouse")?R.clientX:R.touches[0].clientX},Bn=R=>{Pe&&(nt.current=R.type.includes("mouse")?R.clientX:R.touches[0].clientX)},$r=()=>{if(!Pe)return;const R=xt.current-nt.current;Math.abs(R)>50&&(R>0?zr():Yr()),rt(!1)};j.useEffect(()=>{const R=E=>{ye&&(E.key==="Escape"&&dr(),E.key==="ArrowRight"&&zr(),E.key==="ArrowLeft"&&Yr())};return window.addEventListener("keydown",R),()=>window.removeEventListener("keydown",R)},[ye,J.length]);const Sr=t.filter(R=>R.id.toString().includes(c)||R.name.toLowerCase().includes(c.toLowerCase())||R.productCode?.toString().includes(c)),Dr=M.filter(R=>H[R]),Jr=R=>{ce(E=>({...E,[R]:!E[R]}))},Er=R=>{if(R>0){const E=[...M];[E[R],E[R-1]]=[E[R-1],E[R]],Z(E)}},ps=R=>{if(R<M.length-1){const E=[...M];[E[R],E[R+1]]=[E[R+1],E[R]],Z(E)}},Ir=R=>({id:"ID",name:"",productCode:" ",sellingPrice:" ",purchasePrice:" "})[R]||R,jn=(R,E)=>{switch(E){case"id":return R.id;case"name":return R.name;case"productCode":return R.productCode||"-";case"sellingPrice":return R.sellingPrice?`${R.sellingPrice} `:"-";case"purchasePrice":return R.purchasePrice?`${R.purchasePrice} `:"-";default:return""}},O=R=>{Mt(E=>({...E,[R]:!E[R]}))},V=R=>{if(R>0){const E=[...kt];[E[R],E[R-1]]=[E[R-1],E[R]],Pt(E)}},L=R=>{if(R<kt.length-1){const E=[...kt];[E[R],E[R+1]]=[E[R+1],E[R]],Pt(E)}},U=R=>({bidId:" ",bidTema:" ",clientObject:" ",client:"",equipmentName:" ",imei:"IMEI",quantity:""})[R]||R,q=kt.filter(R=>Ut[R]),he=[...[{id:"nomenclature",label:""},{id:"expense-history",label:" "},{id:"return-history",label:" "}],...ue],Ne=R=>{ne(ue.filter(E=>E.id!==R)),A===R&&me("nomenclature")},ae=()=>J.length===0?i.jsx("div",{className:"bg-gray-100 rounded-lg h-64 flex items-center justify-center",children:i.jsxs("div",{className:"text-center text-gray-400",children:[i.jsx("svg",{className:"w-24 h-24 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),i.jsx("span",{children:" "})]})}):i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"bg-gray-100 rounded-lg h-64 overflow-hidden flex items-center justify-center relative",children:[J.length>1&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{const R=document.querySelector(".image-gallery-scroll");R&&R.scrollBy({left:-200,behavior:"smooth"})},className:"absolute left-2 top-1/2 -translate-y-1/2 z-10 bg-white bg-opacity-80 hover:bg-opacity-100 rounded-full p-2 shadow-lg transition",title:" ",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),i.jsx("button",{onClick:()=>{const R=document.querySelector(".image-gallery-scroll");R&&R.scrollBy({left:200,behavior:"smooth"})},className:"absolute right-2 top-1/2 -translate-y-1/2 z-10 bg-white bg-opacity-80 hover:bg-opacity-100 rounded-full p-2 shadow-lg transition",title:" ",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]}),i.jsx("div",{className:"image-gallery-scroll flex gap-2 overflow-x-auto p-2 snap-x",style:{scrollSnapType:"x mandatory",maxWidth:"calc(100% - 60px)"},children:J.map((R,E)=>i.jsxs("div",{className:"flex-shrink-0 w-48 h-48 relative group snap-center cursor-pointer",onClick:()=>Ur(E),children:[i.jsx("img",{src:`${Ad}/equipment/${z.id}/${R}`,alt:` ${E+1}`,className:"w-full h-full object-cover rounded-lg"}),Q&&r("equipment_edit")&&z.id!=="new"&&i.jsx("button",{onClick:ie=>{ie.stopPropagation(),Br(R)},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",title:" ",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]},R))})]}),J.length>1&&i.jsx("div",{className:"text-center text-sm text-gray-500 mt-2",children:"         ."})]}),xe=()=>ye?i.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-95 flex flex-col items-center justify-center z-50",onClick:dr,children:[i.jsx("button",{onClick:dr,className:"absolute top-4 right-4 text-white text-4xl hover:text-gray-300 z-10",children:""}),i.jsxs("div",{className:"relative max-w-full max-h-[70vh] p-4",onMouseDown:En,onMouseMove:Bn,onMouseUp:$r,onMouseLeave:$r,onTouchStart:En,onTouchMove:Bn,onTouchEnd:$r,onClick:R=>R.stopPropagation(),children:[i.jsx("img",{src:`${Ad}/equipment/${z.id}/${J[Xe]}`,alt:` ${Xe+1}`,className:"max-w-full max-h-[60vh] object-contain",style:{transform:Pe?`translateX(${xt.current-nt.current}px)`:"none",transition:Pe?"none":"transform 0.3s ease"}}),Q&&r("equipment_edit")&&z.id!=="new"&&i.jsx("button",{onClick:R=>{R.stopPropagation(),Br(J[Xe]),Xe>=J.length-1&&D(Math.max(0,J.length-2))},className:"absolute top-2 right-2 bg-red-500 hover:bg-red-600 text-white rounded-lg px-3 py-1 transition",children:""})]}),J.length>1&&i.jsxs("div",{className:"flex items-center gap-8 mb-4",children:[i.jsx("button",{onClick:R=>{R.stopPropagation(),Yr()},className:"text-white text-4xl hover:text-gray-300 p-2",children:""}),i.jsxs("span",{className:"text-white text-lg",children:[Xe+1," / ",J.length]}),i.jsx("button",{onClick:R=>{R.stopPropagation(),zr()},className:"text-white text-4xl hover:text-gray-300 p-2",children:""})]})]}):null;return i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:""}),Se&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:Se}),i.jsxs("div",{children:[i.jsxs("div",{className:"border-b border-gray-200 mb-6 relative",children:[i.jsx("nav",{className:"tab-nav -mb-px flex space-x-8 overflow-x-auto pl-8 pr-8",children:he.map(R=>i.jsxs("div",{className:"flex items-center flex-shrink-0",children:[i.jsx("button",{onClick:()=>me(R.id),className:`py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${A===R.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:R.label}),ue.find(E=>E.id===R.id)&&i.jsx("button",{onClick:()=>Ne(R.id),className:"ml-1 text-gray-400 hover:text-gray-600",title:" ",children:""})]},R.id))}),i.jsx("button",{onClick:()=>{const R=document.querySelector(".tab-nav");R&&R.scrollBy({left:-200,behavior:"smooth"})},className:"absolute left-0 top-0 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded",title:" ",children:""}),i.jsx("button",{onClick:()=>{const R=document.querySelector(".tab-nav");R&&R.scrollBy({left:200,behavior:"smooth"})},className:"absolute right-0 top-0 bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded",title:" ",children:""})]}),A==="nomenclature"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-gray-200 rounded-lg p-4 mb-6",children:[i.jsx("div",{className:"flex justify-end mb-4",children:r("equipment_create")&&i.jsx("button",{onClick:()=>{Or(),T({id:"new",name:"",productCode:null,purchasePrice:null,sellingPrice:null,description:"",images:[]}),Y(!0)},className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:" "})}),i.jsxs("div",{className:"flex gap-4",children:[i.jsx("input",{type:"text",placeholder:"  ID,   ...",value:c,onChange:R=>u(R.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),i.jsxs("div",{className:"relative equipment-column-settings",children:[i.jsx("button",{onClick:()=>re(!le),className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition",children:" "}),le&&i.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white border border-gray-300 rounded-lg shadow-lg z-10 equipment-column-settings",children:i.jsxs("div",{className:"p-4",children:[i.jsx("h4",{className:"font-medium mb-2",children:" "}),M.map((R,E)=>i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:H[R],onChange:()=>Jr(R),className:"mr-2"}),Ir(R)]}),H[R]&&i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>Er(E),disabled:E===0,className:"px-2 py-1 bg-gray-200 hover:bg-gray-300 disabled:opacity-50 text-xs rounded",children:""}),i.jsx("button",{onClick:()=>ps(E),disabled:E===M.length-1,className:"px-2 py-1 bg-gray-200 hover:bg-gray-300 disabled:opacity-50 text-xs rounded",children:""})]})]},R))]})})]})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",style:{tableLayout:"fixed"},children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsx("tr",{children:Dr.map(R=>i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[120px]",style:{resize:"horizontal",overflow:"auto"},children:Ir(R)},R))})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Sr.map(R=>i.jsx("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>{T(R),Y(!1)},children:Dr.map(E=>i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:jn(R,E)},E))},R.id))})]})})]}),z&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:Lt,children:i.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",onClick:R=>R.stopPropagation(),children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex justify-between items-start mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold",children:Q?" ":" "}),i.jsx("button",{onClick:Lt,className:"text-gray-500 hover:text-gray-700 text-2xl",children:""})]}),Se&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:Se}),Q?i.jsxs("form",{onSubmit:Ar,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:te.name,onChange:R=>ve({...te,name:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsx("input",{type:"number",value:te.productCode,onChange:R=>ve({...te,productCode:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsx("input",{type:"number",step:"0.01",value:te.sellingPrice,onChange:R=>ve({...te,sellingPrice:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsx("input",{type:"number",step:"0.01",value:te.purchasePrice,onChange:R=>ve({...te,purchasePrice:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("textarea",{value:te.description,onChange:R=>ve({...te,description:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"4",placeholder:"  ..."})]}),r("equipment_edit")&&z.id!=="new"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("input",{type:"file",ref:w,accept:"image/*",multiple:!0,onChange:Nr,className:"hidden"}),i.jsx("button",{type:"button",onClick:()=>w.current?.click(),disabled:fe,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition disabled:opacity-50",children:fe?"...":" "}),i.jsxs("span",{className:"text-sm text-gray-500",children:["(",J.length," )"]})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:": JPEG, PNG, GIF, WebP.  10MB  ."})]}),i.jsxs("div",{className:"flex gap-2 pt-4",children:[i.jsx("button",{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition",children:""}),i.jsx("button",{type:"button",onClick:()=>Y(!1),className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})]})]}):i.jsxs("div",{className:"flex gap-6",children:[i.jsx("div",{className:"w-1/3",children:ae()}),i.jsxs("div",{className:"w-2/3",children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:z.name}),i.jsxs("div",{className:"flex gap-4 text-sm text-gray-500",children:[i.jsxs("span",{children:["ID: ",z.id]}),z.productCode&&i.jsxs("span",{children:[" : ",z.productCode]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("span",{className:"block text-sm text-gray-500 mb-1",children:" "}),i.jsx("span",{className:"text-lg font-semibold text-gray-900",children:z.purchasePrice?`${z.purchasePrice} `:"-"})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("span",{className:"block text-sm text-gray-500 mb-1",children:" "}),i.jsx("span",{className:"text-lg font-semibold text-gray-900",children:z.sellingPrice?`${z.sellingPrice} `:"-"})]})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("span",{className:"block text-sm text-gray-500 mb-1",children:""}),i.jsx("p",{className:"text-gray-900",children:z.description||" "})]})]})]}),!Q&&i.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[i.jsx("button",{onClick:Lt,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg transition",children:""}),r("equipment_delete")&&z.id!=="new"&&i.jsx("button",{onClick:()=>{v(z),k(!0)},className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition",children:""}),r("equipment_edit")&&z.id!=="new"&&i.jsx("button",{onClick:()=>{ve({name:z.name,productCode:z.productCode||"",sellingPrice:z.sellingPrice||"",purchasePrice:z.purchasePrice||"",description:z.description||""}),Y(!0)},className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition",children:""})]})]})})}),xe(),A==="expense-history"&&i.jsxs("div",{children:[i.jsx("div",{className:"bg-gray-200 rounded-lg p-4 mb-6",children:i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsxs("div",{className:"relative expense-history-column-settings",children:[i.jsx("button",{onClick:()=>Tt(!Gt),className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition",children:" "}),Gt&&i.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white border border-gray-300 rounded-lg shadow-lg z-10 expense-history-column-settings",style:{maxHeight:"400px",overflowY:"auto"},children:i.jsxs("div",{className:"p-4",children:[i.jsx("h4",{className:"font-medium mb-2",children:" "}),kt.map((R,E)=>i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:Ut[R],onChange:()=>O(R),className:"mr-2"}),U(R)]}),Ut[R]&&i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>V(E),disabled:E===0,className:"px-2 py-1 bg-gray-200 hover:bg-gray-300 disabled:opacity-50 text-xs rounded",children:""}),i.jsx("button",{onClick:()=>L(E),disabled:E===kt.length-1,className:"px-2 py-1 bg-gray-200 hover:bg-gray-300 disabled:opacity-50 text-xs rounded",children:""})]})]},R))]})})]}),i.jsx("button",{onClick:qt,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:""})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsx("tr",{children:q.map(R=>i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:U(R)},R))})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:q.length,className:"px-6 py-4 text-center text-gray-500",children:"    "})}):s.map(R=>i.jsx("tr",{className:"hover:bg-gray-50",children:q.map(E=>i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[E==="bidId"&&i.jsxs("button",{onClick:()=>e(`/dashboard/bids/${R.bid?.id}`),className:"text-blue-600 hover:text-blue-800 hover:underline font-medium cursor-pointer",children:["",R.bid?.id||"-"]}),E==="bidTema"&&(R.bid?.tema||"-"),E==="clientObject"&&(R.bid?.clientObject?.address||R.bid?.clientObject?.name||R.bid?.clientObject?.brandModel||"-"),E==="client"&&(R.bid?.client?.name||"-"),E==="equipmentName"&&(R.equipment?.name||"-"),E==="imei"&&(R.imei||"-"),E==="quantity"&&(R.quantity||1)]},E))},R.id))})]})})]}),A==="return-history"&&i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[i.jsxs("div",{className:"p-6 pb-0 flex justify-between items-center",children:[i.jsx("h3",{className:"text-xl font-bold",children:" "}),i.jsx("button",{onClick:rr,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:""})]}),i.jsx("div",{className:"overflow-x-auto p-6",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:" "}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:" "}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"IMEI"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"-"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:" "}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:" "}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"  "}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:" "})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:qe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"px-6 py-8 text-center text-gray-500",children:"    "})}):qe.map(R=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:i.jsxs("button",{onClick:()=>e(`/dashboard/bids/${R.bidId}`),className:"text-blue-600 hover:text-blue-800 hover:underline font-medium cursor-pointer",children:["",R.bidId]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:R.bidTema}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:R.client}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:R.clientObject}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:R.equipmentName}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:R.imei}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:R.quantity}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:R.returnReason}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:R.returnedBy}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:R.createdBy}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(R.createdAt).toLocaleString("ru-RU")})]},R.id))})]})})]})]}),i.jsx(vS,{isOpen:y,title:" ",message:` ,     "${b?.name}"?`,confirmText:"",cancelText:"",onConfirm:()=>{b&&(sr(b),Lt()),k(!1),v(null)},onCancel:()=>{k(!1),v(null)},confirmButtonColor:"red"})]})},bS=({closeTab:e})=>{xs(),Xa().state?.from;const[t,n]=j.useState({name:"",entityType:"individual",inn:"",phone:"",email:""}),s=async o=>{o.preventDefault();try{const c=await Lk(t);e()}catch(c){console.error("Error creating supplier:",c)}};return i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:" "}),i.jsx("button",{onClick:e,className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition",children:""})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6 max-w-md",children:i.jsxs("form",{onSubmit:s,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:t.name,onChange:o=>n({...t,name:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsxs("select",{value:t.entityType,onChange:o=>n({...t,entityType:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"individual",children:" "}),i.jsx("option",{value:"legal",children:" "})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:t.inn,onChange:o=>n({...t,inn:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"tel",value:t.phone,onChange:o=>n({...t,phone:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{type:"email",value:t.email,onChange:o=>n({...t,email:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"flex gap-2 pt-4",children:[i.jsx("button",{type:"submit",className:"flex-1 bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg transition",children:" "}),i.jsx("button",{type:"button",onClick:e,className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})]})]})})]})};var L0={};L0.version="0.18.5";var G1=1252,wS=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],eh={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},th=function(e){wS.indexOf(e)!=-1&&(G1=eh[0]=e)};function _S(){th(1252)}var Ts=function(e){th(e)};function rh(){Ts(1200),_S()}function Up(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function kS(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function K1(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var Eo=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?kS(e.slice(2)):r==254&&t==255?K1(e.slice(2)):r==65279?e.slice(1):e},w0=function(r){return String.fromCharCode(r)},zp=function(r){return String.fromCharCode(r)},$o,Ua="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ho(e){for(var r="",t=0,n=0,s=0,o=0,c=0,u=0,d=0,h=0;h<e.length;)t=e.charCodeAt(h++),o=t>>2,n=e.charCodeAt(h++),c=(t&3)<<4|n>>4,s=e.charCodeAt(h++),u=(n&15)<<2|s>>6,d=s&63,isNaN(n)?u=d=64:isNaN(s)&&(d=64),r+=Ua.charAt(o)+Ua.charAt(c)+Ua.charAt(u)+Ua.charAt(d);return r}function Jn(e){var r="",t=0,n=0,s=0,o=0,c=0,u=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)o=Ua.indexOf(e.charAt(h++)),c=Ua.indexOf(e.charAt(h++)),t=o<<2|c>>4,r+=String.fromCharCode(t),u=Ua.indexOf(e.charAt(h++)),n=(c&15)<<4|u>>2,u!==64&&(r+=String.fromCharCode(n)),d=Ua.indexOf(e.charAt(h++)),s=(u&3)<<6|d,d!==64&&(r+=String.fromCharCode(s));return r}var _t=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),pa=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function Ha(e){return _t?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function $p(e){return _t?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Kn=function(r){return _t?pa(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function iu(e){if(typeof ArrayBuffer>"u")return Kn(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),n=0;n!=e.length;++n)t[n]=e.charCodeAt(n)&255;return r}function Ka(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function NS(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function nh(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return nh(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var Gr=_t?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:pa(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),s=0;for(r=0,t=0;r<e.length;t+=s,++r)if(s=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function SS(e){for(var r=[],t=0,n=e.length+250,s=Ha(e.length+255),o=0;o<e.length;++o){var c=e.charCodeAt(o);if(c<128)s[t++]=c;else if(c<2048)s[t++]=192|c>>6&31,s[t++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=e.charCodeAt(++o)&1023;s[t++]=240|c>>8&7,s[t++]=128|c>>2&63,s[t++]=128|u>>6&15|(c&3)<<4,s[t++]=128|u&63}else s[t++]=224|c>>12&15,s[t++]=128|c>>6&63,s[t++]=128|c&63;t>n&&(r.push(s.slice(0,t)),t=0,s=Ha(65535),n=65530)}return r.push(s.slice(0,t)),Gr(r)}var Sn=/\u0000/g,jo=/[\u0001-\u0006]/g;function yl(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function Fs(e,r){var t=""+e;return t.length>=r?t:mr("0",r-t.length)+t}function sh(e,r){var t=""+e;return t.length>=r?t:mr(" ",r-t.length)+t}function B0(e,r){var t=""+e;return t.length>=r?t:t+mr(" ",r-t.length)}function ES(e,r){var t=""+Math.round(e);return t.length>=r?t:mr("0",r-t.length)+t}function jS(e,r){var t=""+e;return t.length>=r?t:mr("0",r-t.length)+t}var Hp=Math.pow(2,32);function hl(e,r){if(e>Hp||e<-Hp)return ES(e,r);var t=Math.round(e);return jS(t,r)}function U0(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var Wp=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],od=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function CS(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var lt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Vp={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},TS={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function z0(e,r,t){for(var n=e<0?-1:1,s=e*n,o=0,c=1,u=0,d=1,h=0,m=0,p=Math.floor(s);h<r&&(p=Math.floor(s),u=p*c+o,m=p*h+d,!(s-p<5e-8));)s=1/(s-p),o=c,c=u,d=h,h=m;if(m>r&&(h>r?(m=d,u=o):(m=h,u=c)),!t)return[0,n*u,m];var y=Math.floor(n*u/m);return[y,n*u-y*m,m]}function yi(e,r,t){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),o=0,c=[],u={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),r&&r.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++s==86400&&(u.T=s=0,++n,++u.D)),n===60)c=t?[1317,10,29]:[1900,2,29],o=3;else if(n===0)c=t?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var d=new Date(1900,0,1);d.setDate(d.getDate()+n-1),c=[d.getFullYear(),d.getMonth()+1,d.getDate()],o=d.getDay(),n<60&&(o=(o+6)%7),t&&(o=RS(d,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=s%60,s=Math.floor(s/60),u.M=s%60,s=Math.floor(s/60),u.H=s,u.q=o,u}var Y1=new Date(1899,11,31,0,0,0),FS=Y1.getTime(),AS=new Date(1900,2,1,0,0,0);function J1(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=AS&&(t+=1440*60*1e3),(t-(FS+(e.getTimezoneOffset()-Y1.getTimezoneOffset())*6e4))/(1440*60*1e3)}function ah(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function OS(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function DS(e){var r=e<0?12:11,t=ah(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function IS(e){var r=ah(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Wo(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=DS(e):r===10?t=e.toFixed(10).substr(0,12):t=IS(e),ah(OS(t.toUpperCase()))}function Ei(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Wo(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return hs(14,J1(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function RS(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function PS(e,r,t,n){var s="",o=0,c=0,u=t.y,d,h=0;switch(e){case 98:u=t.y+543;case 121:switch(r.length){case 1:case 2:d=u%100,h=2;break;default:d=u%1e4,h=4;break}break;case 109:switch(r.length){case 1:case 2:d=t.m,h=r.length;break;case 3:return od[t.m-1][1];case 5:return od[t.m-1][0];default:return od[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:d=t.d,h=r.length;break;case 3:return Wp[t.q][0];default:return Wp[t.q][1]}break;case 104:switch(r.length){case 1:case 2:d=1+(t.H+11)%12,h=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:d=t.H,h=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:d=t.M,h=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?Fs(t.S,r.length):(n>=2?c=n===3?1e3:100:c=n===1?10:1,o=Math.round(c*(t.S+t.u)),o>=60*c&&(o=0),r==="s"?o===0?"0":""+o/c:(s=Fs(o,2+n),r==="ss"?s.substr(0,2):"."+s.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":d=t.D*24+t.H;break;case"[m]":case"[mm]":d=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":d=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}h=r.length===3?1:2;break;case 101:d=u,h=1;break}var m=h>0?Fs(d,h):"";return m}function za(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var Q1=/%/g;function MS(e,r,t){var n=r.replace(Q1,""),s=r.length-n.length;return fa(e,n,t*Math.pow(10,2*s))+mr("%",s)}function LS(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return fa(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function Z1(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Z1(e,-r);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%s;if(o<0&&(o+=s),t=(r/Math.pow(10,o)).toPrecision(n+1+(s+o)%s),t.indexOf("e")===-1){var c=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+o):t+="E+"+(c-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,h,m){return d+h+m.substr(0,(s+o)%s)+"."+m.substr(o)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var ev=/# (\?+)( ?)\/( ?)(\d+)/;function BS(e,r,t){var n=parseInt(e[4],10),s=Math.round(r*n),o=Math.floor(s/n),c=s-o*n,u=n;return t+(o===0?"":""+o)+" "+(c===0?mr(" ",e[1].length+1+e[4].length):sh(c,e[1].length)+e[2]+"/"+e[3]+Fs(u,e[4].length))}function US(e,r,t){return t+(r===0?"":""+r)+mr(" ",e[1].length+2+e[4].length)}var tv=/^#*0*\.([0#]+)/,rv=/\).*[0#]/,nv=/\(###\) ###\\?-####/;function kn(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function qp(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function Xp(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function zS(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function $S(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ls(e,r,t){if(e.charCodeAt(0)===40&&!r.match(rv)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ls("n",n,t):"("+ls("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return LS(e,r,t);if(r.indexOf("%")!==-1)return MS(e,r,t);if(r.indexOf("E")!==-1)return Z1(r,t);if(r.charCodeAt(0)===36)return"$"+ls(e,r.substr(r.charAt(1)==" "?2:1),t);var s,o,c,u,d=Math.abs(t),h=t<0?"-":"";if(r.match(/^00+$/))return h+hl(d,r.length);if(r.match(/^[#?]+$/))return s=hl(t,0),s==="0"&&(s=""),s.length>r.length?s:kn(r.substr(0,r.length-s.length))+s;if(o=r.match(ev))return BS(o,d,h);if(r.match(/^#+0+$/))return h+hl(d,r.length-r.indexOf("0"));if(o=r.match(tv))return s=qp(t,o[1].length).replace(/^([^\.]+)$/,"$1."+kn(o[1])).replace(/\.$/,"."+kn(o[1])).replace(/\.(\d*)$/,function(b,v){return"."+v+mr("0",kn(o[1]).length-v.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return h+qp(d,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return h+za(hl(d,0));if(o=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ls(e,r,-t):za(""+(Math.floor(t)+zS(t,o[1].length)))+"."+Fs(Xp(t,o[1].length),o[1].length);if(o=r.match(/^#,#*,#0/))return ls(e,r.replace(/^#,#*,/,""),t);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=yl(ls(e,r.replace(/[\\-]/g,""),t)),c=0,yl(yl(r.replace(/\\/g,"")).replace(/[0#]/g,function(b){return c<s.length?s.charAt(c++):b==="0"?"0":""}));if(r.match(nv))return s=ls(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var m="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=z0(d,Math.pow(10,c)-1,!1),s=""+h,m=fa("n",o[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),s+=m+o[2]+"/"+o[3],m=B0(u[2],c),m.length<o[4].length&&(m=kn(o[4].substr(o[4].length-m.length))+m),s+=m,s;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=z0(d,Math.pow(10,c)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?sh(u[1],c)+o[2]+"/"+o[3]+B0(u[2],c):mr(" ",2*c+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return s=hl(t,0),r.length<=s.length?s:kn(r.substr(0,r.length-s.length))+s;if(o=r.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var p=r.indexOf(".")-c,y=r.length-s.length-p;return kn(r.substr(0,p)+s+r.substr(r.length-y))}if(o=r.match(/^00,000\.([#0]*0)$/))return c=Xp(t,o[1].length),t<0?"-"+ls(e,r,-t):za($S(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Fs(0,3-b.length):"")+b})+"."+Fs(c,o[1].length);switch(r){case"###,##0.00":return ls(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var k=za(hl(d,0));return k!=="0"?h+k:"";case"###,###.00":return ls(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return ls(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function HS(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return fa(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function WS(e,r,t){var n=r.replace(Q1,""),s=r.length-n.length;return fa(e,n,t*Math.pow(10,2*s))+mr("%",s)}function sv(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+sv(e,-r);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%s;if(o<0&&(o+=s),t=(r/Math.pow(10,o)).toPrecision(n+1+(s+o)%s),!t.match(/[Ee]/)){var c=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+o):t+="E+"+(c-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,h,m){return d+h+m.substr(0,(s+o)%s)+"."+m.substr(o)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Hs(e,r,t){if(e.charCodeAt(0)===40&&!r.match(rv)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Hs("n",n,t):"("+Hs("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return HS(e,r,t);if(r.indexOf("%")!==-1)return WS(e,r,t);if(r.indexOf("E")!==-1)return sv(r,t);if(r.charCodeAt(0)===36)return"$"+Hs(e,r.substr(r.charAt(1)==" "?2:1),t);var s,o,c,u,d=Math.abs(t),h=t<0?"-":"";if(r.match(/^00+$/))return h+Fs(d,r.length);if(r.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>r.length?s:kn(r.substr(0,r.length-s.length))+s;if(o=r.match(ev))return US(o,d,h);if(r.match(/^#+0+$/))return h+Fs(d,r.length-r.indexOf("0"));if(o=r.match(tv))return s=(""+t).replace(/^([^\.]+)$/,"$1."+kn(o[1])).replace(/\.$/,"."+kn(o[1])),s=s.replace(/\.(\d*)$/,function(b,v){return"."+v+mr("0",kn(o[1]).length-v.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return h+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return h+za(""+d);if(o=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Hs(e,r,-t):za(""+t)+"."+mr("0",o[1].length);if(o=r.match(/^#,#*,#0/))return Hs(e,r.replace(/^#,#*,/,""),t);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=yl(Hs(e,r.replace(/[\\-]/g,""),t)),c=0,yl(yl(r.replace(/\\/g,"")).replace(/[0#]/g,function(b){return c<s.length?s.charAt(c++):b==="0"?"0":""}));if(r.match(nv))return s=Hs(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var m="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=z0(d,Math.pow(10,c)-1,!1),s=""+h,m=fa("n",o[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),s+=m+o[2]+"/"+o[3],m=B0(u[2],c),m.length<o[4].length&&(m=kn(o[4].substr(o[4].length-m.length))+m),s+=m,s;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=z0(d,Math.pow(10,c)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?sh(u[1],c)+o[2]+"/"+o[3]+B0(u[2],c):mr(" ",2*c+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return s=""+t,r.length<=s.length?s:kn(r.substr(0,r.length-s.length))+s;if(o=r.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var p=r.indexOf(".")-c,y=r.length-s.length-p;return kn(r.substr(0,p)+s+r.substr(r.length-y))}if(o=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Hs(e,r,-t):za(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Fs(0,3-b.length):"")+b})+"."+Fs(0,o[1].length);switch(r){case"###,###":case"##,###":case"#,###":var k=za(""+d);return k!=="0"?h+k:"";default:if(r.match(/\.[0#?]*$/))return Hs(e,r.slice(0,r.lastIndexOf(".")),t)+kn(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function fa(e,r,t){return(t|0)===t?Hs(e,r,t):ls(e,r,t)}function VS(e){for(var r=[],t=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(s,n-s),s=n+1}if(r[r.length]=e.substr(s),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var av=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Il(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":U0(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(av))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function qS(e,r,t,n){for(var s=[],o="",c=0,u="",d="t",h,m,p,y="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!U0(e,c))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},c+=7;break;case'"':for(o="";(p=e.charCodeAt(++c))!==34&&c<e.length;)o+=String.fromCharCode(p);s[s.length]={t:"t",v:o},++c;break;case"\\":var k=e.charAt(++c),b=k==="("||k===")"?k:"t";s[s.length]={t:b,v:k},++c;break;case"_":s[s.length]={t:"t",v:" "},c+=2;break;case"@":s[s.length]={t:"T",v:r},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(h==null&&(h=yi(r,t,e.charAt(c+1)==="2"),h==null))return"";s[s.length]={t:"X",v:e.substr(c,2)},d=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||h==null&&(h=yi(r,t),h==null))return"";for(o=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)o+=u;u==="m"&&d.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=y),s[s.length]={t:u,v:o},d=u;break;case"A":case"a":case"":var v={t:u,v:u};if(h==null&&(h=yi(r,t)),e.substr(c,3).toUpperCase()==="A/P"?(h!=null&&(v.v=h.H>=12?"P":"A"),v.t="T",y="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(h!=null&&(v.v=h.H>=12?"PM":"AM"),v.t="T",c+=5,y="h"):e.substr(c,5).toUpperCase()==="/"?(h!=null&&(v.v=h.H>=12?"":""),v.t="T",c+=5,y="h"):(v.t="t",++c),h==null&&v.t==="T")return"";s[s.length]=v,d=u;break;case"[":for(o=u;e.charAt(c++)!=="]"&&c<e.length;)o+=e.charAt(c);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(av)){if(h==null&&(h=yi(r,t),h==null))return"";s[s.length]={t:"Z",v:o.toLowerCase()},d=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",Il(e)||(s[s.length]={t:"t",v:o}));break;case".":if(h!=null){for(o=u;++c<e.length&&(u=e.charAt(c))==="0";)o+=u;s[s.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)o+=u;s[s.length]={t:"n",v:o};break;case"?":for(o=u;e.charAt(++c)===u;)o+=u;s[s.length]={t:u,v:o},d=u;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":s[s.length]={t:n===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)o+=e.charAt(c);s[s.length]={t:"D",v:o};break;case" ":s[s.length]={t:u,v:u},++c;break;case"$":s[s.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++c;break}var w=0,S=0,I;for(c=s.length-1,d="t";c>=0;--c)switch(s[c].t){case"h":case"H":s[c].t=y,d="h",w<1&&(w=1);break;case"s":(I=s[c].v.match(/\.0+$/))&&(S=Math.max(S,I[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":d=s[c].t;break;case"m":d==="s"&&(s[c].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[c].v.match(/[Hh]/)&&(w=1),w<2&&s[c].v.match(/[Mm]/)&&(w=2),w<3&&s[c].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var N="",P;for(c=0;c<s.length;++c)switch(s[c].t){case"t":case"T":case" ":case"D":break;case"X":s[c].v="",s[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[c].v=PS(s[c].t.charCodeAt(0),s[c].v,h,S),s[c].t="t";break;case"n":case"?":for(P=c+1;s[P]!=null&&((u=s[P].t)==="?"||u==="D"||(u===" "||u==="t")&&s[P+1]!=null&&(s[P+1].t==="?"||s[P+1].t==="t"&&s[P+1].v==="/")||s[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(s[P].v==="/"||s[P].v===" "&&s[P+1]!=null&&s[P+1].t=="?"));)s[c].v+=s[P].v,s[P]={v:"",t:";"},++P;N+=s[c].v,c=P-1;break;case"G":s[c].t="t",s[c].v=Ei(r,t);break}var W="",X,M;if(N.length>0){N.charCodeAt(0)==40?(X=r<0&&N.charCodeAt(0)===45?-r:r,M=fa("n",N,X)):(X=r<0&&n>1?-r:r,M=fa("n",N,X),X<0&&s[0]&&s[0].t=="t"&&(M=M.substr(1),s[0].v="-"+s[0].v)),P=M.length-1;var Z=s.length;for(c=0;c<s.length;++c)if(s[c]!=null&&s[c].t!="t"&&s[c].v.indexOf(".")>-1){Z=c;break}var H=s.length;if(Z===s.length&&M.indexOf("E")===-1){for(c=s.length-1;c>=0;--c)s[c]==null||"n?".indexOf(s[c].t)===-1||(P>=s[c].v.length-1?(P-=s[c].v.length,s[c].v=M.substr(P+1,s[c].v.length)):P<0?s[c].v="":(s[c].v=M.substr(0,P+1),P=-1),s[c].t="t",H=c);P>=0&&H<s.length&&(s[H].v=M.substr(0,P+1)+s[H].v)}else if(Z!==s.length&&M.indexOf("E")===-1){for(P=M.indexOf(".")-1,c=Z;c>=0;--c)if(!(s[c]==null||"n?".indexOf(s[c].t)===-1)){for(m=s[c].v.indexOf(".")>-1&&c===Z?s[c].v.indexOf(".")-1:s[c].v.length-1,W=s[c].v.substr(m+1);m>=0;--m)P>=0&&(s[c].v.charAt(m)==="0"||s[c].v.charAt(m)==="#")&&(W=M.charAt(P--)+W);s[c].v=W,s[c].t="t",H=c}for(P>=0&&H<s.length&&(s[H].v=M.substr(0,P+1)+s[H].v),P=M.indexOf(".")+1,c=Z;c<s.length;++c)if(!(s[c]==null||"n?(".indexOf(s[c].t)===-1&&c!==Z)){for(m=s[c].v.indexOf(".")>-1&&c===Z?s[c].v.indexOf(".")+1:0,W=s[c].v.substr(0,m);m<s[c].v.length;++m)P<M.length&&(W+=M.charAt(P++));s[c].v=W,s[c].t="t",H=c}}}for(c=0;c<s.length;++c)s[c]!=null&&"n?".indexOf(s[c].t)>-1&&(X=n>1&&r<0&&c>0&&s[c-1].v==="-"?-r:r,s[c].v=fa(s[c].t,s[c].v,X),s[c].t="t");var ce="";for(c=0;c!==s.length;++c)s[c]!=null&&(ce+=s[c].v);return ce}var Gp=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Kp(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function XS(e,r){var t=VS(e),n=t.length,s=t[n-1].indexOf("@");if(n<4&&s>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var c=t[0].match(Gp),u=t[1].match(Gp);return Kp(r,c)?[n,t[0]]:Kp(r,u)?[n,t[1]]:[n,t[c!=null&&u!=null?2:1]]}return[n,o]}function hs(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:lt)[e],n==null&&(n=t.table&&t.table[Vp[e]]||lt[Vp[e]]),n==null&&(n=TS[e]||"General");break}if(U0(n,0))return Ei(r,t);r instanceof Date&&(r=J1(r,t.date1904));var s=XS(n,r);if(U0(s[1]))return Ei(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return qS(s[1],r,t,s[0])}function da(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(lt[t]==null){r<0&&(r=t);continue}if(lt[t]==e){r=t;break}}r<0&&(r=391)}return lt[r]=e,r}function lu(e){for(var r=0;r!=392;++r)e[r]!==void 0&&da(e[r],r)}function Rl(){lt=CS()}var GS={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},iv=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function KS(e){var r=typeof e=="number"?lt[e]:e;return r=r.replace(iv,"(\\d+)"),new RegExp("^"+r+"$")}function YS(e,r,t){var n=-1,s=-1,o=-1,c=-1,u=-1,d=-1;(r.match(iv)||[]).forEach(function(p,y){var k=parseInt(t[y+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=k;break;case"d":o=k;break;case"h":c=k;break;case"s":d=k;break;case"m":c>=0?u=k:s=k;break}}),d>=0&&u==-1&&s>=0&&(u=s,s=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var m=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return c==-1&&u==-1&&d==-1?h:n==-1&&s==-1&&o==-1?m:h+"T"+m}var JS=(function(){var e={};e.version="1.2.0";function r(){for(var M=0,Z=new Array(256),H=0;H!=256;++H)M=H,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,Z[H]=M;return typeof Int32Array<"u"?new Int32Array(Z):Z}var t=r();function n(M){var Z=0,H=0,ce=0,le=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ce=0;ce!=256;++ce)le[ce]=M[ce];for(ce=0;ce!=256;++ce)for(H=M[ce],Z=256+ce;Z<4096;Z+=256)H=le[Z]=H>>>8^M[H&255];var re=[];for(ce=1;ce!=16;++ce)re[ce-1]=typeof Int32Array<"u"?le.subarray(ce*256,ce*256+256):le.slice(ce*256,ce*256+256);return re}var s=n(t),o=s[0],c=s[1],u=s[2],d=s[3],h=s[4],m=s[5],p=s[6],y=s[7],k=s[8],b=s[9],v=s[10],w=s[11],S=s[12],I=s[13],N=s[14];function P(M,Z){for(var H=Z^-1,ce=0,le=M.length;ce<le;)H=H>>>8^t[(H^M.charCodeAt(ce++))&255];return~H}function W(M,Z){for(var H=Z^-1,ce=M.length-15,le=0;le<ce;)H=N[M[le++]^H&255]^I[M[le++]^H>>8&255]^S[M[le++]^H>>16&255]^w[M[le++]^H>>>24]^v[M[le++]]^b[M[le++]]^k[M[le++]]^y[M[le++]]^p[M[le++]]^m[M[le++]]^h[M[le++]]^d[M[le++]]^u[M[le++]]^c[M[le++]]^o[M[le++]]^t[M[le++]];for(ce+=15;le<ce;)H=H>>>8^t[(H^M[le++])&255];return~H}function X(M,Z){for(var H=Z^-1,ce=0,le=M.length,re=0,te=0;ce<le;)re=M.charCodeAt(ce++),re<128?H=H>>>8^t[(H^re)&255]:re<2048?(H=H>>>8^t[(H^(192|re>>6&31))&255],H=H>>>8^t[(H^(128|re&63))&255]):re>=55296&&re<57344?(re=(re&1023)+64,te=M.charCodeAt(ce++)&1023,H=H>>>8^t[(H^(240|re>>8&7))&255],H=H>>>8^t[(H^(128|re>>2&63))&255],H=H>>>8^t[(H^(128|te>>6&15|(re&3)<<4))&255],H=H>>>8^t[(H^(128|te&63))&255]):(H=H>>>8^t[(H^(224|re>>12&15))&255],H=H>>>8^t[(H^(128|re>>6&63))&255],H=H>>>8^t[(H^(128|re&63))&255]);return~H}return e.table=t,e.bstr=P,e.buf=W,e.str=X,e})(),tt=(function(){var r={};r.version="1.2.1";function t(O,V){for(var L=O.split("/"),U=V.split("/"),q=0,G=0,he=Math.min(L.length,U.length);q<he;++q){if(G=L[q].length-U[q].length)return G;if(L[q]!=U[q])return L[q]<U[q]?-1:1}return L.length-U.length}function n(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:n(O.slice(0,-1));var V=O.lastIndexOf("/");return V===-1?O:O.slice(0,V+1)}function s(O){if(O.charAt(O.length-1)=="/")return s(O.slice(0,-1));var V=O.lastIndexOf("/");return V===-1?O:O.slice(V+1)}function o(O,V){typeof V=="string"&&(V=new Date(V));var L=V.getHours();L=L<<6|V.getMinutes(),L=L<<5|V.getSeconds()>>>1,O.write_shift(2,L);var U=V.getFullYear()-1980;U=U<<4|V.getMonth()+1,U=U<<5|V.getDate(),O.write_shift(2,U)}function c(O){var V=O.read_shift(2)&65535,L=O.read_shift(2)&65535,U=new Date,q=L&31;L>>>=5;var G=L&15;L>>>=4,U.setMilliseconds(0),U.setFullYear(L+1980),U.setMonth(G-1),U.setDate(q);var he=V&31;V>>>=5;var Ne=V&63;return V>>>=6,U.setHours(V),U.setMinutes(Ne),U.setSeconds(he<<1),U}function u(O){tn(O,0);for(var V={},L=0;O.l<=O.length-4;){var U=O.read_shift(2),q=O.read_shift(2),G=O.l+q,he={};U===21589&&(L=O.read_shift(1),L&1&&(he.mtime=O.read_shift(4)),q>5&&(L&2&&(he.atime=O.read_shift(4)),L&4&&(he.ctime=O.read_shift(4))),he.mtime&&(he.mt=new Date(he.mtime*1e3))),O.l=G,V[U]=he}return V}var d;function h(){return d||(d={})}function m(O,V){if(O[0]==80&&O[1]==75)return Nr(O,V);if((O[0]|32)==109&&(O[1]|32)==105)return Sr(O,V);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var L=3,U=512,q=0,G=0,he=0,Ne=0,ae=0,xe=[],R=O.slice(0,512);tn(R,0);var E=p(R);switch(L=E[0],L){case 3:U=512;break;case 4:U=4096;break;case 0:if(E[1]==0)return Nr(O,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}U!==512&&(R=O.slice(0,U),tn(R,28));var ie=O.slice(0,U);y(R,L);var Te=R.read_shift(4,"i");if(L===3&&Te!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Te);R.l+=4,he=R.read_shift(4,"i"),R.l+=4,R.chk("00100000","Mini Stream Cutoff Size: "),Ne=R.read_shift(4,"i"),q=R.read_shift(4,"i"),ae=R.read_shift(4,"i"),G=R.read_shift(4,"i");for(var Fe=-1,Ae=0;Ae<109&&(Fe=R.read_shift(4,"i"),!(Fe<0));++Ae)xe[Ae]=Fe;var et=k(O,U);w(ae,G,et,U,xe);var Et=I(et,he,xe,U);Et[he].name="!Directory",q>0&&Ne!==te&&(Et[Ne].name="!MiniFAT"),Et[xe[0]].name="!FAT",Et.fat_addrs=xe,Et.ssz=U;var Ct={},Vt=[],Un=[],zn=[];N(he,Et,et,Vt,q,Ct,Un,Ne),b(Un,zn,Vt),Vt.shift();var gn={FileIndex:Un,FullPaths:zn};return V&&V.raw&&(gn.raw={header:ie,sectors:et}),gn}function p(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(ve,"Header Signature: "),O.l+=16;var V=O.read_shift(2,"u");return[O.read_shift(2,"u"),V]}function y(O,V){var L=9;switch(O.l+=2,L=O.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function k(O,V){for(var L=Math.ceil(O.length/V)-1,U=[],q=1;q<L;++q)U[q-1]=O.slice(q*V,(q+1)*V);return U[L-1]=O.slice(L*V),U}function b(O,V,L){for(var U=0,q=0,G=0,he=0,Ne=0,ae=L.length,xe=[],R=[];U<ae;++U)xe[U]=R[U]=U,V[U]=L[U];for(;Ne<R.length;++Ne)U=R[Ne],q=O[U].L,G=O[U].R,he=O[U].C,xe[U]===U&&(q!==-1&&xe[q]!==q&&(xe[U]=xe[q]),G!==-1&&xe[G]!==G&&(xe[U]=xe[G])),he!==-1&&(xe[he]=U),q!==-1&&U!=xe[U]&&(xe[q]=xe[U],R.lastIndexOf(q)<Ne&&R.push(q)),G!==-1&&U!=xe[U]&&(xe[G]=xe[U],R.lastIndexOf(G)<Ne&&R.push(G));for(U=1;U<ae;++U)xe[U]===U&&(G!==-1&&xe[G]!==G?xe[U]=xe[G]:q!==-1&&xe[q]!==q&&(xe[U]=xe[q]));for(U=1;U<ae;++U)if(O[U].type!==0){if(Ne=U,Ne!=xe[Ne])do Ne=xe[Ne],V[U]=V[Ne]+"/"+V[U];while(Ne!==0&&xe[Ne]!==-1&&Ne!=xe[Ne]);xe[U]=-1}for(V[0]+="/",U=1;U<ae;++U)O[U].type!==2&&(V[U]+="/")}function v(O,V,L){for(var U=O.start,q=O.size,G=[],he=U;L&&q>0&&he>=0;)G.push(V.slice(he*re,he*re+re)),q-=re,he=gi(L,he*4);return G.length===0?Ee(0):Gr(G).slice(0,O.size)}function w(O,V,L,U,q){var G=te;if(O===te){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var he=L[O],Ne=(U>>>2)-1;if(!he)return;for(var ae=0;ae<Ne&&(G=gi(he,ae*4))!==te;++ae)q.push(G);w(gi(he,U-4),V-1,L,U,q)}}function S(O,V,L,U,q){var G=[],he=[];q||(q=[]);var Ne=U-1,ae=0,xe=0;for(ae=V;ae>=0;){q[ae]=!0,G[G.length]=ae,he.push(O[ae]);var R=L[Math.floor(ae*4/U)];if(xe=ae*4&Ne,U<4+xe)throw new Error("FAT boundary crossed: "+ae+" 4 "+U);if(!O[R])break;ae=gi(O[R],xe)}return{nodes:G,data:lg([he])}}function I(O,V,L,U){var q=O.length,G=[],he=[],Ne=[],ae=[],xe=U-1,R=0,E=0,ie=0,Te=0;for(R=0;R<q;++R)if(Ne=[],ie=R+V,ie>=q&&(ie-=q),!he[ie]){ae=[];var Fe=[];for(E=ie;E>=0;){Fe[E]=!0,he[E]=!0,Ne[Ne.length]=E,ae.push(O[E]);var Ae=L[Math.floor(E*4/U)];if(Te=E*4&xe,U<4+Te)throw new Error("FAT boundary crossed: "+E+" 4 "+U);if(!O[Ae]||(E=gi(O[Ae],Te),Fe[E]))break}G[ie]={nodes:Ne,data:lg([ae])}}return G}function N(O,V,L,U,q,G,he,Ne){for(var ae=0,xe=U.length?2:0,R=V[O].data,E=0,ie=0,Te;E<R.length;E+=128){var Fe=R.slice(E,E+128);tn(Fe,64),ie=Fe.read_shift(2),Te=dh(Fe,0,ie-xe),U.push(Te);var Ae={name:Te,type:Fe.read_shift(1),color:Fe.read_shift(1),L:Fe.read_shift(4,"i"),R:Fe.read_shift(4,"i"),C:Fe.read_shift(4,"i"),clsid:Fe.read_shift(16),state:Fe.read_shift(4,"i"),start:0,size:0},et=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);et!==0&&(Ae.ct=P(Fe,Fe.l-8));var Et=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);Et!==0&&(Ae.mt=P(Fe,Fe.l-8)),Ae.start=Fe.read_shift(4,"i"),Ae.size=Fe.read_shift(4,"i"),Ae.size<0&&Ae.start<0&&(Ae.size=Ae.type=0,Ae.start=te,Ae.name=""),Ae.type===5?(ae=Ae.start,q>0&&ae!==te&&(V[ae].name="!StreamData")):Ae.size>=4096?(Ae.storage="fat",V[Ae.start]===void 0&&(V[Ae.start]=S(L,Ae.start,V.fat_addrs,V.ssz)),V[Ae.start].name=Ae.name,Ae.content=V[Ae.start].data.slice(0,Ae.size)):(Ae.storage="minifat",Ae.size<0?Ae.size=0:ae!==te&&Ae.start!==te&&V[ae]&&(Ae.content=v(Ae,V[ae].data,(V[Ne]||{}).data))),Ae.content&&tn(Ae.content,0),G[Te]=Ae,he.push(Ae)}}function P(O,V){return new Date((Gn(O,V+4)/1e7*Math.pow(2,32)+Gn(O,V)/1e7-11644473600)*1e3)}function W(O,V){return h(),m(d.readFileSync(O),V)}function X(O,V){var L=V&&V.type;switch(L||_t&&Buffer.isBuffer(O)&&(L="buffer"),L||"base64"){case"file":return W(O,V);case"base64":return m(Kn(Jn(O)),V);case"binary":return m(Kn(O),V)}return m(O,V)}function M(O,V){var L=V||{},U=L.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=U+"/",O.FileIndex[0]={name:U,type:5}),L.CLSID&&(O.FileIndex[0].clsid=L.CLSID),Z(O)}function Z(O){var V="Sh33tJ5";if(!tt.find(O,"/"+V)){var L=Ee(4);L[0]=55,L[1]=L[3]=50,L[2]=54,O.FileIndex.push({name:V,type:2,content:L,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+V),H(O)}}function H(O,V){M(O);for(var L=!1,U=!1,q=O.FullPaths.length-1;q>=0;--q){var G=O.FileIndex[q];switch(G.type){case 0:U?L=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(G.R*G.L*G.C)&&(L=!0),G.R>-1&&G.L>-1&&G.R==G.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!V)){var he=new Date(1987,1,19),Ne=0,ae=Object.create?Object.create(null):{},xe=[];for(q=0;q<O.FullPaths.length;++q)ae[O.FullPaths[q]]=!0,O.FileIndex[q].type!==0&&xe.push([O.FullPaths[q],O.FileIndex[q]]);for(q=0;q<xe.length;++q){var R=n(xe[q][0]);U=ae[R],U||(xe.push([R,{name:s(R).replace("/",""),type:1,clsid:Ce,ct:he,mt:he,content:null}]),ae[R]=!0)}for(xe.sort(function(Te,Fe){return t(Te[0],Fe[0])}),O.FullPaths=[],O.FileIndex=[],q=0;q<xe.length;++q)O.FullPaths[q]=xe[q][0],O.FileIndex[q]=xe[q][1];for(q=0;q<xe.length;++q){var E=O.FileIndex[q],ie=O.FullPaths[q];if(E.name=s(ie).replace("/",""),E.L=E.R=E.C=-(E.color=1),E.size=E.content?E.content.length:0,E.start=0,E.clsid=E.clsid||Ce,q===0)E.C=xe.length>1?1:-1,E.size=0,E.type=5;else if(ie.slice(-1)=="/"){for(Ne=q+1;Ne<xe.length&&n(O.FullPaths[Ne])!=ie;++Ne);for(E.C=Ne>=xe.length?-1:Ne,Ne=q+1;Ne<xe.length&&n(O.FullPaths[Ne])!=n(ie);++Ne);E.R=Ne>=xe.length?-1:Ne,E.type=1}else n(O.FullPaths[q+1]||"")==n(ie)&&(E.R=q+1),E.type=2}}}function ce(O,V){var L=V||{};if(L.fileType=="mad")return Dr(O,L);if(H(O),L.fileType==="zip")return Ur(O,L);var U=(function(Te){for(var Fe=0,Ae=0,et=0;et<Te.FileIndex.length;++et){var Et=Te.FileIndex[et];if(Et.content){var Ct=Et.content.length;Ct>0&&(Ct<4096?Fe+=Ct+63>>6:Ae+=Ct+511>>9)}}for(var Vt=Te.FullPaths.length+3>>2,Un=Fe+7>>3,zn=Fe+127>>7,gn=Un+Ae+Vt+zn,hr=gn+127>>7,ya=hr<=109?0:Math.ceil((hr-109)/127);gn+hr+ya+127>>7>hr;)ya=++hr<=109?0:Math.ceil((hr-109)/127);var Kt=[1,ya,hr,zn,Vt,Ae,Fe,0];return Te.FileIndex[0].size=Fe<<6,Kt[7]=(Te.FileIndex[0].start=Kt[0]+Kt[1]+Kt[2]+Kt[3]+Kt[4]+Kt[5])+(Kt[6]+7>>3),Kt})(O),q=Ee(U[7]<<9),G=0,he=0;{for(G=0;G<8;++G)q.write_shift(1,Se[G]);for(G=0;G<8;++G)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),G=0;G<3;++G)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,U[2]),q.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),q.write_shift(4,0),q.write_shift(4,4096),q.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:te),q.write_shift(4,U[3]),q.write_shift(-4,U[1]?U[0]-1:te),q.write_shift(4,U[1]),G=0;G<109;++G)q.write_shift(-4,G<U[2]?U[1]+G:-1)}if(U[1])for(he=0;he<U[1];++he){for(;G<236+he*127;++G)q.write_shift(-4,G<U[2]?U[1]+G:-1);q.write_shift(-4,he===U[1]-1?te:he+1)}var Ne=function(Te){for(he+=Te;G<he-1;++G)q.write_shift(-4,G+1);Te&&(++G,q.write_shift(-4,te))};for(he=G=0,he+=U[1];G<he;++G)q.write_shift(-4,ue.DIFSECT);for(he+=U[2];G<he;++G)q.write_shift(-4,ue.FATSECT);Ne(U[3]),Ne(U[4]);for(var ae=0,xe=0,R=O.FileIndex[0];ae<O.FileIndex.length;++ae)R=O.FileIndex[ae],R.content&&(xe=R.content.length,!(xe<4096)&&(R.start=he,Ne(xe+511>>9)));for(Ne(U[6]+7>>3);q.l&511;)q.write_shift(-4,ue.ENDOFCHAIN);for(he=G=0,ae=0;ae<O.FileIndex.length;++ae)R=O.FileIndex[ae],R.content&&(xe=R.content.length,!(!xe||xe>=4096)&&(R.start=he,Ne(xe+63>>6)));for(;q.l&511;)q.write_shift(-4,ue.ENDOFCHAIN);for(G=0;G<U[4]<<2;++G){var E=O.FullPaths[G];if(!E||E.length===0){for(ae=0;ae<17;++ae)q.write_shift(4,0);for(ae=0;ae<3;++ae)q.write_shift(4,-1);for(ae=0;ae<12;++ae)q.write_shift(4,0);continue}R=O.FileIndex[G],G===0&&(R.start=R.size?R.start-1:te);var ie=G===0&&L.root||R.name;if(xe=2*(ie.length+1),q.write_shift(64,ie,"utf16le"),q.write_shift(2,xe),q.write_shift(1,R.type),q.write_shift(1,R.color),q.write_shift(-4,R.L),q.write_shift(-4,R.R),q.write_shift(-4,R.C),R.clsid)q.write_shift(16,R.clsid,"hex");else for(ae=0;ae<4;++ae)q.write_shift(4,0);q.write_shift(4,R.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,R.start),q.write_shift(4,R.size),q.write_shift(4,0)}for(G=1;G<O.FileIndex.length;++G)if(R=O.FileIndex[G],R.size>=4096)if(q.l=R.start+1<<9,_t&&Buffer.isBuffer(R.content))R.content.copy(q,q.l,0,R.size),q.l+=R.size+511&-512;else{for(ae=0;ae<R.size;++ae)q.write_shift(1,R.content[ae]);for(;ae&511;++ae)q.write_shift(1,0)}for(G=1;G<O.FileIndex.length;++G)if(R=O.FileIndex[G],R.size>0&&R.size<4096)if(_t&&Buffer.isBuffer(R.content))R.content.copy(q,q.l,0,R.size),q.l+=R.size+63&-64;else{for(ae=0;ae<R.size;++ae)q.write_shift(1,R.content[ae]);for(;ae&63;++ae)q.write_shift(1,0)}if(_t)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function le(O,V){var L=O.FullPaths.map(function(ae){return ae.toUpperCase()}),U=L.map(function(ae){var xe=ae.split("/");return xe[xe.length-(ae.slice(-1)=="/"?2:1)]}),q=!1;V.charCodeAt(0)===47?(q=!0,V=L[0].slice(0,-1)+V):q=V.indexOf("/")!==-1;var G=V.toUpperCase(),he=q===!0?L.indexOf(G):U.indexOf(G);if(he!==-1)return O.FileIndex[he];var Ne=!G.match(jo);for(G=G.replace(Sn,""),Ne&&(G=G.replace(jo,"!")),he=0;he<L.length;++he)if((Ne?L[he].replace(jo,"!"):L[he]).replace(Sn,"")==G||(Ne?U[he].replace(jo,"!"):U[he]).replace(Sn,"")==G)return O.FileIndex[he];return null}var re=64,te=-2,ve="d0cf11e0a1b11ae1",Se=[208,207,17,224,161,177,26,225],Ce="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:te,FREESECT:-1,HEADER_SIGNATURE:ve,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ce,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ne(O,V,L){h();var U=ce(O,L);d.writeFileSync(V,U)}function A(O){for(var V=new Array(O.length),L=0;L<O.length;++L)V[L]=String.fromCharCode(O[L]);return V.join("")}function me(O,V){var L=ce(O,V);switch(V&&V.type||"buffer"){case"file":return h(),d.writeFileSync(V.filename,L),L;case"binary":return typeof L=="string"?L:A(L);case"base64":return Ho(typeof L=="string"?L:A(L));case"buffer":if(_t)return Buffer.isBuffer(L)?L:pa(L);case"array":return typeof L=="string"?Kn(L):L}return L}var z;function T(O){try{var V=O.InflateRaw,L=new V;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)z=O;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function Q(O,V){if(!z)return sr(O,V);var L=z.InflateRaw,U=new L,q=U._processChunk(O.slice(O.l),U._finishFlushFlag);return O.l+=U.bytesRead,q}function Y(O){return z?z.deflateRawSync(O):Ze(O)}var J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function we(O){var V=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(V>>16|V>>8|V)&255}for(var ye=typeof Uint8Array<"u",je=ye?new Uint8Array(256):[],Xe=0;Xe<256;++Xe)je[Xe]=we(Xe);function D(O,V){var L=je[O&255];return V<=8?L>>>8-V:(L=L<<8|je[O>>8&255],V<=16?L>>>16-V:(L=L<<8|je[O>>16&255],L>>>24-V))}function Pe(O,V){var L=V&7,U=V>>>3;return(O[U]|(L<=6?0:O[U+1]<<8))>>>L&3}function rt(O,V){var L=V&7,U=V>>>3;return(O[U]|(L<=5?0:O[U+1]<<8))>>>L&7}function xt(O,V){var L=V&7,U=V>>>3;return(O[U]|(L<=4?0:O[U+1]<<8))>>>L&15}function nt(O,V){var L=V&7,U=V>>>3;return(O[U]|(L<=3?0:O[U+1]<<8))>>>L&31}function Le(O,V){var L=V&7,U=V>>>3;return(O[U]|(L<=1?0:O[U+1]<<8))>>>L&127}function jt(O,V,L){var U=V&7,q=V>>>3,G=(1<<L)-1,he=O[q]>>>U;return L<8-U||(he|=O[q+1]<<8-U,L<16-U)||(he|=O[q+2]<<16-U,L<24-U)||(he|=O[q+3]<<24-U),he&G}function Rt(O,V,L){var U=V&7,q=V>>>3;return U<=5?O[q]|=(L&7)<<U:(O[q]|=L<<U&255,O[q+1]=(L&7)>>8-U),V+3}function Bt(O,V,L){var U=V&7,q=V>>>3;return L=(L&1)<<U,O[q]|=L,V+1}function bt(O,V,L){var U=V&7,q=V>>>3;return L<<=U,O[q]|=L&255,L>>>=8,O[q+1]=L,V+8}function fr(O,V,L){var U=V&7,q=V>>>3;return L<<=U,O[q]|=L&255,L>>>=8,O[q+1]=L&255,O[q+2]=L>>>8,V+16}function kt(O,V){var L=O.length,U=2*L>V?2*L:V+5,q=0;if(L>=V)return O;if(_t){var G=$p(U);if(O.copy)O.copy(G);else for(;q<O.length;++q)G[q]=O[q];return G}else if(ye){var he=new Uint8Array(U);if(he.set)he.set(O);else for(;q<L;++q)he[q]=O[q];return he}return O.length=U,O}function Pt(O){for(var V=new Array(O),L=0;L<O;++L)V[L]=0;return V}function Ut(O,V,L){var U=1,q=0,G=0,he=0,Ne=0,ae=O.length,xe=ye?new Uint16Array(32):Pt(32);for(G=0;G<32;++G)xe[G]=0;for(G=ae;G<L;++G)O[G]=0;ae=O.length;var R=ye?new Uint16Array(ae):Pt(ae);for(G=0;G<ae;++G)xe[q=O[G]]++,U<q&&(U=q),R[G]=0;for(xe[0]=0,G=1;G<=U;++G)xe[G+16]=Ne=Ne+xe[G-1]<<1;for(G=0;G<ae;++G)Ne=O[G],Ne!=0&&(R[G]=xe[Ne+16]++);var E=0;for(G=0;G<ae;++G)if(E=O[G],E!=0)for(Ne=D(R[G],U)>>U-E,he=(1<<U+4-E)-1;he>=0;--he)V[Ne|he<<E]=E&15|G<<4;return U}var Mt=ye?new Uint16Array(512):Pt(512),Gt=ye?new Uint16Array(32):Pt(32);if(!ye){for(var Tt=0;Tt<512;++Tt)Mt[Tt]=0;for(Tt=0;Tt<32;++Tt)Gt[Tt]=0}(function(){for(var O=[],V=0;V<32;V++)O.push(5);Ut(O,Gt,32);var L=[];for(V=0;V<=143;V++)L.push(8);for(;V<=255;V++)L.push(9);for(;V<=279;V++)L.push(7);for(;V<=287;V++)L.push(8);Ut(L,Mt,288)})();var tr=(function(){for(var V=ye?new Uint8Array(32768):[],L=0,U=0;L<fe.length-1;++L)for(;U<fe[L+1];++U)V[U]=L;for(;U<32768;++U)V[U]=29;var q=ye?new Uint8Array(259):[];for(L=0,U=0;L<K.length-1;++L)for(;U<K[L+1];++U)q[U]=L;function G(Ne,ae){for(var xe=0;xe<Ne.length;){var R=Math.min(65535,Ne.length-xe),E=xe+R==Ne.length;for(ae.write_shift(1,+E),ae.write_shift(2,R),ae.write_shift(2,~R&65535);R-- >0;)ae[ae.l++]=Ne[xe++]}return ae.l}function he(Ne,ae){for(var xe=0,R=0,E=ye?new Uint16Array(32768):[];R<Ne.length;){var ie=Math.min(65535,Ne.length-R);if(ie<10){for(xe=Rt(ae,xe,+(R+ie==Ne.length)),xe&7&&(xe+=8-(xe&7)),ae.l=xe/8|0,ae.write_shift(2,ie),ae.write_shift(2,~ie&65535);ie-- >0;)ae[ae.l++]=Ne[R++];xe=ae.l*8;continue}xe=Rt(ae,xe,+(R+ie==Ne.length)+2);for(var Te=0;ie-- >0;){var Fe=Ne[R];Te=(Te<<5^Fe)&32767;var Ae=-1,et=0;if((Ae=E[Te])&&(Ae|=R&-32768,Ae>R&&(Ae-=32768),Ae<R))for(;Ne[Ae+et]==Ne[R+et]&&et<250;)++et;if(et>2){Fe=q[et],Fe<=22?xe=bt(ae,xe,je[Fe+1]>>1)-1:(bt(ae,xe,3),xe+=5,bt(ae,xe,je[Fe-23]>>5),xe+=3);var Et=Fe<8?0:Fe-4>>2;Et>0&&(fr(ae,xe,et-K[Fe]),xe+=Et),Fe=V[R-Ae],xe=bt(ae,xe,je[Fe]>>3),xe-=3;var Ct=Fe<4?0:Fe-2>>1;Ct>0&&(fr(ae,xe,R-Ae-fe[Fe]),xe+=Ct);for(var Vt=0;Vt<et;++Vt)E[Te]=R&32767,Te=(Te<<5^Ne[R])&32767,++R;ie-=et-1}else Fe<=143?Fe=Fe+48:xe=Bt(ae,xe,1),xe=bt(ae,xe,je[Fe]),E[Te]=R&32767,++R}xe=bt(ae,xe,0)-1}return ae.l=(xe+7)/8|0,ae.l}return function(ae,xe){return ae.length<8?G(ae,xe):he(ae,xe)}})();function Ze(O){var V=Ee(50+Math.floor(O.length*1.1)),L=tr(O,V);return V.slice(0,L)}var qe=ye?new Uint16Array(32768):Pt(32768),vt=ye?new Uint16Array(32768):Pt(32768),ht=ye?new Uint16Array(128):Pt(128),qt=1,rr=1;function Ar(O,V){var L=nt(O,V)+257;V+=5;var U=nt(O,V)+1;V+=5;var q=xt(O,V)+4;V+=4;for(var G=0,he=ye?new Uint8Array(19):Pt(19),Ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ae=1,xe=ye?new Uint8Array(8):Pt(8),R=ye?new Uint8Array(8):Pt(8),E=he.length,ie=0;ie<q;++ie)he[J[ie]]=G=rt(O,V),ae<G&&(ae=G),xe[G]++,V+=3;var Te=0;for(xe[0]=0,ie=1;ie<=ae;++ie)R[ie]=Te=Te+xe[ie-1]<<1;for(ie=0;ie<E;++ie)(Te=he[ie])!=0&&(Ne[ie]=R[Te]++);var Fe=0;for(ie=0;ie<E;++ie)if(Fe=he[ie],Fe!=0){Te=je[Ne[ie]]>>8-Fe;for(var Ae=(1<<7-Fe)-1;Ae>=0;--Ae)ht[Te|Ae<<Fe]=Fe&7|ie<<3}var et=[];for(ae=1;et.length<L+U;)switch(Te=ht[Le(O,V)],V+=Te&7,Te>>>=3){case 16:for(G=3+Pe(O,V),V+=2,Te=et[et.length-1];G-- >0;)et.push(Te);break;case 17:for(G=3+rt(O,V),V+=3;G-- >0;)et.push(0);break;case 18:for(G=11+Le(O,V),V+=7;G-- >0;)et.push(0);break;default:et.push(Te),ae<Te&&(ae=Te);break}var Et=et.slice(0,L),Ct=et.slice(L);for(ie=L;ie<286;++ie)Et[ie]=0;for(ie=U;ie<30;++ie)Ct[ie]=0;return qt=Ut(Et,qe,286),rr=Ut(Ct,vt,30),V}function Lt(O,V){if(O[0]==3&&!(O[1]&3))return[Ha(V),2];for(var L=0,U=0,q=$p(V||1<<18),G=0,he=q.length>>>0,Ne=0,ae=0;(U&1)==0;){if(U=rt(O,L),L+=3,U>>>1)U>>1==1?(Ne=9,ae=5):(L=Ar(O,L),Ne=qt,ae=rr);else{L&7&&(L+=8-(L&7));var xe=O[L>>>3]|O[(L>>>3)+1]<<8;if(L+=32,xe>0)for(!V&&he<G+xe&&(q=kt(q,G+xe),he=q.length);xe-- >0;)q[G++]=O[L>>>3],L+=8;continue}for(;;){!V&&he<G+32767&&(q=kt(q,G+32767),he=q.length);var R=jt(O,L,Ne),E=U>>>1==1?Mt[R]:qe[R];if(L+=E&15,E>>>=4,(E>>>8&255)===0)q[G++]=E;else{if(E==256)break;E-=257;var ie=E<8?0:E-4>>2;ie>5&&(ie=0);var Te=G+K[E];ie>0&&(Te+=jt(O,L,ie),L+=ie),R=jt(O,L,ae),E=U>>>1==1?Gt[R]:vt[R],L+=E&15,E>>>=4;var Fe=E<4?0:E-2>>1,Ae=fe[E];for(Fe>0&&(Ae+=jt(O,L,Fe),L+=Fe),!V&&he<Te&&(q=kt(q,Te+100),he=q.length);G<Te;)q[G]=q[G-Ae],++G}}}return V?[q,L+7>>>3]:[q.slice(0,G),L+7>>>3]}function sr(O,V){var L=O.slice(O.l||0),U=Lt(L,V);return O.l+=U[1],U[0]}function Or(O,V){if(O)typeof console<"u"&&console.error(V);else throw new Error(V)}function Nr(O,V){var L=O;tn(L,0);var U=[],q=[],G={FileIndex:U,FullPaths:q};M(G,{root:V.root});for(var he=L.length-4;(L[he]!=80||L[he+1]!=75||L[he+2]!=5||L[he+3]!=6)&&he>=0;)--he;L.l=he+4,L.l+=4;var Ne=L.read_shift(2);L.l+=6;var ae=L.read_shift(4);for(L.l=ae,he=0;he<Ne;++he){L.l+=20;var xe=L.read_shift(4),R=L.read_shift(4),E=L.read_shift(2),ie=L.read_shift(2),Te=L.read_shift(2);L.l+=8;var Fe=L.read_shift(4),Ae=u(L.slice(L.l+E,L.l+E+ie));L.l+=E+ie+Te;var et=L.l;L.l=Fe+4,Br(L,xe,R,G,Ae),L.l=et}return G}function Br(O,V,L,U,q){O.l+=2;var G=O.read_shift(2),he=O.read_shift(2),Ne=c(O);if(G&8257)throw new Error("Unsupported ZIP encryption");for(var ae=O.read_shift(4),xe=O.read_shift(4),R=O.read_shift(4),E=O.read_shift(2),ie=O.read_shift(2),Te="",Fe=0;Fe<E;++Fe)Te+=String.fromCharCode(O[O.l++]);if(ie){var Ae=u(O.slice(O.l,O.l+ie));(Ae[21589]||{}).mt&&(Ne=Ae[21589].mt),((q||{})[21589]||{}).mt&&(Ne=q[21589].mt)}O.l+=ie;var et=O.slice(O.l,O.l+xe);switch(he){case 8:et=Q(O,R);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+he)}var Et=!1;G&8&&(ae=O.read_shift(4),ae==134695760&&(ae=O.read_shift(4),Et=!0),xe=O.read_shift(4),R=O.read_shift(4)),xe!=V&&Or(Et,"Bad compressed size: "+V+" != "+xe),R!=L&&Or(Et,"Bad uncompressed size: "+L+" != "+R),Er(U,Te,et,{unsafe:!0,mt:Ne})}function Ur(O,V){var L=V||{},U=[],q=[],G=Ee(1),he=L.compression?8:0,Ne=0,ae=0,xe=0,R=0,E=0,ie=O.FullPaths[0],Te=ie,Fe=O.FileIndex[0],Ae=[],et=0;for(ae=1;ae<O.FullPaths.length;++ae)if(Te=O.FullPaths[ae].slice(ie.length),Fe=O.FileIndex[ae],!(!Fe.size||!Fe.content||Te=="Sh33tJ5")){var Et=R,Ct=Ee(Te.length);for(xe=0;xe<Te.length;++xe)Ct.write_shift(1,Te.charCodeAt(xe)&127);Ct=Ct.slice(0,Ct.l),Ae[E]=JS.buf(Fe.content,0);var Vt=Fe.content;he==8&&(Vt=Y(Vt)),G=Ee(30),G.write_shift(4,67324752),G.write_shift(2,20),G.write_shift(2,Ne),G.write_shift(2,he),Fe.mt?o(G,Fe.mt):G.write_shift(4,0),G.write_shift(-4,Ae[E]),G.write_shift(4,Vt.length),G.write_shift(4,Fe.content.length),G.write_shift(2,Ct.length),G.write_shift(2,0),R+=G.length,U.push(G),R+=Ct.length,U.push(Ct),R+=Vt.length,U.push(Vt),G=Ee(46),G.write_shift(4,33639248),G.write_shift(2,0),G.write_shift(2,20),G.write_shift(2,Ne),G.write_shift(2,he),G.write_shift(4,0),G.write_shift(-4,Ae[E]),G.write_shift(4,Vt.length),G.write_shift(4,Fe.content.length),G.write_shift(2,Ct.length),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(4,0),G.write_shift(4,Et),et+=G.l,q.push(G),et+=Ct.length,q.push(Ct),++E}return G=Ee(22),G.write_shift(4,101010256),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,E),G.write_shift(2,E),G.write_shift(4,et),G.write_shift(4,R),G.write_shift(2,0),Gr([Gr(U),Gr(q),G])}var dr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function zr(O,V){if(O.ctype)return O.ctype;var L=O.name||"",U=L.match(/\.([^\.]+)$/);return U&&dr[U[1]]||V&&(U=(L=V).match(/[\.\\]([^\.\\])+$/),U&&dr[U[1]])?dr[U[1]]:"application/octet-stream"}function Yr(O){for(var V=Ho(O),L=[],U=0;U<V.length;U+=76)L.push(V.slice(U,U+76));return L.join(`\r
`)+`\r
`}function En(O){var V=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(xe){var R=xe.charCodeAt(0).toString(16).toUpperCase();return"="+(R.length==1?"0"+R:R)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],U=V.split(`\r
`),q=0;q<U.length;++q){var G=U[q];if(G.length==0){L.push("");continue}for(var he=0;he<G.length;){var Ne=76,ae=G.slice(he,he+Ne);ae.charAt(Ne-1)=="="?Ne--:ae.charAt(Ne-2)=="="?Ne-=2:ae.charAt(Ne-3)=="="&&(Ne-=3),ae=G.slice(he,he+Ne),he+=Ne,he<G.length&&(ae+="="),L.push(ae)}}return L.join(`\r
`)}function Bn(O){for(var V=[],L=0;L<O.length;++L){for(var U=O[L];L<=O.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+O[++L];V.push(U)}for(var q=0;q<V.length;++q)V[q]=V[q].replace(/[=][0-9A-Fa-f]{2}/g,function(G){return String.fromCharCode(parseInt(G.slice(1),16))});return Kn(V.join(`\r
`))}function $r(O,V,L){for(var U="",q="",G="",he,Ne=0;Ne<10;++Ne){var ae=V[Ne];if(!ae||ae.match(/^\s*$/))break;var xe=ae.match(/^(.*?):\s*([^\s].*)$/);if(xe)switch(xe[1].toLowerCase()){case"content-location":U=xe[2].trim();break;case"content-type":G=xe[2].trim();break;case"content-transfer-encoding":q=xe[2].trim();break}}switch(++Ne,q.toLowerCase()){case"base64":he=Kn(Jn(V.slice(Ne).join("")));break;case"quoted-printable":he=Bn(V.slice(Ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var R=Er(O,U.slice(L.length),he,{unsafe:!0});G&&(R.ctype=G)}function Sr(O,V){if(A(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=V&&V.root||"",U=(_t&&Buffer.isBuffer(O)?O.toString("binary"):A(O)).split(`\r
`),q=0,G="";for(q=0;q<U.length;++q)if(G=U[q],!!/^Content-Location:/i.test(G)&&(G=G.slice(G.indexOf("file")),L||(L=G.slice(0,G.lastIndexOf("/")+1)),G.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),G.slice(0,L.length)!=L););var he=(U[1]||"").match(/boundary="(.*?)"/);if(!he)throw new Error("MAD cannot find boundary");var Ne="--"+(he[1]||""),ae=[],xe=[],R={FileIndex:ae,FullPaths:xe};M(R);var E,ie=0;for(q=0;q<U.length;++q){var Te=U[q];Te!==Ne&&Te!==Ne+"--"||(ie++&&$r(R,U.slice(E,q),L),E=q)}return R}function Dr(O,V){var L=V||{},U=L.boundary||"SheetJS";U="------="+U;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],G=O.FullPaths[0],he=G,Ne=O.FileIndex[0],ae=1;ae<O.FullPaths.length;++ae)if(he=O.FullPaths[ae].slice(G.length),Ne=O.FileIndex[ae],!(!Ne.size||!Ne.content||he=="Sh33tJ5")){he=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(et){return"_x"+et.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(et){return"_u"+et.charCodeAt(0).toString(16)+"_"});for(var xe=Ne.content,R=_t&&Buffer.isBuffer(xe)?xe.toString("binary"):A(xe),E=0,ie=Math.min(1024,R.length),Te=0,Fe=0;Fe<=ie;++Fe)(Te=R.charCodeAt(Fe))>=32&&Te<128&&++E;var Ae=E>=ie*4/5;q.push(U),q.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+he),q.push("Content-Transfer-Encoding: "+(Ae?"quoted-printable":"base64")),q.push("Content-Type: "+zr(Ne,he)),q.push(""),q.push(Ae?En(R):Yr(R))}return q.push(U+`--\r
`),q.join(`\r
`)}function Jr(O){var V={};return M(V,O),V}function Er(O,V,L,U){var q=U&&U.unsafe;q||M(O);var G=!q&&tt.find(O,V);if(!G){var he=O.FullPaths[0];V.slice(0,he.length)==he?he=V:(he.slice(-1)!="/"&&(he+="/"),he=(he+V).replace("//","/")),G={name:s(V),type:2},O.FileIndex.push(G),O.FullPaths.push(he),q||tt.utils.cfb_gc(O)}return G.content=L,G.size=L?L.length:0,U&&(U.CLSID&&(G.clsid=U.CLSID),U.mt&&(G.mt=U.mt),U.ct&&(G.ct=U.ct)),G}function ps(O,V){M(O);var L=tt.find(O,V);if(L){for(var U=0;U<O.FileIndex.length;++U)if(O.FileIndex[U]==L)return O.FileIndex.splice(U,1),O.FullPaths.splice(U,1),!0}return!1}function Ir(O,V,L){M(O);var U=tt.find(O,V);if(U){for(var q=0;q<O.FileIndex.length;++q)if(O.FileIndex[q]==U)return O.FileIndex[q].name=s(L),O.FullPaths[q]=L,!0}return!1}function jn(O){H(O,!0)}return r.find=le,r.read=X,r.parse=m,r.write=me,r.writeFile=ne,r.utils={cfb_new:Jr,cfb_add:Er,cfb_del:ps,cfb_mov:Ir,cfb_gc:jn,ReadShift:Ao,CheckField:Cv,prep_blob:tn,bconcat:Gr,use_zlib:T,_deflateRaw:Ze,_inflateRaw:sr,consts:ue},r})();function QS(e){return typeof e=="string"?iu(e):Array.isArray(e)?NS(e):e}function oc(e,r,t){if(typeof Deno<"u"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=iu(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var n=t=="utf8"?Vs(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([QS(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var c=document.createElement("a");if(c.download!=null)return c.download=e,c.href=o,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(r)&&(r=Ka(r)),u.write(r),u.close(),r}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function ZS(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function gr(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function Yp(e,r){for(var t=[],n=gr(e),s=0;s!==n.length;++s)t[e[n[s]][r]]==null&&(t[e[n[s]][r]]=n[s]);return t}function ou(e){for(var r=[],t=gr(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}function cu(e){for(var r=[],t=gr(e),n=0;n!==t.length;++n)r[e[t[n]]]=parseInt(t[n],10);return r}function eE(e){for(var r=[],t=gr(e),n=0;n!==t.length;++n)r[e[t[n]]]==null&&(r[e[t[n]]]=[]),r[e[t[n]]].push(t[n]);return r}var $0=new Date(1899,11,30,0,0,0);function Lr(e,r){var t=e.getTime(),n=$0.getTime()+(e.getTimezoneOffset()-$0.getTimezoneOffset())*6e4;return(t-n)/(1440*60*1e3)}var lv=new Date,tE=$0.getTime()+(lv.getTimezoneOffset()-$0.getTimezoneOffset())*6e4,Jp=lv.getTimezoneOffset();function uu(e){var r=new Date;return r.setTime(e*24*60*60*1e3+tE),r.getTimezoneOffset()!==Jp&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Jp)*6e4),r}function rE(e){var r=0,t=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=s.length;++o)if(s[o]){switch(t=1,o>3&&(n=!0),s[o].slice(s[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[o].slice(s[o].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(s[o],10)}return r}var Qp=new Date("2017-02-19T19:06:09.000Z"),ov=isNaN(Qp.getFullYear())?new Date("2/19/17"):Qp,nE=ov.getFullYear()==2017;function Zt(e,r){var t=new Date(e);if(nE)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(ov.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function ji(e,r){if(_t&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return Vs(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Vs(K1(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Vs(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Vs(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return t[o]||o})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function er(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=er(e[t]));return r}function mr(e,r){for(var t="";t.length<r;)t+=e;return t}function As(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,o){return t=-t,o}),!isNaN(r=Number(n)))?r/t:r}var sE=["january","february","march","april","may","june","july","august","september","october","november","december"];function jl(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),s=r.getMonth(),o=r.getDate();if(isNaN(o))return t;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&sE.indexOf(c)==-1)return t}else if(c.match(/[a-z]/))return t;return n<0||n>8099?t:(s>0||o>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var aE=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,s){if(e||typeof n=="string")return t.split(n);for(var o=t.split(n),c=[o[0]],u=1;u<o.length;++u)c.push(s),c.push(o[u]);return c}})();function cv(e){return e?e.content&&e.type?ji(e.content,!0):e.data?Eo(e.data):e.asNodeBuffer&&_t?Eo(e.asNodeBuffer().toString("binary")):e.asBinary?Eo(e.asBinary()):e._data&&e._data.getContent?Eo(ji(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function uv(e){if(!e)return null;if(e.data)return Up(e.data);if(e.asNodeBuffer&&_t)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?Up(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function iE(e){return e&&e.name.slice(-4)===".bin"?uv(e):cv(e)}function us(e,r){for(var t=e.FullPaths||gr(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),o=0;o<t.length;++o){var c=t[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==c||s==c)return e.files?e.files[t[o]]:e.FileIndex[o]}return null}function ih(e,r){var t=us(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function Tr(e,r,t){if(!t)return iE(ih(e,r));if(!r)return null;try{return Tr(e,r)}catch{return null}}function Yn(e,r,t){if(!t)return cv(ih(e,r));if(!r)return null;try{return Yn(e,r)}catch{return null}}function lE(e,r,t){return uv(ih(e,r))}function Zp(e){for(var r=e.FullPaths||gr(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function yt(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return _t?n=pa(t):n=SS(t),tt.utils.cfb_add(e,r,n)}tt.utils.cfb_add(e,r,t)}else e.file(r,t)}function lh(){return tt.utils.cfb_new()}function fv(e,r){switch(r.type){case"base64":return tt.read(e,{type:"base64"});case"binary":return tt.read(e,{type:"binary"});case"buffer":case"array":return tt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function Co(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?t.pop():s!=="."&&t.push(s)}return t.join("/")}var kr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,oE=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,eg=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,cE=/<[^>]*>/g,pn=kr.match(eg)?eg:cE,uE=/<\w*:/,fE=/<(\/?)\w+:/;function ct(e,r,t){for(var n={},s=0,o=0;s!==e.length&&!((o=e.charCodeAt(s))===32||o===10||o===13);++s);if(r||(n[0]=e.slice(0,s)),s===e.length)return n;var c=e.match(oE),u=0,d="",h=0,m="",p="",y=1;if(c)for(h=0;h!=c.length;++h){for(p=c[h],o=0;o!=p.length&&p.charCodeAt(o)!==61;++o);for(m=p.slice(0,o).trim();p.charCodeAt(o+1)==32;)++o;for(y=(s=p.charCodeAt(o+1))==34||s==39?1:0,d=p.slice(o+1+y,p.length-y),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),n[m]=d,n[m.toLowerCase()]=d;else{var k=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(n[k]&&m.slice(u-3,u)=="ext")continue;n[k]=d,n[k.toLowerCase()]=d}}return n}function Gs(e){return e.replace(fE,"<$1")}var dv={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},oh=ou(dv),At=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var s=n+"",o=s.indexOf("<![CDATA[");if(o==-1)return s.replace(e,function(u,d){return dv[u]||String.fromCharCode(parseInt(d,u.indexOf("x")>-1?16:10))||u}).replace(r,function(u,d){return String.fromCharCode(parseInt(d,16))});var c=s.indexOf("]]>");return t(s.slice(0,o))+s.slice(o+9,c)+t(s.slice(c+3))}})(),ch=/[&<>'"]/g,dE=/[\u0000-\u0008\u000b-\u001f]/g;function Ht(e){var r=e+"";return r.replace(ch,function(t){return oh[t]}).replace(dE,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function tg(e){return Ht(e).replace(/ /g,"_x0020_")}var hv=/[\u0000-\u001f]/g;function uh(e){var r=e+"";return r.replace(ch,function(t){return oh[t]}).replace(/\n/g,"<br/>").replace(hv,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function hE(e){var r=e+"";return r.replace(ch,function(t){return oh[t]}).replace(hv,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var rg=(function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}})();function xE(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Qt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function cd(e){for(var r="",t=0,n=0,s=0,o=0,c=0,u=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(s=e.charCodeAt(t++),n>191&&n<224){c=(n&31)<<6,c|=s&63,r+=String.fromCharCode(c);continue}if(o=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(s&63)<<6|o&63);continue}c=e.charCodeAt(t++),u=((n&7)<<18|(s&63)<<12|(o&63)<<6|c&63)-65536,r+=String.fromCharCode(55296+(u>>>10&1023)),r+=String.fromCharCode(56320+(u&1023))}return r}function ng(e){var r=Ha(2*e.length),t,n,s=1,o=0,c=0,u;for(n=0;n<e.length;n+=s)s=1,(u=e.charCodeAt(n))<128?t=u:u<224?(t=(u&31)*64+(e.charCodeAt(n+1)&63),s=2):u<240?(t=(u&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,t=(u&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,c=55296+(t>>>10&1023),t=56320+(t&1023)),c!==0&&(r[o++]=c&255,r[o++]=c>>>8,c=0),r[o++]=t%256,r[o++]=t>>>8;return r.slice(0,o).toString("ucs2")}function sg(e){return pa(e,"binary").toString("utf8")}var _0="foo bar baz",Wt=_t&&(sg(_0)==cd(_0)&&sg||ng(_0)==cd(_0)&&ng)||cd,Vs=_t?function(e){return pa(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,s=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(s>>18&7))),r.push(String.fromCharCode(144+(s>>12&63))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Vo=(function(){var e={};return function(t,n){var s=t+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}})(),xv=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}})(),mE=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),pE=/<\/?(?:vt:)?variant>/g,gE=/<(?:vt:)([^>]*)>([\s\S]*)</;function ag(e,r){var t=ct(e),n=e.match(mE(t.baseType))||[],s=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return s}return n.forEach(function(o){var c=o.replace(pE,"").match(gE);c&&s.push({v:Wt(c[2]),t:c[1]})}),s}var mv=/(^\s|\s$|\n)/;function rn(e,r){return"<"+e+(r.match(mv)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function qo(e){return gr(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function $e(e,r,t){return"<"+e+(t!=null?qo(t):"")+(r!=null?(r.match(mv)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function Od(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function vE(e,r){switch(typeof e){case"string":var t=$e("vt:lpwstr",Ht(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return $e((e|0)==e?"vt:i4":"vt:r8",Ht(String(e)));case"boolean":return $e("vt:bool",e?"true":"false")}if(e instanceof Date)return $e("vt:filetime",Od(e));throw new Error("Unable to serialize "+e)}function fh(e){if(_t&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Wt(Ka(nh(e)));throw new Error("Bad input format: expected Buffer or string")}var Xo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Mr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Di=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Xn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function yE(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),s=e[r+6]&15,o=5;o>=0;--o)s=s*256+e[r+o];return n==2047?s==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),t*Math.pow(2,n-52)*s)}function bE(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,s=0,o=0,c=n?-r:r;isFinite(c)?c==0?s=o=0:(s=Math.floor(Math.log(c)/Math.LN2),o=c*Math.pow(2,52-s),s<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?s=-1022:(o-=Math.pow(2,52),s+=1023)):(s=2047,o=isNaN(r)?26985:0);for(var u=0;u<=5;++u,o/=256)e[t+u]=o&255;e[t+6]=(s&15)<<4|o&15,e[t+7]=s>>4|n}var ig=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,o=e[0][n].length;s<o;s+=t)r.push.apply(r,e[0][n].slice(s,s+t));return r},lg=_t?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:pa(r)})):ig(e)}:ig,og=function(e,r,t){for(var n=[],s=r;s<t;s+=2)n.push(String.fromCharCode(ua(e,s)));return n.join("").replace(Sn,"")},dh=_t?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Sn,""):og(e,r,t)}:og,cg=function(e,r,t){for(var n=[],s=r;s<r+t;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},pv=_t?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):cg(e,r,t)}:cg,ug=function(e,r,t){for(var n=[],s=r;s<t;s++)n.push(String.fromCharCode(pl(e,s)));return n.join("")},cc=_t?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):ug(r,t,n)}:ug,gv=function(e,r){var t=Gn(e,r);return t>0?cc(e,r+4,r+4+t-1):""},vv=gv,yv=function(e,r){var t=Gn(e,r);return t>0?cc(e,r+4,r+4+t-1):""},bv=yv,wv=function(e,r){var t=2*Gn(e,r);return t>0?cc(e,r+4,r+4+t-1):""},_v=wv,kv=function(r,t){var n=Gn(r,t);return n>0?dh(r,t+4,t+4+n):""},Nv=kv,Sv=function(e,r){var t=Gn(e,r);return t>0?cc(e,r+4,r+4+t):""},Ev=Sv,jv=function(e,r){return yE(e,r)},H0=jv,hh=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};_t&&(vv=function(r,t){if(!Buffer.isBuffer(r))return gv(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},bv=function(r,t){if(!Buffer.isBuffer(r))return yv(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},_v=function(r,t){if(!Buffer.isBuffer(r))return wv(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},Nv=function(r,t){if(!Buffer.isBuffer(r))return kv(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},Ev=function(r,t){if(!Buffer.isBuffer(r))return Sv(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},H0=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):jv(r,t)},hh=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var pl=function(e,r){return e[r]},ua=function(e,r){return e[r+1]*256+e[r]},wE=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Gn=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},gi=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},_E=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Ao(e,r){var t="",n,s,o=[],c,u,d,h;switch(r){case"dbcs":if(h=this.l,_t&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)t+=String.fromCharCode(ua(this,h)),h+=2;e*=2;break;case"utf8":t=cc(this,this.l,this.l+e);break;case"utf16le":e*=2,t=dh(this,this.l,this.l+e);break;case"wstr":return Ao.call(this,e,"dbcs");case"lpstr-ansi":t=vv(this,this.l),e=4+Gn(this,this.l);break;case"lpstr-cp":t=bv(this,this.l),e=4+Gn(this,this.l);break;case"lpwstr":t=_v(this,this.l),e=4+2*Gn(this,this.l);break;case"lpp4":e=4+Gn(this,this.l),t=Nv(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Gn(this,this.l),t=Ev(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(c=pl(this,this.l+e++))!==0;)o.push(w0(c));t=o.join("");break;case"_wstr":for(e=0,t="";(c=ua(this,this.l+e))!==0;)o.push(w0(c)),e+=2;e+=2,t=o.join("");break;case"dbcs-cont":for(t="",h=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return c=pl(this,h),this.l=h+1,u=Ao.call(this,e-d,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(w0(ua(this,h))),h+=2}t=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",h=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return c=pl(this,h),this.l=h+1,u=Ao.call(this,e-d,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(w0(pl(this,h))),h+=1}t=o.join("");break;default:switch(e){case 1:return n=pl(this,this.l),this.l++,n;case 2:return n=(r==="i"?wE:ua)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(e>0?gi:_E)(this,this.l),this.l+=4,n):(s=Gn(this,this.l),this.l+=4,s);case 8:case-8:if(r==="f")return e==8?s=H0(this,this.l):s=H0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:t=pv(this,this.l,e);break}}return this.l+=e,t}var kE=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},NE=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},SE=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function EE(e,r,t){var n=0,s=0;if(t==="dbcs"){for(s=0;s!=r.length;++s)SE(this,r.charCodeAt(s),this.l+2*s);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=r.length;++s)this[this.l+s]=r.charCodeAt(s)&255;n=r.length}else if(t==="hex"){for(;s<e;++s)this[this.l++]=parseInt(r.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(s=0;s<Math.min(r.length,e);++s){var c=r.charCodeAt(s);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,kE(this,r,this.l);break;case 8:if(n=8,t==="f"){bE(this,r,this.l);break}case 16:break;case-4:n=4,NE(this,r,this.l);break}return this.l+=n,this}function Cv(e,r){var t=pv(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function tn(e,r){e.l=r,e.read_shift=Ao,e.chk=Cv,e.write_shift=EE}function mn(e,r){e.l+=r}function Ee(e){var r=Ha(e);return tn(r,0),r}function ga(e,r,t){if(e){var n,s,o;tn(e,e.l||0);for(var c=e.length,u=0,d=0;e.l<c;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var h=Zo[u]||Zo[65535];for(n=e.read_shift(1),o=n&127,s=1;s<4&&n&128;++s)o+=((n=e.read_shift(1))&127)<<7*s;d=e.l+o;var m=h.f&&h.f(e,o,t);if(e.l=d,r(m,h,u))return}}}function Mn(){var e=[],r=_t?256:2048,t=function(h){var m=Ee(h);return tn(m,0),m},n=t(r),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},o=function(h){return n&&h<n.length-n.l?n:(s(),n=t(Math.max(h+1,r)))},c=function(){return s(),Gr(e)},u=function(h){s(),n=h,n.l==null&&(n.l=n.length),o(r)};return{next:o,push:u,end:c,_bufs:e}}function De(e,r,t,n){var s=+r,o;if(!isNaN(s)){n||(n=Zo[s].p||(t||[]).length||0),o=1+(s>=128?1:0)+1,n>=128&&++o,n>=16384&&++o,n>=2097152&&++o;var c=e.next(o);s<=127?c.write_shift(1,s):(c.write_shift(1,(s&127)+128),c.write_shift(1,s>>7));for(var u=0;u!=4;++u)if(n>=128)c.write_shift(1,(n&127)+128),n>>=7;else{c.write_shift(1,n);break}n>0&&hh(t)&&e.push(t)}}function Oo(e,r,t){var n=er(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function fg(e,r,t){var n=er(e);return n.s=Oo(n.s,r.s,t),n.e=Oo(n.e,r.s,t),n}function Do(e,r){if(e.cRel&&e.c<0)for(e=er(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=er(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=ot(e);return!e.cRel&&e.cRel!=null&&(t=TE(t)),!e.rRel&&e.rRel!=null&&(t=jE(t)),t}function ud(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+or(e.s.c)+":"+(e.e.cRel?"":"$")+or(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+wr(e.s.r)+":"+(e.e.rRel?"":"$")+wr(e.e.r):Do(e.s,r.biff)+":"+Do(e.e,r.biff)}function xh(e){return parseInt(CE(e),10)-1}function wr(e){return""+(e+1)}function jE(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function CE(e){return e.replace(/\$(\d+)$/,"$1")}function mh(e){for(var r=FE(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function or(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function TE(e){return e.replace(/^([A-Z])/,"$$$1")}function FE(e){return e.replace(/^\$([A-Z])/,"$1")}function AE(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function cr(e){for(var r=0,t=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?r=10*r+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:r-1}}function ot(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Ln(e){var r=e.indexOf(":");return r==-1?{s:cr(e),e:cr(e)}:{s:cr(e.slice(0,r)),e:cr(e.slice(r+1))}}function gt(e,r){return typeof r>"u"||typeof r=="number"?gt(e.s,e.e):(typeof e!="string"&&(e=ot(e)),typeof r!="string"&&(r=ot(r)),e==r?e:e+":"+r)}function Ot(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,s=0,o=e.length;for(t=0;n<o&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)t=26*t+s;for(r.s.c=--t,t=0;n<o&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)t=10*t+s;if(r.s.r=--t,n===o||s!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=o&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)t=26*t+s;for(r.e.c=--t,t=0;n!=o&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)t=10*t+s;return r.e.r=--t,r}function dg(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=hs(e.z,t?Lr(r):r)}catch{}try{return e.w=hs((e.XF||{}).numFmtId||(t?14:0),t?Lr(r):r)}catch{return""+r}}function xa(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?va[e.v]||e.v:r==null?dg(e,e.v):dg(e,r))}function Ya(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function Tv(e,r,t){var n=t||{},s=e?Array.isArray(e):n.dense,o=e||(s?[]:{}),c=0,u=0;if(o&&n.origin!=null){if(typeof n.origin=="number")c=n.origin;else{var d=typeof n.origin=="string"?cr(n.origin):n.origin;c=d.r,u=d.c}o["!ref"]||(o["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var m=Ot(o["!ref"]);h.s.c=m.s.c,h.s.r=m.s.r,h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),c==-1&&(h.e.r=c=m.e.r+1)}for(var p=0;p!=r.length;++p)if(r[p]){if(!Array.isArray(r[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=r[p].length;++y)if(!(typeof r[p][y]>"u")){var k={v:r[p][y]},b=c+p,v=u+y;if(h.s.r>b&&(h.s.r=b),h.s.c>v&&(h.s.c=v),h.e.r<b&&(h.e.r=b),h.e.c<v&&(h.e.c=v),r[p][y]&&typeof r[p][y]=="object"&&!Array.isArray(r[p][y])&&!(r[p][y]instanceof Date))k=r[p][y];else if(Array.isArray(k.v)&&(k.f=r[p][y][1],k.v=k.v[0]),k.v===null)if(k.f)k.t="n";else if(n.nullError)k.t="e",k.v=0;else if(n.sheetStubs)k.t="z";else continue;else typeof k.v=="number"?k.t="n":typeof k.v=="boolean"?k.t="b":k.v instanceof Date?(k.z=n.dateNF||lt[14],n.cellDates?(k.t="d",k.w=hs(k.z,Lr(k.v))):(k.t="n",k.v=Lr(k.v),k.w=hs(k.z,k.v))):k.t="s";if(s)o[b]||(o[b]=[]),o[b][v]&&o[b][v].z&&(k.z=o[b][v].z),o[b][v]=k;else{var w=ot({c:v,r:b});o[w]&&o[w].z&&(k.z=o[w].z),o[w]=k}}}return h.s.c<1e7&&(o["!ref"]=gt(h)),o}function Pl(e,r){return Tv(null,e,r)}function OE(e){return e.read_shift(4,"i")}function Os(e,r){return r||(r=Ee(4)),r.write_shift(4,e),r}function xn(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function Kr(e,r){var t=!1;return r==null&&(t=!0,r=Ee(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function DE(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function IE(e,r){return r||(r=Ee(4)),r.write_shift(2,0),r.write_shift(2,0),r}function ph(e,r){var t=e.l,n=e.read_shift(1),s=xn(e),o=[],c={t:s,h:s};if((n&1)!==0){for(var u=e.read_shift(4),d=0;d!=u;++d)o.push(DE(e));c.r=o}else c.r=[{ich:0,ifnt:0}];return e.l=t+r,c}function RE(e,r){var t=!1;return r==null&&(t=!0,r=Ee(15+4*e.t.length)),r.write_shift(1,0),Kr(e.t,r),t?r.slice(0,r.l):r}var PE=ph;function ME(e,r){var t=!1;return r==null&&(t=!0,r=Ee(23+4*e.t.length)),r.write_shift(1,1),Kr(e.t,r),r.write_shift(4,1),IE({},r),t?r.slice(0,r.l):r}function ms(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function Ii(e,r){return r==null&&(r=Ee(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function Ri(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function Pi(e,r){return r==null&&(r=Ee(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var LE=xn,Fv=Kr;function gh(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function W0(e,r){var t=!1;return r==null&&(t=!0,r=Ee(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var BE=xn,Dd=gh,vh=W0;function yh(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var s=n===0?H0([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):gi(r,0)>>2;return t?s/100:s}function Av(e,r){r==null&&(r=Ee(4));var t=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,t=1),n)r.write_shift(-4,((t?s:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function Ov(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function UE(e,r){return r||(r=Ee(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var Mi=Ov,Ml=UE;function hn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ci(e,r){return(r||Ee(8)).write_shift(8,e,"f")}function zE(e){var r={},t=e.read_shift(1),n=t>>>1,s=e.read_shift(1),o=e.read_shift(2,"i"),c=e.read_shift(1),u=e.read_shift(1),d=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=s;var h=wi[s];h&&(r.rgb=Ko(h));break;case 2:r.rgb=Ko([c,u,d]);break;case 3:r.theme=s;break}return o!=0&&(r.tint=o>0?o/32767:o/32768),r}function V0(e,r){if(r||(r=Ee(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),r.write_shift(1,parseInt(n.slice(0,2),16)),r.write_shift(1,parseInt(n.slice(2,4),16)),r.write_shift(1,parseInt(n.slice(4,6),16)),r.write_shift(1,255)}return r}function $E(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function HE(e,r){r||(r=Ee(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}function Dv(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function WE(e){return Dv(e,1)}function VE(e){return Dv(e,2)}var bh=2,In=3,k0=11,hg=12,q0=19,N0=64,qE=65,XE=71,GE=4108,KE=4126,Xr=80,Iv=81,YE=[Xr,Iv],Id={1:{n:"CodePage",t:bh},2:{n:"Category",t:Xr},3:{n:"PresentationFormat",t:Xr},4:{n:"ByteCount",t:In},5:{n:"LineCount",t:In},6:{n:"ParagraphCount",t:In},7:{n:"SlideCount",t:In},8:{n:"NoteCount",t:In},9:{n:"HiddenCount",t:In},10:{n:"MultimediaClipCount",t:In},11:{n:"ScaleCrop",t:k0},12:{n:"HeadingPairs",t:GE},13:{n:"TitlesOfParts",t:KE},14:{n:"Manager",t:Xr},15:{n:"Company",t:Xr},16:{n:"LinksUpToDate",t:k0},17:{n:"CharacterCount",t:In},19:{n:"SharedDoc",t:k0},22:{n:"HyperlinksChanged",t:k0},23:{n:"AppVersion",t:In,p:"version"},24:{n:"DigSig",t:qE},26:{n:"ContentType",t:Xr},27:{n:"ContentStatus",t:Xr},28:{n:"Language",t:Xr},29:{n:"Version",t:Xr},255:{},2147483648:{n:"Locale",t:q0},2147483651:{n:"Behavior",t:q0},1919054434:{}},Rd={1:{n:"CodePage",t:bh},2:{n:"Title",t:Xr},3:{n:"Subject",t:Xr},4:{n:"Author",t:Xr},5:{n:"Keywords",t:Xr},6:{n:"Comments",t:Xr},7:{n:"Template",t:Xr},8:{n:"LastAuthor",t:Xr},9:{n:"RevNumber",t:Xr},10:{n:"EditTime",t:N0},11:{n:"LastPrinted",t:N0},12:{n:"CreatedDate",t:N0},13:{n:"ModifiedDate",t:N0},14:{n:"PageCount",t:In},15:{n:"WordCount",t:In},16:{n:"CharCount",t:In},17:{n:"Thumbnail",t:XE},18:{n:"Application",t:Xr},19:{n:"DocSecurity",t:In},255:{},2147483648:{n:"Locale",t:q0},2147483651:{n:"Behavior",t:q0},1919054434:{}},xg={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},JE=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function QE(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var ZE=QE([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),wi=er(ZE),va={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Rv={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Pd={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},S0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function wh(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function e3(e){var r=wh();if(!e||!e.match)return r;var t={};if((e.match(pn)||[]).forEach(function(n){var s=ct(n);switch(s[0].replace(uE,"<")){case"<?xml":break;case"<Types":r.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[s.Extension]=s.ContentType;break;case"<Override":r[Pd[s.ContentType]]!==void 0&&r[Pd[s.ContentType]].push(s.PartName);break}}),r.xmlns!==Mr.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}function Pv(e,r){var t=eE(Pd),n=[],s;n[n.length]=kr,n[n.length]=$e("Types",null,{xmlns:Mr.CT,"xmlns:xsd":Mr.xsd,"xmlns:xsi":Mr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return $e("Default",null,{Extension:d[0],ContentType:d[1]})}));var o=function(d){e[d]&&e[d].length>0&&(s=e[d][0],n[n.length]=$e("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:S0[d][r.bookType]||S0[d].xlsx}))},c=function(d){(e[d]||[]).forEach(function(h){n[n.length]=$e("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:S0[d][r.bookType]||S0[d].xlsx})})},u=function(d){(e[d]||[]).forEach(function(h){n[n.length]=$e("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:t[d][0]})})};return o("workbooks"),c("sheets"),c("charts"),u("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),c("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var St={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Go(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Io(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(pn)||[]).forEach(function(s){var o=ct(s);if(o[0]==="<Relationship"){var c={};c.Type=o.Type,c.Target=o.Target,c.Id=o.Id,o.TargetMode&&(c.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:Co(o.Target,r);t[u]=c,n[o.Id]=c}}),t["!id"]=n,t}function bl(e){var r=[kr,$e("Relationships",null,{xmlns:Mr.RELS})];return gr(e["!id"]).forEach(function(t){r[r.length]=$e("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function $t(e,r,t,n,s,o){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,s.Id="rId"+r,s.Type=n,s.Target=t,[St.HLINK,St.XPATH,St.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,r}var t3="application/vnd.oasis.opendocument.spreadsheet";function r3(e,r){for(var t=fh(e),n,s;n=Xo.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(s=ct(n[0],!1),s.path=="/"&&s.type!==t3)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}function n3(e){var r=[kr];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function mg(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function s3(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function a3(e){var r=[kr];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(mg(e[t][0],e[t][1])),r.push(s3("",e[t][0]));return r.push(mg("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function Mv(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+L0.version+"</meta:generator></office:meta></office:document-meta>"}var ds=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],i3=(function(){for(var e=new Array(ds.length),r=0;r<ds.length;++r){var t=ds[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function Lv(e){var r={};e=Wt(e);for(var t=0;t<ds.length;++t){var n=ds[t],s=e.match(i3[t]);s!=null&&s.length>0&&(r[n[1]]=At(s[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=Zt(r[n[1]]))}return r}function fd(e,r,t,n,s){s[e]!=null||r==null||r===""||(s[e]=r,r=Ht(r),n[n.length]=t?$e(e,r,t):rn(e,r))}function Bv(e,r){var t=r||{},n=[kr,$e("cp:coreProperties",null,{"xmlns:cp":Mr.CORE_PROPS,"xmlns:dc":Mr.dc,"xmlns:dcterms":Mr.dcterms,"xmlns:dcmitype":Mr.dcmitype,"xmlns:xsi":Mr.xsi})],s={};if(!e&&!t.Props)return n.join("");e&&(e.CreatedDate!=null&&fd("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Od(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&fd("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Od(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var o=0;o!=ds.length;++o){var c=ds[o],u=t.Props&&t.Props[c[1]]!=null?t.Props[c[1]]:e?e[c[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&fd(c[0],u,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var _i=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Uv=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function zv(e,r,t,n){var s=[];if(typeof e=="string")s=ag(e,n);else for(var o=0;o<e.length;++o)s=s.concat(e[o].map(function(m){return{v:m}}));var c=typeof r=="string"?ag(r,n).map(function(m){return m.v}):r,u=0,d=0;if(c.length>0)for(var h=0;h!==s.length;h+=2){switch(d=+s[h+1].v,s[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=d,t.SheetNames=c.slice(u,u+d);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=d,t.DefinedNames=c.slice(u,u+d);break;case"Charts":case"Diagramme":t.Chartsheets=d,t.ChartNames=c.slice(u,u+d);break}u+=d}}function l3(e,r,t){var n={};return r||(r={}),e=Wt(e),_i.forEach(function(s){var o=(e.match(Vo(s[0]))||[])[1];switch(s[2]){case"string":o&&(r[s[1]]=At(o));break;case"bool":r[s[1]]=o==="true";break;case"raw":var c=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));c&&c.length>0&&(n[s[1]]=c[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&zv(n.HeadingPairs,n.TitlesOfParts,r,t),r}function $v(e){var r=[],t=$e;return e||(e={}),e.Application="SheetJS",r[r.length]=kr,r[r.length]=$e("Properties",null,{xmlns:Mr.EXT_PROPS,"xmlns:vt":Mr.vt}),_i.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Ht(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(r[r.length]=t(n[0],s))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ht(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var o3=/<[^>]+>[^<]*/g;function c3(e,r){var t={},n="",s=e.match(o3);if(s)for(var o=0;o!=s.length;++o){var c=s[o],u=ct(c);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=At(u.name);break;case"</property>":n=null;break;default:if(c.indexOf("<vt:")===0){var d=c.split(">"),h=d[0].slice(4),m=d[1];switch(h){case"lpstr":case"bstr":case"lpwstr":t[n]=At(m);break;case"bool":t[n]=Qt(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(m,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(m);break;case"filetime":case"date":t[n]=Zt(m);break;case"cy":case"error":t[n]=At(m);break;default:if(h.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",c,h,d)}}else if(c.slice(0,2)!=="</"){if(r.WTF)throw new Error(c)}}}return t}function Hv(e){var r=[kr,$e("Properties",null,{xmlns:Mr.CUST_PROPS,"xmlns:vt":Mr.vt})];if(!e)return r.join("");var t=1;return gr(e).forEach(function(s){++t,r[r.length]=$e("property",vE(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Ht(s)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Md={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},dd;function u3(e,r,t){dd||(dd=ou(Md)),r=dd[r]||r,e[r]=t}function f3(e,r){var t=[];return gr(Md).map(function(n){for(var s=0;s<ds.length;++s)if(ds[s][1]==n)return ds[s];for(s=0;s<_i.length;++s)if(_i[s][1]==n)return _i[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=r&&r.Props&&r.Props[n[1]]!=null?r.Props[n[1]]:e[n[1]];n[2]==="date"&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"Z")),typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),t.push(rn(Md[n[1]]||n[1],s))}}),$e("DocumentProperties",t.join(""),{xmlns:Xn.o})}function d3(e,r){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&gr(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)){for(var c=0;c<ds.length;++c)if(o==ds[c][1])return;for(c=0;c<_i.length;++c)if(o==_i[c][1])return;for(c=0;c<t.length;++c)if(o==t[c])return;var u=e[o],d="string";typeof u=="number"?(d="float",u=String(u)):u===!0||u===!1?(d="boolean",u=u?"1":"0"):u=String(u),s.push($e(tg(o),u,{"dt:dt":d}))}}),r&&gr(r).forEach(function(o){if(Object.prototype.hasOwnProperty.call(r,o)&&!(e&&Object.prototype.hasOwnProperty.call(e,o))){var c=r[o],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c instanceof Date?(u="dateTime.tz",c=c.toISOString()):c=String(c),s.push($e(tg(o),c,{"dt:dt":u}))}}),"<"+n+' xmlns="'+Xn.o+'">'+s.join("")+"</"+n+">"}function _h(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function h3(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,n=t%Math.pow(2,32),s=(t-n)/Math.pow(2,32);n*=1e7,s*=1e7;var o=n/Math.pow(2,32)|0;o>0&&(n=n%Math.pow(2,32),s+=o);var c=Ee(8);return c.write_shift(4,n),c.write_shift(4,s),c}function Wv(e,r,t){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return s}function Vv(e,r,t){var n=e.read_shift(0,"lpwstr");return n}function qv(e,r,t){return r===31?Vv(e):Wv(e,r,t)}function Ld(e,r,t){return qv(e,r,t===!1?0:4)}function x3(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return qv(e,r,0)}function m3(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var s=e.l;t[n]=e.read_shift(0,"lpwstr").replace(Sn,""),e.l-s&2&&(e.l+=2)}return t}function p3(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(Sn,"");return t}function g3(e){var r=e.l,t=X0(e,Iv);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=X0(e,In);return[t,n]}function v3(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(g3(e));return t}function pg(e,r){for(var t=e.read_shift(4),n={},s=0;s!=t;++s){var o=e.read_shift(4),c=e.read_shift(4);n[o]=e.read_shift(c,r===1200?"utf16le":"utf8").replace(Sn,"").replace(jo,"!"),r===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Xv(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function y3(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function X0(e,r,t){var n=e.read_shift(2),s,o=t||{};if(e.l+=2,r!==hg&&n!==r&&YE.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===hg?n:r){case 2:return s=e.read_shift(2,"i"),o.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return Wv(e,n,4).replace(Sn,"");case 31:return Vv(e);case 64:return _h(e);case 65:return Xv(e);case 71:return y3(e);case 80:return Ld(e,n,!o.raw).replace(Sn,"");case 81:return x3(e,n).replace(Sn,"");case 4108:return v3(e);case 4126:case 4127:return n==4127?m3(e):p3(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function gg(e,r){var t=Ee(4),n=Ee(4);switch(t.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,r);break;case 5:n=Ee(8),n.write_shift(8,r,"f");break;case 11:n.write_shift(4,r?1:0);break;case 64:n=h3(r);break;case 31:case 80:for(n=Ee(4+2*(r.length+1)+(r.length%2?0:2)),n.write_shift(4,r.length+1),n.write_shift(0,r,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return Gr([t,n])}function vg(e,r){var t=e.l,n=e.read_shift(4),s=e.read_shift(4),o=[],c=0,u=0,d=-1,h={};for(c=0;c!=s;++c){var m=e.read_shift(4),p=e.read_shift(4);o[c]=[m,p+t]}o.sort(function(I,N){return I[1]-N[1]});var y={};for(c=0;c!=s;++c){if(e.l!==o[c][1]){var k=!0;if(c>0&&r)switch(r[o[c-1][0]].t){case 2:e.l+2===o[c][1]&&(e.l+=2,k=!1);break;case 80:e.l<=o[c][1]&&(e.l=o[c][1],k=!1);break;case 4108:e.l<=o[c][1]&&(e.l=o[c][1],k=!1);break}if((!r||c==0)&&e.l<=o[c][1]&&(k=!1,e.l=o[c][1]),k)throw new Error("Read Error: Expected address "+o[c][1]+" at "+e.l+" :"+c)}if(r){var b=r[o[c][0]];if(y[b.n]=X0(e,b.t,{raw:!0}),b.p==="version"&&(y[b.n]=String(y[b.n]>>16)+"."+("0000"+String(y[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(y[b.n]){case 0:y[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ts(u=y[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[b.n])}}else if(o[c][0]===1){if(u=y.CodePage=X0(e,bh),Ts(u),d!==-1){var v=e.l;e.l=o[d][1],h=pg(e,u),e.l=v}}else if(o[c][0]===0){if(u===0){d=c,e.l=o[c+1][1];continue}h=pg(e,u)}else{var w=h[o[c][0]],S;switch(e[e.l]){case 65:e.l+=4,S=Xv(e);break;case 30:e.l+=4,S=Ld(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,S=Ld(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,S=e.read_shift(4,"i");break;case 19:e.l+=4,S=e.read_shift(4);break;case 5:e.l+=4,S=e.read_shift(8,"f");break;case 11:e.l+=4,S=br(e,4);break;case 64:e.l+=4,S=Zt(_h(e));break;default:throw new Error("unparsed value: "+e[e.l])}y[w]=S}}return e.l=t+n,y}var Gv=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function b3(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function yg(e,r,t){var n=Ee(8),s=[],o=[],c=8,u=0,d=Ee(8),h=Ee(8);if(d.write_shift(4,2),d.write_shift(4,1200),h.write_shift(4,1),o.push(d),s.push(h),c+=8+d.length,!r){h=Ee(8),h.write_shift(4,0),s.unshift(h);var m=[Ee(4)];for(m[0].write_shift(4,e.length),u=0;u<e.length;++u){var p=e[u][0];for(d=Ee(8+2*(p.length+1)+(p.length%2?0:2)),d.write_shift(4,u+2),d.write_shift(4,p.length+1),d.write_shift(0,p,"dbcs");d.l!=d.length;)d.write_shift(1,0);m.push(d)}d=Gr(m),o.unshift(d),c+=8+d.length}for(u=0;u<e.length;++u)if(!(r&&!r[e[u][0]])&&!(Gv.indexOf(e[u][0])>-1||Uv.indexOf(e[u][0])>-1)&&e[u][1]!=null){var y=e[u][1],k=0;if(r){k=+r[e[u][0]];var b=t[k];if(b.p=="version"&&typeof y=="string"){var v=y.split(".");y=(+v[0]<<16)+(+v[1]||0)}d=gg(b.t,y)}else{var w=b3(y);w==-1&&(w=31,y=String(y)),d=gg(w,y)}o.push(d),h=Ee(8),h.write_shift(4,r?k:2+u),s.push(h),c+=8+d.length}var S=8*(o.length+1);for(u=0;u<o.length;++u)s[u].write_shift(4,S),S+=o[u].length;return n.write_shift(4,c),n.write_shift(4,o.length),Gr([n].concat(s).concat(o))}function bg(e,r,t){var n=e.content;if(!n)return{};tn(n,0);var s,o,c,u,d=0;n.chk("feff","Byte Order: "),n.read_shift(2);var h=n.read_shift(4),m=n.read_shift(16);if(m!==tt.utils.consts.HEADER_CLSID&&m!==t)throw new Error("Bad PropertySet CLSID "+m);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(o=n.read_shift(16),u=n.read_shift(4),s===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);s===2&&(c=n.read_shift(16),d=n.read_shift(4));var p=vg(n,r),y={SystemIdentifier:h};for(var k in p)y[k]=p[k];if(y.FMTID=o,s===1)return y;if(d-n.l==2&&(n.l+=2),n.l!==d)throw new Error("Length mismatch 2: "+n.l+" !== "+d);var b;try{b=vg(n,null)}catch{}for(k in b)y[k]=b[k];return y.FMTID=[o,c],y}function wg(e,r,t,n,s,o){var c=Ee(s?68:48),u=[c];c.write_shift(2,65534),c.write_shift(2,0),c.write_shift(4,842412599),c.write_shift(16,tt.utils.consts.HEADER_CLSID,"hex"),c.write_shift(4,s?2:1),c.write_shift(16,r,"hex"),c.write_shift(4,s?68:48);var d=yg(e,t,n);if(u.push(d),s){var h=yg(s,null,null);c.write_shift(16,o,"hex"),c.write_shift(4,68+d.length),u.push(h)}return Gr(u)}function La(e,r){return e.read_shift(r),null}function w3(e,r){r||(r=Ee(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function _3(e,r,t){for(var n=[],s=e.l+r;e.l<s;)n.push(t(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function br(e,r){return e.read_shift(r)===1}function Nn(e,r){return r||(r=Ee(2)),r.write_shift(2,+!!e),r}function Fr(e){return e.read_shift(2,"u")}function fs(e,r){return r||(r=Ee(2)),r.write_shift(2,e),r}function Kv(e,r){return _3(e,r,Fr)}function k3(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function Yv(e,r,t){return t||(t=Ee(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function uc(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=e.read_shift(1);o&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var c=n?e.read_shift(n,s):"";return c}function N3(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,s=t&8,o=1+(t&1),c=0,u,d={};s&&(c=e.read_shift(2)),n&&(u=e.read_shift(4));var h=o==2?"dbcs-cont":"sbcs-cont",m=r===0?"":e.read_shift(r,h);return s&&(e.l+=4*c),n&&(e.l+=u),d.t=m,s||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function S3(e){var r=e.t||"",t=Ee(3);t.write_shift(2,r.length),t.write_shift(1,1);var n=Ee(2*r.length);n.write_shift(2*r.length,r,"utf16le");var s=[t,n];return Gr(s)}function Ti(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function fc(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):Ti(e,n,t)}function Li(e,r,t){if(t.biff>5)return fc(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Jv(e,r,t){return t||(t=Ee(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function E3(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function j3(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var s=e.read_shift((n?r-24:r)>>1,"utf16le").replace(Sn,"");return n&&(e.l+=24),s}function C3(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return t+n.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(o>>1,"utf16le").replace(Sn,"");return t+c}function T3(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return j3(e);case"0303000000000000c000000000000046":return C3(e);default:throw new Error("Unsupported Moniker "+t)}}function E0(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(Sn,""):"";return t}function _g(e,r){r||(r=Ee(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function F3(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var o,c,u,d,h="",m,p;s&16&&(o=E0(e,t-e.l)),s&128&&(c=E0(e,t-e.l)),(s&257)===257&&(u=E0(e,t-e.l)),(s&257)===1&&(d=T3(e,t-e.l)),s&8&&(h=E0(e,t-e.l)),s&32&&(m=e.read_shift(16)),s&64&&(p=_h(e)),e.l=t;var y=c||u||d||"";y&&h&&(y+="#"+h),y||(y="#"+h),s&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var k={Target:y};return m&&(k.guid=m),p&&(k.time=p),o&&(k.Tooltip=o),k}function A3(e){var r=Ee(512),t=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),o=s>-1?31:23;switch(n.charAt(0)){case"#":o=28;break;case".":o&=-3;break}r.write_shift(4,2),r.write_shift(4,o);var c=[8,6815827,6619237,4849780,83];for(t=0;t<c.length;++t)r.write_shift(4,c[t]);if(o==28)n=n.slice(1),_g(n,r);else if(o&2){for(c="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<c.length;++t)r.write_shift(1,parseInt(c[t],16));var u=s>-1?n.slice(0,s):n;for(r.write_shift(4,2*(u.length+1)),t=0;t<u.length;++t)r.write_shift(2,u.charCodeAt(t));r.write_shift(2,0),o&8&&_g(s>-1?n.slice(s+1):"",r)}else{for(c="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<c.length;++t)r.write_shift(1,parseInt(c[t],16));for(var d=0;n.slice(d*3,d*3+3)=="../"||n.slice(d*3,d*3+3)=="..\\";)++d;for(r.write_shift(2,d),r.write_shift(4,n.length-3*d+1),t=0;t<n.length-3*d;++t)r.write_shift(1,n.charCodeAt(t+3*d)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function Qv(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[r,t,n,s]}function Zv(e,r){var t=Qv(e);return t[3]=0,t}function Ks(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function Fi(e,r,t,n){return n||(n=Ee(6)),n.write_shift(2,e),n.write_shift(2,r),n.write_shift(2,t||0),n}function O3(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function D3(e,r,t){return r===0?"":Li(e,r,t)}function I3(e,r,t){var n=t.biff>8?4:2,s=e.read_shift(n),o=e.read_shift(n,"i"),c=e.read_shift(n,"i");return[s,o,c]}function ey(e){var r=e.read_shift(2),t=yh(e);return[r,t]}function R3(e,r,t){e.l+=4,r-=4;var n=e.l+r,s=uc(e,r,t),o=e.read_shift(2);if(n-=e.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return e.l+=o,s}function fu(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r},e:{c:s,r:t}}}function ty(e,r){return r||(r=Ee(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function ry(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r},e:{c:s,r:t}}}var P3=ry;function ny(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function M3(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function L3(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function on(e){e.l+=2,e.l+=e.read_shift(2)}var B3={0:on,4:on,5:on,6:on,7:L3,8:on,9:on,10:on,11:on,12:on,13:M3,14:on,15:on,16:on,17:on,18:on,19:on,20:on,21:ny};function U3(e,r){for(var t=e.l+r,n=[];e.l<t;){var s=e.read_shift(2);e.l-=2;try{n.push(B3[s](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function j0(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function kh(e,r,t){var n=1536,s=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=Ee(s);return o.write_shift(2,n),o.write_shift(2,r),s>4&&o.write_shift(2,29282),s>6&&o.write_shift(2,1997),s>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function z3(e,r){return r===0||e.read_shift(2),1200}function $3(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,s=Li(e,0,t);return e.read_shift(r+n-e.l),s}function H3(e,r){var t=!r||r.biff==8,n=Ee(t?112:54);for(n.write_shift(r.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function W3(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function V3(e,r,t){var n=e.read_shift(4),s=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var c=uc(e,0,t);return c.length===0&&(c="Sheet1"),{pos:n,hs:s,dt:o,name:c}}function q3(e,r){var t=!r||r.biff>=8?2:1,n=Ee(8+t*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),r.biff>=8&&n.write_shift(1,1),n.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function X3(e,r){for(var t=e.l+r,n=e.read_shift(4),s=e.read_shift(4),o=[],c=0;c!=s&&e.l<t;++c)o.push(N3(e));return o.Count=n,o.Unique=s,o}function G3(e,r){var t=Ee(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=S3(e[s]);var o=Gr([t].concat(n));return o.parts=[t.length].concat(n.map(function(c){return c.length})),o}function K3(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function Y3(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function J3(e){var r=O3(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function Q3(e){return e.read_shift(2),e.read_shift(4)}function kg(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);t&&t.biff==2&&(n=1-(s>>15),s&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,s]}function Z3(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),d=e.read_shift(2),h=e.read_shift(2);return{Pos:[r,t],Dim:[n,s],Flags:o,CurTab:c,FirstTab:u,Selected:d,TabRatio:h}}function ej(){var e=Ee(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function tj(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function rj(e){var r=Ee(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function nj(){}function sj(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=uc(e,0,t),n}function aj(e,r){var t=e.name||"Arial",n=r&&r.biff==5,s=n?15+t.length:16+2*t.length,o=Ee(s);return o.write_shift(2,e.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,t.length),n||o.write_shift(1,1),o.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),o}function ij(e){var r=Ks(e);return r.isst=e.read_shift(4),r}function lj(e,r,t,n){var s=Ee(10);return Fi(e,r,n,s),s.write_shift(4,t),s}function oj(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,s=Ks(e);t.biff==2&&e.l++;var o=fc(e,n-e.l,t);return s.val=o,s}function cj(e,r,t,n,s){var o=!s||s.biff==8,c=Ee(8+ +o+(1+o)*t.length);return Fi(e,r,n,c),c.write_shift(2,t.length),o&&c.write_shift(1,1),c.write_shift((1+o)*t.length,t,o?"utf16le":"sbcs"),c}function uj(e,r,t){var n=e.read_shift(2),s=Li(e,0,t);return[n,s]}function fj(e,r,t,n){var s=t&&t.biff==5;n||(n=Ee(s?3+r.length:5+2*r.length)),n.write_shift(2,e),n.write_shift(s?1:2,r.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le");var o=n.length>n.l?n.slice(0,n.l):n;return o.l==null&&(o.l=o.length),o}var dj=Li;function Ng(e,r,t){var n=e.l+r,s=t.biff==8||!t.biff?4:2,o=e.read_shift(s),c=e.read_shift(s),u=e.read_shift(2),d=e.read_shift(2);return e.l=n,{s:{r:o,c:u},e:{r:c,c:d}}}function hj(e,r){var t=r.biff==8||!r.biff?4:2,n=Ee(2*t+6);return n.write_shift(t,e.s.r),n.write_shift(t,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function xj(e){var r=e.read_shift(2),t=e.read_shift(2),n=ey(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function mj(e,r){for(var t=e.l+r-2,n=e.read_shift(2),s=e.read_shift(2),o=[];e.l<t;)o.push(ey(e));if(e.l!==t)throw new Error("MulRK read error");var c=e.read_shift(2);if(o.length!=c-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:c,rkrec:o}}function pj(e,r){for(var t=e.l+r-2,n=e.read_shift(2),s=e.read_shift(2),o=[];e.l<t;)o.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var c=e.read_shift(2);if(o.length!=c-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:c,ixfe:o}}function gj(e,r,t,n){var s={},o=e.read_shift(4),c=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2);return s.patternType=JE[u>>26],n.cellStyles&&(s.alc=o&7,s.fWrap=o>>3&1,s.alcV=o>>4&7,s.fJustLast=o>>7&1,s.trot=o>>8&255,s.cIndent=o>>16&15,s.fShrinkToFit=o>>20&1,s.iReadOrder=o>>22&2,s.fAtrNum=o>>26&1,s.fAtrFnt=o>>27&1,s.fAtrAlc=o>>28&1,s.fAtrBdr=o>>29&1,s.fAtrPat=o>>30&1,s.fAtrProt=o>>31&1,s.dgLeft=c&15,s.dgRight=c>>4&15,s.dgTop=c>>8&15,s.dgBottom=c>>12&15,s.icvLeft=c>>16&127,s.icvRight=c>>23&127,s.grbitDiag=c>>30&3,s.icvTop=u&127,s.icvBottom=u>>7&127,s.icvDiag=u>>14&127,s.dgDiag=u>>21&15,s.icvFore=d&127,s.icvBack=d>>7&127,s.fsxButton=d>>14&1),s}function vj(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=gj(e,r,n.fStyle,t),n}function Sg(e,r,t,n){var s=t&&t.biff==5;n||(n=Ee(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,r<<4));var o=0;return e.numFmtId>0&&s&&(o|=1024),n.write_shift(4,o),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function yj(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function bj(e){var r=Ee(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function Eg(e,r,t){var n=Ks(e);(t.biff==2||r==9)&&++e.l;var s=k3(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function wj(e,r,t,n,s,o){var c=Ee(8);return Fi(e,r,n,c),Yv(t,o,c),c}function _j(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=Ks(e),s=hn(e);return n.val=s,n}function kj(e,r,t,n){var s=Ee(14);return Fi(e,r,n,s),Ci(t,s),s}var jg=D3;function Nj(e,r,t){var n=e.l+r,s=e.read_shift(2),o=e.read_shift(2);if(t.sbcch=o,o==1025||o==14849)return[o,s];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var c=Ti(e,o),u=[];n>e.l;)u.push(fc(e));return[o,s,c,u]}function Cg(e,r,t){var n=e.read_shift(2),s,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(s=R3(e,r-2,t)),o.body=s||e.read_shift(r-2),typeof s=="string"&&(o.Name=s),o}var Sj=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Tg(e,r,t){var n=e.l+r,s=e.read_shift(2),o=e.read_shift(1),c=e.read_shift(1),u=e.read_shift(t&&t.biff==2?1:2),d=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),d=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var h=Ti(e,c,t);s&32&&(h=Sj[h.charCodeAt(0)]);var m=n-e.l;t&&t.biff==2&&--m;var p=n==e.l||u===0||!(m>0)?[]:U5(e,m,t,u);return{chKey:o,Name:h,itab:d,rgce:p}}function sy(e,r,t){if(t.biff<8)return Ej(e,r,t);for(var n=[],s=e.l+r,o=e.read_shift(t.biff>8?4:2);o--!==0;)n.push(I3(e,t.biff>8?12:6,t));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function Ej(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=uc(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function jj(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),s=e.read_shift(2),o=Ti(e,n,t),c=Ti(e,s,t);return[o,c]}function Cj(e,r,t){var n=ry(e);e.l++;var s=e.read_shift(1);return r-=8,[z5(e,r,t),s,n]}function Fg(e,r,t){var n=P3(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,L5(e,r,t)]}function Tj(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function Fj(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=Li(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:s},u,c,o]}}function Aj(e,r,t){return Fj(e,r,t)}function Oj(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(fu(e));return t}function Dj(e){var r=Ee(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)ty(e[t],r);return r}function Ij(e,r,t){if(t&&t.biff<8)return Pj(e,r,t);var n=ny(e),s=U3(e,r-22,n[1]);return{cmo:n,ft:s}}var Rj={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=t,{fmt:n}}};function Pj(e,r,t){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var c=[];return c.push((Rj[n]||mn)(e,r,t)),{cmo:[s,n,o],ft:c}}function Mj(e,r,t){var n=e.l,s="";try{e.l+=4;var o=(t.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:c=E3(e,6,t);var u=e.read_shift(2);e.read_shift(2),Fr(e,2);var d=e.read_shift(2);e.l+=d;for(var h=1;h<e.lens.length-1;++h){if(e.l-n!=e.lens[h])throw new Error("TxO: bad continue record");var m=e[e.l],p=Ti(e,e.lens[h+1]-e.lens[h]-1);if(s+=p,s.length>=(m?u:2*u))break}if(s.length!==u&&s.length!==u*2)throw new Error("cchText: "+u+" != "+s.length);return e.l=n+r,{t:s}}catch{return e.l=n+r,{t:s}}}function Lj(e,r){var t=fu(e);e.l+=16;var n=F3(e,r-24);return[t,n]}function Bj(e){var r=Ee(24),t=cr(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)r.write_shift(1,parseInt(n[s],16));return Gr([r,A3(e[1])])}function Uj(e,r){e.read_shift(2);var t=fu(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(Sn,""),[t,n]}function zj(e){var r=e[1].Tooltip,t=Ee(10+2*(r.length+1));t.write_shift(2,2048);var n=cr(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var s=0;s<r.length;++s)t.write_shift(2,r.charCodeAt(s));return t.write_shift(2,0),t}function $j(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=xg[t]||t,t=e.read_shift(2),r[1]=xg[t]||t,r}function Hj(e){return e||(e=Ee(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Wj(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Zv(e));return t}function Vj(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Zv(e));return t}function qj(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function ay(e,r,t){if(!t.cellStyles)return mn(e,r);var n=t&&t.biff>=12?4:2,s=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(n),u=e.read_shift(n),d=e.read_shift(2);n==2&&(e.l+=2);var h={s,e:o,w:c,ixfe:u,flags:d};return(t.biff>=5||!t.biff)&&(h.level=d>>8&7),h}function Xj(e,r){var t=Ee(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var n=0;return e.hidden&&(n|=1),t.write_shift(1,n),n=e.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function Gj(e,r){var t={};return r<32||(e.l+=16,t.header=hn(e),t.footer=hn(e),e.l+=2),t}function Kj(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function Yj(e){for(var r=Ee(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}var Jj=Ks,Qj=Kv,Zj=fc;function eC(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),s={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function tC(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=Ks(e);++e.l;var s=Li(e,r-7,t);return n.t="str",n.val=s,n}function rC(e){var r=Ks(e);++e.l;var t=hn(e);return r.t="n",r.val=t,r}function nC(e,r,t){var n=Ee(15);return mc(n,e,r),n.write_shift(8,t,"f"),n}function sC(e){var r=Ks(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function aC(e,r,t){var n=Ee(9);return mc(n,e,r),n.write_shift(2,t),n}function iC(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function lC(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function oC(e,r,t){var n=e.l+r,s=Ks(e),o=e.read_shift(2),c=Ti(e,o,t);return e.l=n,s.t="str",s.val=c,s}var cC=[2,3,48,49,131,139,140,245],Bd=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=ou({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(u,d){var h=[],m=Ha(1);switch(d.type){case"base64":m=Kn(Jn(u));break;case"binary":m=Kn(u);break;case"buffer":case"array":m=u;break}tn(m,0);var p=m.read_shift(1),y=!!(p&136),k=!1,b=!1;switch(p){case 2:break;case 3:break;case 48:k=!0,y=!0;break;case 49:k=!0,y=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var v=0,w=521;p==2&&(v=m.read_shift(2)),m.l+=3,p!=2&&(v=m.read_shift(4)),v>1048576&&(v=1e6),p!=2&&(w=m.read_shift(2));var S=m.read_shift(2),I=d.codepage||1252;p!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(I=e[m[m.l]]),m.l+=1,m.l+=2),b&&(m.l+=36);for(var N=[],P={},W=Math.min(m.length,p==2?521:w-10-(k?264:0)),X=b?32:11;m.l<W&&m[m.l]!=13;)switch(P={},P.name=$o.utils.decode(I,m.slice(m.l,m.l+X)).replace(/[\u0000\r\n].*$/g,""),m.l+=X,P.type=String.fromCharCode(m.read_shift(1)),p!=2&&!b&&(P.offset=m.read_shift(4)),P.len=m.read_shift(1),p==2&&(P.offset=m.read_shift(2)),P.dec=m.read_shift(1),P.name.length&&N.push(P),p!=2&&(m.l+=b?13:14),P.type){case"B":(!k||P.len!=8)&&d.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(m[m.l]!==13&&(m.l=w-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=w;var M=0,Z=0;for(h[0]=[],Z=0;Z!=N.length;++Z)h[0][Z]=N[Z].name;for(;v-- >0;){if(m[m.l]===42){m.l+=S;continue}for(++m.l,h[++M]=[],Z=0,Z=0;Z!=N.length;++Z){var H=m.slice(m.l,m.l+N[Z].len);m.l+=N[Z].len,tn(H,0);var ce=$o.utils.decode(I,H);switch(N[Z].type){case"C":ce.trim().length&&(h[M][Z]=ce.replace(/\s+$/,""));break;case"D":ce.length===8?h[M][Z]=new Date(+ce.slice(0,4),+ce.slice(4,6)-1,+ce.slice(6,8)):h[M][Z]=ce;break;case"F":h[M][Z]=parseFloat(ce.trim());break;case"+":case"I":h[M][Z]=b?H.read_shift(-4,"i")^2147483648:H.read_shift(4,"i");break;case"L":switch(ce.trim().toUpperCase()){case"Y":case"T":h[M][Z]=!0;break;case"N":case"F":h[M][Z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ce+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));h[M][Z]="##MEMO##"+(b?parseInt(ce.trim(),10):H.read_shift(4));break;case"N":ce=ce.replace(/\u0000/g,"").trim(),ce&&ce!="."&&(h[M][Z]=+ce||0);break;case"@":h[M][Z]=new Date(H.read_shift(-8,"f")-621356832e5);break;case"T":h[M][Z]=new Date((H.read_shift(4)-2440588)*864e5+H.read_shift(4));break;case"Y":h[M][Z]=H.read_shift(4,"i")/1e4+H.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[M][Z]=-H.read_shift(-8,"f");break;case"B":if(k&&N[Z].len==8){h[M][Z]=H.read_shift(8,"f");break}case"G":case"P":H.l+=N[Z].len;break;case"0":if(N[Z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[Z].type)}}}if(p!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return d&&d.sheetRows&&(h=h.slice(0,d.sheetRows)),d.DBF=N,h}function n(u,d){var h=d||{};h.dateNF||(h.dateNF="yyyymmdd");var m=Pl(t(u,h),h);return m["!cols"]=h.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete h.DBF,m}function s(u,d){try{return Ya(n(u,d),d)}catch(h){if(d&&d.WTF)throw h}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,d){var h=d||{};if(+h.codepage>=0&&Ts(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var m=Mn(),p=J0(u,{header:1,raw:!0,cellDates:!0}),y=p[0],k=p.slice(1),b=u["!cols"]||[],v=0,w=0,S=0,I=1;for(v=0;v<y.length;++v){if(((b[v]||{}).DBF||{}).name){y[v]=b[v].DBF.name,++S;continue}if(y[v]!=null){if(++S,typeof y[v]=="number"&&(y[v]=y[v].toString(10)),typeof y[v]!="string")throw new Error("DBF Invalid column name "+y[v]+" |"+typeof y[v]+"|");if(y.indexOf(y[v])!==v){for(w=0;w<1024;++w)if(y.indexOf(y[v]+"_"+w)==-1){y[v]+="_"+w;break}}}}var N=Ot(u["!ref"]),P=[],W=[],X=[];for(v=0;v<=N.e.c-N.s.c;++v){var M="",Z="",H=0,ce=[];for(w=0;w<k.length;++w)k[w][v]!=null&&ce.push(k[w][v]);if(ce.length==0||y[v]==null){P[v]="?";continue}for(w=0;w<ce.length;++w){switch(typeof ce[w]){case"number":Z="B";break;case"string":Z="C";break;case"boolean":Z="L";break;case"object":Z=ce[w]instanceof Date?"D":"C";break;default:Z="C"}H=Math.max(H,String(ce[w]).length),M=M&&M!=Z?"C":Z}H>250&&(H=250),Z=((b[v]||{}).DBF||{}).type,Z=="C"&&b[v].DBF.len>H&&(H=b[v].DBF.len),M=="B"&&Z=="N"&&(M="N",X[v]=b[v].DBF.dec,H=b[v].DBF.len),W[v]=M=="C"||Z=="N"?H:o[M]||0,I+=W[v],P[v]=M}var le=m.next(32);for(le.write_shift(4,318902576),le.write_shift(4,k.length),le.write_shift(2,296+32*S),le.write_shift(2,I),v=0;v<4;++v)le.write_shift(4,0);for(le.write_shift(4,0|(+r[G1]||3)<<8),v=0,w=0;v<y.length;++v)if(y[v]!=null){var re=m.next(32),te=(y[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);re.write_shift(1,te,"sbcs"),re.write_shift(1,P[v]=="?"?"C":P[v],"sbcs"),re.write_shift(4,w),re.write_shift(1,W[v]||o[P[v]]||0),re.write_shift(1,X[v]||0),re.write_shift(1,2),re.write_shift(4,0),re.write_shift(1,0),re.write_shift(4,0),re.write_shift(4,0),w+=W[v]||o[P[v]]||0}var ve=m.next(264);for(ve.write_shift(4,13),v=0;v<65;++v)ve.write_shift(4,0);for(v=0;v<k.length;++v){var Se=m.next(I);for(Se.write_shift(1,0),w=0;w<y.length;++w)if(y[w]!=null)switch(P[w]){case"L":Se.write_shift(1,k[v][w]==null?63:k[v][w]?84:70);break;case"B":Se.write_shift(8,k[v][w]||0,"f");break;case"N":var Ce="0";for(typeof k[v][w]=="number"&&(Ce=k[v][w].toFixed(X[w]||0)),S=0;S<W[w]-Ce.length;++S)Se.write_shift(1,32);Se.write_shift(1,Ce,"sbcs");break;case"D":k[v][w]?(Se.write_shift(4,("0000"+k[v][w].getFullYear()).slice(-4),"sbcs"),Se.write_shift(2,("00"+(k[v][w].getMonth()+1)).slice(-2),"sbcs"),Se.write_shift(2,("00"+k[v][w].getDate()).slice(-2),"sbcs")):Se.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(k[v][w]!=null?k[v][w]:"").slice(0,W[w]);for(Se.write_shift(1,ue,"sbcs"),S=0;S<W[w]-ue.length;++S)Se.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:s,to_sheet:n,from_sheet:c}})(),iy=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+gr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(y,k){var b=e[k];return typeof b=="number"?zp(b):b},n=function(y,k,b){var v=k.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return v==59?y:zp(v)};e["|"]=254;function s(y,k){switch(k.type){case"base64":return o(Jn(y),k);case"binary":return o(y,k);case"buffer":return o(_t&&Buffer.isBuffer(y)?y.toString("binary"):Ka(y),k);case"array":return o(ji(y),k)}throw new Error("Unrecognized type "+k.type)}function o(y,k){var b=y.split(/[\n\r]+/),v=-1,w=-1,S=0,I=0,N=[],P=[],W=null,X={},M=[],Z=[],H=[],ce=0,le;for(+k.codepage>=0&&Ts(+k.codepage);S!==b.length;++S){ce=0;var re=b[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),te=re.replace(/;;/g,"\0").split(";").map(function(J){return J.replace(/\u0000/g,";")}),ve=te[0],Se;if(re.length>0)switch(ve){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":te[1].charAt(0)=="P"&&P.push(re.slice(3).replace(/;;/g,";"));break;case"C":var Ce=!1,ue=!1,ne=!1,A=!1,me=-1,z=-1;for(I=1;I<te.length;++I)switch(te[I].charAt(0)){case"A":break;case"X":w=parseInt(te[I].slice(1))-1,ue=!0;break;case"Y":for(v=parseInt(te[I].slice(1))-1,ue||(w=0),le=N.length;le<=v;++le)N[le]=[];break;case"K":Se=te[I].slice(1),Se.charAt(0)==='"'?Se=Se.slice(1,Se.length-1):Se==="TRUE"?Se=!0:Se==="FALSE"?Se=!1:isNaN(As(Se))?isNaN(jl(Se).getDate())||(Se=Zt(Se)):(Se=As(Se),W!==null&&Il(W)&&(Se=uu(Se))),Ce=!0;break;case"E":A=!0;var T=wl(te[I].slice(1),{r:v,c:w});N[v][w]=[N[v][w],T];break;case"S":ne=!0,N[v][w]=[N[v][w],"S5S"];break;case"G":break;case"R":me=parseInt(te[I].slice(1))-1;break;case"C":z=parseInt(te[I].slice(1))-1;break;default:if(k&&k.WTF)throw new Error("SYLK bad record "+re)}if(Ce&&(N[v][w]&&N[v][w].length==2?N[v][w][0]=Se:N[v][w]=Se,W=null),ne){if(A)throw new Error("SYLK shared formula cannot have own formula");var Q=me>-1&&N[me][z];if(!Q||!Q[1])throw new Error("SYLK shared formula cannot find base");N[v][w][1]=Ny(Q[1],{r:v-me,c:w-z})}break;case"F":var Y=0;for(I=1;I<te.length;++I)switch(te[I].charAt(0)){case"X":w=parseInt(te[I].slice(1))-1,++Y;break;case"Y":for(v=parseInt(te[I].slice(1))-1,le=N.length;le<=v;++le)N[le]=[];break;case"M":ce=parseInt(te[I].slice(1))/20;break;case"F":break;case"G":break;case"P":W=P[parseInt(te[I].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(H=te[I].slice(1).split(" "),le=parseInt(H[0],10);le<=parseInt(H[1],10);++le)ce=parseInt(H[2],10),Z[le-1]=ce===0?{hidden:!0}:{wch:ce},Wa(Z[le-1]);break;case"C":w=parseInt(te[I].slice(1))-1,Z[w]||(Z[w]={});break;case"R":v=parseInt(te[I].slice(1))-1,M[v]||(M[v]={}),ce>0?(M[v].hpt=ce,M[v].hpx=Tl(ce)):ce===0&&(M[v].hidden=!0);break;default:if(k&&k.WTF)throw new Error("SYLK bad record "+re)}Y<1&&(W=null);break;default:if(k&&k.WTF)throw new Error("SYLK bad record "+re)}}return M.length>0&&(X["!rows"]=M),Z.length>0&&(X["!cols"]=Z),k&&k.sheetRows&&(N=N.slice(0,k.sheetRows)),[N,X]}function c(y,k){var b=s(y,k),v=b[0],w=b[1],S=Pl(v,k);return gr(w).forEach(function(I){S[I]=w[I]}),S}function u(y,k){return Ya(c(y,k),k)}function d(y,k,b,v){var w="C;Y"+(b+1)+";X"+(v+1)+";K";switch(y.t){case"n":w+=y.v||0,y.f&&!y.F&&(w+=";E"+Th(y.f,{r:b,c:v}));break;case"b":w+=y.v?"TRUE":"FALSE";break;case"e":w+=y.w||y.v;break;case"d":w+='"'+(y.w||y.v)+'"';break;case"s":w+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function h(y,k){k.forEach(function(b,v){var w="F;W"+(v+1)+" "+(v+1)+" ";b.hidden?w+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=Yo(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=Jo(b.wpx)),typeof b.wch=="number"&&(w+=Math.round(b.wch))),w.charAt(w.length-1)!=" "&&y.push(w)})}function m(y,k){k.forEach(function(b,v){var w="F;";b.hidden?w+="M0;":b.hpt?w+="M"+20*b.hpt+";":b.hpx&&(w+="M"+20*Qo(b.hpx)+";"),w.length>2&&y.push(w+"R"+(v+1))})}function p(y,k){var b=["ID;PWXL;N;E"],v=[],w=Ot(y["!ref"]),S,I=Array.isArray(y),N=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),y["!cols"]&&h(b,y["!cols"]),y["!rows"]&&m(b,y["!rows"]),b.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var P=w.s.r;P<=w.e.r;++P)for(var W=w.s.c;W<=w.e.c;++W){var X=ot({r:P,c:W});S=I?(y[P]||[])[W]:y[X],!(!S||S.v==null&&(!S.f||S.F))&&v.push(d(S,y,P,W))}return b.join(N)+N+v.join(N)+N+"E"+N}return{to_workbook:u,to_sheet:c,from_sheet:p}})(),ly=(function(){function e(o,c){switch(c.type){case"base64":return r(Jn(o),c);case"binary":return r(o,c);case"buffer":return r(_t&&Buffer.isBuffer(o)?o.toString("binary"):Ka(o),c);case"array":return r(ji(o),c)}throw new Error("Unrecognized type "+c.type)}function r(o,c){for(var u=o.split(`
`),d=-1,h=-1,m=0,p=[];m!==u.length;++m){if(u[m].trim()==="BOT"){p[++d]=[],h=0;continue}if(!(d<0)){var y=u[m].trim().split(","),k=y[0],b=y[1];++m;for(var v=u[m]||"";(v.match(/["]/g)||[]).length&1&&m<u.length-1;)v+=`
`+u[++m];switch(v=v.trim(),+k){case-1:if(v==="BOT"){p[++d]=[],h=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?p[d][h]=!0:v==="FALSE"?p[d][h]=!1:isNaN(As(b))?isNaN(jl(b).getDate())?p[d][h]=b:p[d][h]=Zt(b):p[d][h]=As(b),++h;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),p[d][h++]=v!==""?v:null;break}if(v==="EOD")break}}return c&&c.sheetRows&&(p=p.slice(0,c.sheetRows)),p}function t(o,c){return Pl(e(o,c),c)}function n(o,c){return Ya(t(o,c),c)}var s=(function(){var o=function(d,h,m,p,y){d.push(h),d.push(m+","+p),d.push('"'+y.replace(/"/g,'""')+'"')},c=function(d,h,m,p){d.push(h+","+m),d.push(h==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(d){var h=[],m=Ot(d["!ref"]),p,y=Array.isArray(d);o(h,"TABLE",0,1,"sheetjs"),o(h,"VECTORS",0,m.e.r-m.s.r+1,""),o(h,"TUPLES",0,m.e.c-m.s.c+1,""),o(h,"DATA",0,0,"");for(var k=m.s.r;k<=m.e.r;++k){c(h,-1,0,"BOT");for(var b=m.s.c;b<=m.e.c;++b){var v=ot({r:k,c:b});if(p=y?(d[k]||[])[b]:d[v],!p){c(h,1,0,"");continue}switch(p.t){case"n":var w=p.w;!w&&p.v!=null&&(w=p.v),w==null?p.f&&!p.F?c(h,1,0,"="+p.f):c(h,1,0,""):c(h,0,w,"V");break;case"b":c(h,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":c(h,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=hs(p.z||lt[14],Lr(Zt(p.v)))),c(h,0,p.w,"V");break;default:c(h,1,0,"")}}}c(h,-1,0,"EOD");var S=`\r
`,I=h.join(S);return I}})();return{to_workbook:n,to_sheet:t,from_sheet:s}})(),oy=(function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(p,y){for(var k=p.split(`
`),b=-1,v=-1,w=0,S=[];w!==k.length;++w){var I=k[w].trim().split(":");if(I[0]==="cell"){var N=cr(I[1]);if(S.length<=N.r)for(b=S.length;b<=N.r;++b)S[b]||(S[b]=[]);switch(b=N.r,v=N.c,I[2]){case"t":S[b][v]=e(I[3]);break;case"v":S[b][v]=+I[3];break;case"vtf":var P=I[I.length-1];case"vtc":I[3]==="nl"?S[b][v]=!!+I[4]:S[b][v]=+I[4],I[2]=="vtf"&&(S[b][v]=[S[b][v],P])}}}return y&&y.sheetRows&&(S=S.slice(0,y.sheetRows)),S}function n(p,y){return Pl(t(p,y),y)}function s(p,y){return Ya(n(p,y),y)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function h(p){if(!p||!p["!ref"])return"";for(var y=[],k=[],b,v="",w=Ln(p["!ref"]),S=Array.isArray(p),I=w.s.r;I<=w.e.r;++I)for(var N=w.s.c;N<=w.e.c;++N)if(v=ot({r:I,c:N}),b=S?(p[I]||[])[N]:p[v],!(!b||b.v==null||b.t==="z")){switch(k=["cell",v,"t"],b.t){case"s":case"str":k.push(r(b.v));break;case"n":b.f?(k[2]="vtf",k[3]="n",k[4]=b.v,k[5]=r(b.f)):(k[2]="v",k[3]=b.v);break;case"b":k[2]="vt"+(b.f?"f":"c"),k[3]="nl",k[4]=b.v?"1":"0",k[5]=r(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var P=Lr(Zt(b.v));k[2]="vtc",k[3]="nd",k[4]=""+P,k[5]=b.w||hs(b.z||lt[14],P);break;case"e":continue}y.push(k.join(":"))}return y.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function m(p){return[o,c,u,c,h(p),d].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:m}})(),Cl=(function(){function e(m,p,y,k,b){b.raw?p[y][k]=m:m===""||(m==="TRUE"?p[y][k]=!0:m==="FALSE"?p[y][k]=!1:isNaN(As(m))?isNaN(jl(m).getDate())?p[y][k]=m:p[y][k]=Zt(m):p[y][k]=As(m))}function r(m,p){var y=p||{},k=[];if(!m||m.length===0)return k;for(var b=m.split(/[\r\n]/),v=b.length-1;v>=0&&b[v].length===0;)--v;for(var w=10,S=0,I=0;I<=v;++I)S=b[I].indexOf(" "),S==-1?S=b[I].length:S++,w=Math.max(w,S);for(I=0;I<=v;++I){k[I]=[];var N=0;for(e(b[I].slice(0,w).trim(),k,I,N,y),N=1;N<=(b[I].length-w)/10+1;++N)e(b[I].slice(w+(N-1)*10,w+N*10).trim(),k,I,N,y)}return y.sheetRows&&(k=k.slice(0,y.sheetRows)),k}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(m){for(var p={},y=!1,k=0,b=0;k<m.length;++k)(b=m.charCodeAt(k))==34?y=!y:!y&&b in t&&(p[b]=(p[b]||0)+1);b=[];for(k in p)Object.prototype.hasOwnProperty.call(p,k)&&b.push([p[k],k]);if(!b.length){p=n;for(k in p)Object.prototype.hasOwnProperty.call(p,k)&&b.push([p[k],k])}return b.sort(function(v,w){return v[0]-w[0]||n[v[1]]-n[w[1]]}),t[b.pop()[1]]||44}function o(m,p){var y=p||{},k="",b=y.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(k=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(k=m.charAt(4),m=m.slice(6)):k=s(m.slice(0,1024)):y&&y.FS?k=y.FS:k=s(m.slice(0,1024));var w=0,S=0,I=0,N=0,P=0,W=k.charCodeAt(0),X=!1,M=0,Z=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var H=y.dateNF!=null?KS(y.dateNF):null;function ce(){var le=m.slice(N,P),re={};if(le.charAt(0)=='"'&&le.charAt(le.length-1)=='"'&&(le=le.slice(1,-1).replace(/""/g,'"')),le.length===0)re.t="z";else if(y.raw)re.t="s",re.v=le;else if(le.trim().length===0)re.t="s",re.v=le;else if(le.charCodeAt(0)==61)le.charCodeAt(1)==34&&le.charCodeAt(le.length-1)==34?(re.t="s",re.v=le.slice(2,-1).replace(/""/g,'"')):N6(le)?(re.t="n",re.f=le.slice(1)):(re.t="s",re.v=le);else if(le=="TRUE")re.t="b",re.v=!0;else if(le=="FALSE")re.t="b",re.v=!1;else if(!isNaN(I=As(le)))re.t="n",y.cellText!==!1&&(re.w=le),re.v=I;else if(!isNaN(jl(le).getDate())||H&&le.match(H)){re.z=y.dateNF||lt[14];var te=0;H&&le.match(H)&&(le=YS(le,y.dateNF,le.match(H)||[]),te=1),y.cellDates?(re.t="d",re.v=Zt(le,te)):(re.t="n",re.v=Lr(Zt(le,te))),y.cellText!==!1&&(re.w=hs(re.z,re.v instanceof Date?Lr(re.v):re.v)),y.cellNF||delete re.z}else re.t="s",re.v=le;if(re.t=="z"||(y.dense?(b[w]||(b[w]=[]),b[w][S]=re):b[ot({c:S,r:w})]=re),N=P+1,Z=m.charCodeAt(N),v.e.c<S&&(v.e.c=S),v.e.r<w&&(v.e.r=w),M==W)++S;else if(S=0,++w,y.sheetRows&&y.sheetRows<=w)return!0}e:for(;P<m.length;++P)switch(M=m.charCodeAt(P)){case 34:Z===34&&(X=!X);break;case W:case 10:case 13:if(!X&&ce())break e;break}return P-N>0&&ce(),b["!ref"]=gt(v),b}function c(m,p){return!(p&&p.PRN)||p.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?o(m,p):Pl(r(m,p),p)}function u(m,p){var y="",k=p.type=="string"?[0,0,0,0]:Mh(m,p);switch(p.type){case"base64":y=Jn(m);break;case"binary":y=m;break;case"buffer":p.codepage==65001?y=m.toString("utf8"):p.codepage&&typeof $o<"u"||(y=_t&&Buffer.isBuffer(m)?m.toString("binary"):Ka(m));break;case"array":y=ji(m);break;case"string":y=m;break;default:throw new Error("Unrecognized type "+p.type)}return k[0]==239&&k[1]==187&&k[2]==191?y=Wt(y.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?y=Wt(y):p.type=="binary"&&typeof $o<"u",y.slice(0,19)=="socialcalc:version:"?oy.to_sheet(p.type=="string"?y:Wt(y),p):c(y,p)}function d(m,p){return Ya(u(m,p),p)}function h(m){for(var p=[],y=Ot(m["!ref"]),k,b=Array.isArray(m),v=y.s.r;v<=y.e.r;++v){for(var w=[],S=y.s.c;S<=y.e.c;++S){var I=ot({r:v,c:S});if(k=b?(m[v]||[])[S]:m[I],!k||k.v==null){w.push("          ");continue}for(var N=(k.w||(xa(k),k.w)||"").slice(0,10);N.length<10;)N+=" ";w.push(N+(S===0?" ":""))}p.push(w.join(""))}return p.join(`
`)}return{to_workbook:d,to_sheet:u,from_sheet:h}})();function uC(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var s=iy.to_workbook(e,t);return t.WTF=n,s}catch(o){if(t.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return Cl.to_workbook(e,r)}}var ki=(function(){function e(T,Q,Y){if(T){tn(T,T.l||0);for(var J=Y.Enum||me;T.l<T.length;){var K=T.read_shift(2),fe=J[K]||J[65535],we=T.read_shift(2),ye=T.l+we,je=fe.f&&fe.f(T,we,Y);if(T.l=ye,Q(je,fe,K))return}}}function r(T,Q){switch(Q.type){case"base64":return t(Kn(Jn(T)),Q);case"binary":return t(Kn(T),Q);case"buffer":case"array":return t(T,Q)}throw"Unsupported type "+Q.type}function t(T,Q){if(!T)return T;var Y=Q||{},J=Y.dense?[]:{},K="Sheet1",fe="",we=0,ye={},je=[],Xe=[],D={s:{r:0,c:0},e:{r:0,c:0}},Pe=Y.sheetRows||0;if(T[2]==0&&(T[3]==8||T[3]==9)&&T.length>=16&&T[14]==5&&T[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(T[2]==2)Y.Enum=me,e(T,function(Le,jt,Rt){switch(Rt){case 0:Y.vers=Le,Le>=4096&&(Y.qpro=!0);break;case 6:D=Le;break;case 204:Le&&(fe=Le);break;case 222:fe=Le;break;case 15:case 51:Y.qpro||(Le[1].v=Le[1].v.slice(1));case 13:case 14:case 16:Rt==14&&(Le[2]&112)==112&&(Le[2]&15)>1&&(Le[2]&15)<15&&(Le[1].z=Y.dateNF||lt[14],Y.cellDates&&(Le[1].t="d",Le[1].v=uu(Le[1].v))),Y.qpro&&Le[3]>we&&(J["!ref"]=gt(D),ye[K]=J,je.push(K),J=Y.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},we=Le[3],K=fe||"Sheet"+(we+1),fe="");var Bt=Y.dense?(J[Le[0].r]||[])[Le[0].c]:J[ot(Le[0])];if(Bt){Bt.t=Le[1].t,Bt.v=Le[1].v,Le[1].z!=null&&(Bt.z=Le[1].z),Le[1].f!=null&&(Bt.f=Le[1].f);break}Y.dense?(J[Le[0].r]||(J[Le[0].r]=[]),J[Le[0].r][Le[0].c]=Le[1]):J[ot(Le[0])]=Le[1];break}},Y);else if(T[2]==26||T[2]==14)Y.Enum=z,T[2]==14&&(Y.qpro=!0,T.l=0),e(T,function(Le,jt,Rt){switch(Rt){case 204:K=Le;break;case 22:Le[1].v=Le[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Le[3]>we&&(J["!ref"]=gt(D),ye[K]=J,je.push(K),J=Y.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},we=Le[3],K="Sheet"+(we+1)),Pe>0&&Le[0].r>=Pe)break;Y.dense?(J[Le[0].r]||(J[Le[0].r]=[]),J[Le[0].r][Le[0].c]=Le[1]):J[ot(Le[0])]=Le[1],D.e.c<Le[0].c&&(D.e.c=Le[0].c),D.e.r<Le[0].r&&(D.e.r=Le[0].r);break;case 27:Le[14e3]&&(Xe[Le[14e3][0]]=Le[14e3][1]);break;case 1537:Xe[Le[0]]=Le[1],Le[0]==we&&(K=Le[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+T[2]);if(J["!ref"]=gt(D),ye[fe||K]=J,je.push(fe||K),!Xe.length)return{SheetNames:je,Sheets:ye};for(var rt={},xt=[],nt=0;nt<Xe.length;++nt)ye[je[nt]]?(xt.push(Xe[nt]||je[nt]),rt[Xe[nt]]=ye[Xe[nt]]||ye[je[nt]]):(xt.push(Xe[nt]),rt[Xe[nt]]={"!ref":"A1"});return{SheetNames:xt,Sheets:rt}}function n(T,Q){var Y=Q||{};if(+Y.codepage>=0&&Ts(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var J=Mn(),K=Ot(T["!ref"]),fe=Array.isArray(T),we=[];He(J,0,o(1030)),He(J,6,d(K));for(var ye=Math.min(K.e.r,8191),je=K.s.r;je<=ye;++je)for(var Xe=wr(je),D=K.s.c;D<=K.e.c;++D){je===K.s.r&&(we[D]=or(D));var Pe=we[D]+Xe,rt=fe?(T[je]||[])[D]:T[Pe];if(!(!rt||rt.t=="z"))if(rt.t=="n")(rt.v|0)==rt.v&&rt.v>=-32768&&rt.v<=32767?He(J,13,k(je,D,rt.v)):He(J,14,v(je,D,rt.v));else{var xt=xa(rt);He(J,15,p(je,D,xt.slice(0,239)))}}return He(J,1),J.end()}function s(T,Q){var Y=Q||{};if(+Y.codepage>=0&&Ts(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var J=Mn();He(J,0,c(T));for(var K=0,fe=0;K<T.SheetNames.length;++K)(T.Sheets[T.SheetNames[K]]||{})["!ref"]&&He(J,27,A(T.SheetNames[K],fe++));var we=0;for(K=0;K<T.SheetNames.length;++K){var ye=T.Sheets[T.SheetNames[K]];if(!(!ye||!ye["!ref"])){for(var je=Ot(ye["!ref"]),Xe=Array.isArray(ye),D=[],Pe=Math.min(je.e.r,8191),rt=je.s.r;rt<=Pe;++rt)for(var xt=wr(rt),nt=je.s.c;nt<=je.e.c;++nt){rt===je.s.r&&(D[nt]=or(nt));var Le=D[nt]+xt,jt=Xe?(ye[rt]||[])[nt]:ye[Le];if(!(!jt||jt.t=="z"))if(jt.t=="n")He(J,23,ce(rt,nt,we,jt.v));else{var Rt=xa(jt);He(J,22,M(rt,nt,we,Rt.slice(0,239)))}}++we}}return He(J,1),J.end()}function o(T){var Q=Ee(2);return Q.write_shift(2,T),Q}function c(T){var Q=Ee(26);Q.write_shift(2,4096),Q.write_shift(2,4),Q.write_shift(4,0);for(var Y=0,J=0,K=0,fe=0;fe<T.SheetNames.length;++fe){var we=T.SheetNames[fe],ye=T.Sheets[we];if(!(!ye||!ye["!ref"])){++K;var je=Ln(ye["!ref"]);Y<je.e.r&&(Y=je.e.r),J<je.e.c&&(J=je.e.c)}}return Y>8191&&(Y=8191),Q.write_shift(2,Y),Q.write_shift(1,K),Q.write_shift(1,J),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(1,1),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(4,0),Q}function u(T,Q,Y){var J={s:{c:0,r:0},e:{c:0,r:0}};return Q==8&&Y.qpro?(J.s.c=T.read_shift(1),T.l++,J.s.r=T.read_shift(2),J.e.c=T.read_shift(1),T.l++,J.e.r=T.read_shift(2),J):(J.s.c=T.read_shift(2),J.s.r=T.read_shift(2),Q==12&&Y.qpro&&(T.l+=2),J.e.c=T.read_shift(2),J.e.r=T.read_shift(2),Q==12&&Y.qpro&&(T.l+=2),J.s.c==65535&&(J.s.c=J.e.c=J.s.r=J.e.r=0),J)}function d(T){var Q=Ee(8);return Q.write_shift(2,T.s.c),Q.write_shift(2,T.s.r),Q.write_shift(2,T.e.c),Q.write_shift(2,T.e.r),Q}function h(T,Q,Y){var J=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(J[0].c=T.read_shift(1),J[3]=T.read_shift(1),J[0].r=T.read_shift(2),T.l+=2):(J[2]=T.read_shift(1),J[0].c=T.read_shift(2),J[0].r=T.read_shift(2)),J}function m(T,Q,Y){var J=T.l+Q,K=h(T,Q,Y);if(K[1].t="s",Y.vers==20768){T.l++;var fe=T.read_shift(1);return K[1].v=T.read_shift(fe,"utf8"),K}return Y.qpro&&T.l++,K[1].v=T.read_shift(J-T.l,"cstr"),K}function p(T,Q,Y){var J=Ee(7+Y.length);J.write_shift(1,255),J.write_shift(2,Q),J.write_shift(2,T),J.write_shift(1,39);for(var K=0;K<J.length;++K){var fe=Y.charCodeAt(K);J.write_shift(1,fe>=128?95:fe)}return J.write_shift(1,0),J}function y(T,Q,Y){var J=h(T,Q,Y);return J[1].v=T.read_shift(2,"i"),J}function k(T,Q,Y){var J=Ee(7);return J.write_shift(1,255),J.write_shift(2,Q),J.write_shift(2,T),J.write_shift(2,Y,"i"),J}function b(T,Q,Y){var J=h(T,Q,Y);return J[1].v=T.read_shift(8,"f"),J}function v(T,Q,Y){var J=Ee(13);return J.write_shift(1,255),J.write_shift(2,Q),J.write_shift(2,T),J.write_shift(8,Y,"f"),J}function w(T,Q,Y){var J=T.l+Q,K=h(T,Q,Y);if(K[1].v=T.read_shift(8,"f"),Y.qpro)T.l=J;else{var fe=T.read_shift(2);P(T.slice(T.l,T.l+fe),K),T.l+=fe}return K}function S(T,Q,Y){var J=Q&32768;return Q&=-32769,Q=(J?T:0)+(Q>=8192?Q-16384:Q),(J?"":"$")+(Y?or(Q):wr(Q))}var I={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(T,Q){tn(T,0);for(var Y=[],J=0,K="",fe="",we="",ye="";T.l<T.length;){var je=T[T.l++];switch(je){case 0:Y.push(T.read_shift(8,"f"));break;case 1:fe=S(Q[0].c,T.read_shift(2),!0),K=S(Q[0].r,T.read_shift(2),!1),Y.push(fe+K);break;case 2:{var Xe=S(Q[0].c,T.read_shift(2),!0),D=S(Q[0].r,T.read_shift(2),!1);fe=S(Q[0].c,T.read_shift(2),!0),K=S(Q[0].r,T.read_shift(2),!1),Y.push(Xe+D+":"+fe+K)}break;case 3:if(T.l<T.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(T.read_shift(2));break;case 6:{for(var Pe="";je=T[T.l++];)Pe+=String.fromCharCode(je);Y.push('"'+Pe.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:ye=Y.pop(),we=Y.pop(),Y.push(["AND","OR"][je-20]+"("+we+","+ye+")");break;default:if(je<32&&N[je])ye=Y.pop(),we=Y.pop(),Y.push(we+N[je]+ye);else if(I[je]){if(J=I[je][1],J==69&&(J=T[T.l++]),J>Y.length){console.error("WK1 bad formula parse 0x"+je.toString(16)+":|"+Y.join("|")+"|");return}var rt=Y.slice(-J);Y.length-=J,Y.push(I[je][0]+"("+rt.join(",")+")")}else return je<=7?console.error("WK1 invalid opcode "+je.toString(16)):je<=24?console.error("WK1 unsupported op "+je.toString(16)):je<=30?console.error("WK1 invalid opcode "+je.toString(16)):je<=115?console.error("WK1 unsupported function opcode "+je.toString(16)):console.error("WK1 unrecognized opcode "+je.toString(16))}}Y.length==1?Q[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function W(T){var Q=[{c:0,r:0},{t:"n",v:0},0];return Q[0].r=T.read_shift(2),Q[3]=T[T.l++],Q[0].c=T[T.l++],Q}function X(T,Q){var Y=W(T);return Y[1].t="s",Y[1].v=T.read_shift(Q-4,"cstr"),Y}function M(T,Q,Y,J){var K=Ee(6+J.length);K.write_shift(2,T),K.write_shift(1,Y),K.write_shift(1,Q),K.write_shift(1,39);for(var fe=0;fe<J.length;++fe){var we=J.charCodeAt(fe);K.write_shift(1,we>=128?95:we)}return K.write_shift(1,0),K}function Z(T,Q){var Y=W(T);Y[1].v=T.read_shift(2);var J=Y[1].v>>1;if(Y[1].v&1)switch(J&7){case 0:J=(J>>3)*5e3;break;case 1:J=(J>>3)*500;break;case 2:J=(J>>3)/20;break;case 3:J=(J>>3)/200;break;case 4:J=(J>>3)/2e3;break;case 5:J=(J>>3)/2e4;break;case 6:J=(J>>3)/16;break;case 7:J=(J>>3)/64;break}return Y[1].v=J,Y}function H(T,Q){var Y=W(T),J=T.read_shift(4),K=T.read_shift(4),fe=T.read_shift(2);if(fe==65535)return J===0&&K===3221225472?(Y[1].t="e",Y[1].v=15):J===0&&K===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var we=fe&32768;return fe=(fe&32767)-16446,Y[1].v=(1-we*2)*(K*Math.pow(2,fe+32)+J*Math.pow(2,fe)),Y}function ce(T,Q,Y,J){var K=Ee(14);if(K.write_shift(2,T),K.write_shift(1,Y),K.write_shift(1,Q),J==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var fe=0,we=0,ye=0,je=0;return J<0&&(fe=1,J=-J),we=Math.log2(J)|0,J/=Math.pow(2,we-31),je=J>>>0,(je&2147483648)==0&&(J/=2,++we,je=J>>>0),J-=je,je|=2147483648,je>>>=0,J*=Math.pow(2,32),ye=J>>>0,K.write_shift(4,ye),K.write_shift(4,je),we+=16383+(fe?32768:0),K.write_shift(2,we),K}function le(T,Q){var Y=H(T);return T.l+=Q-14,Y}function re(T,Q){var Y=W(T),J=T.read_shift(4);return Y[1].v=J>>6,Y}function te(T,Q){var Y=W(T),J=T.read_shift(8,"f");return Y[1].v=J,Y}function ve(T,Q){var Y=te(T);return T.l+=Q-10,Y}function Se(T,Q){return T[T.l+Q-1]==0?T.read_shift(Q,"cstr"):""}function Ce(T,Q){var Y=T[T.l++];Y>Q-1&&(Y=Q-1);for(var J="";J.length<Y;)J+=String.fromCharCode(T[T.l++]);return J}function ue(T,Q,Y){if(!(!Y.qpro||Q<21)){var J=T.read_shift(1);T.l+=17,T.l+=1,T.l+=2;var K=T.read_shift(Q-21,"cstr");return[J,K]}}function ne(T,Q){for(var Y={},J=T.l+Q;T.l<J;){var K=T.read_shift(2);if(K==14e3){for(Y[K]=[0,""],Y[K][0]=T.read_shift(2);T[T.l];)Y[K][1]+=String.fromCharCode(T[T.l]),T.l++;T.l++}}return Y}function A(T,Q){var Y=Ee(5+T.length);Y.write_shift(2,14e3),Y.write_shift(2,Q);for(var J=0;J<T.length;++J){var K=T.charCodeAt(J);Y[Y.l++]=K>127?95:K}return Y[Y.l++]=0,Y}var me={0:{n:"BOF",f:Fr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Se},222:{n:"SHEETNAMELP",f:Ce},65535:{n:""}},z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:X},23:{n:"NUMBER17",f:H},24:{n:"NUMBER18",f:Z},25:{n:"FORMULA19",f:le},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ne},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:re},38:{n:"??"},39:{n:"NUMBER27",f:te},40:{n:"FORMULA28",f:ve},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:r}})();function fC(e){var r={},t=e.match(pn),n=0,s=!1;if(t)for(;n!=t.length;++n){var o=ct(t[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;r.cp=eh[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=o.val;break;case"<sz":r.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":o.rgb&&(r.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(o[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+o[0])}}return r}var dC=(function(){var e=Vo("t"),r=Vo("rPr");function t(o){var c=o.match(e);if(!c)return{t:"s",v:""};var u={t:"s",v:At(c[1])},d=o.match(r);return d&&(u.s=fC(d[1])),u}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(c){return c.replace(n,"").split(s).map(t).filter(function(u){return u.v})}})(),hC=(function(){var r=/(\r\n|\n)/g;function t(s,o,c){var u=[];s.u&&u.push("text-decoration: underline;"),s.uval&&u.push("text-underline-style:"+s.uval+";"),s.sz&&u.push("font-size:"+s.sz+"pt;"),s.outline&&u.push("text-effect: outline;"),s.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),s.b&&(o.push("<b>"),c.push("</b>")),s.i&&(o.push("<i>"),c.push("</i>")),s.strike&&(o.push("<s>"),c.push("</s>"));var d=s.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(o.push("<"+d+">"),c.push("</"+d+">")),c.push("</span>"),s}function n(s){var o=[[],s.v,[]];return s.v?(s.s&&t(s.s,o[0],o[2]),o[0].join("")+o[1].replace(r,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}})(),xC=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,mC=/<(?:\w+:)?r>/,pC=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Nh(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=At(Wt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Wt(e),t&&(n.h=uh(n.t))):e.match(mC)&&(n.r=Wt(e),n.t=At(Wt((e.replace(pC,"").match(xC)||[]).join("").replace(pn,""))),t&&(n.h=hC(dC(n.r)))),n):{t:""}}var gC=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,vC=/<(?:\w+:)?(?:si|sstItem)>/g,yC=/<\/(?:\w+:)?(?:si|sstItem)>/;function bC(e,r){var t=[],n="";if(!e)return t;var s=e.match(gC);if(s){n=s[2].replace(vC,"").split(yC);for(var o=0;o!=n.length;++o){var c=Nh(n[o].trim(),r);c!=null&&(t[t.length]=c)}s=ct(s[1]),t.Count=s.count,t.Unique=s.uniqueCount}return t}var wC=/^\s|\s$|[\t\n\r]/;function cy(e,r){if(!r.bookSST)return"";var t=[kr];t[t.length]=$e("sst",null,{xmlns:Di[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],o="<si>";s.r?o+=s.r:(o+="<t",s.t||(s.t=""),s.t.match(wC)&&(o+=' xml:space="preserve"'),o+=">"+Ht(s.t)+"</t>"),o+="</si>",t[t.length]=o}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function _C(e){return[e.read_shift(4),e.read_shift(4)]}function kC(e,r){var t=[],n=!1;return ga(e,function(o,c,u){switch(u){case 159:t.Count=o[0],t.Unique=o[1];break;case 19:t.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(c.T,!n||r.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),t}function NC(e,r){return r||(r=Ee(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var SC=RE;function EC(e){var r=Mn();De(r,159,NC(e));for(var t=0;t<e.length;++t)De(r,19,SC(e[t]));return De(r,160),r.end()}function uy(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function ha(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function jC(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=ha(e,4),r.U=ha(e,4),r.W=ha(e,4),r}function CC(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},s=e.read_shift(4),o=[];s-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=o,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function TC(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(CC(e));return r}function FC(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function AC(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=ha(e,4),r.U=ha(e,4),r.W=ha(e,4),r}function OC(e){var r=AC(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function fy(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function dy(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function DC(e){var r=ha(e);switch(r.Minor){case 2:return[r.Minor,IC(e)];case 3:return[r.Minor,RC()];case 4:return[r.Minor,PC(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function IC(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=fy(e,t),s=dy(e,e.length-e.l);return{t:"Std",h:n,v:s}}function RC(){throw new Error("File is password-protected: ECMA-376 Extensible")}function PC(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(pn,function(o){var c=ct(o);switch(Gs(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(u){n[u]=c[u]});break;case"<dataIntegrity":n.encryptedHmacKey=c.encryptedHmacKey,n.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(c);break;default:throw c[0]}}),n}function MC(e,r){var t={},n=t.EncryptionVersionInfo=ha(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var s=e.read_shift(4);return r-=4,t.EncryptionHeader=fy(e,s),r-=s,t.EncryptionVerifier=dy(e,r),t}function LC(e){var r={},t=r.EncryptionVersionInfo=ha(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function Sh(e){var r=0,t,n=uy(e),s=n.length+1,o,c,u,d,h;for(t=Ha(s),t[0]=n.length,o=1;o!=s;++o)t[o]=n[o-1];for(o=s-1;o>=0;--o)c=t[o],u=(r&16384)===0?0:1,d=r<<1&32767,h=u|d,r=h^c;return r^52811}var hy=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(c){return(c/2|c*128)&255},s=function(c,u){return n(c^u)},o=function(c){for(var u=r[c.length-1],d=104,h=c.length-1;h>=0;--h)for(var m=c[h],p=0;p!=7;++p)m&64&&(u^=t[d]),m*=2,--d;return u};return function(c){for(var u=uy(c),d=o(u),h=u.length,m=Ha(16),p=0;p!=16;++p)m[p]=0;var y,k,b;for((h&1)===1&&(y=d>>8,m[h]=s(e[0],y),--h,y=d&255,k=u[u.length-1],m[h]=s(k,y));h>0;)--h,y=d>>8,m[h]=s(u[h],y),--h,y=d&255,m[h]=s(u[h],y);for(h=15,b=15-u.length;b>0;)y=d>>8,m[h]=s(e[b],y),--h,--b,y=d&255,m[h]=s(u[h],y),--h,--b;return m}})(),BC=function(e,r,t,n,s){s||(s=r),n||(n=hy(e));var o,c;for(o=0;o!=r.length;++o)c=r[o],c^=n[t],c=(c>>5|c<<3)&255,s[o]=c,++t;return[s,t,n]},UC=function(e){var r=0,t=hy(e);return function(n){var s=BC("",n,r,t);return r=s[1],s[0]}};function zC(e,r,t,n){var s={key:Fr(e),verificationBytes:Fr(e)};return t.password&&(s.verifier=Sh(t.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=UC(t.password)),s}function $C(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=LC(e):n.Data=MC(e,r),n}function HC(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?$C(e,r-2,n):zC(e,t.biff>=8?r:r-2,t,n),n}var xy=(function(){function e(s,o){switch(o.type){case"base64":return r(Jn(s),o);case"binary":return r(s,o);case"buffer":return r(_t&&Buffer.isBuffer(s)?s.toString("binary"):Ka(s),o);case"array":return r(ji(s),o)}throw new Error("Unrecognized type "+o.type)}function r(s,o){var c=o||{},u=c.dense?[]:{},d=s.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(m,p){Array.isArray(u)&&(u[p]=[]);for(var y=/\\\w+\b/g,k=0,b,v=-1;b=y.exec(m);){switch(b[0]){case"\\cell":var w=m.slice(k,y.lastIndex-b[0].length);if(w[0]==" "&&(w=w.slice(1)),++v,w.length){var S={v:w,t:"s"};Array.isArray(u)?u[p][v]=S:u[ot({r:p,c:v})]=S}break}k=y.lastIndex}v>h.e.c&&(h.e.c=v)}),u["!ref"]=gt(h),u}function t(s,o){return Ya(e(s,o),o)}function n(s){for(var o=["{\\rtf1\\ansi"],c=Ot(s["!ref"]),u,d=Array.isArray(s),h=c.s.r;h<=c.e.r;++h){o.push("\\trowd\\trautofit1");for(var m=c.s.c;m<=c.e.c;++m)o.push("\\cellx"+(m+1));for(o.push("\\pard\\intbl"),m=c.s.c;m<=c.e.c;++m){var p=ot({r:h,c:m});u=d?(s[h]||[])[m]:s[p],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(xa(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}})();function WC(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Ko(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function VC(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,s=Math.max(r,t,n),o=Math.min(r,t,n),c=s-o;if(c===0)return[0,0,r];var u=0,d=0,h=s+o;switch(d=c/(h>1?2-h:h),s){case r:u=((t-n)/c+6)%6;break;case t:u=(n-r)/c+2;break;case n:u=(r-t)/c+4;break}return[u/6,d,h/2]}function qC(e){var r=e[0],t=e[1],n=e[2],s=t*2*(n<.5?n:1-n),o=n-s/2,c=[o,o,o],u=6*r,d;if(t!==0)switch(u|0){case 0:case 6:d=s*u,c[0]+=s,c[1]+=d;break;case 1:d=s*(2-u),c[0]+=d,c[1]+=s;break;case 2:d=s*(u-2),c[1]+=s,c[2]+=d;break;case 3:d=s*(4-u),c[1]+=d,c[2]+=s;break;case 4:d=s*(u-4),c[2]+=s,c[0]+=d;break;case 5:d=s*(6-u),c[2]+=d,c[0]+=s;break}for(var h=0;h!=3;++h)c[h]=Math.round(c[h]*255);return c}function G0(e,r){if(r===0)return e;var t=VC(WC(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Ko(qC(t))}var my=6,XC=15,GC=1,fn=my;function Yo(e){return Math.floor((e+Math.round(128/fn)/256)*fn)}function Jo(e){return Math.floor((e-5)/fn*100+.5)/100}function K0(e){return Math.round((e*fn+5)/fn*256)/256}function hd(e){return K0(Jo(Yo(e)))}function Eh(e){var r=Math.abs(e-hd(e)),t=fn;if(r>.005)for(fn=GC;fn<XC;++fn)Math.abs(e-hd(e))<=r&&(r=Math.abs(e-hd(e)),t=fn);fn=t}function Wa(e){e.width?(e.wpx=Yo(e.width),e.wch=Jo(e.wpx),e.MDW=fn):e.wpx?(e.wch=Jo(e.wpx),e.width=K0(e.wch),e.MDW=fn):typeof e.wch=="number"&&(e.width=K0(e.wch),e.wpx=Yo(e.width),e.MDW=fn),e.customWidth&&delete e.customWidth}var KC=96,py=KC;function Qo(e){return e*96/py}function Tl(e){return e*py/96}var YC={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function JC(e,r,t,n){r.Borders=[];var s={},o=!1;(e[0].match(pn)||[]).forEach(function(c){var u=ct(c);switch(Gs(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},u.diagonalUp&&(s.diagonalUp=Qt(u.diagonalUp)),u.diagonalDown&&(s.diagonalDown=Qt(u.diagonalDown)),r.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function QC(e,r,t,n){r.Fills=[];var s={},o=!1;(e[0].match(pn)||[]).forEach(function(c){var u=ct(c);switch(Gs(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},r.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":u.patternType&&(s.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),u.indexed&&(s.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(s.bgColor.theme=parseInt(u.theme,10)),u.tint&&(s.bgColor.tint=parseFloat(u.tint)),u.rgb&&(s.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),u.theme&&(s.fgColor.theme=parseInt(u.theme,10)),u.tint&&(s.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(s.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function ZC(e,r,t,n){r.Fonts=[];var s={},o=!1;(e[0].match(pn)||[]).forEach(function(c){var u=ct(c);switch(Gs(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(s),s={};break;case"<name":u.val&&(s.name=Wt(u.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=u.val?Qt(u.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=u.val?Qt(u.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(u.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=u.val?Qt(u.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=u.val?Qt(u.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=u.val?Qt(u.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=u.val?Qt(u.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=u.val?Qt(u.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":u.val&&(s.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(s.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(s.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(s.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=eh[parseInt(u.val,10)];break;case"<color":if(s.color||(s.color={}),u.auto&&(s.color.auto=Qt(u.auto)),u.rgb)s.color.rgb=u.rgb.slice(-6);else if(u.indexed){s.color.index=parseInt(u.indexed,10);var d=wi[s.color.index];s.color.index==81&&(d=wi[1]),d||(d=wi[1]),s.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else u.theme&&(s.color.theme=parseInt(u.theme,10),u.tint&&(s.color.tint=parseFloat(u.tint)),u.theme&&t.themeElements&&t.themeElements.clrScheme&&(s.color.rgb=G0(t.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function eT(e,r,t){r.NumberFmt=[];for(var n=gr(lt),s=0;s<n.length;++s)r.NumberFmt[n[s]]=lt[n[s]];var o=e[0].match(pn);if(o)for(s=0;s<o.length;++s){var c=ct(o[s]);switch(Gs(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=At(Wt(c.formatCode)),d=parseInt(c.numFmtId,10);if(r.NumberFmt[d]=u,d>0){if(d>392){for(d=392;d>60&&r.NumberFmt[d]!=null;--d);r.NumberFmt[d]=u}da(u,d)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}function tT(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)e[n]!=null&&(r[r.length]=$e("numFmt",null,{numFmtId:n,formatCode:Ht(e[n])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=$e("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var C0=["numFmtId","fillId","fontId","borderId","xfId"],T0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function rT(e,r,t){r.CellXf=[];var n,s=!1;(e[0].match(pn)||[]).forEach(function(o){var c=ct(o),u=0;switch(Gs(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=c,delete n[0],u=0;u<C0.length;++u)n[C0[u]]&&(n[C0[u]]=parseInt(n[C0[u]],10));for(u=0;u<T0.length;++u)n[T0[u]]&&(n[T0[u]]=Qt(n[T0[u]]));if(r.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[u]){n.numFmtId=u;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};c.vertical&&(d.vertical=c.vertical),c.horizontal&&(d.horizontal=c.horizontal),c.textRotation!=null&&(d.textRotation=c.textRotation),c.indent&&(d.indent=c.indent),c.wrapText&&(d.wrapText=Qt(c.wrapText)),n.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(t&&t.WTF&&!s)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}function nT(e){var r=[];return r[r.length]=$e("cellXfs",null),e.forEach(function(t){r[r.length]=$e("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=$e("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var sT=(function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,d,h){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=u.match(r))&&eT(p,m,h),(p=u.match(s))&&ZC(p,m,d,h),(p=u.match(n))&&QC(p,m,d,h),(p=u.match(o))&&JC(p,m,d,h),(p=u.match(t))&&rT(p,m,h),m}})();function gy(e,r){var t=[kr,$e("styleSheet",null,{xmlns:Di[0],"xmlns:vt":Mr.vt})],n;return e.SSF&&(n=tT(e.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=nT(r.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function aT(e,r){var t=e.read_shift(2),n=xn(e);return[t,n]}function iT(e,r,t){t||(t=Ee(6+4*r.length)),t.write_shift(2,e),Kr(r,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function lT(e,r,t){var n={};n.sz=e.read_shift(2)/20;var s=$E(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var o=e.read_shift(2);switch(o===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(n.underline=c);var u=e.read_shift(1);u>0&&(n.family=u);var d=e.read_shift(1);switch(d>0&&(n.charset=d),e.l++,n.color=zE(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=xn(e),n}function oT(e,r){r||(r=Ee(153)),r.write_shift(2,e.sz*20),HE(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),V0(e.color,r);var n=0;return n=2,r.write_shift(1,n),Kr(e.name,r),r.length>r.l?r.slice(0,r.l):r}var cT=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],xd,uT=mn;function Ag(e,r){r||(r=Ee(84)),xd||(xd=ou(cT));var t=xd[e.patternType];t==null&&(t=40),r.write_shift(4,t);var n=0;if(t!=40)for(V0({auto:1},r),V0({auto:1},r);n<12;++n)r.write_shift(4,0);else{for(;n<4;++n)r.write_shift(4,0);for(;n<12;++n)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function fT(e,r){var t=e.l+r,n=e.read_shift(2),s=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:s}}function vy(e,r,t){t||(t=Ee(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function So(e,r){return r||(r=Ee(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var dT=mn;function hT(e,r){return r||(r=Ee(51)),r.write_shift(1,0),So(null,r),So(null,r),So(null,r),So(null,r),So(null,r),r.length>r.l?r.slice(0,r.l):r}function xT(e,r){return r||(r=Ee(52)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),W0(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function mT(e,r,t){var n=Ee(2052);return n.write_shift(4,e),W0(r,n),W0(t,n),n.length>n.l?n.slice(0,n.l):n}function pT(e,r,t){var n={};n.NumberFmt=[];for(var s in lt)n.NumberFmt[s]=lt[s];n.CellXf=[],n.Fonts=[];var o=[],c=!1;return ga(e,function(d,h,m){switch(m){case 44:n.NumberFmt[d[0]]=d[1],da(d[1],d[0]);break;case 43:n.Fonts.push(d),d.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(d.color.rgb=G0(r.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:o.push(m),c=!0;break;case 38:o.pop(),c=!1;break;default:if(h.T>0)o.push(m);else if(h.T<0)o.pop();else if(!c||t.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),n}function gT(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&++t}),t!=0&&(De(e,615,Os(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&De(e,44,iT(s,r[s]))}),De(e,616))}}function vT(e){var r=1;De(e,611,Os(r)),De(e,43,oT({sz:12,color:{theme:1},name:"Calibri",family:2})),De(e,612)}function yT(e){var r=2;De(e,603,Os(r)),De(e,45,Ag({patternType:"none"})),De(e,45,Ag({patternType:"gray125"})),De(e,604)}function bT(e){var r=1;De(e,613,Os(r)),De(e,46,hT()),De(e,614)}function wT(e){var r=1;De(e,626,Os(r)),De(e,47,vy({numFmtId:0},65535)),De(e,627)}function _T(e,r){De(e,617,Os(r.length)),r.forEach(function(t){De(e,47,vy(t,0))}),De(e,618)}function kT(e){var r=1;De(e,619,Os(r)),De(e,48,xT({xfId:0,name:"Normal"})),De(e,620)}function NT(e){var r=0;De(e,505,Os(r)),De(e,506)}function ST(e){var r=0;De(e,508,mT(r,"TableStyleMedium9","PivotStyleMedium4")),De(e,509)}function ET(e,r){var t=Mn();return De(t,278),gT(t,e.SSF),vT(t),yT(t),bT(t),wT(t),_T(t,r.cellXfs),kT(t),NT(t),ST(t),De(t,279),t.end()}var jT=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function CT(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(pn)||[]).forEach(function(s){var o=ct(s);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(r.themeElements.clrScheme[jT.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function TT(){}function FT(){}var AT=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,OT=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,DT=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function IT(e,r,t){r.themeElements={};var n;[["clrScheme",AT,CT],["fontScheme",OT,TT],["fmtScheme",DT,FT]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,r,t)})}var RT=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function yy(e,r){(!e||e.length===0)&&(e=jh());var t,n={};if(!(t=e.match(RT)))throw new Error("themeElements not found in theme");return IT(t[0],n,r),n.raw=e,n}function jh(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[kr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function PT(e,r,t){var n=e.l+r,s=e.read_shift(4);if(s!==124226){if(!t.cellStyles){e.l=n;return}var o=e.slice(e.l);e.l=n;var c;try{c=fv(o,{type:"array"})}catch{return}var u=Yn(c,"theme/theme/theme1.xml",!0);if(u)return yy(u,t)}}function MT(e){return e.read_shift(4)}function LT(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=BT(e,4);break;case 2:r.xclrValue=Qv(e);break;case 3:r.xclrValue=MT(e);break;case 4:e.l+=4;break}return e.l+=8,r}function BT(e,r){return mn(e,r)}function UT(e,r){return mn(e,r)}function zT(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=LT(e);break;case 6:n[1]=UT(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function $T(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),o=[];s-- >0;)o.push(zT(e,t-e.l));return{ixfe:n,ext:o}}function HT(e,r){r.forEach(function(t){t[0]})}function WT(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:xn(e)}}function VT(e){var r=Ee(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),Kr(e.name,r),r.slice(0,r.l)}function qT(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function XT(e){var r=Ee(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function GT(e,r){var t=Ee(8+2*r.length);return t.write_shift(4,e),Kr(r,t),t.slice(0,t.l)}function KT(e){return e.l+=4,e.read_shift(4)!=0}function YT(e,r){var t=Ee(8);return t.write_shift(4,e),t.write_shift(4,1),t}function JT(e,r,t){var n={Types:[],Cell:[],Value:[]},s=t||{},o=[],c=!1,u=2;return ga(e,function(d,h,m){switch(m){case 335:n.Types.push({name:d.name});break;case 51:d.forEach(function(p){u==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):u==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:u=d?1:0;break;case 338:u=2;break;case 35:o.push(m),c=!0;break;case 36:o.pop(),c=!1;break;default:if(!h.T){if(!c||s.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),n}function QT(){var e=Mn();return De(e,332),De(e,334,Os(1)),De(e,335,VT({name:"XLDAPR",version:12e4,flags:3496657072})),De(e,336),De(e,339,GT(1,"XLDAPR")),De(e,52),De(e,35,Os(514)),De(e,4096,Os(0)),De(e,4097,fs(1)),De(e,36),De(e,53),De(e,340),De(e,337,YT(1)),De(e,51,XT([[1,0]])),De(e,338),De(e,333),e.end()}function ZT(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,o=2,c;return e.replace(pn,function(u){var d=ct(u);switch(Gs(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<n.Types.length;++h)n.Types[h].name==d.name&&(c=n.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[d.t-1].name,index:+d.v}):o==0&&n.Value.push({type:n.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+d.i);break;default:if(!s&&t.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return u}),n}function by(){var e=[kr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function e6(e){var r=[];if(!e)return r;var t=1;return(e.match(pn)||[]).forEach(function(n){var s=ct(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?t=s.i:s.i=t,r.push(s);break}}),r}function t6(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=ot(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function r6(e,r,t){var n=[];return ga(e,function(o,c,u){switch(u){case 63:n.push(o);break;default:if(!c.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function n6(e,r,t,n){if(!e)return e;var s=n||{},o=!1;ga(e,function(u,d,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!d.T){if(!o||s.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},s)}function s6(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}var gl=1024;function wy(e,r){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),s=[$e("xml",null,{"xmlns:v":Xn.v,"xmlns:o":Xn.o,"xmlns:x":Xn.x,"xmlns:mv":Xn.mv}).replace(/\/>/,">"),$e("o:shapelayout",$e("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),$e("v:shapetype",[$e("v:stroke",null,{joinstyle:"miter"}),$e("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];gl<e*1e3;)gl+=1e3;return r.forEach(function(o){var c=cr(o[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var d=u.type=="gradient"?$e("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=$e("v:fill",d,u),m={on:"t",obscured:"t"};++gl,s=s.concat(["<v:shape"+qo({id:"_x0000_s"+gl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,$e("v:shadow",null,m),$e("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",rn("x:Anchor",[c.c+1,0,c.r+1,0,c.c+3,20,c.r+5,20].join(",")),rn("x:AutoFill","False"),rn("x:Row",String(c.r)),rn("x:Column",String(c.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Og(e,r,t,n){var s=Array.isArray(e),o;r.forEach(function(c){var u=cr(c.ref);if(s?(e[u.r]||(e[u.r]=[]),o=e[u.r][u.c]):o=e[c.ref],!o){o={t:"z"},s?e[u.r][u.c]=o:e[c.ref]=o;var d=Ot(e["!ref"]||"BDWGO1000001:A1");d.s.r>u.r&&(d.s.r=u.r),d.e.r<u.r&&(d.e.r=u.r),d.s.c>u.c&&(d.s.c=u.c),d.e.c<u.c&&(d.e.c=u.c);var h=gt(d);h!==e["!ref"]&&(e["!ref"]=h)}o.c||(o.c=[]);var m={a:c.author,t:c.t,r:c.r,T:t};c.h&&(m.h=c.h);for(var p=o.c.length-1;p>=0;--p){if(!t&&o.c[p].T)return;t&&!o.c[p].T&&o.c.splice(p,1)}if(t&&n){for(p=0;p<n.length;++p)if(m.a==n[p].id){m.a=n[p].name||m.a;break}}o.c.push(m)})}function a6(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&t.push(u[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?comment[^>]*>/);if(u){var d=ct(u[0]),h={author:d.authorId&&t[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},m=cr(d.ref);if(!(r.sheetRows&&r.sheetRows<=m.r)){var p=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!p&&!!p[1]&&Nh(p[1])||{r:"",t:"",h:""};h.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),h.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(h.h=y.h),n.push(h)}}}}),n}function _y(e){var r=[kr,$e("comments",null,{xmlns:Di[0]})],t=[];return r.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var o=Ht(s.a);t.indexOf(o)==-1&&(t.push(o),r.push("<author>"+o+"</author>")),s.T&&s.ID&&t.indexOf("tc="+s.ID)==-1&&(t.push("tc="+s.ID),r.push("<author>tc="+s.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(n){var s=0,o=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(d){d.a&&(s=t.indexOf(Ht(d.a))),o.push(d.t||"")}),r.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),o.length<=1)r.push(rn("t",Ht(o[0]||"")));else{for(var c=`Comment:
    `+o[0]+`
`,u=1;u<o.length;++u)c+=`Reply:
    `+o[u]+`
`;r.push(rn("t",Ht(c)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function i6(e,r){var t=[],n=!1,s={},o=0;return e.replace(pn,function(u,d){var h=ct(u);switch(Gs(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":s.t!=null&&t.push(s);break;case"<text>":case"<text":o=d+u.length;break;case"</text>":s.t=e.slice(o,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return u}),t}function l6(e,r,t){var n=[kr,$e("ThreadedComments",null,{xmlns:Mr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var o="";(s[1]||[]).forEach(function(c,u){if(!c.T){delete c.ID;return}c.a&&r.indexOf(c.a)==-1&&r.push(c.a);var d={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};u==0?o=d.id:d.parentId=o,c.ID=d.id,c.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(c.a)).slice(-12)+"}"),n.push($e("threadedComment",rn("text",c.t||""),d))})}),n.push("</ThreadedComments>"),n.join("")}function o6(e,r){var t=[],n=!1;return e.replace(pn,function(o){var c=ct(o);switch(Gs(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),t}function c6(e){var r=[kr,$e("personList",null,{xmlns:Mr.TCMNT,"xmlns:x":Di[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,n){r.push($e("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function u6(e){var r={};r.iauthor=e.read_shift(4);var t=Mi(e);return r.rfx=t.s,r.ref=ot(t.s),e.l+=16,r}function f6(e,r){return r==null&&(r=Ee(36)),r.write_shift(4,e[1].iauthor),Ml(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var d6=xn;function h6(e){return Kr(e.slice(0,54))}function x6(e,r){var t=[],n=[],s={},o=!1;return ga(e,function(u,d,h){switch(h){case 632:n.push(u);break;case 635:s=u;break;case 637:s.t=u.t,s.h=u.h,s.r=u.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,r.sheetRows&&s.rfx&&r.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,t.push(s);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!o||r.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),t}function m6(e){var r=Mn(),t=[];return De(r,628),De(r,630),e.forEach(function(n){n[1].forEach(function(s){t.indexOf(s.a)>-1||(t.push(s.a.slice(0,54)),De(r,632,h6(s.a)))})}),De(r,631),De(r,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=t.indexOf(s.a);var o={s:cr(n[0]),e:cr(n[0])};De(r,635,f6([o,s])),s.t&&s.t.length>0&&De(r,637,ME(s)),De(r,636),delete s.iauthor})}),De(r,634),De(r,629),r.end()}var p6="application/vnd.ms-office.vbaProject";function g6(e){var r=tt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var s=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");tt.utils.cfb_add(r,s,e.FileIndex[n].content)}}),tt.write(r)}function v6(e,r){r.FullPaths.forEach(function(t,n){if(n!=0){var s=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&tt.utils.cfb_add(e,s,r.FileIndex[n].content)}})}var ky=["xlsb","xlsm","xlam","biff8","xla"];function y6(){return{"!type":"dialog"}}function b6(){return{"!type":"dialog"}}function w6(){return{"!type":"macro"}}function _6(){return{"!type":"macro"}}var wl=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,s,o,c){var u=!1,d=!1;o.length==0?d=!0:o.charAt(0)=="["&&(d=!0,o=o.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var h=o.length>0?parseInt(o,10)|0:0,m=c.length>0?parseInt(c,10)|0:0;return u?m+=r.c:--m,d?h+=r.r:--h,s+(u?"":"$")+or(m)+(d?"":"$")+wr(h)}return function(s,o){return r=o,s.replace(e,t)}})(),Ch=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Th=(function(){return function(r,t){return r.replace(Ch,function(n,s,o,c,u,d){var h=mh(c)-(o?0:t.c),m=xh(d)-(u?0:t.r),p=m==0?"":u?m+1:"["+m+"]",y=h==0?"":o?h+1:"["+h+"]";return s+"R"+p+"C"+y})}})();function Ny(e,r){return e.replace(Ch,function(t,n,s,o,c,u){return n+(s=="$"?s+o:or(mh(o)+r.c))+(c=="$"?c+u:wr(xh(u)+r.r))})}function k6(e,r,t){var n=Ln(r),s=n.s,o=cr(t),c={r:o.r-s.r,c:o.c-s.c};return Ny(e,c)}function N6(e){return e.length!=1}function Dg(e){return e.replace(/_xlfn\./g,"")}function Cr(e){e.l+=1}function Va(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Sy(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return Ey(e);t.biff==12&&(n=4)}var s=e.read_shift(n),o=e.read_shift(n),c=Va(e),u=Va(e);return{s:{r:s,c:c[0],cRel:c[1],rRel:c[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function Ey(e){var r=Va(e),t=Va(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function S6(e,r,t){if(t.biff<8)return Ey(e);var n=e.read_shift(t.biff==12?4:2),s=e.read_shift(t.biff==12?4:2),o=Va(e),c=Va(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function jy(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return E6(e);var n=e.read_shift(t&&t.biff==12?4:2),s=Va(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function E6(e){var r=Va(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function j6(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function C6(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return T6(e);var s=e.read_shift(n>=12?4:2),o=e.read_shift(2),c=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;s>524287;)s-=1048576;if(c==1)for(;o>8191;)o=o-16384;return{r:s,c:o,cRel:c,rRel:u}}function T6(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,s=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),s==1&&t>=128&&(t=t-256),{r,c:t,cRel:s,rRel:n}}function F6(e,r,t){var n=(e[e.l++]&96)>>5,s=Sy(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,s]}function A6(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var c=Sy(e,o,t);return[n,s,c]}function O6(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function D6(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[n,s]}function I6(e,r,t){var n=(e[e.l++]&96)>>5,s=S6(e,r-1,t);return[n,s]}function R6(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function Ig(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function P6(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),s=[],o=0;o<=n;++o)s.push(e.read_shift(t&&t.biff==2?1:2));return s}function M6(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function L6(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function B6(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function U6(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function Cy(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function z6(e){return e.read_shift(2),Cy(e)}function $6(e){return e.read_shift(2),Cy(e)}function H6(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=jy(e,0,t);return[n,s]}function W6(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=C6(e,0,t);return[n,s]}function V6(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var o=jy(e,0,t);return[n,s,o]}function q6(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(t&&t.biff<=3?1:2);return[K5[s],Ay[s],n]}function X6(e,r,t){var n=e[e.l++],s=e.read_shift(1),o=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:G6(e);return[s,(o[0]===0?Ay:G5)[o[1]]]}function G6(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function K6(e,r,t){e.l+=t&&t.biff==2?3:4}function Y6(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function J6(e){return e.l++,va[e.read_shift(1)]}function Q6(e){return e.l++,e.read_shift(2)}function Z6(e){return e.l++,e.read_shift(1)!==0}function e5(e){return e.l++,hn(e)}function t5(e,r,t){return e.l++,uc(e,r-1,t)}function r5(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=br(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=va[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=hn(e);break;case 2:t[1]=Li(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function n5(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),s=[],o=0;o!=n;++o)s.push((t.biff==12?Mi:fu)(e));return s}function s5(e,r,t){var n=0,s=0;t.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--s==0&&(s=256));for(var o=0,c=[];o!=n&&(c[o]=[]);++o)for(var u=0;u!=s;++u)c[o][u]=r5(e,t.biff);return c}function a5(e,r,t){var n=e.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,o=e.read_shift(s);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,o]}function i5(e,r,t){if(t.biff==5)return l5(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),o=e.read_shift(4);return[n,s,o]}function l5(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function o5(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function c5(e,r,t){var n=e.read_shift(1)>>>5&3,s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function u5(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function f5(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[n,s]}var d5=mn,h5=mn,x5=mn;function dc(e,r,t){return e.l+=2,[j6(e)]}function Fh(e){return e.l+=6,[]}var m5=dc,p5=Fh,g5=Fh,v5=dc;function Ty(e){return e.l+=2,[Fr(e),e.read_shift(2)&1]}var y5=dc,b5=Ty,w5=Fh,_5=dc,k5=dc,N5=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function S5(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),o=e.read_shift(2),c=N5[t>>2&31];return{ixti:r,coltype:t&3,rt:c,idx:n,c:s,C:o}}function E5(e){return e.l+=2,[e.read_shift(4)]}function j5(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function C5(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function T5(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function F5(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function A5(e){return e.l+=4,[0,0]}var Rg={1:{n:"PtgExp",f:Y6},2:{n:"PtgTbl",f:x5},3:{n:"PtgAdd",f:Cr},4:{n:"PtgSub",f:Cr},5:{n:"PtgMul",f:Cr},6:{n:"PtgDiv",f:Cr},7:{n:"PtgPower",f:Cr},8:{n:"PtgConcat",f:Cr},9:{n:"PtgLt",f:Cr},10:{n:"PtgLe",f:Cr},11:{n:"PtgEq",f:Cr},12:{n:"PtgGe",f:Cr},13:{n:"PtgGt",f:Cr},14:{n:"PtgNe",f:Cr},15:{n:"PtgIsect",f:Cr},16:{n:"PtgUnion",f:Cr},17:{n:"PtgRange",f:Cr},18:{n:"PtgUplus",f:Cr},19:{n:"PtgUminus",f:Cr},20:{n:"PtgPercent",f:Cr},21:{n:"PtgParen",f:Cr},22:{n:"PtgMissArg",f:Cr},23:{n:"PtgStr",f:t5},26:{n:"PtgSheet",f:j5},27:{n:"PtgEndSheet",f:C5},28:{n:"PtgErr",f:J6},29:{n:"PtgBool",f:Z6},30:{n:"PtgInt",f:Q6},31:{n:"PtgNum",f:e5},32:{n:"PtgArray",f:R6},33:{n:"PtgFunc",f:q6},34:{n:"PtgFuncVar",f:X6},35:{n:"PtgName",f:a5},36:{n:"PtgRef",f:H6},37:{n:"PtgArea",f:F6},38:{n:"PtgMemArea",f:o5},39:{n:"PtgMemErr",f:d5},40:{n:"PtgMemNoMem",f:h5},41:{n:"PtgMemFunc",f:c5},42:{n:"PtgRefErr",f:u5},43:{n:"PtgAreaErr",f:O6},44:{n:"PtgRefN",f:W6},45:{n:"PtgAreaN",f:I6},46:{n:"PtgMemAreaN",f:T5},47:{n:"PtgMemNoMemN",f:F5},57:{n:"PtgNameX",f:i5},58:{n:"PtgRef3d",f:V6},59:{n:"PtgArea3d",f:A6},60:{n:"PtgRefErr3d",f:f5},61:{n:"PtgAreaErr3d",f:D6},255:{}},O5={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},D5={1:{n:"PtgElfLel",f:Ty},2:{n:"PtgElfRw",f:_5},3:{n:"PtgElfCol",f:m5},6:{n:"PtgElfRwV",f:k5},7:{n:"PtgElfColV",f:v5},10:{n:"PtgElfRadical",f:y5},11:{n:"PtgElfRadicalS",f:w5},13:{n:"PtgElfColS",f:p5},15:{n:"PtgElfColSV",f:g5},16:{n:"PtgElfRadicalLel",f:b5},25:{n:"PtgList",f:S5},29:{n:"PtgSxName",f:E5},255:{}},I5={0:{n:"PtgAttrNoop",f:A5},1:{n:"PtgAttrSemi",f:U6},2:{n:"PtgAttrIf",f:L6},4:{n:"PtgAttrChoose",f:P6},8:{n:"PtgAttrGoto",f:M6},16:{n:"PtgAttrSum",f:K6},32:{n:"PtgAttrBaxcel",f:Ig},33:{n:"PtgAttrBaxcel",f:Ig},64:{n:"PtgAttrSpace",f:z6},65:{n:"PtgAttrSpaceSemi",f:$6},128:{n:"PtgAttrIfError",f:B6},255:{}};function hc(e,r,t,n){if(n.biff<8)return mn(e,r);for(var s=e.l+r,o=[],c=0;c!==t.length;++c)switch(t[c][0]){case"PtgArray":t[c][1]=s5(e,0,n),o.push(t[c][1]);break;case"PtgMemArea":t[c][2]=n5(e,t[c][1],n),o.push(t[c][2]);break;case"PtgExp":n&&n.biff==12&&(t[c][1][1]=e.read_shift(4),o.push(t[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[c][0]}return r=s-e.l,r!==0&&o.push(mn(e,r)),o}function xc(e,r,t){for(var n=e.l+r,s,o,c=[];n!=e.l;)r=n-e.l,o=e[e.l],s=Rg[o]||Rg[O5[o]],(o===24||o===25)&&(s=(o===24?D5:I5)[e[e.l+1]]),!s||!s.f?mn(e,r):c.push([s.n,s.f(e,r,t)]);return c}function R5(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],s=[],o=0;o<n.length;++o){var c=n[o];c?c[0]===2?s.push('"'+c[1].replace(/"/g,'""')+'"'):s.push(c[1]):s.push("")}r.push(s.join(","))}return r.join(";")}var P5={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function M5(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Fy(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var s="";if(t.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Pg(e,r,t){var n=Fy(e,r,t);return n=="#REF"?n:M5(n,t)}function un(e,r,t,n,s){var o=s&&s.biff||8,c={s:{c:0,r:0}},u=[],d,h,m,p=0,y=0,k,b="";if(!e[0]||!e[0][0])return"";for(var v=-1,w="",S=0,I=e[0].length;S<I;++S){var N=e[0][S];switch(N[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=u.pop(),h=u.pop(),v>=0){switch(e[0][v][1][0]){case 0:w=mr(" ",e[0][v][1][1]);break;case 1:w=mr("\r",e[0][v][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}h=h+w,v=-1}u.push(h+P5[N[0]]+d);break;case"PtgIsect":d=u.pop(),h=u.pop(),u.push(h+" "+d);break;case"PtgUnion":d=u.pop(),h=u.pop(),u.push(h+","+d);break;case"PtgRange":d=u.pop(),h=u.pop(),u.push(h+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=Oo(N[1][1],c,s),u.push(Do(m,o));break;case"PtgRefN":m=t?Oo(N[1][1],t,s):N[1][1],u.push(Do(m,o));break;case"PtgRef3d":p=N[1][1],m=Oo(N[1][2],c,s),b=Pg(n,p,s),u.push(b+"!"+Do(m,o));break;case"PtgFunc":case"PtgFuncVar":var P=N[1][0],W=N[1][1];P||(P=0),P&=127;var X=P==0?[]:u.slice(-P);u.length-=P,W==="User"&&(W=X.shift()),u.push(W+"("+X.join(",")+")");break;case"PtgBool":u.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(N[1]);break;case"PtgNum":u.push(String(N[1]));break;case"PtgStr":u.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(N[1]);break;case"PtgAreaN":k=fg(N[1][1],t?{s:t}:c,s),u.push(ud(k,s));break;case"PtgArea":k=fg(N[1][1],c,s),u.push(ud(k,s));break;case"PtgArea3d":p=N[1][1],k=N[1][2],b=Pg(n,p,s),u.push(b+"!"+ud(k,s));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=N[1][2];var M=(n.names||[])[y-1]||(n[0]||[])[y],Z=M?M.Name:"SH33TJSNAME"+String(y);Z&&Z.slice(0,6)=="_xlfn."&&!s.xlfn&&(Z=Z.slice(6)),u.push(Z);break;case"PtgNameX":var H=N[1][1];y=N[1][2];var ce;if(s.biff<=5)H<0&&(H=-H),n[H]&&(ce=n[H][y]);else{var le="";if(((n[H]||[])[0]||[])[0]==14849||(((n[H]||[])[0]||[])[0]==1025?n[H][y]&&n[H][y].itab>0&&(le=n.SheetNames[n[H][y].itab-1]+"!"):le=n.SheetNames[y-1]+"!"),n[H]&&n[H][y])le+=n[H][y].Name;else if(n[0]&&n[0][y])le+=n[0][y].Name;else{var re=(Fy(n,H,s)||"").split(";;");re[y-1]?le=re[y-1]:le+="SH33TJSERRX"}u.push(le);break}ce||(ce={Name:"SH33TJSERRY"}),u.push(ce.Name);break;case"PtgParen":var te="(",ve=")";if(v>=0){switch(w="",e[0][v][1][0]){case 2:te=mr(" ",e[0][v][1][1])+te;break;case 3:te=mr("\r",e[0][v][1][1])+te;break;case 4:ve=mr(" ",e[0][v][1][1])+ve;break;case 5:ve=mr("\r",e[0][v][1][1])+ve;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}u.push(te+u.pop()+ve);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:N[1][1],r:N[1][0]};var Se={c:t.c,r:t.r};if(n.sharedf[ot(m)]){var Ce=n.sharedf[ot(m)];u.push(un(Ce,c,Se,n,s))}else{var ue=!1;for(d=0;d!=n.arrayf.length;++d)if(h=n.arrayf[d],!(m.c<h[0].s.c||m.c>h[0].e.c)&&!(m.r<h[0].s.r||m.r>h[0].e.r)){u.push(un(h[1],c,Se,n,s)),ue=!0;break}ue||u.push(N[1])}break;case"PtgArray":u.push("{"+R5(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var ne=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&ne.indexOf(e[0][S][0])==-1){N=e[0][v];var A=!0;switch(N[1][0]){case 4:A=!1;case 0:w=mr(" ",N[1][1]);break;case 5:A=!1;case 1:w=mr("\r",N[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}u.push((A?w:"")+u.pop()+(A?"":w)),v=-1}}if(u.length>1&&s.WTF)throw new Error("bad formula stack");return u[0]}function L5(e,r,t){var n=e.l+r,s=t.biff==2?1:2,o,c=e.read_shift(s);if(c==65535)return[[],mn(e,r-2)];var u=xc(e,c,t);return r!==c+s&&(o=hc(e,r-c-s,u,t)),e.l=n,[u,o]}function B5(e,r,t){var n=e.l+r,s=t.biff==2?1:2,o,c=e.read_shift(s);if(c==65535)return[[],mn(e,r-2)];var u=xc(e,c,t);return r!==c+s&&(o=hc(e,r-c-s,u,t)),e.l=n,[u,o]}function U5(e,r,t,n){var s=e.l+r,o=xc(e,n,t),c;return s!==e.l&&(c=hc(e,s-e.l,o,t)),[o,c]}function z5(e,r,t){var n=e.l+r,s,o=e.read_shift(2),c=xc(e,o,t);return o==65535?[[],mn(e,r-2)]:(r!==o+2&&(s=hc(e,n-o-2,c,t)),[c,s])}function $5(e){var r;if(ua(e,e.l+6)!==65535)return[hn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function H5(e){if(e==null){var r=Ee(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return Ci(e);return Ci(0)}function md(e,r,t){var n=e.l+r,s=Ks(e);t.biff==2&&++e.l;var o=$5(e),c=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var u=B5(e,n-e.l,t);return{cell:s,val:o[0],formula:u,shared:c>>3&1,tt:o[1]}}function W5(e,r,t,n,s){var o=Fi(r,t,s),c=H5(e.v),u=Ee(6),d=33;u.write_shift(2,d),u.write_shift(4,0);for(var h=Ee(e.bf.length),m=0;m<e.bf.length;++m)h[m]=e.bf[m];var p=Gr([o,c,u,h]);return p}function du(e,r,t){var n=e.read_shift(4),s=xc(e,n,t),o=e.read_shift(4),c=o>0?hc(e,o,s,t):null;return[s,c]}var V5=du,hu=du,q5=du,X5=du,G5={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ay={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},K5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Mg(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Y5(e){var r="of:="+e.replace(Ch,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function pd(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function J5(e){return e.replace(/\./,"!")}var Ro={},_l={},Po=typeof Map<"u";function Ah(e,r,t){var n=0,s=e.length;if(t){if(Po?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var o=Po?t.get(r):t[r];n<o.length;++n)if(e[o[n]].t===r)return e.Count++,o[n]}}else for(;n<s;++n)if(e[n].t===r)return e.Count++,n;return e[s]={t:r},e.Count++,e.Unique++,t&&(Po?(t.has(r)||t.set(r,[]),t.get(r).push(s)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(s))),s}function xu(e,r){var t={min:e+1,max:e+1},n=-1;return r.MDW&&(fn=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?n=Jo(r.wpx):r.wch!=null&&(n=r.wch),n>-1?(t.width=K0(n),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function Ni(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function Ja(e,r,t){var n=t.revssf[r.z!=null?r.z:"General"],s=60,o=e.length;if(n==null&&t.ssf){for(;s<392;++s)if(t.ssf[s]==null){da(r.z,s),t.ssf[s]=r.z,t.revssf[r.z]=n=s;break}}for(s=0;s!=o;++s)if(e[s].numFmtId===n)return s;return e[o]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function Oy(e,r,t,n,s,o){try{n.cellNF&&(e.z=lt[r])}catch(u){if(n.WTF)throw u}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Zt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(lt[r]==null&&da(GS[r]||"General",r),e.t==="e")e.w=e.w||va[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wo(e.v);else if(e.t==="d"){var c=Lr(e.v);(c|0)===c?e.w=c.toString(10):e.w=Wo(c)}else{if(e.v===void 0)return"";e.w=Ei(e.v,_l)}else e.t==="d"?e.w=hs(r,Lr(e.v),_l):e.w=hs(r,e.v,_l)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&t!=null)try{e.s=o.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=G0(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=G0(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&o.Fills)throw u}}}function Q5(e,r,t){if(e&&e["!ref"]){var n=Ot(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function Z5(e,r){var t=Ot(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=gt(t))}var eF=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,tF=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,rF=/<(?:\w:)?hyperlink [^>]*>/mg,nF=/"(\w*:\w*)"/,sF=/<(?:\w:)?col\b[^>]*[\/]?>/g,aF=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,iF=/<(?:\w:)?pageMargins[^>]*\/>/g,Dy=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,lF=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,oF=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function cF(e,r,t,n,s,o,c){if(!e)return e;n||(n={"!id":{}});var u=r.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",m="",p=e.match(tF);p?(h=e.slice(0,p.index),m=e.slice(p.index+p[0].length)):h=m=e;var y=h.match(Dy);y?Oh(y[0],u,s,t):(y=h.match(lF))&&fF(y[0],y[1]||"",u,s,t);var k=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(k>0){var b=h.slice(k,k+50).match(nF);b&&Z5(u,b[1])}var v=h.match(oF);v&&v[1]&&NF(v[1],s);var w=[];if(r.cellStyles){var S=h.match(sF);S&&yF(w,S)}p&&jF(p[1],u,r,d,o,c);var I=m.match(aF);I&&(u["!autofilter"]=wF(I[0]));var N=[],P=m.match(eF);if(P)for(k=0;k!=P.length;++k)N[k]=Ot(P[k].slice(P[k].indexOf('"')+1));var W=m.match(rF);W&&pF(u,W,n);var X=m.match(iF);if(X&&(u["!margins"]=gF(ct(X[0]))),!u["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(u["!ref"]=gt(d)),r.sheetRows>0&&u["!ref"]){var M=Ot(u["!ref"]);r.sheetRows<=+M.e.r&&(M.e.r=r.sheetRows-1,M.e.r>d.e.r&&(M.e.r=d.e.r),M.e.r<M.s.r&&(M.s.r=M.e.r),M.e.c>d.e.c&&(M.e.c=d.e.c),M.e.c<M.s.c&&(M.s.c=M.e.c),u["!fullref"]=u["!ref"],u["!ref"]=gt(M))}return w.length>0&&(u["!cols"]=w),N.length>0&&(u["!merges"]=N),u}function uF(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+gt(e[t])+'"/>';return r+"</mergeCells>"}function Oh(e,r,t,n){var s=ct(e);t.Sheets[n]||(t.Sheets[n]={}),s.codeName&&(t.Sheets[n].CodeName=At(Wt(s.codeName)))}function fF(e,r,t,n,s){Oh(e.slice(0,e.indexOf(">")),t,n,s)}function dF(e,r,t,n,s){var o=!1,c={},u=null;if(n.bookType!=="xlsx"&&r.vbaraw){var d=r.SheetNames[t];try{r.Workbook&&(d=r.Workbook.Sheets[t].CodeName||d)}catch{}o=!0,c.codeName=Vs(Ht(d))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),u=(u||"")+$e("outlinePr",null,h)}!o&&!u||(s[s.length]=$e("sheetPr",u,c))}var hF=["objects","scenarios","selectLockedCells","selectUnlockedCells"],xF=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function mF(e){var r={sheet:1};return hF.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),xF.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=Sh(e.password).toString(16).toUpperCase()),$e("sheetProtection",null,r)}function pF(e,r,t){for(var n=Array.isArray(e),s=0;s!=r.length;++s){var o=ct(Wt(r[s]),!0);if(!o.ref)return;var c=((t||{})["!id"]||[])[o.id];c?(o.Target=c.Target,o.location&&(o.Target+="#"+At(o.location))):(o.Target="#"+At(o.location),c={Target:o.Target,TargetMode:"Internal"}),o.Rel=c,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=Ot(o.ref),d=u.s.r;d<=u.e.r;++d)for(var h=u.s.c;h<=u.e.c;++h){var m=ot({c:h,r:d});n?(e[d]||(e[d]=[]),e[d][h]||(e[d][h]={t:"z",v:void 0}),e[d][h].l=o):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=o)}}}function gF(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function vF(e){return Ni(e),$e("pageMargins",null,e)}function yF(e,r){for(var t=!1,n=0;n!=r.length;++n){var s=ct(r[n],!0);s.hidden&&(s.hidden=Qt(s.hidden));var o=parseInt(s.min,10)-1,c=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!t&&s.width&&(t=!0,Eh(s.width)),Wa(s);o<=c;)e[o++]=er(s)}}function bF(e,r){for(var t=["<cols>"],n,s=0;s!=r.length;++s)(n=r[s])&&(t[t.length]=$e("col",null,xu(s,n)));return t[t.length]="</cols>",t.join("")}function wF(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}function _F(e,r,t,n){var s=typeof e.ref=="string"?e.ref:gt(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,c=Ln(s);c.s.r==c.e.r&&(c.e.r=Ln(r["!ref"]).e.r,s=gt(c));for(var u=0;u<o.length;++u){var d=o[u];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+t.SheetNames[n]+"'!"+s;break}}return u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),$e("autoFilter",null,{ref:s})}var kF=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function NF(e,r){r.Views||(r.Views=[{}]),(e.match(kF)||[]).forEach(function(t,n){var s=ct(t);r.Views[n]||(r.Views[n]={}),+s.zoomScale&&(r.Views[n].zoom=+s.zoomScale),Qt(s.rightToLeft)&&(r.Views[n].RTL=!0)})}function SF(e,r,t,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),$e("sheetViews",$e("sheetView",null,s),{})}function EF(e,r,t,n){if(e.c&&t["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",o=e.t,c=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=va[e.v];break;case"d":n&&n.cellDates?s=Zt(e.v,-1).toISOString():(e=er(e),e.t="n",s=""+(e.v=Lr(Zt(e.v)))),typeof e.z>"u"&&(e.z=lt[14]);break;default:s=e.v;break}var u=rn("v",Ht(s)),d={r},h=Ja(n.cellXfs,e,n);switch(h!==0&&(d.s=h),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=rn("v",""+Ah(n.Strings,e.v,n.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=o&&(e.t=o,e.v=c),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;u=$e("f",Ht(e.f),m)+(e.v!=null?u:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(d.cm=1),$e("c",u,d)}var jF=(function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,o=Vo("v"),c=Vo("f");return function(d,h,m,p,y,k){for(var b=0,v="",w=[],S=[],I=0,N=0,P=0,W="",X,M,Z=0,H=0,ce,le,re=0,te=0,ve=Array.isArray(k.CellXf),Se,Ce=[],ue=[],ne=Array.isArray(h),A=[],me={},z=!1,T=!!m.sheetStubs,Q=d.split(r),Y=0,J=Q.length;Y!=J;++Y){v=Q[Y].trim();var K=v.length;if(K!==0){var fe=0;e:for(b=0;b<K;++b)switch(v[b]){case">":if(v[b-1]!="/"){++b;break e}if(m&&m.cellStyles){if(M=ct(v.slice(fe,b),!0),Z=M.r!=null?parseInt(M.r,10):Z+1,H=-1,m.sheetRows&&m.sheetRows<Z)continue;me={},z=!1,M.ht&&(z=!0,me.hpt=parseFloat(M.ht),me.hpx=Tl(me.hpt)),M.hidden=="1"&&(z=!0,me.hidden=!0),M.outlineLevel!=null&&(z=!0,me.level=+M.outlineLevel),z&&(A[Z-1]=me)}break;case"<":fe=b;break}if(fe>=b)break;if(M=ct(v.slice(fe,b),!0),Z=M.r!=null?parseInt(M.r,10):Z+1,H=-1,!(m.sheetRows&&m.sheetRows<Z)){p.s.r>Z-1&&(p.s.r=Z-1),p.e.r<Z-1&&(p.e.r=Z-1),m&&m.cellStyles&&(me={},z=!1,M.ht&&(z=!0,me.hpt=parseFloat(M.ht),me.hpx=Tl(me.hpt)),M.hidden=="1"&&(z=!0,me.hidden=!0),M.outlineLevel!=null&&(z=!0,me.level=+M.outlineLevel),z&&(A[Z-1]=me)),w=v.slice(b).split(e);for(var we=0;we!=w.length&&w[we].trim().charAt(0)=="<";++we);for(w=w.slice(we),b=0;b!=w.length;++b)if(v=w[b].trim(),v.length!==0){if(S=v.match(t),I=b,N=0,P=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,S!=null&&S.length===2){for(I=0,W=S[1],N=0;N!=W.length&&!((P=W.charCodeAt(N)-64)<1||P>26);++N)I=26*I+P;--I,H=I}else++H;for(N=0;N!=v.length&&v.charCodeAt(N)!==62;++N);if(++N,M=ct(v.slice(0,N),!0),M.r||(M.r=ot({r:Z-1,c:H})),W=v.slice(N),X={t:""},(S=W.match(o))!=null&&S[1]!==""&&(X.v=At(S[1])),m.cellFormula){if((S=W.match(c))!=null&&S[1]!==""){if(X.f=At(Wt(S[1])).replace(/\r\n/g,`
`),m.xlfn||(X.f=Dg(X.f)),S[0].indexOf('t="array"')>-1)X.F=(W.match(s)||[])[1],X.F.indexOf(":")>-1&&Ce.push([Ot(X.F),X.F]);else if(S[0].indexOf('t="shared"')>-1){le=ct(S[0]);var ye=At(Wt(S[1]));m.xlfn||(ye=Dg(ye)),ue[parseInt(le.si,10)]=[le,ye,M.r]}}else(S=W.match(/<f[^>]*\/>/))&&(le=ct(S[0]),ue[le.si]&&(X.f=k6(ue[le.si][1],ue[le.si][2],M.r)));var je=cr(M.r);for(N=0;N<Ce.length;++N)je.r>=Ce[N][0].s.r&&je.r<=Ce[N][0].e.r&&je.c>=Ce[N][0].s.c&&je.c<=Ce[N][0].e.c&&(X.F=Ce[N][1])}if(M.t==null&&X.v===void 0)if(X.f||X.F)X.v=0,X.t="n";else if(T)X.t="z";else continue;else X.t=M.t||"n";switch(p.s.c>H&&(p.s.c=H),p.e.c<H&&(p.e.c=H),X.t){case"n":if(X.v==""||X.v==null){if(!T)continue;X.t="z"}else X.v=parseFloat(X.v);break;case"s":if(typeof X.v>"u"){if(!T)continue;X.t="z"}else ce=Ro[parseInt(X.v,10)],X.v=ce.t,X.r=ce.r,m.cellHTML&&(X.h=ce.h);break;case"str":X.t="s",X.v=X.v!=null?Wt(X.v):"",m.cellHTML&&(X.h=uh(X.v));break;case"inlineStr":S=W.match(n),X.t="s",S!=null&&(ce=Nh(S[1]))?(X.v=ce.t,m.cellHTML&&(X.h=ce.h)):X.v="";break;case"b":X.v=Qt(X.v);break;case"d":m.cellDates?X.v=Zt(X.v,1):(X.v=Lr(Zt(X.v,1)),X.t="n");break;case"e":(!m||m.cellText!==!1)&&(X.w=X.v),X.v=Rv[X.v];break}if(re=te=0,Se=null,ve&&M.s!==void 0&&(Se=k.CellXf[M.s],Se!=null&&(Se.numFmtId!=null&&(re=Se.numFmtId),m.cellStyles&&Se.fillId!=null&&(te=Se.fillId))),Oy(X,re,te,m,y,k),m.cellDates&&ve&&X.t=="n"&&Il(lt[re])&&(X.t="d",X.v=uu(X.v)),M.cm&&m.xlmeta){var Xe=(m.xlmeta.Cell||[])[+M.cm-1];Xe&&Xe.type=="XLDAPR"&&(X.D=!0)}if(ne){var D=cr(M.r);h[D.r]||(h[D.r]=[]),h[D.r][D.c]=X}else h[M.r]=X}}}}A.length>0&&(h["!rows"]=A)}})();function CF(e,r,t,n){var s=[],o=[],c=Ot(e["!ref"]),u="",d,h="",m=[],p=0,y=0,k=e["!rows"],b=Array.isArray(e),v={r:h},w,S=-1;for(y=c.s.c;y<=c.e.c;++y)m[y]=or(y);for(p=c.s.r;p<=c.e.r;++p){for(o=[],h=wr(p),y=c.s.c;y<=c.e.c;++y){d=m[y]+h;var I=b?(e[p]||[])[y]:e[d];I!==void 0&&(u=EF(I,d,e,r))!=null&&o.push(u)}(o.length>0||k&&k[p])&&(v={r:h},k&&k[p]&&(w=k[p],w.hidden&&(v.hidden=1),S=-1,w.hpx?S=Qo(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(v.ht=S,v.customHeight=1),w.level&&(v.outlineLevel=w.level)),s[s.length]=$e("row",o.join(""),v))}if(k)for(;p<k.length;++p)k&&k[p]&&(v={r:p+1},w=k[p],w.hidden&&(v.hidden=1),S=-1,w.hpx?S=Qo(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(v.ht=S,v.customHeight=1),w.level&&(v.outlineLevel=w.level),s[s.length]=$e("row","",v));return s.join("")}function Iy(e,r,t,n){var s=[kr,$e("worksheet",null,{xmlns:Di[0],"xmlns:r":Mr.r})],o=t.SheetNames[e],c=0,u="",d=t.Sheets[o];d==null&&(d={});var h=d["!ref"]||"A1",m=Ot(h);if(m.e.c>16383||m.e.r>1048575){if(r.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),h=gt(m)}n||(n={}),d["!comments"]=[];var p=[];dF(d,t,e,r,s),s[s.length]=$e("dimension",null,{ref:h}),s[s.length]=SF(d,r,e,t),r.sheetFormat&&(s[s.length]=$e("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(s[s.length]=bF(d,d["!cols"])),s[c=s.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(u=CF(d,r),u.length>0&&(s[s.length]=u)),s.length>c+1&&(s[s.length]="</sheetData>",s[c]=s[c].replace("/>",">")),d["!protect"]&&(s[s.length]=mF(d["!protect"])),d["!autofilter"]!=null&&(s[s.length]=_F(d["!autofilter"],d,t,e)),d["!merges"]!=null&&d["!merges"].length>0&&(s[s.length]=uF(d["!merges"]));var y=-1,k,b=-1;return d["!links"].length>0&&(s[s.length]="<hyperlinks>",d["!links"].forEach(function(v){v[1].Target&&(k={ref:v[0]},v[1].Target.charAt(0)!="#"&&(b=$t(n,-1,Ht(v[1].Target).replace(/#.*$/,""),St.HLINK),k["r:id"]="rId"+b),(y=v[1].Target.indexOf("#"))>-1&&(k.location=Ht(v[1].Target.slice(y+1))),v[1].Tooltip&&(k.tooltip=Ht(v[1].Tooltip)),s[s.length]=$e("hyperlink",null,k))}),s[s.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(s[s.length]=vF(d["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(s[s.length]=rn("ignoredErrors",$e("ignoredError",null,{numberStoredAsText:1,sqref:h}))),p.length>0&&(b=$t(n,-1,"../drawings/drawing"+(e+1)+".xml",St.DRAW),s[s.length]=$e("drawing",null,{"r:id":"rId"+b}),d["!drawing"]=p),d["!comments"].length>0&&(b=$t(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",St.VML),s[s.length]=$e("legacyDrawing",null,{"r:id":"rId"+b}),d["!legacy"]=b),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function TF(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=n,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=s/20),t}function FF(e,r,t){var n=Ee(145),s=(t["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var o=320;s.hpx?o=Qo(s.hpx)*20:s.hpt&&(o=s.hpt*20),n.write_shift(2,o),n.write_shift(1,0);var c=0;s.level&&(c|=s.level),s.hidden&&(c|=16),(s.hpx||s.hpt)&&(c|=32),n.write_shift(1,c),n.write_shift(1,0);var u=0,d=n.l;n.l+=4;for(var h={r:e,c:0},m=0;m<16;++m)if(!(r.s.c>m+1<<10||r.e.c<m<<10)){for(var p=-1,y=-1,k=m<<10;k<m+1<<10;++k){h.c=k;var b=Array.isArray(t)?(t[h.r]||[])[h.c]:t[ot(h)];b&&(p<0&&(p=k),y=k)}p<0||(++u,n.write_shift(4,p),n.write_shift(4,y))}var v=n.l;return n.l=d,n.write_shift(4,u),n.l=v,n.length>n.l?n.slice(0,n.l):n}function AF(e,r,t,n){var s=FF(n,t,r);(s.length>17||(r["!rows"]||[])[n])&&De(e,0,s)}var OF=Mi,DF=Ml;function IF(){}function RF(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=LE(e),t}function PF(e,r,t){t==null&&(t=Ee(84+4*e.length));var n=192;r&&(r.above&&(n&=-65),r.left&&(n&=-129)),t.write_shift(1,n);for(var s=1;s<3;++s)t.write_shift(1,0);return V0({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),Fv(e,t),t.slice(0,t.l)}function MF(e){var r=ms(e);return[r]}function LF(e,r,t){return t==null&&(t=Ee(8)),Ii(r,t)}function BF(e){var r=Ri(e);return[r]}function UF(e,r,t){return t==null&&(t=Ee(4)),Pi(r,t)}function zF(e){var r=ms(e),t=e.read_shift(1);return[r,t,"b"]}function $F(e,r,t){return t==null&&(t=Ee(9)),Ii(r,t),t.write_shift(1,e.v?1:0),t}function HF(e){var r=Ri(e),t=e.read_shift(1);return[r,t,"b"]}function WF(e,r,t){return t==null&&(t=Ee(5)),Pi(r,t),t.write_shift(1,e.v?1:0),t}function VF(e){var r=ms(e),t=e.read_shift(1);return[r,t,"e"]}function qF(e,r,t){return t==null&&(t=Ee(9)),Ii(r,t),t.write_shift(1,e.v),t}function XF(e){var r=Ri(e),t=e.read_shift(1);return[r,t,"e"]}function GF(e,r,t){return t==null&&(t=Ee(8)),Pi(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function KF(e){var r=ms(e),t=e.read_shift(4);return[r,t,"s"]}function YF(e,r,t){return t==null&&(t=Ee(12)),Ii(r,t),t.write_shift(4,r.v),t}function JF(e){var r=Ri(e),t=e.read_shift(4);return[r,t,"s"]}function QF(e,r,t){return t==null&&(t=Ee(8)),Pi(r,t),t.write_shift(4,r.v),t}function ZF(e){var r=ms(e),t=hn(e);return[r,t,"n"]}function eA(e,r,t){return t==null&&(t=Ee(16)),Ii(r,t),Ci(e.v,t),t}function Ry(e){var r=Ri(e),t=hn(e);return[r,t,"n"]}function tA(e,r,t){return t==null&&(t=Ee(12)),Pi(r,t),Ci(e.v,t),t}function rA(e){var r=ms(e),t=yh(e);return[r,t,"n"]}function nA(e,r,t){return t==null&&(t=Ee(12)),Ii(r,t),Av(e.v,t),t}function sA(e){var r=Ri(e),t=yh(e);return[r,t,"n"]}function aA(e,r,t){return t==null&&(t=Ee(8)),Pi(r,t),Av(e.v,t),t}function iA(e){var r=ms(e),t=ph(e);return[r,t,"is"]}function lA(e){var r=ms(e),t=xn(e);return[r,t,"str"]}function oA(e,r,t){return t==null&&(t=Ee(12+4*e.v.length)),Ii(r,t),Kr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function cA(e){var r=Ri(e),t=xn(e);return[r,t,"str"]}function uA(e,r,t){return t==null&&(t=Ee(8+4*e.v.length)),Pi(r,t),Kr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function fA(e,r,t){var n=e.l+r,s=ms(e);s.r=t["!row"];var o=e.read_shift(1),c=[s,o,"b"];if(t.cellFormula){e.l+=2;var u=hu(e,n-e.l,t);c[3]=un(u,null,s,t.supbooks,t)}else e.l=n;return c}function dA(e,r,t){var n=e.l+r,s=ms(e);s.r=t["!row"];var o=e.read_shift(1),c=[s,o,"e"];if(t.cellFormula){e.l+=2;var u=hu(e,n-e.l,t);c[3]=un(u,null,s,t.supbooks,t)}else e.l=n;return c}function hA(e,r,t){var n=e.l+r,s=ms(e);s.r=t["!row"];var o=hn(e),c=[s,o,"n"];if(t.cellFormula){e.l+=2;var u=hu(e,n-e.l,t);c[3]=un(u,null,s,t.supbooks,t)}else e.l=n;return c}function xA(e,r,t){var n=e.l+r,s=ms(e);s.r=t["!row"];var o=xn(e),c=[s,o,"str"];if(t.cellFormula){e.l+=2;var u=hu(e,n-e.l,t);c[3]=un(u,null,s,t.supbooks,t)}else e.l=n;return c}var mA=Mi,pA=Ml;function gA(e,r){return r==null&&(r=Ee(4)),r.write_shift(4,e),r}function vA(e,r){var t=e.l+r,n=Mi(e),s=gh(e),o=xn(e),c=xn(e),u=xn(e);e.l=t;var d={rfx:n,relId:s,loc:o,display:u};return c&&(d.Tooltip=c),d}function yA(e,r){var t=Ee(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ml({s:cr(e[0]),e:cr(e[0])},t),vh("rId"+r,t);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Kr(s||"",t),Kr(e[1].Tooltip||"",t),Kr("",t),t.slice(0,t.l)}function bA(){}function wA(e,r,t){var n=e.l+r,s=Ov(e),o=e.read_shift(1),c=[s];if(c[2]=o,t.cellFormula){var u=V5(e,n-e.l,t);c[1]=u}else e.l=n;return c}function _A(e,r,t){var n=e.l+r,s=Mi(e),o=[s];if(t.cellFormula){var c=X5(e,n-e.l,t);o[1]=c,e.l=n}else e.l=n;return o}function kA(e,r,t){t==null&&(t=Ee(18));var n=xu(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var s=0;return r.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),r.level&&(s|=r.level<<8),t.write_shift(2,s),t}var Py=["left","right","top","bottom","header","footer"];function NA(e){var r={};return Py.forEach(function(t){r[t]=hn(e)}),r}function SA(e,r){return r==null&&(r=Ee(48)),Ni(e),Py.forEach(function(t){Ci(e[t],r)}),r}function EA(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function jA(e,r,t){t==null&&(t=Ee(30));var n=924;return(((r||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function CA(e){var r=Ee(24);return r.write_shift(4,4),r.write_shift(4,1),Ml(e,r),r}function TA(e,r){return r==null&&(r=Ee(66)),r.write_shift(2,e.password?Sh(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function FA(){}function AA(){}function OA(e,r,t,n,s,o,c){if(!e)return e;var u=r||{};n||(n={"!id":{}});var d=u.dense?[]:{},h,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,y=!1,k,b,v,w,S,I,N,P,W,X=[];u.biff=12,u["!row"]=0;var M=0,Z=!1,H=[],ce={},le=u.supbooks||s.supbooks||[[]];if(le.sharedf=ce,le.arrayf=H,le.SheetNames=s.SheetNames||s.Sheets.map(function(ne){return ne.name}),!u.supbooks&&(u.supbooks=le,s.Names))for(var re=0;re<s.Names.length;++re)le[0][re+1]=s.Names[re];var te=[],ve=[],Se=!1;Zo[16]={n:"BrtShortReal",f:Ry};var Ce;if(ga(e,function(A,me,z){if(!y)switch(z){case 148:h=A;break;case 0:k=A,u.sheetRows&&u.sheetRows<=k.r&&(y=!0),P=wr(w=k.r),u["!row"]=k.r,(A.hidden||A.hpt||A.level!=null)&&(A.hpt&&(A.hpx=Tl(A.hpt)),ve[A.r]=A);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:A[2]},A[2]){case"n":b.v=A[1];break;case"s":N=Ro[A[1]],b.v=N.t,b.r=N.r;break;case"b":b.v=!!A[1];break;case"e":b.v=A[1],u.cellText!==!1&&(b.w=va[b.v]);break;case"str":b.t="s",b.v=A[1];break;case"is":b.t="s",b.v=A[1].t;break}if((v=c.CellXf[A[0].iStyleRef])&&Oy(b,v.numFmtId,null,u,o,c),S=A[0].c==-1?S+1:A[0].c,u.dense?(d[w]||(d[w]=[]),d[w][S]=b):d[or(S)+P]=b,u.cellFormula){for(Z=!1,M=0;M<H.length;++M){var T=H[M];k.r>=T[0].s.r&&k.r<=T[0].e.r&&S>=T[0].s.c&&S<=T[0].e.c&&(b.F=gt(T[0]),Z=!0)}!Z&&A.length>3&&(b.f=A[3])}if(m.s.r>k.r&&(m.s.r=k.r),m.s.c>S&&(m.s.c=S),m.e.r<k.r&&(m.e.r=k.r),m.e.c<S&&(m.e.c=S),u.cellDates&&v&&b.t=="n"&&Il(lt[v.numFmtId])){var Q=yi(b.v);Q&&(b.t="d",b.v=new Date(Q.y,Q.m-1,Q.d,Q.H,Q.M,Q.S,Q.u))}Ce&&(Ce.type=="XLDAPR"&&(b.D=!0),Ce=void 0);break;case 1:case 12:if(!u.sheetStubs||p)break;b={t:"z",v:void 0},S=A[0].c==-1?S+1:A[0].c,u.dense?(d[w]||(d[w]=[]),d[w][S]=b):d[or(S)+P]=b,m.s.r>k.r&&(m.s.r=k.r),m.s.c>S&&(m.s.c=S),m.e.r<k.r&&(m.e.r=k.r),m.e.c<S&&(m.e.c=S),Ce&&(Ce.type=="XLDAPR"&&(b.D=!0),Ce=void 0);break;case 176:X.push(A);break;case 49:Ce=((u.xlmeta||{}).Cell||[])[A-1];break;case 494:var Y=n["!id"][A.relId];for(Y?(A.Target=Y.Target,A.loc&&(A.Target+="#"+A.loc),A.Rel=Y):A.relId==""&&(A.Target="#"+A.loc),w=A.rfx.s.r;w<=A.rfx.e.r;++w)for(S=A.rfx.s.c;S<=A.rfx.e.c;++S)u.dense?(d[w]||(d[w]=[]),d[w][S]||(d[w][S]={t:"z",v:void 0}),d[w][S].l=A):(I=ot({c:S,r:w}),d[I]||(d[I]={t:"z",v:void 0}),d[I].l=A);break;case 426:if(!u.cellFormula)break;H.push(A),W=u.dense?d[w][S]:d[or(S)+P],W.f=un(A[1],m,{r:k.r,c:S},le,u),W.F=gt(A[0]);break;case 427:if(!u.cellFormula)break;ce[ot(A[0].s)]=A[1],W=u.dense?d[w][S]:d[or(S)+P],W.f=un(A[1],m,{r:k.r,c:S},le,u);break;case 60:if(!u.cellStyles)break;for(;A.e>=A.s;)te[A.e--]={width:A.w/256,hidden:!!(A.flags&1),level:A.level},Se||(Se=!0,Eh(A.w/256)),Wa(te[A.e+1]);break;case 161:d["!autofilter"]={ref:gt(A)};break;case 476:d["!margins"]=A;break;case 147:s.Sheets[t]||(s.Sheets[t]={}),A.name&&(s.Sheets[t].CodeName=A.name),(A.above||A.left)&&(d["!outline"]={above:A.above,left:A.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),A.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!me.T){if(!p||u.WTF)throw new Error("Unexpected record 0x"+z.toString(16))}}},u),delete u.supbooks,delete u["!row"],!d["!ref"]&&(m.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(d["!ref"]=gt(h||m)),u.sheetRows&&d["!ref"]){var ue=Ot(d["!ref"]);u.sheetRows<=+ue.e.r&&(ue.e.r=u.sheetRows-1,ue.e.r>m.e.r&&(ue.e.r=m.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>m.e.c&&(ue.e.c=m.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),d["!fullref"]=d["!ref"],d["!ref"]=gt(ue))}return X.length>0&&(d["!merges"]=X),te.length>0&&(d["!cols"]=te),ve.length>0&&(d["!rows"]=ve),d}function DA(e,r,t,n,s,o,c){if(r.v===void 0)return!1;var u="";switch(r.t){case"b":u=r.v?"1":"0";break;case"d":r=er(r),r.z=r.z||lt[14],r.v=Lr(Zt(r.v)),r.t="n";break;case"n":case"e":u=""+r.v;break;default:u=r.v;break}var d={r:t,c:n};switch(d.s=Ja(s.cellXfs,r,s),r.l&&o["!links"].push([ot(d),r.l]),r.c&&o["!comments"].push([ot(d),r.c]),r.t){case"s":case"str":return s.bookSST?(u=Ah(s.Strings,r.v,s.revStrings),d.t="s",d.v=u,c?De(e,18,QF(r,d)):De(e,7,YF(r,d))):(d.t="str",c?De(e,17,uA(r,d)):De(e,6,oA(r,d))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?c?De(e,13,aA(r,d)):De(e,2,nA(r,d)):c?De(e,16,tA(r,d)):De(e,5,eA(r,d)),!0;case"b":return d.t="b",c?De(e,15,WF(r,d)):De(e,4,$F(r,d)),!0;case"e":return d.t="e",c?De(e,14,GF(r,d)):De(e,3,qF(r,d)),!0}return c?De(e,12,UF(r,d)):De(e,1,LF(r,d)),!0}function IA(e,r,t,n){var s=Ot(r["!ref"]||"A1"),o,c="",u=[];De(e,145);var d=Array.isArray(r),h=s.e.r;r["!rows"]&&(h=Math.max(s.e.r,r["!rows"].length-1));for(var m=s.s.r;m<=h;++m){c=wr(m),AF(e,r,s,m);var p=!1;if(m<=s.e.r)for(var y=s.s.c;y<=s.e.c;++y){m===s.s.r&&(u[y]=or(y)),o=u[y]+c;var k=d?(r[m]||[])[y]:r[o];if(!k){p=!1;continue}p=DA(e,k,m,y,n,r,p)}}De(e,146)}function RA(e,r){!r||!r["!merges"]||(De(e,177,gA(r["!merges"].length)),r["!merges"].forEach(function(t){De(e,176,pA(t))}),De(e,178))}function PA(e,r){!r||!r["!cols"]||(De(e,390),r["!cols"].forEach(function(t,n){t&&De(e,60,kA(n,t))}),De(e,391))}function MA(e,r){!r||!r["!ref"]||(De(e,648),De(e,649,CA(Ot(r["!ref"]))),De(e,650))}function LA(e,r,t){r["!links"].forEach(function(n){if(n[1].Target){var s=$t(t,-1,n[1].Target.replace(/#.*$/,""),St.HLINK);De(e,494,yA(n,s))}}),delete r["!links"]}function BA(e,r,t,n){if(r["!comments"].length>0){var s=$t(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",St.VML);De(e,551,vh("rId"+s)),r["!legacy"]=s}}function UA(e,r,t,n){if(r["!autofilter"]){var s=r["!autofilter"],o=typeof s.ref=="string"?s.ref:gt(s.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var c=t.Workbook.Names,u=Ln(o);u.s.r==u.e.r&&(u.e.r=Ln(r["!ref"]).e.r,o=gt(u));for(var d=0;d<c.length;++d){var h=c[d];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+t.SheetNames[n]+"'!"+o;break}}d==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+o}),De(e,161,Ml(Ot(o))),De(e,162)}}function zA(e,r,t){De(e,133),De(e,137,jA(r,t)),De(e,138),De(e,134)}function $A(e,r){r["!protect"]&&De(e,535,TA(r["!protect"]))}function HA(e,r,t,n){var s=Mn(),o=t.SheetNames[e],c=t.Sheets[o]||{},u=o;try{t&&t.Workbook&&(u=t.Workbook.Sheets[e].CodeName||u)}catch{}var d=Ot(c["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(r.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return c["!links"]=[],c["!comments"]=[],De(s,129),(t.vbaraw||c["!outline"])&&De(s,147,PF(u,c["!outline"])),De(s,148,DF(d)),zA(s,c,t.Workbook),PA(s,c),IA(s,c,e,r),$A(s,c),UA(s,c,t,e),RA(s,c),LA(s,c,n),c["!margins"]&&De(s,476,SA(c["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&MA(s,c),BA(s,c,e,n),De(s,130),s.end()}function WA(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var c=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(r[+c[1]]=t?+c[2]:c[2])});var s=At((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[r,s,n]}function VA(e,r,t,n,s,o){var c=o||{"!type":"chart"};if(!e)return o;var u=0,d=0,h="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var y=WA(p);m.s.r=m.s.c=0,m.e.c=u,h=or(u),y[0].forEach(function(k,b){c[h+wr(b)]={t:"n",v:k,z:y[1]},d=b}),m.e.r<d&&(m.e.r=d),++u}),u>0&&(c["!ref"]=gt(m)),c}function qA(e,r,t,n,s){if(!e)return e;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c,u=e.match(Dy);return u&&Oh(u[0],o,s,t),(c=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=c[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function XA(e,r){e.l+=10;var t=xn(e);return{name:t}}function GA(e,r,t,n,s){if(!e)return e;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c=!1;return ga(e,function(d,h,m){switch(m){case 550:o["!rel"]=d;break;case 651:s.Sheets[t]||(s.Sheets[t]={}),d.name&&(s.Sheets[t].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!c||r.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},r),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var Dh=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],KA=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],YA=[],JA=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Lg(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],s=0;s!=r.length;++s){var o=r[s];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=Qt(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function Bg(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Qt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function My(e){Bg(e.WBProps,Dh),Bg(e.CalcPr,JA),Lg(e.WBView,KA),Lg(e.Sheets,YA),_l.date1904=Qt(e.WBProps.date1904)}function QA(e){return!e.Workbook||!e.Workbook.WBProps?"false":Qt(e.Workbook.WBProps.date1904)?"true":"false"}var ZA="][*?/\\".split("");function Ly(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return ZA.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function e8(e,r,t){e.forEach(function(n,s){Ly(n);for(var o=0;o<s;++o)if(n==e[o])throw new Error("Duplicate Sheet Name: "+n);if(t){var c=r&&r[s]&&r[s].CodeName||n;if(c.charCodeAt(0)==95&&c.length>22)throw new Error("Bad Code Name: Worksheet"+c)}})}function t8(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];e8(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)Q5(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}var r8=/<\w+:workbook/;function n8(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",o={},c=0;if(e.replace(pn,function(d,h){var m=ct(d);switch(Gs(m[0])){case"<?xml":break;case"<workbook":d.match(r8)&&(s="xmlns"+d.match(/<(\w+):/)[1]),t.xmlns=m[s];break;case"</workbook>":break;case"<fileVersion":delete m[0],t.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Dh.forEach(function(p){if(m[p[0]]!=null)switch(p[2]){case"bool":t.WBProps[p[0]]=Qt(m[p[0]]);break;case"int":t.WBProps[p[0]]=parseInt(m[p[0]],10);break;default:t.WBProps[p[0]]=m[p[0]]}}),m.codeName&&(t.WBProps.CodeName=Wt(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],t.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=At(Wt(m.name)),delete m[0],t.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=Wt(m.name),m.comment&&(o.Comment=m.comment),m.localSheetId&&(o.Sheet=+m.localSheetId),Qt(m.hidden||"0")&&(o.Hidden=!0),c=h+d.length;break;case"</definedName>":o.Ref=At(Wt(e.slice(c,h))),t.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete m[0],t.CalcPr=m;break;case"<calcPr/>":delete m[0],t.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return d}),Di.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return My(t),t}function By(e){var r=[kr];r[r.length]=$e("workbook",null,{xmlns:Di[0],"xmlns:r":Mr.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Dh.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),r[r.length]=$e("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],o=0;if(s&&s[0]&&s[0].Hidden){for(r[r.length]="<bookViews>",o=0;o!=e.SheetNames.length&&!(!s[o]||!s[o].Hidden);++o);o==e.SheetNames.length&&(o=0),r[r.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var c={name:Ht(e.SheetNames[o].slice(0,31))};if(c.sheetId=""+(o+1),c["r:id"]="rId"+(o+1),s[o])switch(s[o].Hidden){case 1:c.state="hidden";break;case 2:c.state="veryHidden";break}r[r.length]=$e("sheet",null,c)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var d={name:u.Name};u.Comment&&(d.comment=u.Comment),u.Sheet!=null&&(d.localSheetId=""+u.Sheet),u.Hidden&&(d.hidden="1"),u.Ref&&(r[r.length]=$e("definedName",Ht(u.Ref),d))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function s8(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Dd(e),t.name=xn(e),t}function a8(e,r){return r||(r=Ee(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),vh(e.strRelID,r),Kr(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function i8(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var s=r>8?xn(e):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function l8(e,r){r||(r=Ee(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),Fv(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function o8(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function c8(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var s=e.read_shift(4),o=BE(e),c=q5(e,0,t),u=gh(e);e.l=n;var d={Name:o,Ptg:c};return s<268435455&&(d.Sheet=s),u&&(d.Comment=u),d}function u8(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;r||(r={}),r.biff=12;var o=[],c=[[]];return c.SheetNames=[],c.XTI=[],Zo[16]={n:"BrtFRTArchID$",f:o8},ga(e,function(d,h,m){switch(m){case 156:c.SheetNames.push(d.name),t.Sheets.push(d);break;case 153:t.WBProps=d;break;case 39:d.Sheet!=null&&(r.SID=d.Sheet),d.Ref=un(d.Ptg,null,null,c,r),delete r.SID,delete d.Ptg,o.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([m,d]):c[0]=[m,d],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(d),c.XTI=c.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(m),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(m),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!h.T){if(!s||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},r),My(t),t.Names=o,t.supbooks=c,t}function f8(e,r){De(e,143);for(var t=0;t!=r.SheetNames.length;++t){var n=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,s={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};De(e,156,a8(s))}De(e,144)}function d8(e,r){r||(r=Ee(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return Kr("SheetJS",r),Kr(L0.version,r),Kr(L0.version,r),Kr("7262",r),r.length>r.l?r.slice(0,r.l):r}function h8(e,r){r||(r=Ee(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function x8(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,n=0,s=-1,o=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&s==-1?s=n:t[n].Hidden==1&&o==-1&&(o=n);o>s||(De(e,135),De(e,158,h8(s)),De(e,136))}}function m8(e,r){var t=Mn();return De(t,131),De(t,128,d8()),De(t,153,l8(e.Workbook&&e.Workbook.WBProps||null)),x8(t,e),f8(t,e),De(t,132),t.end()}function p8(e,r,t){return r.slice(-4)===".bin"?u8(e,t):n8(e,t)}function g8(e,r,t,n,s,o,c,u){return r.slice(-4)===".bin"?OA(e,n,t,s,o,c,u):cF(e,n,t,s,o,c,u)}function v8(e,r,t,n,s,o,c,u){return r.slice(-4)===".bin"?GA(e,n,t,s,o):qA(e,n,t,s,o)}function y8(e,r,t,n,s,o,c,u){return r.slice(-4)===".bin"?w6():_6()}function b8(e,r,t,n,s,o,c,u){return r.slice(-4)===".bin"?y6():b6()}function w8(e,r,t,n){return r.slice(-4)===".bin"?pT(e,t,n):sT(e,t,n)}function _8(e,r,t){return yy(e,t)}function k8(e,r,t){return r.slice(-4)===".bin"?kC(e,t):bC(e,t)}function N8(e,r,t){return r.slice(-4)===".bin"?x6(e,t):a6(e,t)}function S8(e,r,t){return r.slice(-4)===".bin"?r6(e):e6(e)}function E8(e,r,t,n){return t.slice(-4)===".bin"?n6(e,r,t,n):void 0}function j8(e,r,t){return r.slice(-4)===".bin"?JT(e,r,t):ZT(e,r,t)}function C8(e,r,t){return(r.slice(-4)===".bin"?m8:By)(e)}function T8(e,r,t,n,s){return(r.slice(-4)===".bin"?HA:Iy)(e,t,n,s)}function F8(e,r,t){return(r.slice(-4)===".bin"?ET:gy)(e,t)}function A8(e,r,t){return(r.slice(-4)===".bin"?EC:cy)(e,t)}function O8(e,r,t){return(r.slice(-4)===".bin"?m6:_y)(e)}function D8(e){return(e.slice(-4)===".bin"?QT:by)()}var Uy=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,zy=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function js(e,r){var t=e.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var s=e.match(Uy),o,c,u,d;if(s)for(d=0;d!=s.length;++d)o=s[d].match(zy),(c=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(c+1),n[u]=o[2].slice(1,o[2].length-1));return n}function I8(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(Uy),s,o,c,u;if(n)for(u=0;u!=n.length;++u)s=n[u].match(zy),(o=s[1].indexOf(":"))===-1?t[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(o+1),t[c]=s[2].slice(1,s[2].length-1));return t}var Mo;function R8(e,r){var t=Mo[e]||At(e);return t==="General"?Ei(r):hs(t,r)}function P8(e,r,t,n){var s=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Qt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Zt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[At(r)]=s}function M8(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||va[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wo(e.v):e.w=Ei(e.v):e.w=R8(r||"General",e.v)}catch(o){if(t.WTF)throw o}try{var n=Mo[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&Il(n)){var s=yi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(o){if(t.WTF)throw o}}}function L8(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=YC[n.Pattern]||n.Pattern)}e[r.ID]=r}function B8(e,r,t,n,s,o,c,u,d,h){var m="General",p=n.StyleID,y={};h=h||{};var k=[],b=0;for(p===void 0&&u&&(p=u.StyleID),p===void 0&&c&&(p=c.StyleID);o[p]!==void 0&&(o[p].nf&&(m=o[p].nf),o[p].Interior&&k.push(o[p].Interior),!!o[p].Parent);)p=o[p].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=Qt(e);break;case"String":n.t="s",n.r=rg(At(e)),n.v=e.indexOf("<")>-1?At(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Zt(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=At(e):n.v<60&&(n.v=n.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Rv[e],h.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=rg(r||e));break}if(M8(n,m,h),h.cellFormula!==!1)if(n.Formula){var v=At(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=wl(v,s),delete n.Formula,n.ArrayRange=="RC"?n.F=wl("RC:RC",s):n.ArrayRange&&(n.F=wl(n.ArrayRange,s),d.push([Ot(n.F),n.F]))}else for(b=0;b<d.length;++b)s.r>=d[b][0].s.r&&s.r<=d[b][0].e.r&&s.c>=d[b][0].s.c&&s.c<=d[b][0].e.c&&(n.F=d[b][1]);h.cellStyles&&(k.forEach(function(w){!y.patternType&&w.patternType&&(y.patternType=w.patternType)}),n.s=y),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function U8(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function gd(e,r){var t=r||{};Rl();var n=Eo(fh(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=Wt(n));var s=n.slice(0,1024).toLowerCase(),o=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var c=er(t);return c.type="string",Cl.to_workbook(n,c)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(jt){s.indexOf("<"+jt)>=0&&(o=!0)}),o)return SO(n,t);Mo={"General Number":"General","General Date":lt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":lt[15],"Short Date":lt[14],"Long Time":lt[19],"Medium Time":lt[18],"Short Time":lt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:lt[2],Standard:lt[4],Percent:lt[10],Scientific:lt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,d=[],h,m={},p=[],y=t.dense?[]:{},k="",b={},v={},w=js('<Data ss:Type="String">'),S=0,I=0,N=0,P={s:{r:2e6,c:2e6},e:{r:0,c:0}},W={},X={},M="",Z=0,H=[],ce={},le={},re=0,te=[],ve=[],Se={},Ce=[],ue,ne=!1,A=[],me=[],z={},T=0,Q=0,Y={Sheets:[],WBProps:{date1904:!1}},J={};Xo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";u=Xo.exec(n);)switch(u[3]=(K=u[3]).toLowerCase()){case"data":if(K=="data"){if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break}if(d[d.length-1][1])break;u[1]==="/"?B8(n.slice(S,u.index),M,w,d[d.length-1][0]=="comment"?Se:b,{c:I,r:N},W,Ce[I],v,A,t):(M="",w=js(u[0]),S=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(ve.length>0&&(b.c=ve),(!t.sheetRows||t.sheetRows>N)&&b.v!==void 0&&(t.dense?(y[N]||(y[N]=[]),y[N][I]=b):y[or(I)+wr(N)]=b),b.HRef&&(b.l={Target:At(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(T=I+(parseInt(b.MergeAcross,10)|0),Q=N+(parseInt(b.MergeDown,10)|0),H.push({s:{c:I,r:N},e:{c:T,r:Q}})),!t.sheetStubs)b.MergeAcross?I=T+1:++I;else if(b.MergeAcross||b.MergeDown){for(var fe=I;fe<=T;++fe)for(var we=N;we<=Q;++we)(fe>I||we>N)&&(t.dense?(y[we]||(y[we]=[]),y[we][fe]={t:"z"}):y[or(fe)+wr(we)]={t:"z"});I=T+1}else++I;else b=I8(u[0]),b.Index&&(I=+b.Index-1),I<P.s.c&&(P.s.c=I),I>P.e.c&&(P.e.c=I),u[0].slice(-2)==="/>"&&++I,ve=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(N<P.s.r&&(P.s.r=N),N>P.e.r&&(P.e.r=N),u[0].slice(-2)==="/>"&&(v=js(u[0]),v.Index&&(N=+v.Index-1)),I=0,++N):(v=js(u[0]),v.Index&&(N=+v.Index-1),z={},(v.AutoFitHeight=="0"||v.Height)&&(z.hpx=parseInt(v.Height,10),z.hpt=Qo(z.hpx),me[N]=z),v.Hidden=="1"&&(z.hidden=!0,me[N]=z));break;case"worksheet":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));p.push(k),P.s.r<=P.e.r&&P.s.c<=P.e.c&&(y["!ref"]=gt(P),t.sheetRows&&t.sheetRows<=P.e.r&&(y["!fullref"]=y["!ref"],P.e.r=t.sheetRows-1,y["!ref"]=gt(P))),H.length&&(y["!merges"]=H),Ce.length>0&&(y["!cols"]=Ce),me.length>0&&(y["!rows"]=me),m[k]=y}else P={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=I=0,d.push([u[3],!1]),h=js(u[0]),k=At(h.Name),y=t.dense?[]:{},H=[],A=[],me=[],J={name:k,Hidden:0},Y.Sheets.push(J);break;case"table":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else{if(u[0].slice(-2)=="/>")break;d.push([u[3],!1]),Ce=[],ne=!1}break;case"style":u[1]==="/"?L8(W,X,t):X=js(u[0]);break;case"numberformat":X.nf=At(js(u[0]).Format||"General"),Mo[X.nf]&&(X.nf=Mo[X.nf]);for(var ye=0;ye!=392&&lt[ye]!=X.nf;++ye);if(ye==392){for(ye=57;ye!=392;++ye)if(lt[ye]==null){da(X.nf,ye);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(ue=js(u[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!ne&&ue.wpx>10){ne=!0,fn=my;for(var je=0;je<Ce.length;++je)Ce[je]&&Wa(Ce[je])}ne&&Wa(ue),Ce[ue.Index-1||Ce.length]=ue;for(var Xe=0;Xe<+ue.Span;++Xe)Ce[Ce.length]=er(ue);break;case"namedrange":if(u[1]==="/")break;Y.Names||(Y.Names=[]);var D=ct(u[0]),Pe={Name:D.Name,Ref:wl(D.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(Pe.Sheet=Y.Sheets.length-1),Y.Names.push(Pe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?M+=n.slice(Z,u.index):Z=u.index+u[0].length;break;case"interior":if(!t.cellStyles)break;X.Interior=js(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?u3(ce,K,n.slice(re,u.index)):re=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else d.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));U8(Se),ve.push(Se)}else d.push([u[3],!1]),h=js(u[0]),Se={a:h.Author};break;case"autofilter":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var rt=js(u[0]);y["!autofilter"]={ref:wl(rt.Range).replace(/\$/g,"")},d.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"null":break;default:if(d.length==0&&u[3]=="document"||d.length==0&&u[3]=="uof")return Wg(n,t);var xt=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:xt=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:xt=!1}break;case"excelworkbook":switch(u[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:xt=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:xt=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(re,u.index)){case"SheetHidden":J.Hidden=1;break;case"SheetVeryHidden":J.Hidden=2;break}else re=u.index+u[0].length;break;case"header":y["!margins"]||Ni(y["!margins"]={},"xlml"),isNaN(+ct(u[0]).Margin)||(y["!margins"].header=+ct(u[0]).Margin);break;case"footer":y["!margins"]||Ni(y["!margins"]={},"xlml"),isNaN(+ct(u[0]).Margin)||(y["!margins"].footer=+ct(u[0]).Margin);break;case"pagemargins":var nt=ct(u[0]);y["!margins"]||Ni(y["!margins"]={},"xlml"),isNaN(+nt.Top)||(y["!margins"].top=+nt.Top),isNaN(+nt.Left)||(y["!margins"].left=+nt.Left),isNaN(+nt.Right)||(y["!margins"].right=+nt.Right),isNaN(+nt.Bottom)||(y["!margins"].bottom=+nt.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:xt=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:xt=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:xt=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:xt=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:xt=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:xt=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:xt=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:xt=!1}break;case"smarttags":break;default:xt=!1;break}if(xt||u[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?P8(le,K,te,n.slice(re,u.index)):(te=u,re=u.index+u[0].length);break}if(t.WTF)throw"Unrecognized tag: "+u[3]+"|"+d.join("|")}var Le={};return!t.bookSheets&&!t.bookProps&&(Le.Sheets=m),Le.SheetNames=p,Le.Workbook=Y,Le.SSF=er(lt),Le.Props=ce,Le.Custprops=le,Le}function Ud(e,r){switch(Rh(r=r||{}),r.type||"base64"){case"base64":return gd(Jn(e),r);case"binary":case"buffer":case"file":return gd(e,r);case"array":return gd(Ka(e),r)}}function z8(e,r){var t=[];return e.Props&&t.push(f3(e.Props,r)),e.Custprops&&t.push(d3(e.Props,e.Custprops)),t.join("")}function $8(){return""}function H8(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(n,s){var o=[];o.push($e("NumberFormat",null,{"ss:Format":Ht(lt[n.numFmtId])}));var c={"ss:ID":"s"+(21+s)};t.push($e("Style",o.join(""),c))}),$e("Styles",t.join(""))}function $y(e){return $e("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Th(e.Ref,{r:0,c:0})})}function W8(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],n=0;n<r.length;++n){var s=r[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||t.push($y(s)))}return $e("Names",t.join(""))}function V8(e,r,t,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,o=[],c=0;c<s.length;++c){var u=s[c];u.Sheet==t&&(u.Name.match(/^_xlfn\./)||o.push($y(u)))}return o.join("")}function q8(e,r,t,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push($e("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push($e("Footer",null,{"x:Margin":e["!margins"].footer})),s.push($e("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)s.push($e("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<t&&!(n.Workbook.Sheets[o]&&!n.Workbook.Sheets[o].Hidden);++o);o==t&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(rn("ProtectContents","True")),e["!protect"].objects&&s.push(rn("ProtectObjects","True")),e["!protect"].scenarios&&s.push(rn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(rn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(rn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(c){e["!protect"][c[0]]&&s.push("<"+c[1]+"/>")})),s.length==0?"":$e("WorksheetOptions",s.join(""),{xmlns:Xn.x})}function X8(e){return e.map(function(r){var t=xE(r.t||""),n=$e("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return $e("Comment",n,{"ss:Author":r.a})}).join("")}function G8(e,r,t,n,s,o,c){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+Ht(Th(e.f,c))),e.F&&e.F.slice(0,r.length)==r){var d=cr(e.F.slice(r.length+1));u["ss:ArrayRange"]="RC:R"+(d.r==c.r?"":"["+(d.r-c.r)+"]")+"C"+(d.c==c.c?"":"["+(d.c-c.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=Ht(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=Ht(e.l.Tooltip))),t["!merges"])for(var h=t["!merges"],m=0;m!=h.length;++m)h[m].s.c!=c.c||h[m].s.r!=c.r||(h[m].e.c>h[m].s.c&&(u["ss:MergeAcross"]=h[m].e.c-h[m].s.c),h[m].e.r>h[m].s.r&&(u["ss:MergeDown"]=h[m].e.r-h[m].s.r));var p="",y="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",y=String(e.v);break;case"b":p="Boolean",y=e.v?"1":"0";break;case"e":p="Error",y=va[e.v];break;case"d":p="DateTime",y=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||lt[14]);break;case"s":p="String",y=hE(e.v||"");break}var k=Ja(n.cellXfs,e,n);u["ss:StyleID"]="s"+(21+k),u["ss:Index"]=c.c+1;var b=e.v!=null?y:"",v=e.t=="z"?"":'<Data ss:Type="'+p+'">'+b+"</Data>";return(e.c||[]).length>0&&(v+=X8(e.c)),$e("Cell",v,u)}function K8(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Tl(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function Y8(e,r,t,n){if(!e["!ref"])return"";var s=Ot(e["!ref"]),o=e["!merges"]||[],c=0,u=[];e["!cols"]&&e["!cols"].forEach(function(w,S){Wa(w);var I=!!w.width,N=xu(S,w),P={"ss:Index":S+1};I&&(P["ss:Width"]=Yo(N.width)),w.hidden&&(P["ss:Hidden"]="1"),u.push($e("Column",null,P))});for(var d=Array.isArray(e),h=s.s.r;h<=s.e.r;++h){for(var m=[K8(h,(e["!rows"]||[])[h])],p=s.s.c;p<=s.e.c;++p){var y=!1;for(c=0;c!=o.length;++c)if(!(o[c].s.c>p)&&!(o[c].s.r>h)&&!(o[c].e.c<p)&&!(o[c].e.r<h)){(o[c].s.c!=p||o[c].s.r!=h)&&(y=!0);break}if(!y){var k={r:h,c:p},b=ot(k),v=d?(e[h]||[])[p]:e[b];m.push(G8(v,b,e,r,t,n,k))}}m.push("</Row>"),m.length>2&&u.push(m.join(""))}return u.join("")}function J8(e,r,t){var n=[],s=t.SheetNames[e],o=t.Sheets[s],c=o?V8(o,r,e,t):"";return c.length>0&&n.push("<Names>"+c+"</Names>"),c=o?Y8(o,r,e,t):"",c.length>0&&n.push("<Table>"+c+"</Table>"),n.push(q8(o,r,e,t)),n.join("")}function Q8(e,r){r||(r={}),e.SSF||(e.SSF=er(lt)),e.SSF&&(Rl(),lu(e.SSF),r.revssf=cu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],Ja(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(z8(e,r)),t.push($8()),t.push(""),t.push("");for(var n=0;n<e.SheetNames.length;++n)t.push($e("Worksheet",J8(n,r,e),{"ss:Name":Ht(e.SheetNames[n])}));return t[2]=H8(e,r),t[3]=W8(e),kr+$e("Workbook",t.join(""),{xmlns:Xn.ss,"xmlns:o":Xn.o,"xmlns:x":Xn.x,"xmlns:ss":Xn.ss,"xmlns:dt":Xn.dt,"xmlns:html":Xn.html})}function Z8(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=WE(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=VE(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var eO=[60,1084,2066,2165,2175];function tO(e,r,t,n,s){var o=n,c=[],u=t.slice(t.l,t.l+o);if(s&&s.enc&&s.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(u)}c.push(u),t.l+=o;for(var d=ua(t,t.l),h=zd[d],m=0;h!=null&&eO.indexOf(d)>-1;)o=ua(t,t.l+2),m=t.l+4,d==2066?m+=4:(d==2165||d==2175)&&(m+=12),u=t.slice(m,t.l+4+o),c.push(u),t.l+=4+o,h=zd[d=ua(t,t.l)];var p=Gr(c);tn(p,0);var y=0;p.lens=[];for(var k=0;k<c.length;++k)p.lens.push(y),y+=c[k].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return r.f(p,p.length,s)}function $s(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=lt[n])}catch(o){if(r.WTF)throw o}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||va[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wo(e.v):e.w=Ei(e.v):e.w=hs(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(o){if(r.WTF)throw o}if(r.cellDates&&n&&e.t=="n"&&Il(lt[n]||String(n))){var s=yi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function F0(e,r,t){return{v:e,ixfe:r,t}}function rO(e,r){var t={opts:{}},n={},s=r.dense?[]:{},o={},c={},u=null,d=[],h="",m={},p,y="",k,b,v,w,S={},I=[],N,P,W=[],X=[],M={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Z={},H=function(Ze){return Ze<8?wi[Ze]:Ze<64&&X[Ze-8]||wi[Ze]},ce=function(Ze,qe,vt){var ht=qe.XF.data;if(!(!ht||!ht.patternType||!vt||!vt.cellStyles)){qe.s={},qe.s.patternType=ht.patternType;var qt;(qt=Ko(H(ht.icvFore)))&&(qe.s.fgColor={rgb:qt}),(qt=Ko(H(ht.icvBack)))&&(qe.s.bgColor={rgb:qt})}},le=function(Ze,qe,vt){if(!(z>1)&&!(vt.sheetRows&&Ze.r>=vt.sheetRows)){if(vt.cellStyles&&qe.XF&&qe.XF.data&&ce(Ze,qe,vt),delete qe.ixfe,delete qe.XF,p=Ze,y=ot(Ze),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),Ze.r<c.s.r&&(c.s.r=Ze.r),Ze.c<c.s.c&&(c.s.c=Ze.c),Ze.r+1>c.e.r&&(c.e.r=Ze.r+1),Ze.c+1>c.e.c&&(c.e.c=Ze.c+1),vt.cellFormula&&qe.f){for(var ht=0;ht<I.length;++ht)if(!(I[ht][0].s.c>Ze.c||I[ht][0].s.r>Ze.r)&&!(I[ht][0].e.c<Ze.c||I[ht][0].e.r<Ze.r)){qe.F=gt(I[ht][0]),(I[ht][0].s.c!=Ze.c||I[ht][0].s.r!=Ze.r)&&delete qe.f,qe.f&&(qe.f=""+un(I[ht][1],c,Ze,A,re));break}}vt.dense?(s[Ze.r]||(s[Ze.r]=[]),s[Ze.r][Ze.c]=qe):s[y]=qe}},re={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:I,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(re.password=r.password);var te,ve=[],Se=[],Ce=[],ue=[],ne=!1,A=[];A.SheetNames=re.snames,A.sharedf=re.sharedf,A.arrayf=re.arrayf,A.names=[],A.XTI=[];var me=0,z=0,T=0,Q=[],Y=[],J;re.codepage=1200,Ts(1200);for(var K=!1;e.l<e.length-1;){var fe=e.l,we=e.read_shift(2);if(we===0&&me===10)break;var ye=e.l===e.length?0:e.read_shift(2),je=zd[we];if(je&&je.f){if(r.bookSheets&&me===133&&we!==133)break;if(me=we,je.r===2||je.r==12){var Xe=e.read_shift(2);if(ye-=2,!re.enc&&Xe!==we&&((Xe&255)<<8|Xe>>8)!==we)throw new Error("rt mismatch: "+Xe+"!="+we);je.r==12&&(e.l+=10,ye-=10)}var D={};if(we===10?D=je.f(e,ye,re):D=tO(we,je,e,ye,re),z==0&&[9,521,1033,2057].indexOf(me)===-1)continue;switch(we){case 34:t.opts.Date1904=M.WBProps.date1904=D;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(re.enc||(e.l=0),re.enc=D,!r.password)throw new Error("File is password-protected");if(D.valid==null)throw new Error("Encryption scheme unsupported");if(!D.valid)throw new Error("Password is incorrect");break;case 92:re.lastuser=D;break;case 66:var Pe=Number(D);switch(Pe){case 21010:Pe=1200;break;case 32768:Pe=1e4;break;case 32769:Pe=1252;break}Ts(re.codepage=Pe),K=!0;break;case 317:re.rrtabid=D;break;case 25:re.winlocked=D;break;case 439:t.opts.RefreshAll=D;break;case 12:t.opts.CalcCount=D;break;case 16:t.opts.CalcDelta=D;break;case 17:t.opts.CalcIter=D;break;case 13:t.opts.CalcMode=D;break;case 14:t.opts.CalcPrecision=D;break;case 95:t.opts.CalcSaveRecalc=D;break;case 15:re.CalcRefMode=D;break;case 2211:t.opts.FullCalc=D;break;case 129:D.fDialog&&(s["!type"]="dialog"),D.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),D.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:W.push(D);break;case 430:A.push([D]),A[A.length-1].XTI=[];break;case 35:case 547:A[A.length-1].push(D);break;case 24:case 536:J={Name:D.Name,Ref:un(D.rgce,c,null,A,re)},D.itab>0&&(J.Sheet=D.itab-1),A.names.push(J),A[0]||(A[0]=[],A[0].XTI=[]),A[A.length-1].push(D),D.Name=="_xlnm._FilterDatabase"&&D.itab>0&&D.rgce&&D.rgce[0]&&D.rgce[0][0]&&D.rgce[0][0][0]=="PtgArea3d"&&(Y[D.itab-1]={ref:gt(D.rgce[0][0][1][2])});break;case 22:re.ExternCount=D;break;case 23:A.length==0&&(A[0]=[],A[0].XTI=[]),A[A.length-1].XTI=A[A.length-1].XTI.concat(D),A.XTI=A.XTI.concat(D);break;case 2196:if(re.biff<8)break;J!=null&&(J.Comment=D[1]);break;case 18:s["!protect"]=D;break;case 19:D!==0&&re.WTF&&console.error("Password verifier: "+D);break;case 133:o[D.pos]=D,re.snames.push(D.name);break;case 10:{if(--z)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,s["!ref"]=gt(c),r.sheetRows&&r.sheetRows<=c.e.r){var rt=c.e.r;c.e.r=r.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=gt(c),c.e.r=rt}c.e.r++,c.e.c++}ve.length>0&&(s["!merges"]=ve),Se.length>0&&(s["!objects"]=Se),Ce.length>0&&(s["!cols"]=Ce),ue.length>0&&(s["!rows"]=ue),M.Sheets.push(Z)}h===""?m=s:n[h]=s,s=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(re.biff===8&&(re.biff={9:2,521:3,1033:4}[we]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[D.BIFFVer]||8),re.biffguess=D.BIFFVer==0,D.BIFFVer==0&&D.dt==4096&&(re.biff=5,K=!0,Ts(re.codepage=28591)),re.biff==8&&D.BIFFVer==0&&D.dt==16&&(re.biff=2),z++)break;if(s=r.dense?[]:{},re.biff<8&&!K&&(K=!0,Ts(re.codepage=r.codepage||1252)),re.biff<5||D.BIFFVer==0&&D.dt==4096){h===""&&(h="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var xt={pos:e.l-ye,name:h};o[xt.pos]=xt,re.snames.push(h)}else h=(o[fe]||{name:""}).name;D.dt==32&&(s["!type"]="chart"),D.dt==64&&(s["!type"]="macro"),ve=[],Se=[],re.arrayf=I=[],Ce=[],ue=[],ne=!1,Z={Hidden:(o[fe]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(r.dense?(s[D.r]||[])[D.c]:s[ot({c:D.c,r:D.r})])&&++D.c,N={ixfe:D.ixfe,XF:W[D.ixfe]||{},v:D.val,t:"n"},T>0&&(N.z=Q[N.ixfe>>8&63]),$s(N,r,t.opts.Date1904),le({c:D.c,r:D.r},N,r);break;case 5:case 517:N={ixfe:D.ixfe,XF:W[D.ixfe],v:D.val,t:D.t},T>0&&(N.z=Q[N.ixfe>>8&63]),$s(N,r,t.opts.Date1904),le({c:D.c,r:D.r},N,r);break;case 638:N={ixfe:D.ixfe,XF:W[D.ixfe],v:D.rknum,t:"n"},T>0&&(N.z=Q[N.ixfe>>8&63]),$s(N,r,t.opts.Date1904),le({c:D.c,r:D.r},N,r);break;case 189:for(var nt=D.c;nt<=D.C;++nt){var Le=D.rkrec[nt-D.c][0];N={ixfe:Le,XF:W[Le],v:D.rkrec[nt-D.c][1],t:"n"},T>0&&(N.z=Q[N.ixfe>>8&63]),$s(N,r,t.opts.Date1904),le({c:nt,r:D.r},N,r)}break;case 6:case 518:case 1030:{if(D.val=="String"){u=D;break}if(N=F0(D.val,D.cell.ixfe,D.tt),N.XF=W[N.ixfe],r.cellFormula){var jt=D.formula;if(jt&&jt[0]&&jt[0][0]&&jt[0][0][0]=="PtgExp"){var Rt=jt[0][0][1][0],Bt=jt[0][0][1][1],bt=ot({r:Rt,c:Bt});S[bt]?N.f=""+un(D.formula,c,D.cell,A,re):N.F=((r.dense?(s[Rt]||[])[Bt]:s[bt])||{}).F}else N.f=""+un(D.formula,c,D.cell,A,re)}T>0&&(N.z=Q[N.ixfe>>8&63]),$s(N,r,t.opts.Date1904),le(D.cell,N,r),u=D}break;case 7:case 519:if(u)u.val=D,N=F0(D,u.cell.ixfe,"s"),N.XF=W[N.ixfe],r.cellFormula&&(N.f=""+un(u.formula,c,u.cell,A,re)),T>0&&(N.z=Q[N.ixfe>>8&63]),$s(N,r,t.opts.Date1904),le(u.cell,N,r),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{I.push(D);var fr=ot(D[0].s);if(k=r.dense?(s[D[0].s.r]||[])[D[0].s.c]:s[fr],r.cellFormula&&k){if(!u||!fr||!k)break;k.f=""+un(D[1],c,D[0],A,re),k.F=gt(D[0])}}break;case 1212:{if(!r.cellFormula)break;if(y){if(!u)break;S[ot(u.cell)]=D[0],k=r.dense?(s[u.cell.r]||[])[u.cell.c]:s[ot(u.cell)],(k||{}).f=""+un(D[0],c,p,A,re)}}break;case 253:N=F0(d[D.isst].t,D.ixfe,"s"),d[D.isst].h&&(N.h=d[D.isst].h),N.XF=W[N.ixfe],T>0&&(N.z=Q[N.ixfe>>8&63]),$s(N,r,t.opts.Date1904),le({c:D.c,r:D.r},N,r);break;case 513:r.sheetStubs&&(N={ixfe:D.ixfe,XF:W[D.ixfe],t:"z"},T>0&&(N.z=Q[N.ixfe>>8&63]),$s(N,r,t.opts.Date1904),le({c:D.c,r:D.r},N,r));break;case 190:if(r.sheetStubs)for(var kt=D.c;kt<=D.C;++kt){var Pt=D.ixfe[kt-D.c];N={ixfe:Pt,XF:W[Pt],t:"z"},T>0&&(N.z=Q[N.ixfe>>8&63]),$s(N,r,t.opts.Date1904),le({c:kt,r:D.r},N,r)}break;case 214:case 516:case 4:N=F0(D.val,D.ixfe,"s"),N.XF=W[N.ixfe],T>0&&(N.z=Q[N.ixfe>>8&63]),$s(N,r,t.opts.Date1904),le({c:D.c,r:D.r},N,r);break;case 0:case 512:z===1&&(c=D);break;case 252:d=D;break;case 1054:if(re.biff==4){Q[T++]=D[1];for(var Ut=0;Ut<T+163&&lt[Ut]!=D[1];++Ut);Ut>=163&&da(D[1],T+163)}else da(D[1],D[0]);break;case 30:{Q[T++]=D;for(var Mt=0;Mt<T+163&&lt[Mt]!=D;++Mt);Mt>=163&&da(D,T+163)}break;case 229:ve=ve.concat(D);break;case 93:Se[D.cmo[0]]=re.lastobj=D;break;case 438:re.lastobj.TxO=D;break;case 127:re.lastobj.ImData=D;break;case 440:for(w=D[0].s.r;w<=D[0].e.r;++w)for(v=D[0].s.c;v<=D[0].e.c;++v)k=r.dense?(s[w]||[])[v]:s[ot({c:v,r:w})],k&&(k.l=D[1]);break;case 2048:for(w=D[0].s.r;w<=D[0].e.r;++w)for(v=D[0].s.c;v<=D[0].e.c;++v)k=r.dense?(s[w]||[])[v]:s[ot({c:v,r:w})],k&&k.l&&(k.l.Tooltip=D[1]);break;case 28:{if(re.biff<=5&&re.biff>=2)break;k=r.dense?(s[D[0].r]||[])[D[0].c]:s[ot(D[0])];var Gt=Se[D[2]];k||(r.dense?(s[D[0].r]||(s[D[0].r]=[]),k=s[D[0].r][D[0].c]={t:"z"}):k=s[ot(D[0])]={t:"z"},c.e.r=Math.max(c.e.r,D[0].r),c.s.r=Math.min(c.s.r,D[0].r),c.e.c=Math.max(c.e.c,D[0].c),c.s.c=Math.min(c.s.c,D[0].c)),k.c||(k.c=[]),b={a:D[1],t:Gt.TxO.t},k.c.push(b)}break;case 2173:HT(W[D.ixfe],D.ext);break;case 125:{if(!re.cellStyles)break;for(;D.e>=D.s;)Ce[D.e--]={width:D.w/256,level:D.level||0,hidden:!!(D.flags&1)},ne||(ne=!0,Eh(D.w/256)),Wa(Ce[D.e+1])}break;case 520:{var Tt={};D.level!=null&&(ue[D.r]=Tt,Tt.level=D.level),D.hidden&&(ue[D.r]=Tt,Tt.hidden=!0),D.hpt&&(ue[D.r]=Tt,Tt.hpt=D.hpt,Tt.hpx=Tl(D.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Ni(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[we]]=D;break;case 161:s["!margins"]||Ni(s["!margins"]={}),s["!margins"].header=D.header,s["!margins"].footer=D.footer;break;case 574:D.RTL&&(M.Views[0].RTL=!0);break;case 146:X=D;break;case 2198:te=D;break;case 140:P=D;break;case 442:h?Z.CodeName=D||Z.name:M.WBProps.CodeName=D||"ThisWorkbook";break}}else je||console.error("Missing Info for XLS Record 0x"+we.toString(16)),e.l+=ye}return t.SheetNames=gr(o).sort(function(tr,Ze){return Number(tr)-Number(Ze)}).map(function(tr){return o[tr].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&m["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=m)):t.Preamble=m,t.Sheets&&Y.forEach(function(tr,Ze){t.Sheets[t.SheetNames[Ze]]["!autofilter"]=tr}),t.Strings=d,t.SSF=er(lt),re.enc&&(t.Encryption=re.enc),te&&(t.Themes=te),t.Metadata={},P!==void 0&&(t.Metadata.Country=P),A.names.length>0&&(M.Names=A.names),t.Workbook=M,t}var Lo={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function nO(e,r,t){var n=tt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=bg(n,Id,Lo.DSI);for(var o in s)r[o]=s[o]}catch(h){if(t.WTF)throw h}var c=tt.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var u=bg(c,Rd,Lo.SI);for(var d in u)r[d]==null&&(r[d]=u[d])}catch(h){if(t.WTF)throw h}r.HeadingPairs&&r.TitlesOfParts&&(zv(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function sO(e,r){var t=[],n=[],s=[],o=0,c,u=Yp(Id,"n"),d=Yp(Rd,"n");if(e.Props)for(c=gr(e.Props),o=0;o<c.length;++o)(Object.prototype.hasOwnProperty.call(u,c[o])?t:Object.prototype.hasOwnProperty.call(d,c[o])?n:s).push([c[o],e.Props[c[o]]]);if(e.Custprops)for(c=gr(e.Custprops),o=0;o<c.length;++o)Object.prototype.hasOwnProperty.call(e.Props||{},c[o])||(Object.prototype.hasOwnProperty.call(u,c[o])?t:Object.prototype.hasOwnProperty.call(d,c[o])?n:s).push([c[o],e.Custprops[c[o]]]);var h=[];for(o=0;o<s.length;++o)Gv.indexOf(s[o][0])>-1||Uv.indexOf(s[o][0])>-1||s[o][1]!=null&&h.push(s[o]);n.length&&tt.utils.cfb_add(r,"/SummaryInformation",wg(n,Lo.SI,d,Rd)),(t.length||h.length)&&tt.utils.cfb_add(r,"/DocumentSummaryInformation",wg(t,Lo.DSI,u,Id,h.length?h:null,Lo.UDI))}function Hy(e,r){r||(r={}),Rh(r),rh(),r.codepage&&th(r.codepage);var t,n;if(e.FullPaths){if(tt.find(e,"/encryption"))throw new Error("File is password-protected");t=tt.find(e,"!CompObj"),n=tt.find(e,"/Workbook")||tt.find(e,"/Book")}else{switch(r.type){case"base64":e=Kn(Jn(e));break;case"binary":e=Kn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}tn(e,0),n={content:e}}var s,o;if(t&&Z8(t),r.bookProps&&!r.bookSheets)s={};else{var c=_t?"buffer":"array";if(n&&n.content)s=rO(n.content,r);else if((o=tt.find(e,"PerfectOffice_MAIN"))&&o.content)s=ki.to_workbook(o.content,(r.type=c,r));else if((o=tt.find(e,"NativeContent_MAIN"))&&o.content)s=ki.to_workbook(o.content,(r.type=c,r));else throw(o=tt.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&tt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=g6(e))}var u={};return e.FullPaths&&nO(e,u,r),s.Props=s.Custprops=u,r.bookFiles&&(s.cfb=e),s}function aO(e,r){var t=r||{},n=tt.utils.cfb_new({root:"R"}),s="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":s="/Workbook",t.biff=8;break;case"biff5":s="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return tt.utils.cfb_add(n,s,Wy(e,t)),t.biff==8&&(e.Props||e.Custprops)&&sO(e,n),t.biff==8&&e.vbaraw&&v6(n,tt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Zo={0:{f:TF},1:{f:MF},2:{f:rA},3:{f:VF},4:{f:zF},5:{f:ZF},6:{f:lA},7:{f:KF},8:{f:xA},9:{f:hA},10:{f:fA},11:{f:dA},12:{f:BF},13:{f:sA},14:{f:XF},15:{f:HF},16:{f:Ry},17:{f:cA},18:{f:JF},19:{f:ph},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:c8},40:{},42:{},43:{f:lT},44:{f:aT},45:{f:uT},46:{f:dT},47:{f:fT},48:{},49:{f:OE},50:{},51:{f:qT},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ay},62:{f:iA},63:{f:t6},64:{f:FA},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:mn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:EA},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:RF},148:{f:OF,p:16},151:{f:bA},152:{},153:{f:i8},154:{},155:{},156:{f:s8},157:{},158:{},159:{T:1,f:_C},160:{T:-1},161:{T:1,f:Mi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:mA},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:WT},336:{T:-1},337:{f:KT,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Dd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:sy},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:wA},427:{f:_A},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:NA},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:IF},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:vA},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Dd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:d6},633:{T:1},634:{T:-1},635:{T:1,f:u6},636:{T:-1},637:{f:PE},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:XA},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:AA},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},zd={6:{f:md},10:{f:La},12:{f:Fr},13:{f:Fr},14:{f:br},15:{f:br},16:{f:hn},17:{f:br},18:{f:br},19:{f:Fr},20:{f:jg},21:{f:jg},23:{f:sy},24:{f:Tg},25:{f:br},26:{},27:{},28:{f:Aj},29:{},34:{f:br},35:{f:Cg},38:{f:hn},39:{f:hn},40:{f:hn},41:{f:hn},42:{f:br},43:{f:br},47:{f:HC},49:{f:sj},51:{f:Fr},60:{},61:{f:Z3},64:{f:br},65:{f:nj},66:{f:Fr},77:{},80:{},81:{},82:{},85:{f:Fr},89:{},90:{},91:{},92:{f:$3},93:{f:Ij},94:{},95:{f:br},96:{},97:{},99:{f:br},125:{f:ay},128:{f:yj},129:{f:W3},130:{f:Fr},131:{f:br},132:{f:br},133:{f:V3},134:{},140:{f:$j},141:{f:Fr},144:{},146:{f:Vj},151:{},152:{},153:{},154:{},155:{},156:{f:Fr},157:{},158:{},160:{f:Qj},161:{f:Gj},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:mj},190:{f:pj},193:{f:La},197:{},198:{},199:{},200:{},201:{},202:{f:br},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Fr},220:{},221:{f:br},222:{},224:{f:vj},225:{f:z3},226:{f:La},227:{},229:{f:Oj},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:X3},253:{f:ij},255:{f:K3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Kv},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:br},353:{f:La},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Nj},431:{f:br},432:{},433:{},434:{},437:{},438:{f:Mj},439:{f:br},440:{f:Lj},441:{},442:{f:fc},443:{},444:{f:Fr},445:{},446:{},448:{f:La},449:{f:Q3,r:2},450:{f:La},512:{f:Ng},513:{f:Jj},515:{f:_j},516:{f:oj},517:{f:Eg},519:{f:Zj},520:{f:Y3},523:{},545:{f:Fg},549:{f:kg},566:{},574:{f:tj},638:{f:xj},659:{},1048:{},1054:{f:uj},1084:{},1212:{f:Cj},2048:{f:Uj},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:j0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:La},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:qj,r:12},2173:{f:$T,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:br,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:jj,r:12},2197:{},2198:{f:PT,r:12},2199:{},2200:{},2201:{},2202:{f:Tj,r:12},2203:{f:La},2204:{},2205:{},2206:{},2207:{},2211:{f:J3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Fr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Kj},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Wj},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Ng},1:{},2:{f:sC},3:{f:rC},4:{f:tC},5:{f:Eg},7:{f:iC},8:{},9:{f:j0},11:{},22:{f:Fr},30:{f:dj},31:{},32:{},33:{f:Fg},36:{},37:{f:kg},50:{f:lC},62:{},52:{},67:{},68:{f:Fr},69:{},86:{},126:{},127:{f:eC},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:oC},223:{},234:{},354:{},421:{},518:{f:md},521:{f:j0},536:{f:Tg},547:{f:Cg},561:{},579:{},1030:{f:md},1033:{f:j0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function He(e,r,t,n){var s=r;if(!isNaN(s)){var o=n||(t||[]).length||0,c=e.next(4);c.write_shift(2,s),c.write_shift(2,o),o>0&&hh(t)&&e.push(t)}}function iO(e,r,t,n){var s=(t||[]).length||0;if(s<=8224)return He(e,r,t,s);var o=r;if(!isNaN(o)){for(var c=t.parts||[],u=0,d=0,h=0;h+(c[u]||8224)<=8224;)h+=c[u]||8224,u++;var m=e.next(4);for(m.write_shift(2,o),m.write_shift(2,h),e.push(t.slice(d,d+h)),d+=h;d<s;){for(m=e.next(4),m.write_shift(2,60),h=0;h+(c[u]||8224)<=8224;)h+=c[u]||8224,u++;m.write_shift(2,h),e.push(t.slice(d,d+h)),d+=h}}}function mc(e,r,t){return e||(e=Ee(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function lO(e,r,t,n){var s=Ee(9);return mc(s,e,r),Yv(t,n||"b",s),s}function oO(e,r,t){var n=Ee(8+2*t.length);return mc(n,e,r),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function cO(e,r,t,n){if(r.v!=null)switch(r.t){case"d":case"n":var s=r.t=="d"?Lr(Zt(r.v)):r.v;s==(s|0)&&s>=0&&s<65536?He(e,2,aC(t,n,s)):He(e,3,nC(t,n,s));return;case"b":case"e":He(e,5,lO(t,n,r.v,r.t));return;case"s":case"str":He(e,4,oO(t,n,(r.v||"").slice(0,255)));return}He(e,1,mc(null,t,n))}function uO(e,r,t,n){var s=Array.isArray(r),o=Ot(r["!ref"]||"A1"),c,u="",d=[];if(o.e.c>255||o.e.r>16383){if(n.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),c=gt(o)}for(var h=o.s.r;h<=o.e.r;++h){u=wr(h);for(var m=o.s.c;m<=o.e.c;++m){h===o.s.r&&(d[m]=or(m)),c=d[m]+u;var p=s?(r[h]||[])[m]:r[c];p&&cO(e,p,h,m)}}}function fO(e,r){for(var t=r||{},n=Mn(),s=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==t.sheet&&(s=o);if(s==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return He(n,t.biff==4?1033:t.biff==3?521:9,kh(e,16,t)),uO(n,e.Sheets[e.SheetNames[s]],s,t),He(n,10),n.end()}function dO(e,r,t){He(e,49,aj({sz:12,name:"Arial"},t))}function hO(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&He(e,1054,fj(s,r[s],t))})}function xO(e,r){var t=Ee(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),He(e,2151,t),t=Ee(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),ty(Ot(r["!ref"]||"A1"),t),t.write_shift(4,4),He(e,2152,t)}function mO(e,r){for(var t=0;t<16;++t)He(e,224,Sg({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(n){He(e,224,Sg(n,0,r))})}function pO(e,r){for(var t=0;t<r["!links"].length;++t){var n=r["!links"][t];He(e,440,Bj(n)),n[1].Tooltip&&He(e,2048,zj(n))}delete r["!links"]}function gO(e,r){if(r){var t=0;r.forEach(function(n,s){++t<=256&&n&&He(e,125,Xj(xu(s,n),s))})}}function vO(e,r,t,n,s){var o=16+Ja(s.cellXfs,r,s);if(r.v==null&&!r.bf){He(e,513,Fi(t,n,o));return}if(r.bf)He(e,6,W5(r,t,n,s,o));else switch(r.t){case"d":case"n":var c=r.t=="d"?Lr(Zt(r.v)):r.v;He(e,515,kj(t,n,c,o));break;case"b":case"e":He(e,517,wj(t,n,r.v,o,s,r.t));break;case"s":case"str":if(s.bookSST){var u=Ah(s.Strings,r.v,s.revStrings);He(e,253,lj(t,n,u,o))}else He(e,516,cj(t,n,(r.v||"").slice(0,255),o,s));break;default:He(e,513,Fi(t,n,o))}}function yO(e,r,t){var n=Mn(),s=t.SheetNames[e],o=t.Sheets[s]||{},c=(t||{}).Workbook||{},u=(c.Sheets||[])[e]||{},d=Array.isArray(o),h=r.biff==8,m,p="",y=[],k=Ot(o["!ref"]||"A1"),b=h?65536:16384;if(k.e.c>255||k.e.r>=b){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");k.e.c=Math.min(k.e.c,255),k.e.r=Math.min(k.e.c,b-1)}He(n,2057,kh(t,16,r)),He(n,13,fs(1)),He(n,12,fs(100)),He(n,15,Nn(!0)),He(n,17,Nn(!1)),He(n,16,Ci(.001)),He(n,95,Nn(!0)),He(n,42,Nn(!1)),He(n,43,Nn(!1)),He(n,130,fs(1)),He(n,128,bj()),He(n,131,Nn(!1)),He(n,132,Nn(!1)),h&&gO(n,o["!cols"]),He(n,512,hj(k,r)),h&&(o["!links"]=[]);for(var v=k.s.r;v<=k.e.r;++v){p=wr(v);for(var w=k.s.c;w<=k.e.c;++w){v===k.s.r&&(y[w]=or(w)),m=y[w]+p;var S=d?(o[v]||[])[w]:o[m];S&&(vO(n,S,v,w,r),h&&S.l&&o["!links"].push([m,S.l]))}}var I=u.CodeName||u.name||s;return h&&He(n,574,rj((c.Views||[])[0])),h&&(o["!merges"]||[]).length&&He(n,229,Dj(o["!merges"])),h&&pO(n,o),He(n,442,Jv(I)),h&&xO(n,o),He(n,10),n.end()}function bO(e,r,t){var n=Mn(),s=(e||{}).Workbook||{},o=s.Sheets||[],c=s.WBProps||{},u=t.biff==8,d=t.biff==5;if(He(n,2057,kh(e,5,t)),t.bookType=="xla"&&He(n,135),He(n,225,u?fs(1200):null),He(n,193,w3(2)),d&&He(n,191),d&&He(n,192),He(n,226),He(n,92,H3("SheetJS",t)),He(n,66,fs(u?1200:1252)),u&&He(n,353,fs(0)),u&&He(n,448),He(n,317,Yj(e.SheetNames.length)),u&&e.vbaraw&&He(n,211),u&&e.vbaraw){var h=c.CodeName||"ThisWorkbook";He(n,442,Jv(h))}He(n,156,fs(17)),He(n,25,Nn(!1)),He(n,18,Nn(!1)),He(n,19,fs(0)),u&&He(n,431,Nn(!1)),u&&He(n,444,fs(0)),He(n,61,ej()),He(n,64,Nn(!1)),He(n,141,fs(0)),He(n,34,Nn(QA(e)=="true")),He(n,14,Nn(!0)),u&&He(n,439,Nn(!1)),He(n,218,fs(0)),dO(n,e,t),hO(n,e.SSF,t),mO(n,t),u&&He(n,352,Nn(!1));var m=n.end(),p=Mn();u&&He(p,140,Hj()),u&&t.Strings&&iO(p,252,G3(t.Strings)),He(p,10);var y=p.end(),k=Mn(),b=0,v=0;for(v=0;v<e.SheetNames.length;++v)b+=(u?12:11)+(u?2:1)*e.SheetNames[v].length;var w=m.length+b+y.length;for(v=0;v<e.SheetNames.length;++v){var S=o[v]||{};He(k,133,q3({pos:w,hs:S.Hidden||0,dt:0,name:e.SheetNames[v]},t)),w+=r[v].length}var I=k.end();if(b!=I.length)throw new Error("BS8 "+b+" != "+I.length);var N=[];return m.length&&N.push(m),I.length&&N.push(I),y.length&&N.push(y),Gr(N)}function wO(e,r){var t=r||{},n=[];e&&!e.SSF&&(e.SSF=er(lt)),e&&e.SSF&&(Rl(),lu(e.SSF),t.revssf=cu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ph(t),t.cellXfs=[],Ja(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=yO(s,t,e);return n.unshift(bO(e,n,t)),Gr(n)}function Wy(e,r){for(var t=0;t<=e.SheetNames.length;++t){var n=e.Sheets[e.SheetNames[t]];if(!(!n||!n["!ref"])){var s=Ln(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var o=r||{};switch(o.biff||2){case 8:case 5:return wO(e,r);case 4:case 3:case 2:return fO(e,r)}throw new Error("invalid type "+o.bookType+" for BIFF")}function Ug(e,r){var t=r||{},n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),c=s.index,u=o&&o.index||e.length,d=aE(e.slice(c,u),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,m=0,p=0,y=0,k={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(c=0;c<d.length;++c){var v=d[c].trim(),w=v.slice(0,3).toLowerCase();if(w=="<tr"){if(++h,t.sheetRows&&t.sheetRows<=h){--h;break}m=0;continue}if(!(w!="<td"&&w!="<th")){var S=v.split(/<\/t[dh]>/i);for(u=0;u<S.length;++u){var I=S[u].trim();if(I.match(/<t[dh]/i)){for(var N=I,P=0;N.charAt(0)=="<"&&(P=N.indexOf(">"))>-1;)N=N.slice(P+1);for(var W=0;W<b.length;++W){var X=b[W];X.s.c==m&&X.s.r<h&&h<=X.e.r&&(m=X.e.c+1,W=-1)}var M=ct(I.slice(0,I.indexOf(">")));y=M.colspan?+M.colspan:1,((p=+M.rowspan)>1||y>1)&&b.push({s:{r:h,c:m},e:{r:h+(p||1)-1,c:m+y-1}});var Z=M.t||M["data-t"]||"";if(!N.length){m+=y;continue}if(N=xv(N),k.s.r>h&&(k.s.r=h),k.e.r<h&&(k.e.r=h),k.s.c>m&&(k.s.c=m),k.e.c<m&&(k.e.c=m),!N.length){m+=y;continue}var H={t:"s",v:N};t.raw||!N.trim().length||Z=="s"||(N==="TRUE"?H={t:"b",v:!0}:N==="FALSE"?H={t:"b",v:!1}:isNaN(As(N))?isNaN(jl(N).getDate())||(H={t:"d",v:Zt(N)},t.cellDates||(H={t:"n",v:Lr(H.v)}),H.z=t.dateNF||lt[14]):H={t:"n",v:As(N)}),t.dense?(n[h]||(n[h]=[]),n[h][m]=H):n[ot({r:h,c:m})]=H,m+=y}}}}return n["!ref"]=gt(k),b.length&&(n["!merges"]=b),n}function _O(e,r,t,n){for(var s=e["!merges"]||[],o=[],c=r.s.c;c<=r.e.c;++c){for(var u=0,d=0,h=0;h<s.length;++h)if(!(s[h].s.r>t||s[h].s.c>c)&&!(s[h].e.r<t||s[h].e.c<c)){if(s[h].s.r<t||s[h].s.c<c){u=-1;break}u=s[h].e.r-s[h].s.r+1,d=s[h].e.c-s[h].s.c+1;break}if(!(u<0)){var m=ot({r:t,c}),p=n.dense?(e[t]||[])[c]:e[m],y=p&&p.v!=null&&(p.h||uh(p.w||(xa(p),p.w)||""))||"",k={};u>1&&(k.rowspan=u),d>1&&(k.colspan=d),n.editable?y='<span contenteditable="true">'+y+"</span>":p&&(k["data-t"]=p&&p.t||"z",p.v!=null&&(k["data-v"]=p.v),p.z!=null&&(k["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+p.l.Target+'">'+y+"</a>")),k.id=(n.id||"sjs")+"-"+m,o.push($e("td",y,k))}}var b="<tr>";return b+o.join("")+"</tr>"}var kO='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',NO="</body></html>";function SO(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Ya(Ug(t[0],r),r);var n=Bh();return t.forEach(function(s,o){Uh(n,Ug(s,r),"Sheet"+(o+1))}),n}function EO(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Vy(e,r){var t=r||{},n=t.header!=null?t.header:kO,s=t.footer!=null?t.footer:NO,o=[n],c=Ln(e["!ref"]);t.dense=Array.isArray(e),o.push(EO(e,c,t));for(var u=c.s.r;u<=c.e.r;++u)o.push(_O(e,c,u,t));return o.push("</table>"+s),o.join("")}function qy(e,r,t){var n=t||{},s=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?cr(n.origin):n.origin;s=c.r,o=c.c}var u=r.getElementsByTagName("tr"),d=Math.min(n.sheetRows||1e7,u.length),h={s:{r:0,c:0},e:{r:s,c:o}};if(e["!ref"]){var m=Ln(e["!ref"]);h.s.r=Math.min(h.s.r,m.s.r),h.s.c=Math.min(h.s.c,m.s.c),h.e.r=Math.max(h.e.r,m.e.r),h.e.c=Math.max(h.e.c,m.e.c),s==-1&&(h.e.r=s=m.e.r+1)}var p=[],y=0,k=e["!rows"]||(e["!rows"]=[]),b=0,v=0,w=0,S=0,I=0,N=0;for(e["!cols"]||(e["!cols"]=[]);b<u.length&&v<d;++b){var P=u[b];if(zg(P)){if(n.display)continue;k[v]={hidden:!0}}var W=P.children;for(w=S=0;w<W.length;++w){var X=W[w];if(!(n.display&&zg(X))){var M=X.hasAttribute("data-v")?X.getAttribute("data-v"):X.hasAttribute("v")?X.getAttribute("v"):xv(X.innerHTML),Z=X.getAttribute("data-z")||X.getAttribute("z");for(y=0;y<p.length;++y){var H=p[y];H.s.c==S+o&&H.s.r<v+s&&v+s<=H.e.r&&(S=H.e.c+1-o,y=-1)}N=+X.getAttribute("colspan")||1,((I=+X.getAttribute("rowspan")||1)>1||N>1)&&p.push({s:{r:v+s,c:S+o},e:{r:v+s+(I||1)-1,c:S+o+(N||1)-1}});var ce={t:"s",v:M},le=X.getAttribute("data-t")||X.getAttribute("t")||"";M!=null&&(M.length==0?ce.t=le||"z":n.raw||M.trim().length==0||le=="s"||(M==="TRUE"?ce={t:"b",v:!0}:M==="FALSE"?ce={t:"b",v:!1}:isNaN(As(M))?isNaN(jl(M).getDate())||(ce={t:"d",v:Zt(M)},n.cellDates||(ce={t:"n",v:Lr(ce.v)}),ce.z=n.dateNF||lt[14]):ce={t:"n",v:As(M)})),ce.z===void 0&&Z!=null&&(ce.z=Z);var re="",te=X.getElementsByTagName("A");if(te&&te.length)for(var ve=0;ve<te.length&&!(te[ve].hasAttribute("href")&&(re=te[ve].getAttribute("href"),re.charAt(0)!="#"));++ve);re&&re.charAt(0)!="#"&&(ce.l={Target:re}),n.dense?(e[v+s]||(e[v+s]=[]),e[v+s][S+o]=ce):e[ot({c:S+o,r:v+s})]=ce,h.e.c<S+o&&(h.e.c=S+o),S+=N}}++v}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),h.e.r=Math.max(h.e.r,v-1+s),e["!ref"]=gt(h),v>=d&&(e["!fullref"]=gt((h.e.r=u.length-b+v-1+s,h))),e}function Xy(e,r){var t=r||{},n=t.dense?[]:{};return qy(n,e,r)}function jO(e,r){return Ya(Xy(e,r),r)}function zg(e){var r="",t=CO(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function CO(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function TO(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=At(r.replace(/<[^>]*>/g,""));return[t]}var $g={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Gy(e,r){var t=r||{},n=fh(e),s=[],o,c,u={name:""},d="",h=0,m,p,y={},k=[],b=t.dense?[]:{},v,w,S={value:""},I="",N=0,P=[],W=-1,X=-1,M={s:{r:1e6,c:1e7},e:{r:0,c:0}},Z=0,H={},ce=[],le={},re=0,te=0,ve=[],Se=1,Ce=1,ue=[],ne={Names:[]},A={},me=["",""],z=[],T={},Q="",Y=0,J=!1,K=!1,fe=0;for(Xo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=Xo.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(M.e.c>=M.s.c&&M.e.r>=M.s.r?b["!ref"]=gt(M):b["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=M.e.r&&(b["!fullref"]=b["!ref"],M.e.r=t.sheetRows-1,b["!ref"]=gt(M)),ce.length&&(b["!merges"]=ce),ve.length&&(b["!rows"]=ve),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),k.push(m.name),y[m.name]=b,K=!1):v[0].charAt(v[0].length-2)!=="/"&&(m=ct(v[0],!1),W=X=-1,M.s.r=M.s.c=1e7,M.e.r=M.e.c=0,b=t.dense?[]:{},ce=[],ve=[],K=!0);break;case"table-row-group":v[1]==="/"?--Z:++Z;break;case"table-row":case"":if(v[1]==="/"){W+=Se,Se=1;break}if(p=ct(v[0],!1),p.?W=p.-1:W==-1&&(W=0),Se=+p["number-rows-repeated"]||1,Se<10)for(fe=0;fe<Se;++fe)Z>0&&(ve[W+fe]={level:Z});X=-1;break;case"covered-table-cell":v[1]!=="/"&&++X,t.sheetStubs&&(t.dense?(b[W]||(b[W]=[]),b[W][X]={t:"z"}):b[ot({r:W,c:X})]={t:"z"}),I="",P=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++X,S=ct(v[0],!1),Ce=parseInt(S["number-columns-repeated"]||"1",10),w={t:"z",v:null},S.formula&&t.cellFormula!=!1&&(w.f=Mg(At(S.formula))),(S.||S["value-type"])=="string"&&(w.t="s",w.v=At(S["string-value"]||""),t.dense?(b[W]||(b[W]=[]),b[W][X]=w):b[ot({r:W,c:X})]=w),X+=Ce-1;else if(v[1]!=="/"){++X,I="",N=0,P=[],Ce=1;var we=Se?W+Se-1:W;if(X>M.e.c&&(M.e.c=X),X<M.s.c&&(M.s.c=X),W<M.s.r&&(M.s.r=W),we>M.e.r&&(M.e.r=we),S=ct(v[0],!1),z=[],T={},w={t:S.||S["value-type"],v:null},t.cellFormula)if(S.formula&&(S.formula=At(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(re=parseInt(S["number-matrix-rows-spanned"],10)||0,te=parseInt(S["number-matrix-columns-spanned"],10)||0,le={s:{r:W,c:X},e:{r:W+re-1,c:X+te-1}},w.F=gt(le),ue.push([le,w.F])),S.formula)w.f=Mg(S.formula);else for(fe=0;fe<ue.length;++fe)W>=ue[fe][0].s.r&&W<=ue[fe][0].e.r&&X>=ue[fe][0].s.c&&X<=ue[fe][0].e.c&&(w.F=ue[fe][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(re=parseInt(S["number-rows-spanned"],10)||0,te=parseInt(S["number-columns-spanned"],10)||0,le={s:{r:W,c:X},e:{r:W+re-1,c:X+te-1}},ce.push(le)),S["number-columns-repeated"]&&(Ce=parseInt(S["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Qt(S["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(S.value);break;case"percentage":w.t="n",w.v=parseFloat(S.value);break;case"currency":w.t="n",w.v=parseFloat(S.value);break;case"date":w.t="d",w.v=Zt(S["date-value"]),t.cellDates||(w.t="n",w.v=Lr(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=rE(S["time-value"])/86400,t.cellDates&&(w.t="d",w.v=uu(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(S.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",S["string-value"]!=null&&(I=At(S["string-value"]),P=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(J=!1,w.t==="s"&&(w.v=I||"",P.length&&(w.R=P),J=N==0),A.Target&&(w.l=A),z.length>0&&(w.c=z,z=[]),I&&t.cellText!==!1&&(w.w=I),J&&(w.t="z",delete w.v),(!J||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=W))for(var ye=0;ye<Se;++ye){if(Ce=parseInt(S["number-columns-repeated"]||"1",10),t.dense)for(b[W+ye]||(b[W+ye]=[]),b[W+ye][X]=ye==0?w:er(w);--Ce>0;)b[W+ye][X+Ce]=er(w);else for(b[ot({r:W+ye,c:X})]=w;--Ce>0;)b[ot({r:W+ye,c:X+Ce})]=er(w);M.e.c<=X&&(M.e.c=X)}Ce=parseInt(S["number-columns-repeated"]||"1",10),X+=Ce-1,Ce=0,w={},I="",P=[]}A={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((o=s.pop())[0]!==v[3])throw"Bad state: "+o}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((o=s.pop())[0]!==v[3])throw"Bad state: "+o;T.t=I,P.length&&(T.R=P),T.a=Q,z.push(T)}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);Q="",Y=0,I="",N=0,P=[];break;case"creator":v[1]==="/"?Q=n.slice(Y,v.index):Y=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((o=s.pop())[0]!==v[3])throw"Bad state: "+o}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);I="",N=0,P=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(H[u.name]=d,(o=s.pop())[0]!==v[3])throw"Bad state: "+o}else v[0].charAt(v[0].length-2)!=="/"&&(d="",u=ct(v[0],!1),s.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":c=ct(v[0],!1),d+=$g[v[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":c=ct(v[0],!1),d+=$g[v[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":d+=n.slice(h,v.index);break}else h=v.index+v[0].length;break;case"named-range":c=ct(v[0],!1),me=pd(c["cell-range-address"]);var je={Name:c.name,Ref:me[0]+"!"+me[1]};K&&(je.Sheet=k.length),ne.Names.push(je);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(v[1]==="/"&&(!S||!S["string-value"])){var Xe=TO(n.slice(N,v.index));I=(I.length>0?I+`
`:"")+Xe[0]}else ct(v[0],!1),N=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{me=pd(ct(v[0])["target-range-address"]),y[me[0]]["!autofilter"]={ref:me[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(A=ct(v[0],!1),!A.href)break;A.Target=At(A.href),delete A.href,A.Target.charAt(0)=="#"&&A.Target.indexOf(".")>-1?(me=pd(A.Target.slice(1)),A.Target="#"+me[0]+"!"+me[1]):A.Target.match(/^\.\.[\\\/]/)&&(A.Target=A.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(v)}}var D={Sheets:y,SheetNames:k,Workbook:ne};return t.bookSheets&&delete D.Sheets,D}function Hg(e,r){r=r||{},us(e,"META-INF/manifest.xml")&&r3(Tr(e,"META-INF/manifest.xml"),r);var t=Yn(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=Gy(Wt(t),r);return us(e,"meta.xml")&&(n.Props=Lv(Tr(e,"meta.xml"))),n}function Wg(e,r){return Gy(e,r)}var FO=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+qo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return kr+r}})(),Vg=(function(){var e=function(o){return Ht(o).replace(/  +/g,function(c){return'<text:s text:c="'+c.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(o,c,u){var d=[];d.push('      <table:table table:name="'+Ht(c.SheetNames[u])+`" table:style-name="ta1">
`);var h=0,m=0,p=Ln(o["!ref"]||"A1"),y=o["!merges"]||[],k=0,b=Array.isArray(o);if(o["!cols"])for(m=0;m<=p.e.c;++m)d.push("        <table:table-column"+(o["!cols"][m]?' table:style-name="co'+o["!cols"][m].ods+'"':"")+`></table:table-column>
`);var v="",w=o["!rows"]||[];for(h=0;h<p.s.r;++h)v=w[h]?' table:style-name="ro'+w[h].ods+'"':"",d.push("        <table:table-row"+v+`></table:table-row>
`);for(;h<=p.e.r;++h){for(v=w[h]?' table:style-name="ro'+w[h].ods+'"':"",d.push("        <table:table-row"+v+`>
`),m=0;m<p.s.c;++m)d.push(r);for(;m<=p.e.c;++m){var S=!1,I={},N="";for(k=0;k!=y.length;++k)if(!(y[k].s.c>m)&&!(y[k].s.r>h)&&!(y[k].e.c<m)&&!(y[k].e.r<h)){(y[k].s.c!=m||y[k].s.r!=h)&&(S=!0),I["table:number-columns-spanned"]=y[k].e.c-y[k].s.c+1,I["table:number-rows-spanned"]=y[k].e.r-y[k].s.r+1;break}if(S){d.push(t);continue}var P=ot({r:h,c:m}),W=b?(o[h]||[])[m]:o[P];if(W&&W.f&&(I["table:formula"]=Ht(Y5(W.f)),W.F&&W.F.slice(0,P.length)==P)){var X=Ln(W.F);I["table:number-matrix-columns-spanned"]=X.e.c-X.s.c+1,I["table:number-matrix-rows-spanned"]=X.e.r-X.s.r+1}if(!W){d.push(r);continue}switch(W.t){case"b":N=W.v?"TRUE":"FALSE",I["office:value-type"]="boolean",I["office:boolean-value"]=W.v?"true":"false";break;case"n":N=W.w||String(W.v||0),I["office:value-type"]="float",I["office:value"]=W.v||0;break;case"s":case"str":N=W.v==null?"":W.v,I["office:value-type"]="string";break;case"d":N=W.w||Zt(W.v).toISOString(),I["office:value-type"]="date",I["office:date-value"]=Zt(W.v).toISOString(),I["table:style-name"]="ce1";break;default:d.push(r);continue}var M=e(N);if(W.l&&W.l.Target){var Z=W.l.Target;Z=Z.charAt(0)=="#"?"#"+J5(Z.slice(1)):Z,Z.charAt(0)!="#"&&!Z.match(/^\w+:/)&&(Z="../"+Z),M=$e("text:a",M,{"xlink:href":Z.replace(/&/g,"&amp;")})}d.push("          "+$e("table:table-cell",$e("text:p",M,{}),I)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},s=function(o,c){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var u=0;c.SheetNames.map(function(h){return c.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var m=0;m<h["!cols"].length;++m)if(h["!cols"][m]){var p=h["!cols"][m];if(p.width==null&&p.wpx==null&&p.wch==null)continue;Wa(p),p.ods=u;var y=h["!cols"][m].wpx+"px";o.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),o.push(`  </style:style>
`),++u}}});var d=0;c.SheetNames.map(function(h){return c.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var m=0;m<h["!rows"].length;++m)if(h["!rows"][m]){h["!rows"][m].ods=d;var p=h["!rows"][m].hpx+"px";o.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),o.push(`  </style:style>
`),++d}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(c,u){var d=[kr],h=qo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=qo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(d.push("<office:document"+h+m+`>
`),d.push(Mv().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+h+`>
`),s(d,c),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var p=0;p!=c.SheetNames.length;++p)d.push(n(c.Sheets[c.SheetNames[p]],c,p));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),u.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}})();function Ky(e,r){if(r.bookType=="fods")return Vg(e,r);var t=lh(),n="",s=[],o=[];return n="mimetype",yt(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",yt(t,n,Vg(e,r)),s.push([n,"text/xml"]),o.push([n,"ContentFile"]),n="styles.xml",yt(t,n,FO(e,r)),s.push([n,"text/xml"]),o.push([n,"StylesFile"]),n="meta.xml",yt(t,n,kr+Mv()),s.push([n,"text/xml"]),o.push([n,"MetadataFile"]),n="manifest.rdf",yt(t,n,a3(o)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",yt(t,n,n3(s)),t}function Ai(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function $d(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Wt(Ka(e))}function AO(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Kn(Vs(e))}function OO(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var n=0;n<r.length;++n)if(e[t+n]!=r[n])continue e;return!0}return!1}function qa(e){var r=e.reduce(function(s,o){return s+o.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(s){t.set(s,n),n+=s.length}),t}function qg(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function DO(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,s=r+13;s>=r;--s)n=n*256+e[s];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function IO(e,r,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,s=t/Math.pow(10,n-6176);e[r+15]|=n>>7,e[r+14]|=(n&127)<<1;for(var o=0;s>=1;++o,s/=256)e[r+o]=s&255;e[r+15]|=t>=0?0:128}function ec(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function zt(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function pr(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function It(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],s=ec(e,t),o=s&7;s=Math.floor(s/8);var c=0,u;if(s==0)break;switch(o){case 0:{for(var d=t[0];e[t[0]++]>=128;);u=e.slice(d,t[0])}break;case 5:c=4,u=e.slice(t[0],t[0]+c),t[0]+=c;break;case 1:c=8,u=e.slice(t[0],t[0]+c),t[0]+=c;break;case 2:c=ec(e,t),u=e.slice(t[0],t[0]+c),t[0]+=c;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(s," at offset ").concat(n))}var h={data:u,type:o};r[s]==null?r[s]=[h]:r[s].push(h)}return r}function en(e){var r=[];return e.forEach(function(t,n){t.forEach(function(s){s.data&&(r.push(zt(n*8+s.type)),s.type==2&&r.push(zt(s.data.length)),r.push(s.data))})}),qa(r)}function Ih(e,r){return e?.map(function(t){return r(t.data)})||[]}function os(e){for(var r,t=[],n=[0];n[0]<e.length;){var s=ec(e,n),o=It(e.slice(n[0],n[0]+s));n[0]+=s;var c={id:pr(o[1][0].data),messages:[]};o[2].forEach(function(u){var d=It(u.data),h=pr(d[3][0].data);c.messages.push({meta:d,data:e.slice(n[0],n[0]+h)}),n[0]+=h}),(r=o[3])!=null&&r[0]&&(c.merge=pr(o[3][0].data)>>>0>0),t.push(c)}return t}function xl(e){var r=[];return e.forEach(function(t){var n=[];n[1]=[{data:zt(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:zt(+!!t.merge),type:0}]);var s=[];t.messages.forEach(function(c){s.push(c.data),c.meta[3]=[{type:0,data:zt(c.data.length)}],n[2].push({data:en(c.meta),type:2})});var o=en(n);r.push(zt(o.length)),r.push(o),s.forEach(function(c){return r.push(c)})}),qa(r)}function RO(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=ec(r,t),s=[];t[0]<r.length;){var o=r[t[0]]&3;if(o==0){var c=r[t[0]++]>>2;if(c<60)++c;else{var u=c-59;c=r[t[0]],u>1&&(c|=r[t[0]+1]<<8),u>2&&(c|=r[t[0]+2]<<16),u>3&&(c|=r[t[0]+3]<<24),c>>>=0,c++,t[0]+=u}s.push(r.slice(t[0],t[0]+c)),t[0]+=c;continue}else{var d=0,h=0;if(o==1?(h=(r[t[0]]>>2&7)+4,d=(r[t[0]++]&224)<<3,d|=r[t[0]++]):(h=(r[t[0]++]>>2)+1,o==2?(d=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(d=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),s=[qa(s)],d==0)throw new Error("Invalid offset 0");if(d>s[0].length)throw new Error("Invalid offset beyond length");if(h>=d)for(s.push(s[0].slice(-d)),h-=d;h>=s[s.length-1].length;)s.push(s[s.length-1]),h-=s[s.length-1].length;s.push(s[0].slice(-d,-d+h))}}var m=qa(s);if(m.length!=n)throw new Error("Unexpected length: ".concat(m.length," != ").concat(n));return m}function cs(e){for(var r=[],t=0;t<e.length;){var n=e[t++],s=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(RO(n,e.slice(t,t+s))),t+=s}if(t!==e.length)throw new Error("data is not a valid framed stream!");return qa(r)}function ml(e){for(var r=[],t=0;t<e.length;){var n=Math.min(e.length-t,268435455),s=new Uint8Array(4);r.push(s);var o=zt(n),c=o.length;r.push(o),n<=60?(c++,r.push(new Uint8Array([n-1<<2]))):n<=256?(c+=2,r.push(new Uint8Array([240,n-1&255]))):n<=65536?(c+=3,r.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(c+=4,r.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(c+=5,r.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),r.push(e.slice(t,t+n)),c+=n,s[0]=0,s[1]=c&255,s[2]=c>>8&255,s[3]=c>>16&255,t+=n}return qa(r)}function PO(e,r,t,n){var s=Ai(e),o=s.getUint32(4,!0),c=(n>1?12:8)+qg(o&(n>1?3470:398))*4,u=-1,d=-1,h=NaN,m=new Date(2001,0,1);o&512&&(u=s.getUint32(c,!0),c+=4),c+=qg(o&(n>1?12288:4096))*4,o&16&&(d=s.getUint32(c,!0),c+=4),o&32&&(h=s.getFloat64(c,!0),c+=8),o&64&&(m.setTime(m.getTime()+s.getFloat64(c,!0)*1e3),c+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:h};break;case 3:p={t:"s",v:r[d]};break;case 5:p={t:"d",v:m};break;case 6:p={t:"b",v:h>0};break;case 7:p={t:"n",v:h/86400};break;case 8:p={t:"e",v:0};break;case 9:if(u>-1)p={t:"s",v:t[u]};else if(d>-1)p={t:"s",v:r[d]};else if(!isNaN(h))p={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function MO(e,r,t){var n=Ai(e),s=n.getUint32(8,!0),o=12,c=-1,u=-1,d=NaN,h=NaN,m=new Date(2001,0,1);s&1&&(d=DO(e,o),o+=16),s&2&&(h=n.getFloat64(o,!0),o+=8),s&4&&(m.setTime(m.getTime()+n.getFloat64(o,!0)*1e3),o+=8),s&8&&(u=n.getUint32(o,!0),o+=4),s&16&&(c=n.getUint32(o,!0),o+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:d};break;case 3:p={t:"s",v:r[u]};break;case 5:p={t:"d",v:m};break;case 6:p={t:"b",v:h>0};break;case 7:p={t:"n",v:h/86400};break;case 8:p={t:"e",v:0};break;case 9:if(c>-1)p={t:"s",v:t[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return p}function vd(e,r){var t=new Uint8Array(32),n=Ai(t),s=12,o=0;switch(t[0]=5,e.t){case"n":t[1]=2,IO(t,s,e.v),o|=1,s+=16;break;case"b":t[1]=6,n.setFloat64(s,e.v?1:0,!0),o|=2,s+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,n.setUint32(s,r.indexOf(e.v),!0),o|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,o,!0),t.slice(0,s)}function yd(e,r){var t=new Uint8Array(32),n=Ai(t),s=12,o=0;switch(t[0]=3,e.t){case"n":t[2]=2,n.setFloat64(s,e.v,!0),o|=32,s+=8;break;case"b":t[2]=6,n.setFloat64(s,e.v?1:0,!0),o|=32,s+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,n.setUint32(s,r.indexOf(e.v),!0),o|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,o,!0),t.slice(0,s)}function LO(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return PO(e,r,t,e[0]);case 5:return MO(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function cn(e){var r=It(e);return ec(r[1][0].data)}function Xg(e,r){var t=It(r.data),n=pr(t[1][0].data),s=t[3],o=[];return(s||[]).forEach(function(c){var u=It(c.data),d=pr(u[1][0].data)>>>0;switch(n){case 1:o[d]=$d(u[3][0].data);break;case 8:{var h=e[cn(u[9][0].data)][0],m=It(h.data),p=e[cn(m[1][0].data)][0],y=pr(p.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var k=It(p.data);o[d]=k[3].map(function(b){return $d(b.data)}).join("")}break}}),o}function BO(e,r){var t,n,s,o,c,u,d,h,m,p,y,k,b,v,w=It(e),S=pr(w[1][0].data)>>>0,I=pr(w[2][0].data)>>>0,N=((n=(t=w[8])==null?void 0:t[0])==null?void 0:n.data)&&pr(w[8][0].data)>0||!1,P,W;if((o=(s=w[7])==null?void 0:s[0])!=null&&o.data&&r!=0)P=(u=(c=w[7])==null?void 0:c[0])==null?void 0:u.data,W=(h=(d=w[6])==null?void 0:d[0])==null?void 0:h.data;else if((p=(m=w[4])==null?void 0:m[0])!=null&&p.data&&r!=1)P=(k=(y=w[4])==null?void 0:y[0])==null?void 0:k.data,W=(v=(b=w[3])==null?void 0:b[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var X=N?4:1,M=Ai(P),Z=[],H=0;H<P.length/2;++H){var ce=M.getUint16(H*2,!0);ce<65535&&Z.push([H,ce])}if(Z.length!=I)throw"Expected ".concat(I," cells, found ").concat(Z.length);var le=[];for(H=0;H<Z.length-1;++H)le[Z[H][0]]=W.subarray(Z[H][1]*X,Z[H+1][1]*X);return Z.length>=1&&(le[Z[Z.length-1][0]]=W.subarray(Z[Z.length-1][1]*X)),{R:S,cells:le}}function UO(e,r){var t,n=It(r.data),s=(t=n?.[7])!=null&&t[0]?pr(n[7][0].data)>>>0>0?1:0:-1,o=Ih(n[5],function(c){return BO(c,s)});return{nrows:pr(n[4][0].data)>>>0,data:o.reduce(function(c,u){return c[u.R]||(c[u.R]=[]),u.cells.forEach(function(d,h){if(c[u.R][h])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(h));c[u.R][h]=d}),c},[])}}function zO(e,r,t){var n,s=It(r.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(pr(s[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(o.e.c=(pr(s[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));t["!ref"]=gt(o);var c=It(s[4][0].data),u=Xg(e,e[cn(c[4][0].data)][0]),d=(n=c[17])!=null&&n[0]?Xg(e,e[cn(c[17][0].data)][0]):[],h=It(c[3][0].data),m=0;h[1].forEach(function(p){var y=It(p.data),k=e[cn(y[2][0].data)][0],b=pr(k.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var v=UO(e,k);v.data.forEach(function(w,S){w.forEach(function(I,N){var P=ot({r:m+S,c:N}),W=LO(I,u,d);W&&(t[P]=W)})}),m+=v.nrows})}function $O(e,r){var t=It(r.data),n={"!ref":"A1"},s=e[cn(t[2][0].data)],o=pr(s[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return zO(e,s[0],n),n}function HO(e,r){var t,n=It(r.data),s={name:(t=n[1])!=null&&t[0]?$d(n[1][0].data):"",sheets:[]},o=Ih(n[2],cn);return o.forEach(function(c){e[c].forEach(function(u){var d=pr(u.meta[1][0].data);d==6e3&&s.sheets.push($O(e,u))})}),s}function WO(e,r){var t=Bh(),n=It(r.data),s=Ih(n[1],cn);if(s.forEach(function(o){e[o].forEach(function(c){var u=pr(c.meta[1][0].data);if(u==2){var d=HO(e,c);d.sheets.forEach(function(h,m){Uh(t,h,m==0?d.name:d.name+"_"+m,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function bd(e){var r,t,n,s,o={},c=[];if(e.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var h;try{h=cs(d.content)}catch(p){return console.log("?? "+d.content.length+" "+(p.message||p))}var m;try{m=os(h)}catch(p){return console.log("## "+(p.message||p))}m.forEach(function(p){o[p.id]=p.messages,c.push(p.id)})}}),!c.length)throw new Error("File has no messages");var u=((s=(n=(t=(r=o?.[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&pr(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||c.forEach(function(d){o[d].forEach(function(h){var m=pr(h.meta[1][0].data)>>>0;if(m==1)if(!u)u=h;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return WO(o,u)}function VO(e,r,t){var n,s,o,c;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var u=((c=(o=e[8])==null?void 0:o[0])==null?void 0:c.data)&&pr(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var d=0,h=Ai(e[7][0].data),m=0,p=[],y=Ai(e[4][0].data),k=0,b=[],v=0;v<r.length;++v){if(r[v]==null){h.setUint16(v*2,65535,!0),y.setUint16(v*2,65535);continue}h.setUint16(v*2,m,!0),y.setUint16(v*2,k,!0);var w,S;switch(typeof r[v]){case"string":w=vd({t:"s",v:r[v]},t),S=yd({t:"s",v:r[v]},t);break;case"number":w=vd({t:"n",v:r[v]},t),S=yd({t:"n",v:r[v]},t);break;case"boolean":w=vd({t:"b",v:r[v]},t),S=yd({t:"b",v:r[v]},t);break;default:throw new Error("Unsupported value "+r[v])}p.push(w),m+=w.length,b.push(S),k+=S.length,++d}for(e[2][0].data=zt(d);v<e[7][0].data.length/2;++v)h.setUint16(v*2,65535,!0),y.setUint16(v*2,65535,!0);return e[6][0].data=qa(p),e[3][0].data=qa(b),d}function qO(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ln(t["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(gt(n)));var o=J0(t,{range:n,header:1}),c=["~Sh33tJ5~"];o.forEach(function(Q){return Q.forEach(function(Y){typeof Y=="string"&&c.push(Y)})});var u={},d=[],h=tt.read(r.numbers,{type:"base64"});h.FileIndex.map(function(Q,Y){return[Q,h.FullPaths[Y]]}).forEach(function(Q){var Y=Q[0],J=Q[1];if(Y.type==2&&Y.name.match(/\.iwa/)){var K=Y.content,fe=cs(K),we=os(fe);we.forEach(function(ye){d.push(ye.id),u[ye.id]={deps:[],location:J,type:pr(ye.messages[0].meta[1][0].data)}})}}),d.sort(function(Q,Y){return Q-Y});var m=d.filter(function(Q){return Q>1}).map(function(Q){return[Q,zt(Q)]});h.FileIndex.map(function(Q,Y){return[Q,h.FullPaths[Y]]}).forEach(function(Q){var Y=Q[0];if(Q[1],!!Y.name.match(/\.iwa/)){var J=os(cs(Y.content));J.forEach(function(K){K.messages.forEach(function(fe){m.forEach(function(we){K.messages.some(function(ye){return pr(ye.meta[1][0].data)!=11006&&OO(ye.data,we[1])})&&u[we[0]].deps.push(K.id)})})})}});for(var p=tt.find(h,u[1].location),y=os(cs(p.content)),k,b=0;b<y.length;++b){var v=y[b];v.id==1&&(k=v)}var w=cn(It(k.messages[0].data)[1][0].data);for(p=tt.find(h,u[w].location),y=os(cs(p.content)),b=0;b<y.length;++b)v=y[b],v.id==w&&(k=v);for(w=cn(It(k.messages[0].data)[2][0].data),p=tt.find(h,u[w].location),y=os(cs(p.content)),b=0;b<y.length;++b)v=y[b],v.id==w&&(k=v);for(w=cn(It(k.messages[0].data)[2][0].data),p=tt.find(h,u[w].location),y=os(cs(p.content)),b=0;b<y.length;++b)v=y[b],v.id==w&&(k=v);var S=It(k.messages[0].data);{S[6][0].data=zt(n.e.r+1),S[7][0].data=zt(n.e.c+1);var I=cn(S[46][0].data),N=tt.find(h,u[I].location),P=os(cs(N.content));{for(var W=0;W<P.length&&P[W].id!=I;++W);if(P[W].id!=I)throw"Bad ColumnRowUIDMapArchive";var X=It(P[W].messages[0].data);X[1]=[],X[2]=[],X[3]=[];for(var M=0;M<=n.e.c;++M){var Z=[];Z[1]=Z[2]=[{type:0,data:zt(M+420690)}],X[1].push({type:2,data:en(Z)}),X[2].push({type:0,data:zt(M)}),X[3].push({type:0,data:zt(M)})}X[4]=[],X[5]=[],X[6]=[];for(var H=0;H<=n.e.r;++H)Z=[],Z[1]=Z[2]=[{type:0,data:zt(H+726270)}],X[4].push({type:2,data:en(Z)}),X[5].push({type:0,data:zt(H)}),X[6].push({type:0,data:zt(H)});P[W].messages[0].data=en(X)}N.content=ml(xl(P)),N.size=N.content.length,delete S[46];var ce=It(S[4][0].data);{ce[7][0].data=zt(n.e.r+1);var le=It(ce[1][0].data),re=cn(le[2][0].data);N=tt.find(h,u[re].location),P=os(cs(N.content));{if(P[0].id!=re)throw"Bad HeaderStorageBucket";var te=It(P[0].messages[0].data);for(H=0;H<o.length;++H){var ve=It(te[2][0].data);ve[1][0].data=zt(H),ve[4][0].data=zt(o[H].length),te[2][H]={type:te[2][0].type,data:en(ve)}}P[0].messages[0].data=en(te)}N.content=ml(xl(P)),N.size=N.content.length;var Se=cn(ce[2][0].data);N=tt.find(h,u[Se].location),P=os(cs(N.content));{if(P[0].id!=Se)throw"Bad HeaderStorageBucket";for(te=It(P[0].messages[0].data),M=0;M<=n.e.c;++M)ve=It(te[2][0].data),ve[1][0].data=zt(M),ve[4][0].data=zt(n.e.r+1),te[2][M]={type:te[2][0].type,data:en(ve)};P[0].messages[0].data=en(te)}N.content=ml(xl(P)),N.size=N.content.length;var Ce=cn(ce[4][0].data);(function(){for(var Q=tt.find(h,u[Ce].location),Y=os(cs(Q.content)),J,K=0;K<Y.length;++K){var fe=Y[K];fe.id==Ce&&(J=fe)}var we=It(J.messages[0].data);{we[3]=[];var ye=[];c.forEach(function(D,Pe){ye[1]=[{type:0,data:zt(Pe)}],ye[2]=[{type:0,data:zt(1)}],ye[3]=[{type:2,data:AO(D)}],we[3].push({type:2,data:en(ye)})})}J.messages[0].data=en(we);var je=xl(Y),Xe=ml(je);Q.content=Xe,Q.size=Q.content.length})();var ue=It(ce[3][0].data);{var ne=ue[1][0];delete ue[2];var A=It(ne.data);{var me=cn(A[2][0].data);(function(){for(var Q=tt.find(h,u[me].location),Y=os(cs(Q.content)),J,K=0;K<Y.length;++K){var fe=Y[K];fe.id==me&&(J=fe)}var we=It(J.messages[0].data);{delete we[6],delete ue[7];var ye=new Uint8Array(we[5][0].data);we[5]=[];for(var je=0,Xe=0;Xe<=n.e.r;++Xe){var D=It(ye);je+=VO(D,o[Xe],c),D[1][0].data=zt(Xe),we[5].push({data:en(D),type:2})}we[1]=[{type:0,data:zt(n.e.c+1)}],we[2]=[{type:0,data:zt(n.e.r+1)}],we[3]=[{type:0,data:zt(je)}],we[4]=[{type:0,data:zt(n.e.r+1)}]}J.messages[0].data=en(we);var Pe=xl(Y),rt=ml(Pe);Q.content=rt,Q.size=Q.content.length})()}ne.data=en(A)}ce[3][0].data=en(ue)}S[4][0].data=en(ce)}k.messages[0].data=en(S);var z=xl(y),T=ml(z);return p.content=T,p.size=p.content.length,h}function Yy(e){return function(t){for(var n=0;n!=e.length;++n){var s=e[n];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function Rh(e){Yy([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Ph(e){Yy([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function XO(e){return St.WS.indexOf(e)>-1?"sheet":e==St.CS?"chart":e==St.DS?"dialog":e==St.MS?"macro":e&&e.length?e:"sheet"}function GO(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,XO(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function KO(e,r,t,n,s,o,c,u,d,h,m,p){try{o[n]=Io(Yn(e,t,!0),r);var y=Tr(e,r),k;switch(u){case"sheet":k=g8(y,r,s,d,o[n],h,m,p);break;case"chart":if(k=v8(y,r,s,d,o[n],h,m,p),!k||!k["!drawel"])break;var b=Co(k["!drawel"].Target,r),v=Go(b),w=s6(Yn(e,b,!0),Io(Yn(e,v,!0),b)),S=Co(w,b),I=Go(S);k=VA(Yn(e,S,!0),S,d,Io(Yn(e,I,!0),S),h,k);break;case"macro":k=y8(y,r,s,d,o[n],h,m,p);break;case"dialog":k=b8(y,r,s,d,o[n],h,m,p);break;default:throw new Error("Unrecognized sheet type "+u)}c[n]=k;var N=[];o&&o[n]&&gr(o[n]).forEach(function(P){var W="";if(o[n][P].Type==St.CMNT){W=Co(o[n][P].Target,r);var X=N8(Tr(e,W,!0),W,d);if(!X||!X.length)return;Og(k,X,!1)}o[n][P].Type==St.TCMNT&&(W=Co(o[n][P].Target,r),N=N.concat(i6(Tr(e,W,!0),d)))}),N&&N.length&&Og(k,N,!0,d.people||[])}catch(P){if(d.WTF)throw P}}function is(e){return e.charAt(0)=="/"?e.slice(1):e}function YO(e,r){if(Rl(),r=r||{},Rh(r),us(e,"META-INF/manifest.xml")||us(e,"objectdata.xml"))return Hg(e,r);if(us(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof bd<"u"){if(e.FileIndex)return bd(e);var t=tt.utils.cfb_new();return Zp(e).forEach(function(ve){yt(t,ve,lE(e,ve))}),bd(t)}throw new Error("Unsupported NUMBERS file")}if(!us(e,"[Content_Types].xml"))throw us(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):us(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Zp(e),s=e3(Yn(e,"[Content_Types].xml")),o=!1,c,u;if(s.workbooks.length===0&&(u="xl/workbook.xml",Tr(e,u,!0)&&s.workbooks.push(u)),s.workbooks.length===0){if(u="xl/workbook.bin",!Tr(e,u,!0))throw new Error("Could not find workbook");s.workbooks.push(u),o=!0}s.workbooks[0].slice(-3)=="bin"&&(o=!0);var d={},h={};if(!r.bookSheets&&!r.bookProps){if(Ro=[],s.sst)try{Ro=k8(Tr(e,is(s.sst)),s.sst,r)}catch(ve){if(r.WTF)throw ve}r.cellStyles&&s.themes.length&&(d=_8(Yn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],r)),s.style&&(h=w8(Tr(e,is(s.style)),s.style,d,r))}s.links.map(function(ve){try{var Se=Io(Yn(e,Go(is(ve))),ve);return E8(Tr(e,is(ve)),Se,ve,r)}catch{}});var m=p8(Tr(e,is(s.workbooks[0])),s.workbooks[0],r),p={},y="";s.coreprops.length&&(y=Tr(e,is(s.coreprops[0]),!0),y&&(p=Lv(y)),s.extprops.length!==0&&(y=Tr(e,is(s.extprops[0]),!0),y&&l3(y,p,r)));var k={};(!r.bookSheets||r.bookProps)&&s.custprops.length!==0&&(y=Yn(e,is(s.custprops[0]),!0),y&&(k=c3(y,r)));var b={};if((r.bookSheets||r.bookProps)&&(m.Sheets?c=m.Sheets.map(function(Se){return Se.name}):p.Worksheets&&p.SheetNames.length>0&&(c=p.SheetNames),r.bookProps&&(b.Props=p,b.Custprops=k),r.bookSheets&&typeof c<"u"&&(b.SheetNames=c),r.bookSheets?b.SheetNames:r.bookProps))return b;c={};var v={};r.bookDeps&&s.calcchain&&(v=S8(Tr(e,is(s.calcchain)),s.calcchain));var w=0,S={},I,N;{var P=m.Sheets;p.Worksheets=P.length,p.SheetNames=[];for(var W=0;W!=P.length;++W)p.SheetNames[W]=P[W].name}var X=o?"bin":"xml",M=s.workbooks[0].lastIndexOf("/"),Z=(s.workbooks[0].slice(0,M+1)+"_rels/"+s.workbooks[0].slice(M+1)+".rels").replace(/^\//,"");us(e,Z)||(Z="xl/_rels/workbook."+X+".rels");var H=Io(Yn(e,Z,!0),Z.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(r.xlmeta=j8(Tr(e,is(s.metadata[0])),s.metadata[0],r)),(s.people||[]).length>=1&&(r.people=o6(Tr(e,is(s.people[0])),r)),H&&(H=GO(H,m.Sheets));var ce=Tr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=p.Worksheets;++w){var le="sheet";if(H&&H[w]?(I="xl/"+H[w][1].replace(/[\/]?xl\//,""),us(e,I)||(I=H[w][1]),us(e,I)||(I=Z.replace(/_rels\/.*$/,"")+H[w][1]),le=H[w][2]):(I="xl/worksheets/sheet"+(w+1-ce)+"."+X,I=I.replace(/sheet0\./,"sheet.")),N=I.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(w!=r.sheets)continue e;break;case"string":if(p.SheetNames[w].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var re=!1,te=0;te!=r.sheets.length;++te)typeof r.sheets[te]=="number"&&r.sheets[te]==w&&(re=1),typeof r.sheets[te]=="string"&&r.sheets[te].toLowerCase()==p.SheetNames[w].toLowerCase()&&(re=1);if(!re)continue e}}KO(e,I,N,p.SheetNames[w],w,S,c,le,r,m,d,h)}return b={Directory:s,Workbook:m,Props:p,Custprops:k,Deps:v,Sheets:c,SheetNames:p.SheetNames,Strings:Ro,Styles:h,Themes:d,SSF:er(lt)},r&&r.bookFiles&&(e.files?(b.keys=n,b.files=e.files):(b.keys=[],b.files={},e.FullPaths.forEach(function(ve,Se){ve=ve.replace(/^Root Entry[\/]/,""),b.keys.push(ve),b.files[ve]=e.FileIndex[Se]}))),r&&r.bookVBA&&(s.vba.length>0?b.vbaraw=Tr(e,is(s.vba[0]),!0):s.defaults&&s.defaults.bin===p6&&(b.vbaraw=Tr(e,"xl/vbaProject.bin",!0))),b}function JO(e,r){var t=r||{},n="Workbook",s=tt.find(e,n);try{if(n="/!DataSpaces/Version",s=tt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(jC(s.content),n="/!DataSpaces/DataSpaceMap",s=tt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=TC(s.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=tt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=FC(s.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=tt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);OC(s.content)}catch{}if(n="/EncryptionInfo",s=tt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=DC(s.content);if(n="/EncryptedPackage",s=tt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],s.content,t.password||"",t);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],s.content,t.password||"",t);throw new Error("File is password-protected")}function QO(e,r){return r.bookType=="ods"?Ky(e,r):r.bookType=="numbers"?qO(e,r):r.bookType=="xlsb"?ZO(e,r):eD(e,r)}function ZO(e,r){gl=1024,e&&!e.SSF&&(e.SSF=er(lt)),e&&e.SSF&&(Rl(),lu(e.SSF),r.revssf=cu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Po?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t=r.bookType=="xlsb"?"bin":"xml",n=ky.indexOf(r.bookType)>-1,s=wh();Ph(r=r||{});var o=lh(),c="",u=0;if(r.cellXfs=[],Ja(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),c="docProps/core.xml",yt(o,c,Bv(e.Props,r)),s.coreprops.push(c),$t(r.rels,2,c,St.CORE_PROPS),c="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,yt(o,c,$v(e.Props)),s.extprops.push(c),$t(r.rels,3,c,St.EXT_PROPS),e.Custprops!==e.Props&&gr(e.Custprops||{}).length>0&&(c="docProps/custom.xml",yt(o,c,Hv(e.Custprops)),s.custprops.push(c),$t(r.rels,4,c,St.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var m={"!id":{}},p=e.Sheets[e.SheetNames[u-1]],y=(p||{})["!type"]||"sheet";if(c="xl/worksheets/sheet"+u+"."+t,yt(o,c,T8(u-1,c,r,e,m)),s.sheets.push(c),$t(r.wbrels,-1,"worksheets/sheet"+u+"."+t,St.WS[0]),p){var k=p["!comments"],b=!1,v="";k&&k.length>0&&(v="xl/comments"+u+"."+t,yt(o,v,O8(k,v)),s.comments.push(v),$t(m,-1,"../comments"+u+"."+t,St.CMNT),b=!0),p["!legacy"]&&b&&yt(o,"xl/drawings/vmlDrawing"+u+".vml",wy(u,p["!comments"])),delete p["!comments"],delete p["!legacy"]}m["!id"].rId1&&yt(o,Go(c),bl(m))}return r.Strings!=null&&r.Strings.length>0&&(c="xl/sharedStrings."+t,yt(o,c,A8(r.Strings,c,r)),s.strs.push(c),$t(r.wbrels,-1,"sharedStrings."+t,St.SST)),c="xl/workbook."+t,yt(o,c,C8(e,c)),s.workbooks.push(c),$t(r.rels,1,c,St.WB),c="xl/theme/theme1.xml",yt(o,c,jh(e.Themes,r)),s.themes.push(c),$t(r.wbrels,-1,"theme/theme1.xml",St.THEME),c="xl/styles."+t,yt(o,c,F8(e,c,r)),s.styles.push(c),$t(r.wbrels,-1,"styles."+t,St.STY),e.vbaraw&&n&&(c="xl/vbaProject.bin",yt(o,c,e.vbaraw),s.vba.push(c),$t(r.wbrels,-1,"vbaProject.bin",St.VBA)),c="xl/metadata."+t,yt(o,c,D8(c)),s.metadata.push(c),$t(r.wbrels,-1,"metadata."+t,St.XLMETA),yt(o,"[Content_Types].xml",Pv(s,r)),yt(o,"_rels/.rels",bl(r.rels)),yt(o,"xl/_rels/workbook."+t+".rels",bl(r.wbrels)),delete r.revssf,delete r.ssf,o}function eD(e,r){gl=1024,e&&!e.SSF&&(e.SSF=er(lt)),e&&e.SSF&&(Rl(),lu(e.SSF),r.revssf=cu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Po?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",n=ky.indexOf(r.bookType)>-1,s=wh();Ph(r=r||{});var o=lh(),c="",u=0;if(r.cellXfs=[],Ja(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),c="docProps/core.xml",yt(o,c,Bv(e.Props,r)),s.coreprops.push(c),$t(r.rels,2,c,St.CORE_PROPS),c="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,yt(o,c,$v(e.Props)),s.extprops.push(c),$t(r.rels,3,c,St.EXT_PROPS),e.Custprops!==e.Props&&gr(e.Custprops||{}).length>0&&(c="docProps/custom.xml",yt(o,c,Hv(e.Custprops)),s.custprops.push(c),$t(r.rels,4,c,St.CUST_PROPS));var m=["SheetJ5"];for(r.tcid=0,u=1;u<=e.SheetNames.length;++u){var p={"!id":{}},y=e.Sheets[e.SheetNames[u-1]],k=(y||{})["!type"]||"sheet";if(c="xl/worksheets/sheet"+u+"."+t,yt(o,c,Iy(u-1,r,e,p)),s.sheets.push(c),$t(r.wbrels,-1,"worksheets/sheet"+u+"."+t,St.WS[0]),y){var b=y["!comments"],v=!1,w="";if(b&&b.length>0){var S=!1;b.forEach(function(I){I[1].forEach(function(N){N.T==!0&&(S=!0)})}),S&&(w="xl/threadedComments/threadedComment"+u+"."+t,yt(o,w,l6(b,m,r)),s.threadedcomments.push(w),$t(p,-1,"../threadedComments/threadedComment"+u+"."+t,St.TCMNT)),w="xl/comments"+u+"."+t,yt(o,w,_y(b)),s.comments.push(w),$t(p,-1,"../comments"+u+"."+t,St.CMNT),v=!0}y["!legacy"]&&v&&yt(o,"xl/drawings/vmlDrawing"+u+".vml",wy(u,y["!comments"])),delete y["!comments"],delete y["!legacy"]}p["!id"].rId1&&yt(o,Go(c),bl(p))}return r.Strings!=null&&r.Strings.length>0&&(c="xl/sharedStrings."+t,yt(o,c,cy(r.Strings,r)),s.strs.push(c),$t(r.wbrels,-1,"sharedStrings."+t,St.SST)),c="xl/workbook."+t,yt(o,c,By(e)),s.workbooks.push(c),$t(r.rels,1,c,St.WB),c="xl/theme/theme1.xml",yt(o,c,jh(e.Themes,r)),s.themes.push(c),$t(r.wbrels,-1,"theme/theme1.xml",St.THEME),c="xl/styles."+t,yt(o,c,gy(e,r)),s.styles.push(c),$t(r.wbrels,-1,"styles."+t,St.STY),e.vbaraw&&n&&(c="xl/vbaProject.bin",yt(o,c,e.vbaraw),s.vba.push(c),$t(r.wbrels,-1,"vbaProject.bin",St.VBA)),c="xl/metadata."+t,yt(o,c,by()),s.metadata.push(c),$t(r.wbrels,-1,"metadata."+t,St.XLMETA),m.length>1&&(c="xl/persons/person.xml",yt(o,c,c6(m)),s.people.push(c),$t(r.wbrels,-1,"persons/person.xml",St.PEOPLE)),yt(o,"[Content_Types].xml",Pv(s,r)),yt(o,"_rels/.rels",bl(r.rels)),yt(o,"xl/_rels/workbook."+t+".rels",bl(r.wbrels)),delete r.revssf,delete r.ssf,o}function Mh(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Jn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function tD(e,r){return tt.find(e,"EncryptedPackage")?JO(e,r):Hy(e,r)}function rD(e,r){var t,n=e,s=r||{};return s.type||(s.type=_t&&Buffer.isBuffer(e)?"buffer":"base64"),t=fv(n,s),YO(t,s)}function Jy(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Ud(e.slice(t),r);default:break e}return Cl.to_workbook(e,r)}function nD(e,r){var t="",n=Mh(e,r);switch(r.type){case"base64":t=Jn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=ji(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=Wt(t)),r.type="binary",Jy(t,r)}function sD(e,r){var t=e;return r.type=="base64"&&(t=Jn(t)),t=$o.utils.decode(1200,t.slice(2),"str"),r.type="binary",Jy(t,r)}function aD(e){return e.match(/[^\x00-\x7F]/)?Vs(e):e}function wd(e,r,t,n){return n?(t.type="string",Cl.to_workbook(e,t)):Cl.to_workbook(r,t)}function Y0(e,r){rh();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Y0(new Uint8Array(e),(t=er(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],o=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),_l={},t.dateNF&&(_l.dateNF=t.dateNF),t.type||(t.type=_t&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=_t?"buffer":"binary",n=ZS(e),typeof Uint8Array<"u"&&!_t&&(t.type="array")),t.type=="string"&&(o=!0,t.type="binary",t.codepage=65001,n=aD(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),u=new Uint8Array(c);if(u.foo="bar",!u.foo)return t=er(t),t.type="array",Y0(nh(n),t)}switch((s=Mh(n,t))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return tD(tt.read(n,t),t);break;case 9:if(s[1]<=8)return Hy(n,t);break;case 60:return Ud(n,t);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return uC(n,t);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return ly.to_workbook(n,t);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?rD(n,t):wd(e,n,t,o);case 239:return s[3]===60?Ud(n,t):wd(e,n,t,o);case 255:if(s[1]===254)return sD(n,t);if(s[1]===0&&s[2]===2&&s[3]===0)return ki.to_workbook(n,t);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return ki.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return Bd.to_workbook(n,t);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return xy.to_workbook(n,t);break;case 10:case 13:case 32:return nD(n,t);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return cC.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Bd.to_workbook(n,t):wd(e,n,t,o)}function Qy(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return oc(r.file,tt.write(e,{type:_t?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return tt.write(e,r)}function iD(e,r){var t=er(r||{}),n=QO(e,t);return lD(n,t)}function lD(e,r){var t={},n=_t?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=n;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+r.type)}var s=e.FullPaths?tt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&typeof s=="string"){if(r.type=="binary"||r.type=="base64")return s;s=new Uint8Array(iu(s))}return r.password&&typeof encrypt_agile<"u"?Qy(encrypt_agile(s,r.password),r):r.type==="file"?oc(r.file,s):r.type=="string"?Wt(s):s}function oD(e,r){var t=r||{},n=aO(e,t);return Qy(n,t)}function Ws(e,r,t){t||(t="");var n=t+e;switch(r.type){case"base64":return Ho(Vs(n));case"binary":return Vs(n);case"string":return e;case"file":return oc(r.file,n,"utf8");case"buffer":return _t?pa(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ws(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function cD(e,r){switch(r.type){case"base64":return Ho(e);case"binary":return e;case"string":return e;case"file":return oc(r.file,e,"binary");case"buffer":return _t?pa(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function A0(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return r.type=="base64"?Ho(t):r.type=="string"?Wt(t):t;case"file":return oc(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function Zy(e,r){rh(),t8(e);var t=er(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=Zy(e,t);return t.type="array",iu(n)}var s=0;if(t.sheet&&(typeof t.sheet=="number"?s=t.sheet:s=e.SheetNames.indexOf(t.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Ws(Q8(e,t),t);case"slk":case"sylk":return Ws(iy.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"htm":case"html":return Ws(Vy(e.Sheets[e.SheetNames[s]],t),t);case"txt":return cD(e2(e.Sheets[e.SheetNames[s]],t),t);case"csv":return Ws(Lh(e.Sheets[e.SheetNames[s]],t),t,"\uFEFF");case"dif":return Ws(ly.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"dbf":return A0(Bd.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"prn":return Ws(Cl.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"rtf":return Ws(xy.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"eth":return Ws(oy.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"fods":return Ws(Ky(e,t),t);case"wk1":return A0(ki.sheet_to_wk1(e.Sheets[e.SheetNames[s]],t),t);case"wk3":return A0(ki.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),A0(Wy(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),oD(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return iD(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function uD(e){if(!e.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=r[e.bookType]||e.bookType}}function _d(e,r,t){var n={};return n.type="file",n.file=r,uD(n),Zy(e,n)}function fD(e,r,t,n,s,o,c,u){var d=wr(t),h=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),p=!0,y=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:t,enumerable:!1})}catch{y.__rowNum__=t}else y.__rowNum__=t;if(!c||e[t])for(var k=r.s.c;k<=r.e.c;++k){var b=c?e[t][k]:e[n[k]+d];if(b===void 0||b.t===void 0){if(h===void 0)continue;o[k]!=null&&(y[o[k]]=h);continue}var v=b.v;switch(b.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(o[k]!=null){if(v==null)if(b.t=="e"&&v===null)y[o[k]]=null;else if(h!==void 0)y[o[k]]=h;else if(m&&v===null)y[o[k]]=null;else continue;else y[o[k]]=m&&(b.t!=="n"||b.t==="n"&&u.rawNumbers!==!1)?v:xa(b,v,u);v!=null&&(p=!1)}}return{row:y,isempty:p}}function J0(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,s=1,o=[],c=0,u="",d={s:{r:0,c:0},e:{r:0,c:0}},h=r||{},m=h.range!=null?h.range:e["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof m){case"string":d=Ot(m);break;case"number":d=Ot(e["!ref"]),d.s.r=m;break;default:d=m}n>0&&(s=0);var p=wr(d.s.r),y=[],k=[],b=0,v=0,w=Array.isArray(e),S=d.s.r,I=0,N={};w&&!e[S]&&(e[S]=[]);var P=h.skipHidden&&e["!cols"]||[],W=h.skipHidden&&e["!rows"]||[];for(I=d.s.c;I<=d.e.c;++I)if(!(P[I]||{}).hidden)switch(y[I]=or(I),t=w?e[S][I]:e[y[I]+p],n){case 1:o[I]=I-d.s.c;break;case 2:o[I]=y[I];break;case 3:o[I]=h.header[I-d.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),u=c=xa(t,null,h),v=N[c]||0,!v)N[c]=1;else{do u=c+"_"+v++;while(N[u]);N[c]=v,N[u]=1}o[I]=u}for(S=d.s.r+s;S<=d.e.r;++S)if(!(W[S]||{}).hidden){var X=fD(e,d,S,y,n,o,w,h);(X.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(k[b++]=X.row)}return k.length=b,k}var Gg=/"/g;function dD(e,r,t,n,s,o,c,u){for(var d=!0,h=[],m="",p=wr(t),y=r.s.c;y<=r.e.c;++y)if(n[y]){var k=u.dense?(e[t]||[])[y]:e[n[y]+p];if(k==null)m="";else if(k.v!=null){d=!1,m=""+(u.rawNumbers&&k.t=="n"?k.v:xa(k,null,u));for(var b=0,v=0;b!==m.length;++b)if((v=m.charCodeAt(b))===s||v===o||v===34||u.forceQuotes){m='"'+m.replace(Gg,'""')+'"';break}m=="ID"&&(m='"ID"')}else k.f!=null&&!k.F?(d=!1,m="="+k.f,m.indexOf(",")>=0&&(m='"'+m.replace(Gg,'""')+'"')):m="";h.push(m)}return u.blankrows===!1&&d?null:h.join(c)}function Lh(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var s=Ot(e["!ref"]),o=n.FS!==void 0?n.FS:",",c=o.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,d=u.charCodeAt(0),h=new RegExp((o=="|"?"\\|":o)+"+$"),m="",p=[];n.dense=Array.isArray(e);for(var y=n.skipHidden&&e["!cols"]||[],k=n.skipHidden&&e["!rows"]||[],b=s.s.c;b<=s.e.c;++b)(y[b]||{}).hidden||(p[b]=or(b));for(var v=0,w=s.s.r;w<=s.e.r;++w)(k[w]||{}).hidden||(m=dD(e,s,w,p,c,d,o,n),m!=null&&(n.strip&&(m=m.replace(h,"")),(m||n.blankrows!==!1)&&t.push((v++?u:"")+m)));return delete n.dense,t.join("")}function e2(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=Lh(e,r);return t}function hD(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var s=Ot(e["!ref"]),o="",c=[],u,d=[],h=Array.isArray(e);for(u=s.s.c;u<=s.e.c;++u)c[u]=or(u);for(var m=s.s.r;m<=s.e.r;++m)for(o=wr(m),u=s.s.c;u<=s.e.c;++u)if(r=c[u]+o,t=h?(e[m]||[])[u]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}d[d.length]=r+"="+n}return d}function t2(e,r,t){var n=t||{},s=+!n.skipHeader,o=e||{},c=0,u=0;if(o&&n.origin!=null)if(typeof n.origin=="number")c=n.origin;else{var d=typeof n.origin=="string"?cr(n.origin):n.origin;c=d.r,u=d.c}var h,m={s:{c:0,r:0},e:{c:u,r:c+r.length-1+s}};if(o["!ref"]){var p=Ot(o["!ref"]);m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),c==-1&&(c=p.e.r+1,m.e.r=c+r.length-1+s)}else c==-1&&(c=0,m.e.r=r.length-1+s);var y=n.header||[],k=0;r.forEach(function(v,w){gr(v).forEach(function(S){(k=y.indexOf(S))==-1&&(y[k=y.length]=S);var I=v[S],N="z",P="",W=ot({c:u+k,r:c+w+s});h=tc(o,W),I&&typeof I=="object"&&!(I instanceof Date)?o[W]=I:(typeof I=="number"?N="n":typeof I=="boolean"?N="b":typeof I=="string"?N="s":I instanceof Date?(N="d",n.cellDates||(N="n",I=Lr(I)),P=n.dateNF||lt[14]):I===null&&n.nullError&&(N="e",I=0),h?(h.t=N,h.v=I,delete h.w,delete h.R,P&&(h.z=P)):o[W]=h={t:N,v:I},P&&(h.z=P))})}),m.e.c=Math.max(m.e.c,u+y.length-1);var b=wr(c);if(s)for(k=0;k<y.length;++k)o[or(k+u)+b]={t:"s",v:y[k]};return o["!ref"]=gt(m),o}function xD(e,r){return t2(null,e,r)}function tc(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=cr(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?tc(e,ot(r)):tc(e,ot({r,c:t||0}))}function mD(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Bh(){return{SheetNames:[],Sheets:{}}}function Uh(e,r,t,n){var s=1;if(!t)for(;s<=65535&&e.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);s=o&&+o[2]||0;var c=o&&o[1]||t;for(++s;s<=65535&&e.SheetNames.indexOf(t=c+s)!=-1;++s);}if(Ly(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function pD(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=mD(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function gD(e,r){return e.z=r,e}function r2(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function vD(e,r,t){return r2(e,"#"+r,t)}function yD(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function bD(e,r,t,n){for(var s=typeof r!="string"?r:Ot(r),o=typeof r=="string"?r:gt(r),c=s.s.r;c<=s.e.r;++c)for(var u=s.s.c;u<=s.e.c;++u){var d=tc(e,c,u);d.t="n",d.F=o,delete d.v,c==s.s.r&&u==s.s.c&&(d.f=t,n&&(d.D=!0))}return e}var Cs={encode_col:or,encode_row:wr,encode_cell:ot,encode_range:gt,decode_col:mh,decode_row:xh,split_cell:AE,decode_cell:cr,decode_range:Ln,format_cell:xa,sheet_add_aoa:Tv,sheet_add_json:t2,sheet_add_dom:qy,aoa_to_sheet:Pl,json_to_sheet:xD,table_to_sheet:Xy,table_to_book:jO,sheet_to_csv:Lh,sheet_to_txt:e2,sheet_to_json:J0,sheet_to_html:Vy,sheet_to_formulae:hD,sheet_to_row_object_array:J0,sheet_get_cell:tc,book_new:Bh,book_append_sheet:Uh,book_set_sheet_visibility:pD,cell_set_number_format:gD,cell_set_hyperlink:r2,cell_set_internal_link:vD,cell_add_comment:yD,sheet_set_array_formula:bD,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const wD=()=>{Xs();const[e,r]=j.useState([]),[t,n]=j.useState(!1),[s,o]=j.useState(null),[c,u]=j.useState(!1),[d,h]=j.useState(null),m=j.useRef(null);j.useEffect(()=>{p()},[]),j.useEffect(()=>{if(s){const W=setTimeout(()=>o(null),3e3);return()=>clearTimeout(W)}},[s]);const p=async()=>{try{const W=await cN();r(W.data.backups)}catch(W){console.error("Error fetching backups:",W),o({type:"error",message:"   "})}},y=async()=>{n(!0);try{await oN(),o({type:"success",message:"  "}),p()}catch(W){console.error("Error creating backup:",W),o({type:"error",message:"  "})}finally{n(!1)}},k=async W=>{try{const X=await uN(W)}catch(X){console.error("Error downloading backup:",X),o({type:"error",message:"  "})}},b=async W=>{if(confirm(` ,     "${W}"?`))try{await fN(W),o({type:"success",message:"  "}),p()}catch(X){console.error("Error deleting backup:",X),o({type:"error",message:"  "})}},v=async W=>{h(W),u(!0)},w=async()=>{n(!0);try{await Fp(d),o({type:"success",message:"  "}),u(!1),h(null)}catch(W){console.error("Error restoring backup:",W),o({type:"error",message:"  "})}finally{n(!1)}},S=()=>{m.current.click()},I=async W=>{const X=W.target.files[0];if(!X)return;const M=new FormData;M.append("backupFile",X),n(!0);try{await Fp(M),o({type:"success",message:"    "})}catch(Z){console.error("Error restoring from file:",Z),o({type:"error",message:"   "})}finally{n(!1),W.target.value=null}},N=W=>{if(W===0)return"0 Bytes";const X=1024,M=["Bytes","KB","MB","GB"],Z=Math.floor(Math.log(W)/Math.log(X));return parseFloat((W/Math.pow(X,Z)).toFixed(2))+" "+M[Z]},P=W=>new Date(W).toLocaleString("ru-RU");return i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:" "}),s&&i.jsx("div",{className:`mb-4 p-4 rounded-lg ${s.type==="success"?"bg-green-100 border border-green-400 text-green-700":"bg-red-100 border border-red-400 text-red-700"}`,children:s.message}),i.jsxs("div",{className:"flex gap-4 mb-6",children:[i.jsx("button",{onClick:y,disabled:t,className:"bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300 text-white px-4 py-2 rounded-lg transition",children:t?"...":" "}),i.jsx("button",{onClick:S,disabled:t,className:"bg-green-500 hover:bg-green-600 disabled:bg-green-300 text-white px-4 py-2 rounded-lg transition",children:"  "})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h4",{className:"text-md font-semibold mb-4",children:" "}),e.length===0?i.jsx("p",{className:"text-gray-500",children:"  "}):i.jsx("div",{className:"space-y-2",children:e.map(W=>i.jsxs("div",{className:"bg-white p-4 rounded-lg border flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:W.filename}),i.jsxs("div",{className:"text-sm text-gray-600",children:[": ",N(W.size)," | : ",P(W.createdAt)," | : ",P(W.modifiedAt)]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>k(W.filename),className:"bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm transition",children:""}),i.jsx("button",{onClick:()=>v(W.filename),className:"bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded text-sm transition",children:""}),i.jsx("button",{onClick:()=>b(W.filename),className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm transition",children:""})]})]},W.filename))})]}),i.jsx("input",{type:"file",ref:m,onChange:I,accept:".sql,.dump",style:{display:"none"}})]}),c&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-60",children:i.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:i.jsxs("div",{className:"p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:" "}),i.jsxs("p",{className:"text-gray-600 mb-4",children:[' ,        "',d,'"?     .']}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:w,disabled:t,className:"flex-1 bg-red-500 hover:bg-red-600 disabled:bg-red-300 text-white py-2 rounded-lg transition",children:t?"...":""}),i.jsx("button",{onClick:()=>u(!1),className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})]})]})})})]})},_D=()=>{const{user:e}=Oi(),{hasPermission:r}=Xs(),{activeSettingsTab:t}=qb(),[n,s]=j.useState(!1),[o,c]=j.useState({username:"",fullName:"",email:"",password:"",role:""}),[u,d]=j.useState(!1),[h,m]=j.useState(null),[p,y]=j.useState({name:"",description:"",permissions:{user_create:!1,user_edit:!1,user_delete:!1,role_create:!1,role_edit:!1,role_delete:!1,spec_category_create:!1,spec_category_edit:!1,spec_category_delete:!1,spec_create:!1,spec_edit:!1,spec_delete:!1,bid_type_create:!1,bid_type_edit:!1,bid_type_delete:!1,client_create:!1,client_edit:!1,client_delete:!1,client_object_create:!1,client_object_edit:!1,client_object_delete:!1,bid_create:!1,bid_edit:!1,bid_delete:!1,bid_equipment_add:!1,equipment_create:!1,equipment_edit:!1,equipment_delete:!1,tab_warehouse:!1,tab_salary:!1,settings_user_button:!1,settings_role_button:!1,settings_spec_category_button:!1,settings_spec_button:!1,settings_bid_type_button:!1}}),[k,b]=j.useState([]),[v,w]=j.useState([]),[S,I]=j.useState(null),[N,P]=j.useState(null),[W,X]=j.useState(!1),[M,Z]=j.useState([]),[H,ce]=j.useState(!1),[le,re]=j.useState(null),[te,ve]=j.useState({categoryId:"",name:"",discount:"",cost:""}),[Se,Ce]=j.useState([]),[ue,ne]=j.useState(!1),[A,me]=j.useState(null),[z,T]=j.useState({name:"",type:"string",options:[],isEnabled:!0}),[Q,Y]=j.useState([]),[J,K]=j.useState(!1),[fe,we]=j.useState(null),[ye,je]=j.useState({name:""}),[Xe,D]=j.useState([]),[Pe,rt]=j.useState([]),[xt,nt]=j.useState(new Set),[Le,jt]=j.useState(new Set),[Rt,Bt]=j.useState(!1),[bt,fr]=j.useState(null),[kt,Pt]=j.useState({name:"",description:"",parentId:""}),[Ut,Mt]=j.useState([]),[Gt,Tt]=j.useState(!1),[tr,Ze]=j.useState(null),[qe,vt]=j.useState({name:"",description:"",statuses:[],transitions:[],plannedReactionTimeMinutes:"",plannedDurationMinutes:""}),[ht,qt]=j.useState(!1),[rr,Ar]=j.useState(null),[Lt,sr]=j.useState({name:"",position:"",allowedActions:[]}),[Or,Nr]=j.useState(null),[Br,Ur]=j.useState(!1),[dr,zr]=j.useState(!1),Yr=j.useRef(null),En=j.useRef(null),Bn=C=>{const _e=C.map(Ve=>Ve.position).sort((Ve,wt)=>Ve-wt);let ke=2;for(;_e.includes(ke)&&ke<999;)ke++;return ke<999?ke:null};j.useEffect(()=>{const _e=[{id:"user",permission:"settings_user_button"},{id:"roles",permission:"settings_role_button"},{id:"client-attributes",permission:"settings_client_attributes_button"},{id:"specification-categories",permission:"settings_spec_category_button"},{id:"specifications",permission:"settings_spec_button"},{id:"bid-types",permission:"settings_bid_type_button"},{id:"administration",permission:"settings_administration_button"}].find(ke=>r(ke.permission));if(_e)switch(_e.id){case"user":$r(),r("user_create")&&Sr();break;case"roles":Sr();break;case"specification-categories":Jr();break;case"specifications":Dr();break;case"bid-types":Er();break}},[r]),j.useEffect(()=>{console.log("Debug: Current logged-in user information:",e)},[e]),j.useEffect(()=>{if(N){const C=setTimeout(()=>P(null),3e3);return()=>clearTimeout(C)}},[N]),j.useEffect(()=>{switch(t){case"user":k.length===0&&r("user_edit")&&$r(),v.length===0&&r("user_create")&&Sr();break;case"roles":v.length===0&&r("role_create")&&Sr();break;case"specification-categories":Pe.length===0&&r("spec_category_create")&&Jr();break;case"specifications":M.length===0&&r("settings_spec_button")&&Dr(),Pe.length===0&&r("settings_spec_button")&&Jr();break;case"bid-types":Ut.length===0&&r("bid_type_create")&&Er();break;case"client-attributes":V();break;case"subject-forms":L();break}},[t,r,k.length,v.length,Se.length,Pe.length,M.length,Ut.length]);const $r=async()=>{try{const C=await Ga();b(C.data)}catch(C){console.error("Error fetching users:",C)}},Sr=async()=>{if(!W){X(!0);try{const C=await L1();w(C.data)}catch(C){console.error("Error fetching roles:",C),w([])}finally{X(!1)}}},Dr=async()=>{try{const C=await B1();Z(C.data)}catch(C){console.error("Error fetching specifications:",C)}},Jr=async()=>{try{const[C,_e]=await Promise.all([U1(),nN()]);D(C.data),rt(_e.data)}catch(C){console.error("Error fetching specification categories:",C)}},Er=async()=>{try{const C=await R1();Mt(C.data)}catch(C){console.error("Error fetching bid types:",C)}},ps=async C=>{C.preventDefault();try{S?(await Uk(S.id,o),P({type:"success",message:"  "})):(await Bk(o),P({type:"success",message:"  "})),c({username:"",fullName:"",email:"",password:"",role:"user"}),I(null),s(!1),$r()}catch(_e){console.error("Error saving user:",_e),P({type:"error",message:"   "})}},Ir=async C=>{C.preventDefault();try{h?(await Hk(h.id,p),P({type:"success",message:"  "})):(await $k(p),P({type:"success",message:"  "})),y({name:"",description:"",permissions:{user_create:!1,user_edit:!1,user_delete:!1,role_create:!1,role_edit:!1,role_delete:!1,spec_category_create:!1,spec_category_edit:!1,spec_category_delete:!1,spec_create:!1,spec_edit:!1,spec_delete:!1,bid_type_create:!1,bid_type_edit:!1,bid_type_delete:!1,client_create:!1,client_edit:!1,client_delete:!1,client_object_create:!1,client_object_edit:!1,client_object_delete:!1,bid_create:!1,bid_edit:!1,bid_delete:!1,bid_equipment_add:!1,equipment_create:!1,equipment_edit:!1,equipment_delete:!1,tab_warehouse:!1,tab_salary:!1,settings_user_button:!1,settings_role_button:!1,settings_spec_category_button:!1,settings_spec_button:!1,settings_bid_type_button:!1}}),m(null),d(!1),Sr()}catch(_e){console.error("Error saving role:",_e),P({type:"error",message:"   "})}},jn=C=>{m(C),y({name:C.name,description:C.description,permissions:{user_create:!1,user_edit:!1,user_delete:!1,role_create:!1,role_edit:!1,role_delete:!1,spec_category_create:!1,spec_category_edit:!1,spec_category_delete:!1,spec_create:!1,spec_edit:!1,spec_delete:!1,bid_type_create:!1,bid_type_edit:!1,bid_type_delete:!1,client_create:!1,client_edit:!1,client_delete:!1,client_object_create:!1,client_object_edit:!1,client_object_delete:!1,bid_create:!1,bid_edit:!1,bid_delete:!1,bid_equipment_add:!1,equipment_create:!1,equipment_edit:!1,equipment_delete:!1,tab_warehouse:!1,tab_salary:!1,settings_user_button:!1,settings_role_button:!1,settings_spec_category_button:!1,settings_spec_button:!1,settings_bid_type_button:!1,...C.permissions||{}}}),d(!0)},O=async C=>{if(window.confirm(" ,     ?"))try{await Wk(C),P({type:"success",message:"  "}),Sr()}catch(_e){console.error("Error deleting role:",_e),P({type:"error",message:"   "})}},V=async()=>{try{const C=await ok();Ce(C.data)}catch(C){console.error("Error fetching client attributes:",C)}},L=async()=>{try{const C=await Zd();Y(C.data)}catch(C){console.error("Error fetching subject forms:",C)}},U=async C=>{C.preventDefault();try{A?(await fk(A.id,z),P({type:"success",message:"  "})):(await uk(z),P({type:"success",message:"  "})),T({name:"",type:"string",options:[],isEnabled:!0}),me(null),ne(!1),V()}catch(_e){console.error("Error saving client attribute:",_e),P({type:"error",message:"   "})}},q=async C=>{if(window.confirm(" ,     ?"))try{await dk(C),P({type:"success",message:"  "}),V()}catch(_e){console.error("Error deleting client attribute:",_e),P({type:"error",message:"   "})}},G=async C=>{C.preventDefault();try{fe?(await bN(fe.id,ye),P({type:"success",message:"   "})):(await yN(ye),P({type:"success",message:"   "})),je({name:""}),we(null),K(!1),L()}catch(_e){console.error("Error saving subject form:",_e),_e.response?.data?.message?P({type:"error",message:_e.response.data.message}):P({type:"error",message:"    "})}},he=C=>{we(C),je({name:C.name}),K(!0)},Ne=async C=>{if(window.confirm(" ,      ?"))try{await wN(C),P({type:"success",message:"   "}),L()}catch(_e){console.error("Error deleting subject form:",_e),P({type:"error",message:"    "})}},ae=(C,_e)=>{y(ke=>({...ke,permissions:{...ke.permissions,[C]:_e}}))},xe=C=>{I(C),c({username:C.username,fullName:C.fullName,email:C.email,password:"",role:C.role}),s(!0)},R=async C=>{if(k.find(ke=>ke.id===C).role===""){P({type:"error",message:"  "});return}if(window.confirm(" ,     ?"))try{await zk(C),P({type:"success",message:"  "}),$r()}catch(ke){console.error("Error deleting user:",ke),P({type:"error",message:"   "})}},E=async C=>{C.preventDefault();try{le?(await Yk(le.id,te),P({type:"success",message:"  "})):(await Kk(te),P({type:"success",message:"  "})),ve({categoryId:"",name:"",discount:"",cost:""}),re(null),ce(!1),Dr()}catch(_e){console.error("Error saving specification:",_e),P({type:"error",message:"   "})}},ie=C=>{re(C),ve({categoryId:C.categoryId.toString(),name:C.name,discount:C.discount.toString(),cost:C.cost.toString()}),ce(!0)},Te=async C=>{if(window.confirm(" ,     ?"))try{await Jk(C),P({type:"success",message:"  "}),Dr()}catch(_e){console.error("Error deleting specification:",_e),P({type:"error",message:"   "})}},Fe=async C=>{C.preventDefault();try{bt?(await aN(bt.id,kt),P({type:"success",message:"   "})):(await sN(kt),P({type:"success",message:"   "})),Pt({name:"",description:""}),fr(null),Bt(!1),Jr()}catch(_e){console.error("Error saving specification category:",_e),P({type:"error",message:"    "})}},Ae=C=>{fr(C),Pt({name:C.name,description:C.description||"",parentId:C.parentId?C.parentId.toString():""}),Bt(!0)},et=async C=>{if(window.confirm(" ,      ?"))try{await iN(C),P({type:"success",message:"   "}),Jr()}catch(_e){console.error("Error deleting specification category:",_e),P({type:"error",message:"    "})}},Et=async C=>{C.preventDefault();try{tr?(await _k(tr.id,qe),P({type:"success",message:"   "})):(await wk(qe),P({type:"success",message:"   "})),vt({name:"",description:"",statuses:[],transitions:[],plannedReactionTimeMinutes:"",plannedDurationMinutes:""}),Ze(null),Tt(!1),qt(!1),Ar(null),sr({name:"",position:"",allowedActions:[]}),Nr(null),Er()}catch(_e){console.error("Error saving bid type:",_e),P({type:"error",message:"    "})}},Ct=C=>{Ze(C),vt({name:C.name,description:C.description||"",statuses:(C.statuses||[]).map(_e=>({..._e,color:_e.color||(_e.position===1?"#c75a5a":_e.position===999?"#7a7777":"#ffffff")})),transitions:C.transitions||[],plannedReactionTimeMinutes:C.plannedReactionTimeMinutes?C.plannedReactionTimeMinutes.toString():"",plannedDurationMinutes:C.plannedDurationMinutes?C.plannedDurationMinutes.toString():""}),Tt(!0),qt(!1),Ar(null),sr({name:"",position:"",allowedActions:[]}),Nr(null)},Vt=async C=>{if(window.confirm(" ,      ?"))try{await kk(C),P({type:"success",message:"   "}),Er()}catch(_e){console.error("Error deleting bid type:",_e),P({type:"error",message:"    "})}},Un=C=>{C.preventDefault();const _e=[...qe.statuses];if(rr){const ke=_e.findIndex(Ve=>Ve.position===rr.position);ke!==-1&&(_e[ke]={...Lt,position:parseInt(Lt.position)})}else _e.push({...Lt,position:parseInt(Lt.position)});vt({...qe,statuses:_e}),sr({name:"",position:"",allowedActions:[]}),Ar(null),qt(!1)},zn=C=>{const _e=qe.statuses.filter(ke=>ke.position!==C.position);vt({...qe,statuses:_e})},gn=(C,_e)=>{const ke=[...qe.transitions];ke.some(Ve=>Ve.fromPosition===C&&Ve.toPosition===_e)||(ke.push({fromPosition:C,toPosition:_e}),vt({...qe,transitions:ke}))},hr=(C,_e)=>{const ke=qe.transitions.filter(Ve=>!(Ve.fromPosition===C&&Ve.toPosition===_e));vt({...qe,transitions:ke})},ya=(C,_e)=>{const ke=qe.statuses.map(Ve=>Ve.position===C?{...Ve,name:_e}:Ve);vt({...qe,statuses:ke})},Kt=C=>{nt(_e=>{const ke=new Set(_e);return ke.has(C)?ke.delete(C):ke.add(C),ke})},Bi=C=>{jt(_e=>{const ke=new Set(_e);return ke.has(C)?ke.delete(C):ke.add(C),ke})},Ll=()=>{Yr.current?.click()},Ui=async C=>{const _e=C.target.files[0];if(_e)try{const ke=await _e.arrayBuffer(),Ve=Y0(ke),wt=Ve.Sheets[Ve.SheetNames[0]],yn=Cs.sheet_to_json(wt).map(We=>({name:We.||We.Name||"",inn:We.||We.INN||"",email:We[" "]||We.Email||"",phone:We.||We.Phone||"",createdAt:We[" "]||We["Created Date"]||new Date().toISOString(),responsibleId:We.||We.User||e?.id}));try{const We=await ik({clients:yn});P({type:"success",message:`  ${We.data.created} ${We.data.errors>0?`, : ${We.data.errors}`:""}`}),Ur(!1)}catch(We){console.error("Bulk upload error:",We),P({type:"error",message:"   "})}}catch(ke){console.error("Error processing file:",ke),P({type:"error",message:"   "})}},vn=async()=>{try{const _e=(await ic()).data,ke=_e.map(We=>({:We.name||"",:We.inn||""," ":We.email||"",:We.phone||""," ":We.createdAt?new Date(We.createdAt).toLocaleDateString("ru-RU"):"",:We.responsible?We.responsible.fullName||We.responsible.username:" "," ":We._count?.bids||0," ":We._count?.clientObjects||0})),Ve=Cs.json_to_sheet(ke),wt=Cs.book_new();Cs.book_append_sheet(wt,Ve,"");const yn=`_${new Date().toISOString().split("T")[0]}.xlsx`;_d(wt,yn),P({type:"success",message:` .  ${_e.length} .`})}catch(C){console.error("Export error:",C),P({type:"error",message:"   "})}},Ys=async()=>{try{const _e=(await I1()).data,ke=_e.map(We=>({ID:We.id||"",:We.client?.name||""," ":We.bidType?.name||"",:We.tema||"",:We.amount||"",:We.status||"",:We.description||""," ":We.clientObject?`${We.clientObject.brandModel} ${We.clientObject.stateNumber}`:""," ":We.workAddress||""," ":We.contactFullName||""," ":We.contactPhone||""," ":We.createdAt?new Date(We.createdAt).toLocaleDateString("ru-RU"):"",:We.createdByUser?.fullName||""})),Ve=Cs.json_to_sheet(ke),wt=Cs.book_new();Cs.book_append_sheet(wt,Ve,"");const yn=`_${new Date().toISOString().split("T")[0]}.xlsx`;_d(wt,yn),P({type:"success",message:` .  ${_e.length} .`})}catch(C){console.error("Export error:",C),P({type:"error",message:"   "})}},Qn=async()=>{try{const _e=(await lc()).data,ke=_e.map(We=>({ID:We.id||"",:We.client?.name||"","/":We.brandModel||""," ":We.stateNumber||"",:We.equipment||""," ":We.createdAt?new Date(We.createdAt).toLocaleDateString("ru-RU"):""})),Ve=Cs.json_to_sheet(ke),wt=Cs.book_new();Cs.book_append_sheet(wt,Ve,"");const yn=`_${new Date().toISOString().split("T")[0]}.xlsx`;_d(wt,yn),P({type:"success",message:` .  ${_e.length} .`})}catch(C){console.error("Export error:",C),P({type:"error",message:"   "})}},gs=()=>{En.current?.click()},Bl=async C=>{const _e=C.target.files[0];if(_e)try{const ke=await _e.arrayBuffer(),Ve=Y0(ke),wt=Ve.Sheets[Ve.SheetNames[0]],yn=Cs.sheet_to_json(wt).map(We=>({clientId:We.||We.Client||"",brandModel:We["/"]||We["Brand/Model"]||"",stateNumber:We[" "]||We["State Number"]||"",equipment:We.||We.Equipment||"",createdAt:We[" "]||We["Created Date"]||new Date().toISOString()}));try{const We=await lk({clientObjects:yn});P({type:"success",message:`  ${We.data.created} ${We.data.errors>0?`, : ${We.data.errors}`:""}`}),zr(!1)}catch(We){console.error("Bulk upload error:",We),P({type:"error",message:"   "})}}catch(ke){console.error("Error processing file:",ke),P({type:"error",message:"   "})}},Js=()=>{P({type:"info",message:" "})},ba=(C,_e,ke=0)=>C.map(Ve=>{const wt=_e.filter(yn=>yn.categoryId===Ve.id),vs=Ve.children?ba(Ve.children,_e,ke+1):[];return{...Ve,specifications:wt,children:vs,level:ke}}),Qa=(C,_e=0,ke=null)=>{const Ve=[];return C.forEach(wt=>{wt.id!==ke&&(Ve.push({id:wt.id,name:`${"  ".repeat(_e)}${wt.name}`,level:_e}),wt.children&&Ve.push(...Qa(wt.children,_e+1,ke)))}),Ve},wa=({category:C,level:_e=0})=>{const ke=C.children&&C.children.length>0,Ve=xt.has(C.id);return i.jsxs("div",{children:[i.jsxs("div",{className:`flex items-center py-2 px-4 hover:bg-gray-50 cursor-pointer ${_e>0?"ml-6":""}`,style:{paddingLeft:`${16+_e*24}px`},children:[ke&&i.jsx("button",{onClick:()=>Kt(C.id),className:"mr-2 text-gray-500 hover:text-gray-700",children:Ve?"":""}),!ke&&i.jsx("span",{className:"mr-2 w-4"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("span",{className:"font-medium",children:C.name}),C.description&&i.jsxs("span",{className:"text-gray-500 ml-2",children:["(",C.description,")"]})]}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:()=>Ae(C),className:"text-blue-600 hover:text-blue-900 text-sm",children:""}),i.jsx("button",{onClick:()=>et(C.id),className:"text-red-600 hover:text-red-900 text-sm",children:""})]})]}),ke&&Ve&&i.jsx("div",{children:C.children.map(wt=>i.jsx(wa,{category:wt,level:_e+1},wt.id))}),dr&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:i.jsxs("div",{className:"p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:" "}),i.jsxs("div",{className:"mb-4",children:[i.jsx("p",{className:"text-sm text-gray-600 mb-2",children:" Excel    .     :"}),i.jsxs("ul",{className:"text-sm text-gray-600 list-disc list-inside space-y-1",children:[i.jsx("li",{children:" - ID   "}),i.jsx("li",{children:"/ -    "}),i.jsx("li",{children:"  - . "}),i.jsx("li",{children:" -  "}),i.jsx("li",{children:"  -   "})]})]}),i.jsxs("div",{className:"flex gap-2 pt-4",children:[i.jsx("button",{onClick:gs,className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition",children:" "}),i.jsx("button",{onClick:()=>zr(!1),className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})]}),i.jsx("input",{type:"file",ref:En,onChange:Bl,accept:".xlsx,.xls",style:{display:"none"}})]})})})]})},$n=({category:C})=>{const _e=C.children&&C.children.length>0,ke=C.specifications&&C.specifications.length>0,Ve=Le.has(C.id);return i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center py-2 px-4 hover:bg-gray-50 cursor-pointer",style:{paddingLeft:`${16+C.level*24}px`},children:[(_e||ke)&&i.jsx("button",{onClick:()=>Bi(C.id),className:"mr-2 text-gray-500 hover:text-gray-700",children:Ve?"":""}),!(_e||ke)&&i.jsx("span",{className:"mr-2 w-4"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("span",{className:"font-medium",children:C.name}),C.description&&i.jsxs("span",{className:"text-gray-500 ml-2",children:["(",C.description,")"]})]})]}),Ve&&i.jsxs("div",{children:[C.specifications.map(wt=>i.jsxs("div",{className:"flex items-center py-1 px-4 hover:bg-gray-50",style:{paddingLeft:`${40+C.level*24}px`},children:[i.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-4",children:[i.jsx("span",{children:wt.name}),i.jsxs("span",{children:[wt.discount,"%"]}),i.jsxs("span",{children:[wt.cost," "]})]}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:()=>ie(wt),className:"text-blue-600 hover:text-blue-900 text-sm",children:""}),i.jsx("button",{onClick:()=>Te(wt.id),className:"text-red-600 hover:text-red-900 text-sm",children:""})]})]},wt.id)),C.children.map(wt=>i.jsx($n,{category:wt},wt.id))]})]})};return i.jsxs("div",{className:"p-8 relative",children:[N&&i.jsx("div",{className:"fixed top-4 right-4 z-50 transition-all duration-300 ease-in-out opacity-100",children:i.jsx("div",{className:`max-w-sm p-4 rounded-lg shadow-lg ${N.type==="success"?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{children:N.message}),i.jsx("button",{onClick:()=>P(null),className:"ml-4 text-gray-500 hover:text-gray-700 focus:outline-none text-xl font-bold",children:""})]})})}),t==="user"&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:" "}),r("settings_user_button")&&r("user_create")&&i.jsx("button",{onClick:()=>{s(!n),I(null),c({username:"",fullName:"",email:"",password:"",role:""})},className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:n?"":"+  "})]}),!n&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:" "}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsx("p",{className:"text-gray-900",children:e?.username||" "})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("p",{className:"text-gray-900",children:e?.email||" "})]})]}),ht&&i.jsxs("div",{className:"mt-4 bg-white rounded-lg shadow p-4",children:[i.jsx("h5",{className:"text-md font-semibold mb-4",children:rr?" ":"  "}),i.jsxs("form",{onSubmit:Un,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:Lt.name,onChange:C=>sr({...Lt,name:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"number",value:Lt.position,onChange:C=>sr({...Lt,position:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1",max:"999"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsx("input",{type:"text",value:Lt.allowedActions.join(", "),onChange:C=>sr({...Lt,allowedActions:C.target.value.split(",").map(_e=>_e.trim()).filter(_e=>_e)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"1, 2"})]}),i.jsxs("div",{className:"flex gap-2 pt-4",children:[i.jsx("button",{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition",children:rr?"":""}),i.jsx("button",{type:"button",onClick:()=>qt(!1),className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})]})]})]})]}),r("user_edit")&&i.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",style:{tableLayout:"fixed"},children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[120px]",style:{resize:"horizontal",overflow:"auto"},children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[120px]",style:{resize:"horizontal",overflow:"auto"},children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[120px]",style:{resize:"horizontal",overflow:"auto"},children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[120px]",style:{resize:"horizontal",overflow:"auto"},children:""}),r("user_create")&&i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[120px]",style:{resize:"horizontal",overflow:"auto"},children:""})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:k.map(C=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C.username}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C.fullName}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C.email}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C.role===""?"":C.role===""?" ":C.role===""?"":C.role===" "?" ":C.role===""?"":C.role===""?"":C.role===""?"":C.role}),r("user_create")&&i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("button",{onClick:()=>xe(C),className:"text-blue-600 hover:text-blue-900 mr-3",children:""}),C.role!==""&&i.jsx("button",{onClick:()=>R(C.id),className:"text-red-600 hover:text-red-900",children:""})]})]},C.id))})]})})]}),n&&i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:S?" ":"  "}),i.jsxs("form",{onSubmit:ps,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:o.username,onChange:C=>c({...o,username:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:o.fullName,onChange:C=>c({...o,fullName:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"email",value:o.email,onChange:C=>c({...o,email:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",S&&i.jsx("span",{className:"text-gray-500",children:"( ,   )"})]}),i.jsx("input",{type:"password",value:o.password,onChange:C=>c({...o,password:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!S,placeholder:S?" ,    ":""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsxs("select",{value:o.role,onChange:C=>c({...o,role:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!S,children:[i.jsx("option",{value:"",children:" "}),v.filter(C=>C.name!=="").map(C=>i.jsx("option",{value:C.name,children:C.name},C.id))]})]}),i.jsxs("div",{className:"flex gap-2 pt-4",children:[i.jsx("button",{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition",children:S?"":""}),i.jsx("button",{type:"button",onClick:()=>s(!1),className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})]})]})]})]}),t==="roles"&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:" "}),r("settings_role_button")&&r("role_create")&&i.jsx("button",{onClick:()=>{d(!u),m(null),y({name:"",description:"",permissions:{user_create:!1,user_edit:!1,user_delete:!1,role_create:!1,role_edit:!1,role_delete:!1,spec_category_create:!1,spec_category_edit:!1,spec_category_delete:!1,spec_create:!1,spec_edit:!1,spec_delete:!1,bid_type_create:!1,bid_type_edit:!1,bid_type_delete:!1,client_create:!1,client_edit:!1,client_delete:!1,client_object_create:!1,client_object_edit:!1,client_object_delete:!1,bid_create:!1,bid_edit:!1,bid_delete:!1,bid_equipment_add:!1,equipment_create:!1,equipment_edit:!1,equipment_delete:!1,tab_warehouse:!1,tab_salary:!1,settings_user_button:!1,settings_role_button:!1,settings_client_attributes_button:!1,settings_spec_category_button:!1,settings_spec_button:!1,settings_bid_type_button:!1,settings_administration_button:!1,backup_create:!1,backup_list:!1,backup_download:!1,backup_restore:!1,backup_delete:!1}})},className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:u?"":"+  "})]}),!u&&i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden mb-6",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),r("user_create")&&i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(C=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C.name}),i.jsx("td",{className:"px-6 py-4",children:C.description}),r("user_create")&&i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("button",{onClick:()=>jn(C),className:"text-blue-600 hover:text-blue-900 mr-3",children:""}),i.jsx("button",{onClick:()=>O(C.id),className:"text-red-600 hover:text-red-900",children:""})]})]},C.id))})]})}),u&&i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:h?" ":"  "}),i.jsxs("form",{onSubmit:Ir,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:p.name,onChange:C=>y({...p,name:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("textarea",{value:p.description,onChange:C=>y({...p,description:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",required:!0})]}),i.jsxs("div",{className:"mt-6",children:[i.jsx("h4",{className:"text-lg font-semibold mb-4",children:" "}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:""}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.user_create,onChange:C=>ae("user_create",C.target.checked),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.user_edit,onChange:C=>ae("user_edit",C.target.checked),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.user_delete,onChange:C=>ae("user_delete",C.target.checked),className:"mr-2"})," "]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:""}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.role_create,onChange:C=>ae("role_create",C.target.checked),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.role_edit,onChange:C=>ae("role_edit",C.target.checked),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.role_delete,onChange:C=>ae("role_delete",C.target.checked),className:"mr-2"})," "]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:""}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.client_create,onChange:C=>ae("client_create",C.target.checked),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.client_edit,onChange:C=>ae("client_edit",C.target.checked),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.client_delete,onChange:C=>ae("client_delete",C.target.checked),className:"mr-2"})," "]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:" "}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.client_object_create,onChange:C=>ae("client_object_create",C.target.checked),className:"mr-2"}),"  "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.client_object_edit,onChange:C=>ae("client_object_edit",C.target.checked),className:"mr-2"}),"  "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.client_object_delete,onChange:C=>ae("client_object_delete",C.target.checked),className:"mr-2"}),"  "]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:" "}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.spec_category_create,onChange:C=>ae("spec_category_create",C.target.checked),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.spec_category_edit,onChange:C=>ae("spec_category_edit",C.target.checked),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.spec_category_delete,onChange:C=>ae("spec_category_delete",C.target.checked),className:"mr-2"})," "]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:""}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.spec_create,onChange:C=>ae("spec_create",C.target.checked),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.spec_edit,onChange:C=>ae("spec_edit",C.target.checked),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.spec_delete,onChange:C=>ae("spec_delete",C.target.checked),className:"mr-2"})," "]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:" "}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.bid_type_create,onChange:C=>ae("bid_type_create",C.target.checked),className:"mr-2"}),"  "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.bid_type_edit,onChange:C=>ae("bid_type_edit",C.target.checked),className:"mr-2"}),"  "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.bid_type_delete,onChange:C=>ae("bid_type_delete",C.target.checked),className:"mr-2"}),"  "]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:""}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.bid_create,onChange:C=>ae("bid_create",C.target.checked),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.bid_edit,onChange:C=>ae("bid_edit",C.target.checked),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.bid_delete,onChange:C=>ae("bid_delete",C.target.checked),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.bid_equipment_add,onChange:C=>ae("bid_equipment_add",C.target.checked),className:"mr-2"}),"   "]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:""}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.equipment_create,onChange:C=>ae("equipment_create",C.target.checked),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.equipment_edit,onChange:C=>ae("equipment_edit",C.target.checked),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.equipment_delete,onChange:C=>ae("equipment_delete",C.target.checked),className:"mr-2"})," "]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:" "}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.tab_warehouse,onChange:C=>ae("tab_warehouse",C.target.checked),className:"mr-2"}),'   ""']}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.tab_salary,onChange:C=>ae("tab_salary",C.target.checked),className:"mr-2"}),'   "/"']})]})]}),i.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[i.jsx("h5",{className:"font-medium mb-3 text-blue-800",children:""}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.settings_user_button,onChange:C=>ae("settings_user_button",C.target.checked),className:"mr-2"}),'  ""']}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.settings_role_button,onChange:C=>ae("settings_role_button",C.target.checked),className:"mr-2"}),'  ""']}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.settings_client_attributes_button,onChange:C=>ae("settings_client_attributes_button",C.target.checked),className:"mr-2"}),'  " "']}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.settings_spec_category_button,onChange:C=>ae("settings_spec_category_button",C.target.checked),className:"mr-2"}),'  " "']}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.settings_spec_button,onChange:C=>ae("settings_spec_button",C.target.checked),className:"mr-2"}),'  ""']}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.settings_bid_type_button,onChange:C=>ae("settings_bid_type_button",C.target.checked),className:"mr-2"}),'  " "']}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.settings_administration_button,onChange:C=>ae("settings_administration_button",C.target.checked),className:"mr-2"}),'  ""']})]})]}),i.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[i.jsx("h5",{className:"font-medium mb-3 text-green-800",children:""}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.backup_create,onChange:C=>ae("backup_create",C.target.checked),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.backup_list,onChange:C=>ae("backup_list",C.target.checked),className:"mr-2"}),"  "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.backup_download,onChange:C=>ae("backup_download",C.target.checked),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.backup_restore,onChange:C=>ae("backup_restore",C.target.checked),className:"mr-2"}),"  "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.permissions.backup_delete,onChange:C=>ae("backup_delete",C.target.checked),className:"mr-2"})," "]})]})]})]})]}),i.jsxs("div",{className:"flex gap-2 pt-4",children:[i.jsx("button",{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition",children:h?"":""}),i.jsx("button",{type:"button",onClick:()=>{d(!1),m(null),y({name:"",description:"",permissions:{user_create:!1,user_edit:!1,user_delete:!1,role_create:!1,role_edit:!1,role_delete:!1,spec_category_create:!1,spec_category_edit:!1,spec_category_delete:!1,spec_create:!1,spec_edit:!1,spec_delete:!1,bid_type_create:!1,bid_type_edit:!1,bid_type_delete:!1,client_create:!1,client_edit:!1,client_delete:!1,client_object_create:!1,client_object_edit:!1,client_object_delete:!1,bid_create:!1,bid_edit:!1,bid_delete:!1,bid_equipment_add:!1,equipment_create:!1,equipment_edit:!1,equipment_delete:!1,tab_warehouse:!1,tab_salary:!1,settings_user_button:!1,settings_role_button:!1,settings_spec_category_button:!1,settings_spec_button:!1,settings_bid_type_button:!1}})},className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})]})]})]})]}),t==="specification-categories"&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"  "}),r("settings_spec_category_button")&&i.jsx("button",{onClick:()=>{Bt(!Rt),fr(null),Pt({name:"",description:"",parentId:""})},className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:Rt?"":"+  "})]}),!Rt&&i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsx("div",{className:"divide-y divide-gray-200",children:Xe.map(C=>i.jsx(wa,{category:C},C.id))})}),Rt&&i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:bt?" ":"  "}),i.jsxs("form",{onSubmit:Fe,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:kt.name,onChange:C=>Pt({...kt,name:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsxs("select",{value:kt.parentId,onChange:C=>Pt({...kt,parentId:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"  ( )"}),Qa(Xe,0,bt?.id).map(C=>i.jsx("option",{value:C.id,children:C.name},C.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("textarea",{value:kt.description,onChange:C=>Pt({...kt,description:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3"})]}),i.jsxs("div",{className:"flex gap-2 pt-4",children:[i.jsx("button",{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition",children:bt?"":""}),i.jsx("button",{type:"button",onClick:()=>Bt(!1),className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})]})]})]})]}),t==="bid-types"&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"  "}),r("settings_bid_type_button")&&i.jsx("button",{onClick:()=>{Tt(!Gt),Ze(null),vt({name:"",description:"",statuses:[{name:"",position:1,allowedActions:["edit","assign_executor"],color:"#dcfce7"},{name:"",position:999,allowedActions:[],color:"#f3f4f6"}],transitions:[{fromPosition:1,toPosition:999}]})},className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:Gt?"":"+   "})]}),!Gt&&i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Ut.map(C=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C.name}),i.jsx("td",{className:"px-6 py-4",children:C.description}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("button",{onClick:()=>Ct(C),className:"text-blue-600 hover:text-blue-900 mr-3",children:""}),i.jsx("button",{onClick:()=>Vt(C.id),className:"text-red-600 hover:text-red-900",children:""})]})]},C.id))})]})}),Gt&&i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:tr?"  ":"   "}),i.jsxs("form",{onSubmit:Et,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:qe.name,onChange:C=>vt({...qe,name:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("textarea",{value:qe.description,onChange:C=>vt({...qe,description:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3"})]}),i.jsxs("div",{className:"border-t pt-4 mt-4",children:[i.jsx("h4",{className:"text-md font-semibold mb-3",children:" SLA"}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"   ()"}),i.jsx("input",{type:"number",value:qe.plannedReactionTimeMinutes,onChange:C=>vt({...qe,plannedReactionTimeMinutes:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:": 60",min:"0"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"     "})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  ()"}),i.jsx("input",{type:"number",value:qe.plannedDurationMinutes,onChange:C=>vt({...qe,plannedDurationMinutes:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:": 8",min:"0",step:"0.5"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"    ( )"})]})]})]}),i.jsxs("div",{className:"mt-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h4",{className:"text-lg font-semibold",children:" "}),i.jsx("button",{type:"button",onClick:()=>{if(ht)qt(!1),Ar(null),sr({name:"",position:"",allowedActions:[]});else{const C=Bn(qe.statuses);if(C===null){alert("     ");return}const _e={name:" ",position:C,allowedActions:[],responsibleUserId:null,responsibleRoleId:null,color:"#ffffff"};vt({...qe,statuses:[...qe.statuses,_e]})}},className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:ht?"":"+  "})]}),i.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:""})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(qe.statuses||[]).sort((C,_e)=>C.position-_e.position).map(C=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:Or===C.position?i.jsx("input",{type:"text",value:C.name,onChange:_e=>ya(C.position,_e.target.value),onBlur:()=>Nr(null),onKeyDown:_e=>{_e.key==="Enter"&&Nr(null)},className:"w-full px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",autoFocus:!0}):C.position===1||C.position===999?i.jsx("span",{className:"px-1 py-1",children:C.name}):i.jsx("span",{onClick:()=>Nr(C.position),className:"cursor-pointer hover:underline px-1 py-1 rounded text-blue-600",children:C.name})}),i.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:C.position}),i.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:i.jsx("input",{type:"color",value:C.color||"#ffffff",onChange:_e=>{const ke=qe.statuses.map(Ve=>Ve.position===C.position?{...Ve,color:_e.target.value}:Ve);vt({...qe,statuses:ke})},className:"w-8 h-8 border border-gray-300 rounded cursor-pointer"})}),i.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:i.jsxs("select",{value:C.responsibleRoleId||"",onChange:_e=>{const ke=qe.statuses.map(Ve=>Ve.position===C.position?{...Ve,responsibleRoleId:_e.target.value||null}:Ve);vt({...qe,statuses:ke})},className:"w-full px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:" "}),v.map(_e=>i.jsx("option",{value:_e.id,children:_e.name},_e.id))]})}),i.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:i.jsxs("select",{value:C.responsibleUserId||"",onChange:_e=>{const ke=qe.statuses.map(Ve=>Ve.position===C.position?{...Ve,responsibleUserId:_e.target.value||null}:Ve);vt({...qe,statuses:ke})},className:"w-full px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:" "}),k.map(_e=>i.jsx("option",{value:_e.id,children:_e.fullName},_e.id))]})}),i.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:C.position!==1&&C.position!==999&&i.jsx("button",{type:"button",onClick:()=>zn(C),className:"text-red-600 hover:text-red-900 text-sm",children:""})})]},C.position))})]})}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h5",{className:"text-md font-semibold mb-4",children:"  "}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(qe.statuses||[]).sort((C,_e)=>C.position-_e.position).map(C=>i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("h6",{className:"font-medium mb-2",children:[": ",C.name]}),i.jsx("div",{className:"space-y-2",children:(qe.statuses||[]).filter(_e=>_e.position!==C.position).sort((_e,ke)=>_e.position-ke.position).map(_e=>{const ke=(qe.transitions||[]).find(Ve=>Ve.fromPosition===C.position&&Ve.toPosition===_e.position);return i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("span",{children:[": ",_e.name]}),ke?i.jsx("button",{type:"button",onClick:()=>hr(C.position,_e.position),className:"text-red-600 hover:text-red-900 text-sm",children:" "}):i.jsx("button",{type:"button",onClick:()=>gn(C.position,_e.position),className:"text-green-600 hover:text-green-900 text-sm",children:" "})]},_e.position)})})]},C.position))})]})]}),i.jsxs("div",{className:"flex gap-2 pt-4",children:[i.jsx("button",{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition",children:tr?"":""}),i.jsx("button",{type:"button",onClick:()=>{Tt(!1),qt(!1),Ar(null),sr({name:"",position:"",allowedActions:[]}),Nr(null)},className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})]})]})]})]}),t==="specifications"&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:" "}),r("settings_spec_button")&&i.jsx("button",{onClick:()=>{ce(!H),re(null),ve({categoryId:"",name:"",discount:"",cost:""})},className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:H?"":"+  "})]}),!H&&i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsx("div",{className:"divide-y divide-gray-200",children:ba(Xe,M).map(C=>i.jsx($n,{category:C},C.id))})}),H&&i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:le?" ":"  "}),i.jsxs("form",{onSubmit:E,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsxs("select",{value:te.categoryId,onChange:C=>ve({...te,categoryId:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:" "}),Pe.map(C=>i.jsx("option",{value:C.id,children:C.name},C.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:te.name,onChange:C=>ve({...te,name:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" (%)"}),i.jsx("input",{type:"number",step:"0.01",value:te.discount,onChange:C=>ve({...te,discount:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,min:"0",max:"100"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"number",step:"0.01",value:te.cost,onChange:C=>ve({...te,cost:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,min:"0"})]})]}),i.jsxs("div",{className:"flex gap-2 pt-4",children:[i.jsx("button",{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition",children:le?"":""}),i.jsx("button",{type:"button",onClick:()=>ce(!1),className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})]})]})]})]}),t==="client-attributes"&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:" "}),i.jsx("button",{onClick:()=>{T({name:"",type:"string",options:[],isEnabled:!0}),me(null),ne(!0)},className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:"+  "})]}),i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Se.map(C=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C.name}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C.type}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C.isEnabled?"":""}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("button",{onClick:()=>{T({name:C.name,type:C.type,options:C.options||[],isEnabled:C.isEnabled}),me(C),ne(!0)},className:"text-blue-600 hover:text-blue-900 mr-2",children:""}),i.jsx("button",{onClick:()=>q(C.id),className:"text-red-600 hover:text-red-900",children:""})]})]},C.id))})]})}),ue&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:A?" ":" "}),i.jsxs("form",{onSubmit:U,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:z.name,onChange:C=>T({...z,name:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsxs("select",{value:z.type,onChange:C=>T({...z,type:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"string",children:""}),i.jsx("option",{value:"number",children:""}),i.jsx("option",{value:"boolean",children:""}),i.jsx("option",{value:"select",children:" "}),i.jsx("option",{value:"multiselect",children:"   "}),i.jsx("option",{value:"image",children:""})]})]}),(z.type==="select"||z.type==="multiselect")&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" ( )"}),i.jsx("input",{type:"text",value:z.options?z.options.join(", "):"",onChange:C=>T({...z,options:C.target.value.split(",").map(_e=>_e.trim()).filter(_e=>_e)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:" 1,  2,  3"})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:z.isEnabled,onChange:C=>T({...z,isEnabled:C.target.checked}),className:"mr-2"}),i.jsx("label",{className:"text-sm font-medium text-gray-700",children:""})]}),i.jsxs("div",{className:"flex gap-2 pt-4",children:[i.jsx("button",{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition",children:A?"":""}),i.jsx("button",{type:"button",onClick:()=>ne(!1),className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})]})]})]})})]}),t==="subject-forms"&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"   "}),i.jsx("button",{onClick:()=>{je({name:""}),we(null),K(!0)},className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:"+   "})]}),i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Q.map(C=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C.name}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("button",{onClick:()=>he(C),className:"text-blue-600 hover:text-blue-900 mr-2",children:""}),i.jsx("button",{onClick:()=>Ne(C.id),className:"text-red-600 hover:text-red-900",children:""})]})]},C.id))})]})}),J&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:fe?"  ":"  "}),i.jsxs("form",{onSubmit:G,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:ye.name,onChange:C=>je({...ye,name:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{className:"flex gap-2 pt-4",children:[i.jsx("button",{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition",children:fe?"":""}),i.jsx("button",{type:"button",onClick:()=>{K(!1),we(null),je({name:""})},className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})]})]})]})})]}),t==="administration"&&i.jsxs("div",{children:[i.jsx("div",{className:"flex justify-between items-center mb-6",children:i.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:""})}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:" "}),i.jsxs("div",{className:"flex gap-4",children:[i.jsx("button",{onClick:()=>Ur(!0),className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:" "}),i.jsx("button",{onClick:vn,className:"flex-1 bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition",children:" "})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:" "}),i.jsxs("div",{className:"flex gap-4",children:[i.jsx("button",{onClick:()=>zr(!0),className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:" "}),i.jsx("button",{onClick:Qn,className:"flex-1 bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition",children:" "})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:" "}),i.jsxs("div",{className:"flex gap-4",children:[i.jsx("button",{onClick:Js,className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",children:" "}),i.jsx("button",{onClick:Ys,className:"flex-1 bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition",children:" "})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsx(wD,{})})]})]}),Br&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:i.jsxs("div",{className:"p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:" "}),i.jsxs("div",{className:"mb-4",children:[i.jsx("p",{className:"text-sm text-gray-600 mb-2",children:" Excel    .     :"}),i.jsxs("ul",{className:"text-sm text-gray-600 list-disc list-inside space-y-1",children:[i.jsx("li",{children:" -  "}),i.jsx("li",{children:" -  "}),i.jsx("li",{children:"  - email "}),i.jsx("li",{children:" -  "}),i.jsx("li",{children:"  -   "}),i.jsx("li",{children:" -  "})]})]}),i.jsxs("div",{className:"flex gap-2 pt-4",children:[i.jsx("button",{onClick:Ll,className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition",children:" "}),i.jsx("button",{onClick:()=>Ur(!1),className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg transition",children:""})]}),i.jsx("input",{type:"file",ref:Yr,onChange:Ui,accept:".xlsx,.xls",style:{display:"none"}})]})})})]})},kD=()=>{const e=xs(),[r,t]=j.useState([]),[n,s]=j.useState(!1),[o,c]=j.useState({startDate:"",endDate:"",userId:"all"}),[u,d]=j.useState([]),[h,m]=j.useState(!1),p=["date","specification","cost","executor","bid","creator","client"],y=localStorage.getItem("salaryVisibleColumns"),k=y?JSON.parse(y):{date:!0,specification:!0,cost:!0,executor:!0,bid:!0,client:!0},b=localStorage.getItem("salaryColumnOrder"),v=b?JSON.parse(b):p,[w,S]=j.useState(v),[I,N]=j.useState(k),[P,W]=j.useState(!1);j.useEffect(()=>{(async()=>{try{const A=await Ga();t(A.data)}catch(A){console.error("Error fetching users:",A)}})()},[]),j.useEffect(()=>{localStorage.setItem("salaryVisibleColumns",JSON.stringify(I))},[I]),j.useEffect(()=>{localStorage.setItem("salaryColumnOrder",JSON.stringify(w))},[w]),j.useEffect(()=>{const ne=A=>{P&&!A.target.closest(".column-settings")&&W(!1)};return document.addEventListener("mousedown",ne),()=>document.removeEventListener("mousedown",ne)},[P]);const X=ne=>{const{name:A,value:me}=ne.target;c({...o,[A]:me})},M=async()=>{if(!o.startDate||!o.endDate){alert(",   ");return}m(!0);try{const ne={startDate:o.startDate,endDate:o.endDate};o.userId!=="all"&&(ne.userId=o.userId);const A=await lN(ne);d(A.data)}catch(ne){console.error("Error generating salary report:",ne),alert("   ")}finally{m(!1)}},Z=u.reduce((ne,A)=>ne+parseFloat(A.specification.cost),0),H=u.reduce((ne,A)=>{const me=parseFloat(A.specification.cost),z=A.executors.length,T=z>0?me/z:0;return A.executors.forEach(Q=>{ne[Q.id]||(ne[Q.id]={name:Q.fullName||Q.username,total:0,count:0}),ne[Q.id].total+=T,ne[Q.id].count+=1}),ne},{}),ce=Object.values(H).sort((ne,A)=>A.total-ne.total),le=ne=>{N(A=>({...A,[ne]:!A[ne]}))},re=ne=>{if(ne>0){const A=[...w];[A[ne],A[ne-1]]=[A[ne-1],A[ne]],S(A)}},te=ne=>{if(ne<w.length-1){const A=[...w];[A[ne],A[ne+1]]=[A[ne+1],A[ne]],S(A)}},ve=ne=>{switch(ne){case"date":return"";case"specification":return"";case"cost":return"";case"executor":return"";case"bid":return"";case"creator":return"";case"client":return"";default:return ne}},Se=(ne,A)=>{switch(A){case"date":return new Date(ne.createdAt).toLocaleDateString("ru-RU");case"specification":return ne.specification.name;case"cost":return`${parseFloat(ne.specification.cost).toFixed(2)} .`;case"executor":return ne.executors&&ne.executors.length>0?ne.executors.map(me=>me.fullName||me.username).join(", "):" ";case"bid":return i.jsxs("span",{className:"text-blue-600 hover:text-blue-800 cursor-pointer underline",onClick:()=>ue(ne.bid.id),children:[" ",ne.bid.id]});case"creator":return ne.bid.creator?ne.bid.creator.fullName||ne.bid.creator.username:" ";case"client":return ne.bid.client.name;default:return""}},Ce=w.filter(ne=>I[ne]),ue=ne=>{e(`/dashboard/bids/${ne}`)};return i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:""}),i.jsxs("div",{className:"bg-gray-200 rounded-lg p-4 mb-6",children:[i.jsx("div",{className:"mb-4",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsx("input",{type:"date",name:"startDate",value:o.startDate,onChange:X,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsx("input",{type:"date",name:"endDate",value:o.endDate,onChange:X,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsxs("select",{name:"userId",value:o.userId,onChange:X,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:" "}),r.map(ne=>i.jsx("option",{value:ne.id,children:ne.fullName||ne.username},ne.id))]})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{onClick:M,disabled:h,className:"w-full bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300 text-white px-4 py-2 rounded-lg transition",children:h?"...":""})})]})}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("div",{className:"relative column-settings",children:[i.jsx("button",{onClick:()=>W(!P),className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition",children:" "}),P&&i.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white border border-gray-300 rounded-lg shadow-lg z-10 column-settings",children:i.jsxs("div",{className:"p-4",children:[i.jsx("h4",{className:"font-medium mb-2",children:" "}),w.map((ne,A)=>i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:I[ne],onChange:()=>le(ne),className:"mr-2"}),ve(ne)]}),I[ne]&&i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>re(A),disabled:A===0,className:"px-2 py-1 bg-gray-200 hover:bg-gray-300 disabled:opacity-50 text-xs rounded",children:""}),i.jsx("button",{onClick:()=>te(A),disabled:A===w.length-1,className:"px-2 py-1 bg-gray-200 hover:bg-gray-300 disabled:opacity-50 text-xs rounded",children:""})]})]},ne))]})})]})})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:[u.length>0&&i.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-b",children:[i.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["  : ",o.startDate," - ",o.endDate]}),i.jsxs("p",{className:"text-sm text-gray-600",children:[" : ",u.length," |  : ",Z.toFixed(2)," ."]})]}),i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",style:{tableLayout:"fixed"},children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsx("tr",{children:Ce.map(ne=>i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[120px]",style:{resize:"horizontal",overflow:"auto"},children:ve(ne)},ne))})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.length>0?u.map(ne=>i.jsx("tr",{children:Ce.map(A=>i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Se(ne,A)},A))},ne.id)):i.jsx("tr",{children:i.jsx("td",{colSpan:Ce.length,className:"px-6 py-8 text-center text-gray-500",children:'    ""   '})})})]})]}),u.length>0&&i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-x-auto mt-6",children:[i.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b",children:i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"  "})}),i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",style:{tableLayout:"fixed"},children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[120px]",style:{resize:"horizontal",overflow:"auto"},children:""}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[120px]",style:{resize:"horizontal",overflow:"auto"},children:" "}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[120px]",style:{resize:"horizontal",overflow:"auto"},children:" "})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ce.map((ne,A)=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium",children:ne.name}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ne.count}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap font-medium",children:[ne.total.toFixed(2)," ."]})]},A))})]})]})]})},ND=()=>{const[e,r]=j.useState({totalBids:0,issuedEquipmentCount:0,totalSpecifications:0,completedBids:0,avgCompletionHours:0,userStats:[]}),[t,n]=j.useState(!0),[s,o]=j.useState("all"),[c,u]=j.useState(""),{showError:d}=X1(),h=[{value:"all",label:" "},{value:"year",label:""},{value:"halfYear",label:" "},{value:"month",label:""},{value:"week",label:""},{value:"day",label:""}],m=["day","week","month","halfYear","year"];j.useEffect(()=>{p()},[s,c]);const p=async()=>{try{n(!0);const S=await dN(s,c);r(S.data)}catch(S){console.error("Error fetching analytics:",S),d("   ","   ")}finally{n(!1)}},y=()=>{const S=h.find(I=>I.value===s);return S?S.label:" "},k=S=>{const I=S.target.value;o(I),u("")},b=S=>{u(S.target.value)},v=()=>m.includes(s),w=()=>{if(!c)return" ";const S=new Date(c),I={year:"numeric",month:"long",day:"numeric"};if(s==="day")return` ${S.toLocaleDateString("ru-RU",I)}`;if(s==="week"){const N=new Date(S);return N.setDate(N.getDate()+6),` ${S.toLocaleDateString("ru-RU",I)}  ${N.toLocaleDateString("ru-RU",I)}`}else if(s==="month"){const N=new Date(S);return N.setMonth(N.getMonth()+1),N.setDate(N.getDate()-1),` ${S.toLocaleDateString("ru-RU",I)}  ${N.toLocaleDateString("ru-RU",I)}`}else if(s==="halfYear"){const N=new Date(S);return N.setMonth(N.getMonth()+6),N.setDate(N.getDate()-1),` ${S.toLocaleDateString("ru-RU",I)}  ${N.toLocaleDateString("ru-RU",I)}`}else if(s==="year"){const N=new Date(S);return N.setFullYear(N.getFullYear()+1),N.setDate(N.getDate()-1),` ${S.toLocaleDateString("ru-RU",I)}  ${N.toLocaleDateString("ru-RU",I)}`}return""};return t?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"text-gray-500",children:" ..."})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:""}),i.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(PN,{size:18,className:"text-gray-500"}),i.jsx("select",{value:s,onChange:k,className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:h.map(S=>i.jsx("option",{value:S.value,children:S.label},S.value))})]}),v()&&i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("input",{type:"date",value:c,onChange:b,className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white"})}),i.jsxs("button",{onClick:p,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition",children:[i.jsx(y4,{size:18}),""]})]})]}),i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg px-4 py-2",children:i.jsxs("span",{className:"text-blue-700 font-medium",children:[": ",y(),v()&&c&&i.jsxs("span",{className:"text-blue-600",children:[" ",w()]}),v()&&!c&&i.jsx("span",{className:"text-gray-500",children:" ( )"})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-blue-500",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500 mb-1",children:" "}),i.jsx("p",{className:"text-3xl font-bold text-gray-800",children:e.issuedEquipmentCount})]}),i.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:i.jsx(W1,{className:"text-blue-600",size:28})})]}),i.jsxs("div",{className:"mt-4 flex items-center text-sm text-green-600",children:[i.jsx(dl,{size:16,className:"mr-1"}),i.jsx("span",{children:" "})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-green-500",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500 mb-1",children:" "}),i.jsx("p",{className:"text-3xl font-bold text-gray-800",children:e.totalBids})]}),i.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:i.jsx(H1,{className:"text-green-600",size:28})})]}),i.jsxs("div",{className:"mt-4 flex items-center text-sm text-green-600",children:[i.jsx(dl,{size:16,className:"mr-1"}),i.jsx("span",{children:"  "})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-purple-500",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500 mb-1",children:""}),i.jsx("p",{className:"text-3xl font-bold text-gray-800",children:e.totalBids>0?(e.issuedEquipmentCount/e.totalBids).toFixed(2):0})]}),i.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:i.jsx(dl,{className:"text-purple-600",size:28})})]}),i.jsx("div",{className:"mt-4 flex items-center text-sm text-purple-600",children:i.jsx("span",{children:"   "})})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-orange-500",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500 mb-1",children:" "}),i.jsx("p",{className:"text-3xl font-bold text-gray-800",children:e.totalSpecifications})]}),i.jsx("div",{className:"bg-orange-100 p-3 rounded-full",children:i.jsx(Sl,{className:"text-orange-600",size:28})})]}),i.jsxs("div",{className:"mt-4 flex items-center text-sm text-orange-600",children:[i.jsx(dl,{size:16,className:"mr-1"}),i.jsx("span",{children:"  "})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-green-500",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500 mb-1",children:" "}),i.jsx("p",{className:"text-3xl font-bold text-gray-800",children:e.completedBids})]}),i.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:i.jsx(qN,{className:"text-green-600",size:28})})]}),i.jsxs("div",{className:"mt-4 flex items-center text-sm text-green-600",children:[i.jsx(dl,{size:16,className:"mr-1"}),i.jsx("span",{children:" "})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-indigo-500",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"  "}),i.jsx("p",{className:"text-3xl font-bold text-gray-800",children:e.avgCompletionHours>0?`${e.avgCompletionHours.toFixed(1)} .`:""})]}),i.jsx("div",{className:"bg-indigo-100 p-3 rounded-full",children:i.jsx(KN,{className:"text-indigo-600",size:28})})]}),i.jsxs("div",{className:"mt-4 flex items-center text-sm text-indigo-600",children:[i.jsx(dl,{size:16,className:"mr-1"}),i.jsx("span",{children:"   "})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:" "}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:""}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:" :"}),i.jsx("span",{className:"font-semibold",children:e.issuedEquipmentCount})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-semibold text-blue-600",children:y()})]})]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:""}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:" :"}),i.jsx("span",{className:"font-semibold",children:e.totalBids})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-semibold text-orange-600",children:e.totalSpecifications})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-semibold text-green-600",children:e.completedBids})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:". :"}),i.jsx("span",{className:"font-semibold text-indigo-600",children:e.avgCompletionHours>0?`${e.avgCompletionHours.toFixed(1)} .`:""})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:":"}),i.jsx("span",{className:"font-semibold text-blue-600",children:e.totalBids>0?"100%":"0%"})]})]})]})]})]}),e.userStats&&e.userStats.length>0&&i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(V1,{className:"text-gray-600",size:20}),i.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"  "})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-100",children:[i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-600",children:""}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-600",children:""}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-600",children:" "}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-600",children:""})]})}),i.jsx("tbody",{children:e.userStats.map((S,I)=>{const N=e.totalBids>0?(S.bidCount/e.totalBids*100).toFixed(1):0;return i.jsxs("tr",{className:`border-b ${I===0?"bg-yellow-50":""}`,children:[i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:i.jsx("span",{className:`inline-flex items-center justify-center w-6 h-6 rounded-full text-xs font-semibold ${I===0?"bg-yellow-400 text-white":I===1?"bg-gray-400 text-white":I===2?"bg-orange-400 text-white":"bg-gray-200 text-gray-600"}`,children:I+1})}),i.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-800",children:S.userName}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:S.bidCount}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 max-w-100",children:i.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${N}%`}})}),i.jsxs("span",{className:"text-sm text-gray-600",children:[N,"%"]})]})})]},S.userId)})})]})})]})]})},SD=({contract:e,onClose:r})=>{if(!e)return null;const t=s=>s?new Date(s).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"}):"-",n=()=>{if(!e.contractEndDate)return"-";const s=new Date,c=new Date(e.contractEndDate)-s,u=Math.ceil(c/(1e3*60*60*24));return u<0?i.jsxs("span",{className:"text-red-500 font-medium",children:[" (",Math.abs(u)," .)"]}):u<=7?i.jsxs("span",{className:"text-orange-500 font-medium",children:[u," ."]}):i.jsxs("span",{className:"text-green-500",children:[u," ."]})};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200",children:[i.jsxs("h2",{className:"text-lg font-semibold text-gray-800",children:["  ",e.id]}),i.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 transition",children:i.jsx(El,{size:24})})]}),i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-3 uppercase tracking-wide",children:" "}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:" "}),i.jsx("p",{className:"font-medium",children:e.contractNumber||"-"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:" "}),i.jsx("p",{className:"font-medium text-blue-600",children:e.id})]})]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-3 uppercase tracking-wide",children:"  "}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:""}),i.jsx("p",{className:"font-medium",children:e.clientName||"-"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:""}),i.jsx("p",{className:"font-medium",children:e.responsibleName||"-"})]})]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-3 uppercase tracking-wide",children:"  "}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:""}),i.jsx("p",{className:"font-medium",children:e.clientObject?`${e.clientObject.brandModel} ${e.clientObject.stateNumber?`(${e.clientObject.stateNumber})`:""}`:"-"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:""}),i.jsx("p",{className:"font-medium",children:e.equipmentName||"-"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"IMEI"}),i.jsx("p",{className:"font-medium font-mono text-sm",children:e.imei||"-"})]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:""}),i.jsx("p",{className:"font-medium",children:e.quantity||"-"})]})]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-3 uppercase tracking-wide",children:" "}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"  "}),i.jsx("p",{className:"font-medium",children:t(e.contractEndDate)})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:" "}),i.jsx("p",{className:"font-medium",children:n()})]})]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-3 uppercase tracking-wide",children:""}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:""}),i.jsx("p",{className:"font-medium",children:t(e.createdAt)})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:""}),i.jsx("p",{className:"font-medium",children:t(e.updatedAt)})]})]})]})]}),i.jsx("div",{className:"flex justify-end gap-3 p-4 border-t border-gray-200",children:i.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition",children:""})})]})})},ED=()=>{const e=xs(),[r,t]=j.useState([]),[n,s]=j.useState(!0),[o,c]=j.useState(null),[u,d]=j.useState(!1),[h,m]=j.useState({page:1,limit:20,total:0,totalPages:0}),[p,y]=j.useState(""),[k,b]=j.useState({client:"",responsible:"",clientObject:"",equipment:""}),[v,w]=j.useState({key:null,direction:"asc"}),S=["id","bidNumber","clientName","responsibleName","clientObject","equipmentName","imei","quantity","contractEndDate","remainingDays"],I={id:!0,bidNumber:!0,clientName:!0,responsibleName:!0,clientObject:!0,equipmentName:!0,imei:!0,quantity:!0,contractEndDate:!0,remainingDays:!0},N=localStorage.getItem("contractsVisibleColumns"),P=N?{...I,...JSON.parse(N)}:I,W=localStorage.getItem("contractsColumnOrder");let X=W?JSON.parse(W).filter(D=>S.includes(D)):S;S.forEach(D=>{X.includes(D)||X.push(D)});const[M,Z]=j.useState(X),[H,ce]=j.useState(P),[le,re]=j.useState(!1),[te,ve]=j.useState([]),[Se,Ce]=j.useState([]),[ue,ne]=j.useState(()=>{const D=localStorage.getItem("contractsVisibleFilters");return D?JSON.parse(D):{client:!0,responsible:!0,clientObject:!0,equipment:!0}}),[A,me]=j.useState(!1);j.useEffect(()=>{T(),z()},[h.page,h.limit,k,v]),j.useEffect(()=>{localStorage.setItem("contractsVisibleColumns",JSON.stringify(H))},[H]),j.useEffect(()=>{localStorage.setItem("contractsColumnOrder",JSON.stringify(M))},[M]),j.useEffect(()=>{localStorage.setItem("contractsVisibleFilters",JSON.stringify(ue))},[ue]),j.useEffect(()=>{const D=Pe=>{le&&!Pe.target.closest(".column-settings")&&re(!1)};return document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[le]);const z=async()=>{try{const D=await Ga();ve(D.data);const Pe=await lc();Ce(Pe.data)}catch(D){console.error("Error fetching filters:",D)}},T=async()=>{try{s(!0);const D={page:h.page,limit:h.limit,search:p,...k};v.key&&(D.sortBy=v.key,D.sortOrder=v.direction);const Pe=await mN(D);t(Pe.data.data),m(rt=>({...rt,total:Pe.data.pagination.total,totalPages:Pe.data.pagination.totalPages}))}catch(D){console.error("Error fetching contracts:",D)}finally{s(!1)}},Q=D=>{D.preventDefault(),m(Pe=>({...Pe,page:1})),T()},Y=D=>{let Pe="asc";v.key===D&&v.direction==="asc"&&(Pe="desc"),w({key:D,direction:Pe})},J=D=>{ce(Pe=>({...Pe,[D]:!Pe[D]}))},K=D=>{if(D>0){const Pe=[...M];[Pe[D],Pe[D-1]]=[Pe[D-1],Pe[D]],Z(Pe)}},fe=D=>{if(D<M.length-1){const Pe=[...M];[Pe[D],Pe[D+1]]=[Pe[D+1],Pe[D]],Z(Pe)}},we=D=>v.key!==D?i.jsxs("div",{className:"w-4 h-4 flex items-center justify-center opacity-30",children:[i.jsx(id,{size:14}),i.jsx(vl,{size:14})]}):v.direction==="asc"?i.jsx(id,{size:16}):i.jsx(vl,{size:16}),ye=D=>{switch(D){case"id":return"";case"bidNumber":return" ";case"clientName":return"";case"responsibleName":return"";case"clientObject":return"";case"equipmentName":return"";case"imei":return"Imei";case"quantity":return"";case"contractEndDate":return" ";case"remainingDays":return"  ()";default:return D}},je=(D,Pe)=>{switch(Pe){case"id":return i.jsxs("span",{className:"font-medium",children:[" ",D.id]});case"bidNumber":return i.jsxs("span",{className:"font-medium text-blue-600 hover:underline",onClick:rt=>{rt.stopPropagation(),e(`/dashboard/bids/${D.id}`)},children:[" ",D.id]});case"clientName":return D.clientName||"-";case"responsibleName":return D.responsibleName||"-";case"clientObject":return D.clientObject?`${D.clientObject.brandModel} ${D.clientObject.stateNumber?`(${D.clientObject.stateNumber})`:""}`:"-";case"equipmentName":return D.equipmentName||"-";case"imei":return D.imei||"-";case"quantity":return D.quantity||"-";case"contractEndDate":return D.contractEndDate?new Date(D.contractEndDate).toLocaleDateString():"-";case"remainingDays":if(D.contractEndDate){const rt=new Date,nt=new Date(D.contractEndDate)-rt,Le=Math.ceil(nt/(1e3*60*60*24));return Le<0?i.jsxs("span",{className:"text-red-500 font-medium",children:[" (",Math.abs(Le)," .)"]}):Le<=7?i.jsxs("span",{className:"text-orange-500 font-medium",children:[Le," ."]}):i.jsxs("span",{className:"text-green-500",children:[Le," ."]})}return"-";default:return""}},Xe=M.filter(D=>H[D]);return i.jsxs("div",{className:"contracts-page",children:[i.jsx("div",{className:"flex justify-between items-center mb-6",children:i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:""})}),A&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h3",{className:"text-lg font-medium",children:" "}),i.jsx("button",{onClick:()=>me(!1),children:i.jsx(El,{size:20})})]}),i.jsx("div",{className:"space-y-3",children:Object.keys(ue).map(D=>i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:ue[D],onChange:()=>ne(Pe=>({...Pe,[D]:!Pe[D]})),className:"rounded"}),i.jsx("span",{className:"capitalize",children:D==="client"?"":D==="responsible"?"":D==="clientObject"?"":D==="equipment"?"":D})]},D))})]})}),i.jsx("form",{onSubmit:Q,className:"bg-gray-200 rounded-lg p-4 mb-6 border border-gray-300 flex-none",children:i.jsxs("div",{className:"flex flex-col gap-4",children:[i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsxs("div",{className:"relative",children:[i.jsx("button",{type:"button",onClick:()=>re(!le),className:"px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition",children:""}),le&&i.jsxs("div",{className:"column-settings absolute right-0 top-full mt-2 w-64 bg-white border border-gray-300 rounded-lg shadow-lg z-50 max-h-96 overflow-y-auto",children:[i.jsxs("div",{className:"p-3 border-b border-gray-200 flex justify-between items-center",children:[i.jsx("h3",{className:"font-medium",children:" "}),i.jsx("button",{type:"button",onClick:()=>re(!1),children:i.jsx(El,{size:16})})]}),i.jsx("div",{className:"p-2",children:M.map((D,Pe)=>i.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded",children:[i.jsxs("label",{className:"flex items-center gap-2 flex-1 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:H[D],onChange:()=>J(D),className:"rounded"}),i.jsx("span",{className:"text-sm",children:ye(D)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("button",{type:"button",onClick:()=>K(Pe),disabled:Pe===0,className:"text-gray-400 hover:text-gray-600 disabled:opacity-30",children:i.jsx(id,{size:14})}),i.jsx("button",{type:"button",onClick:()=>fe(Pe),disabled:Pe===M.length-1,className:"text-gray-400 hover:text-gray-600 disabled:opacity-30",children:i.jsx(vl,{size:14})})]})]},D))})]})]}),i.jsx("button",{type:"button",onClick:()=>me(!0),className:"px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition",children:""})]}),i.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[i.jsx("div",{className:"flex-1 min-w-64",children:i.jsx("input",{type:"text",placeholder:"...",value:p,onChange:D=>y(D.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),ue.client&&i.jsx("div",{className:"w-48",children:i.jsx("select",{value:k.client,onChange:D=>b(Pe=>({...Pe,client:D.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:i.jsx("option",{value:"",children:" "})})}),ue.responsible&&i.jsx("div",{className:"w-48",children:i.jsxs("select",{value:k.responsible,onChange:D=>b(Pe=>({...Pe,responsible:D.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:" "}),te.map(D=>i.jsx("option",{value:D.id,children:D.fullName},D.id))]})}),ue.clientObject&&i.jsx("div",{className:"w-48",children:i.jsxs("select",{value:k.clientObject,onChange:D=>b(Pe=>({...Pe,clientObject:D.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:" "}),Se.map(D=>i.jsxs("option",{value:D.id,children:[D.brandModel," ",D.stateNumber]},D.id))]})}),ue.equipment&&i.jsx("div",{className:"w-48",children:i.jsx("input",{type:"text",placeholder:"...",value:k.equipment,onChange:D=>b(Pe=>({...Pe,equipment:D.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition",children:""}),i.jsx("button",{type:"button",onClick:()=>{b({client:"",responsible:"",clientObject:"",equipment:""}),y(""),m(D=>({...D,page:1})),T()},className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition",children:""})]})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto table-container flex-1 min-h-0",children:i.jsxs("table",{className:"divide-y divide-gray-200",style:{minWidth:`${Xe.length*120}px`},children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsx("tr",{children:Xe.map(D=>i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 resize-x overflow-auto cursor-pointer hover:bg-gray-100 transition",style:{minWidth:"1px"},onClick:()=>Y(D),children:i.jsxs("div",{className:"flex items-center gap-1",children:[ye(D),we(D)]})},D))})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n?i.jsx("tr",{children:i.jsx("td",{colSpan:Xe.length,className:"px-4 py-8 text-center text-gray-500",children:"..."})}):r.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:Xe.length,className:"px-4 py-8 text-center text-gray-500",children:"  "})}):r.map(D=>i.jsx("tr",{className:"hover:bg-gray-50 cursor-pointer transition",onClick:()=>{c(D),d(!0)},children:Xe.map(Pe=>i.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 whitespace-nowrap",children:je(D,Pe)},Pe))},D.id))})]})}),!n&&r.length>0&&i.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-700",children:[" ",r.length,"  ",h.total," "]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>m(D=>({...D,page:D.page-1})),disabled:h.page===1,className:"px-3 py-1 border border-gray-300 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""}),i.jsxs("span",{className:"px-3 py-1",children:[" ",h.page,"  ",h.totalPages]}),i.jsx("button",{onClick:()=>m(D=>({...D,page:D.page+1})),disabled:h.page===h.totalPages,className:"px-3 py-1 border border-gray-300 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""})]})]})]}),u&&i.jsx(SD,{contract:o,onClose:()=>{d(!1),c(null)}})]})};function jD(){return i.jsx(vw,{children:i.jsx(_N,{children:i.jsx(nS,{children:i.jsxs(uw,{children:[i.jsx(qr,{path:"/login",element:i.jsx(NN,{})}),i.jsxs(qr,{path:"/dashboard",element:i.jsx(kN,{children:i.jsx(sS,{})}),children:[i.jsx(qr,{index:!0,element:i.jsx(To,{to:"/dashboard/bids",replace:!0})})," ",i.jsx(qr,{path:"clients",element:i.jsx(aS,{})})," ",i.jsx(qr,{path:"clients/:id",element:i.jsx(lS,{})})," ",i.jsx(qr,{path:"client-objects/:id",element:i.jsx(pS,{})})," ",i.jsx(qr,{path:"objects",element:i.jsx(gS,{})})," ",i.jsx(qr,{path:"bids",element:i.jsx(iS,{})})," ",i.jsx(qr,{path:"bids/:id",element:i.jsx(cS,{})})," ",i.jsx(qr,{path:"equipment",element:i.jsx(Op,{permissions:"tab_warehouse",children:i.jsx(yS,{})})})," ",i.jsx(qr,{path:"suppliers/create",element:i.jsx(bS,{})})," ",i.jsx(qr,{path:"salary",element:i.jsx(Op,{permissions:"tab_salary",children:i.jsx(kD,{})})})," ",i.jsx(qr,{path:"analytics",element:i.jsx(ND,{})})," ",i.jsx(qr,{path:"settings",element:i.jsx(_D,{})})," ",i.jsx(qr,{path:"contracts",element:i.jsx(ED,{})})," "]}),i.jsx(qr,{path:"/",element:i.jsx(To,{to:"/dashboard/bids",replace:!0})}),i.jsx(qr,{path:"*",element:i.jsx(To,{to:"/dashboard/bids",replace:!0})})]})})})})}gb.createRoot(document.getElementById("root")).render(i.jsx(Yg.StrictMode,{children:i.jsx(jD,{})}));
